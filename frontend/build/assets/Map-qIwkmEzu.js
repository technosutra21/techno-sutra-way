import{j as e}from"./ui-CNstozTn.js";import{r}from"./vendor-DWZhD1wM.js";import{D as Ee,M as We,t as Te,a as F,n as Ie}from"./maps-B--tHXM4.js";/* empty css                     */import{c as v,B as d,a as Re,R as Ae,U as Fe}from"./index-CAhwwkRS.js";import{C as k}from"./card-N_mjhS3w.js";import{S as Ue,I as Ve}from"./input-6w1Nlqf7.js";import{B as De,u as He,E as Oe}from"./useSutraData-C8uNhd6z.js";import{C as Be}from"./CharacterDetailModal-iOjpSZQv.js";import{l as me}from"./logger-CnUqTrA3.js";import{N as G,Z as _,u as qe}from"./useProgress-DaXfEfUy.js";import{A as U,m as i}from"./animations-CDP8czNI.js";import{M as ue}from"./map-pin-3k3DvKoB.js";import"./query-CJXKl7Sg.js";import"./router-DAaxAjqu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=v("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=v("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=v("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=v("LocateFixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=v("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=v("SignalHigh",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=v("SignalLow",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=v("SignalMedium",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=v("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=v("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),tt=({isTrackingUser:u,userLocation:n,userAccuracy:l,nearbyWaypoints:M,visitedCount:f,totalProgress:w,onStartTracking:S,onStopTracking:V,onCenterOnUser:L,onMarkVisited:P})=>{const N=x=>x?x<=10?e.jsx(Qe,{className:"w-4 h-4 text-green-400"}):x<=30?e.jsx(Ye,{className:"w-4 h-4 text-yellow-400"}):e.jsx(Xe,{className:"w-4 h-4 text-red-400"}):e.jsx(et,{className:"w-4 h-4"}),$=x=>x?`±${Math.round(x)}m`:"Sem GPS";return e.jsxs("div",{className:"absolute bottom-20 right-4 space-y-3 z-10",children:[e.jsx(U,{children:u&&e.jsx(i.div,{initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},className:"min-w-[200px]",children:e.jsxs(k,{className:"cyberpunk-card p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[N(l),e.jsx("span",{className:"text-xs font-medium",children:"GPS Status"})]}),e.jsx(De,{variant:"outline",className:"text-xs",children:$(l)})]}),n&&e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:["Lat: ",n[1].toFixed(5)]}),e.jsxs("div",{children:["Lng: ",n[0].toFixed(5)]})]}),e.jsxs("div",{className:"pt-2 border-t border-border",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progresso:"}),e.jsxs("span",{className:"font-medium text-primary",children:[f,"/56 (",w.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:e.jsx("div",{className:"bg-gradient-to-r from-primary to-accent h-1.5 rounded-full transition-all duration-500",style:{width:`${w}%`}})})]}),M.length>0&&e.jsxs("div",{className:"pt-2 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ue,{className:"w-3 h-3 text-accent"}),e.jsx("span",{className:"text-xs font-medium",children:"Pontos Próximos:"})]}),e.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:M.slice(0,3).map(x=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"truncate flex-1 mr-2",children:x.title}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"text-muted-foreground",children:[Math.round(x.distance),"m"]}),x.distance<=50&&P&&e.jsx(d,{size:"sm",variant:"ghost",className:"h-5 px-1 text-green-400 hover:text-green-300",onClick:()=>P(x.id),children:e.jsx(Ge,{className:"w-3 h-3"})})]})]},x.id))})]})]})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{onClick:u?V:S,variant:u?"destructive":"default",size:"sm",className:`w-full gap-2 ${u?"animate-pulse bg-destructive hover:bg-destructive/90":"bg-primary hover:bg-primary/90"}`,children:[e.jsx(G,{className:"w-4 h-4"}),u?"Parar GPS":"Iniciar GPS"]}),n&&e.jsxs(d,{onClick:L,variant:"outline",size:"sm",className:"w-full gap-2 hover:bg-accent/20 border-accent/50",children:[e.jsx(xe,{className:"w-4 h-4"}),"Minha Localização"]})]}),e.jsx(U,{children:f>0&&f%10===0&&e.jsx(i.div,{initial:{opacity:0,y:20,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.8},className:"absolute -top-16 right-0",children:e.jsx(k,{className:"cyberpunk-card p-3 bg-gradient-to-r from-accent/20 to-primary/20 border-accent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-accent animate-pulse"}),e.jsxs("span",{className:"text-sm font-medium",children:[f===10&&"Explorador Desbloqueado!",f===28&&"Meio Caminho Alcançado!",f===56&&"Jornada Completa!"]})]})})})})]})},y={lat:-21.9427,lng:-46.7167},bt=()=>{const u=r.useRef(null),n=r.useRef(null),[l,M]=r.useState(null),[f,w]=r.useState(!1),[S,V]=r.useState(null),[L,P]=r.useState(null),[N,$]=r.useState(null),[x,pe]=r.useState([]),[D,he]=r.useState(new Set),[m,E]=r.useState(null),[W,fe]=r.useState("backdrop"),[j,ge]=r.useState(!0),[ye,J]=r.useState(!0),[b,ve]=r.useState(""),[Z,H]=r.useState([]),[K,je]=r.useState(!1),[p,be]=r.useState(!1),[at,Q]=r.useState(null),[X,Ne]=r.useState(!0),[st,rt]=r.useState("pilgrimage"),O=r.useRef(new globalThis.Map),B=r.useRef(null),{getCombinedData:ke,loading:T,error:I}=He(),{totalProgress:Y,visitedCount:ee,markAsVisited:we}=qe(),{toast:R}=Re(),[A,Ce]=r.useState({});r.useEffect(()=>{(async()=>{try{const t=await fetch("/waypoint-coordinates.json");if(t.ok){const o=await t.json();Ce(o),me.info("✅ Fixed coordinates loaded:",Object.keys(o).length,"waypoints")}else console.warn("⚠️ Could not load fixed coordinates, using fallback positioning")}catch(t){console.warn("⚠️ Error loading fixed coordinates:",t)}})()},[]);const Me=()=>{const s=ke("pt");if(s.length===0)return[];const t=s.slice(0,56).filter(a=>A[a.chapter]).map(a=>{const c=A[a.chapter],g=[c.lng,c.lat];return{id:a.chapter,coordinates:g,chapter:a.chapter,title:`${a.nome}`,subtitle:`Capítulo ${a.chapter}`,description:a.descPersonagem||a.ensinamento.substring(0,200)+"...",fullDescription:a.descPersonagem,teaching:a.ensinamento,occupation:a.ocupacao,meaning:a.significado,location:a.local,chapterSummary:a.resumoCap,model:a.linkModel,capUrl:a.capUrl,qrCodeUrl:a.qrCodeUrl}}),o=s.filter(a=>!A[a.chapter]);return o.length>0&&console.warn(`⚠️ ${o.length} waypoints missing coordinates:`,o.map(a=>`Chapter ${a.chapter}: ${a.nome}`)),me.info(`✅ Generated ${t.length} waypoints with fixed coordinates`),t},[h,te]=r.useState([]);r.useEffect(()=>{if(!T&&!I){const s=Me();te(s),H(s)}},[T,I,A]);const Se=(s,t)=>{const o=JSON.parse(localStorage.getItem("technosutra-waypoint-positions")||"{}");o[s]=t,localStorage.setItem("technosutra-waypoint-positions",JSON.stringify(o)),te(a=>a.map(c=>c.chapter===s?{...c,coordinates:t}:c))},Le=()=>{be(!p)},q=(s,t=!1)=>{fe(s),ge(t)};r.useEffect(()=>{if(b){const s=h.filter(t=>t.title.toLowerCase().includes(b.toLowerCase())||t.subtitle.toLowerCase().includes(b.toLowerCase())||t.chapter.toString().includes(b)||t.occupation.toLowerCase().includes(b.toLowerCase())||t.location.toLowerCase().includes(b.toLowerCase()));H(s)}else H(h)},[b,h]),r.useEffect(()=>{if(!(!u.current||h.length===0))return J(!0),Ee.apiKey="rg7OAqXjLo7cLdwqlrVt",n.current=new We({container:u.current,style:W,center:[y.lng,y.lat],zoom:12,pitch:45,bearing:0,attributionControl:!1}),n.current.addControl(new Te({visualizePitch:!0}),"top-right"),n.current.on("load",()=>{J(!1),j&&u.current?setTimeout(()=>{u.current.classList.add("cyberpunk-map")},1e3):u.current&&u.current.classList.remove("cyberpunk-map")}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{const t=[s.coords.latitude,s.coords.longitude];M(t),new F({color:"#00ffff",scale:1.2}).setLngLat([t[1],t[0]]).addTo(n.current)},s=>{console.warn("Geolocation not available:",s)}),n.current.on("load",()=>{if(!n.current||h.length===0)return;const s=[[y.lng-.001,y.lat-.001],...h.map(t=>t.coordinates),[y.lng+.001,y.lat+.001]];n.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}}}),n.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-gradient":["interpolate",["linear"],["line-progress"],0,"#ff00ff",1,"#00ffff"],"line-width":4,"line-opacity":.8}}),O.current.forEach(t=>t.remove()),O.current.clear(),h.forEach((t,o)=>{const a=document.createElement("div");a.className=`waypoint-marker ${p?"waypoint-edit-mode waypoint-draggable":""}`,a.style.cssText=`
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: linear-gradient(135deg, ${j?"#ff00ff, #00ffff":"#00ffff, #ff00ff"});
          border: 2px solid #ffffff;
          cursor: ${p?"grab":"pointer"};
          display: flex;
          align-items: center;
          justify-content: center;
          color: #000;
          font-weight: bold;
          font-size: 11px;
          box-shadow: 0 0 20px ${j?"#ff00ff":"#00ffff"};
          position: relative;
          z-index: ${p?"1000":"100"};
        `,a.textContent=String(t.chapter),a.title=`${t.title} - ${t.occupation}`,a.addEventListener("click",g=>{p||E(t),g.stopPropagation()});const c=new F(a,{draggable:p}).setLngLat(t.coordinates).setPopup(new Ie({closeButton:!1,offset:25}).setHTML(`
              <div class="cyberpunk-popup">
                <h3 class="text-primary text-glow">${t.title}</h3>
                <p class="text-muted-foreground">Capítulo ${t.chapter}</p>
                <button class="cyberpunk-popup-button">Ver Detalhes</button>
              </div>
            `)).addTo(n.current);p&&(c.on("dragstart",()=>{Q(t),a.style.cursor="grabbing"}),c.on("dragend",()=>{const g=c.getLngLat(),z=[g.lng,g.lat];Se(t.chapter,z),a.style.cursor="grab",Q(null),ze()})),O.current.set(t.chapter,c)})}),()=>{var s;u.current&&u.current.classList.remove("cyberpunk-map"),(s=n.current)==null||s.remove()}},[W,h,p,j]);const ze=()=>{if(!n.current)return;const s=[[y.lng-.001,y.lat-.001],...h.map(t=>t.coordinates),[y.lng+.001,y.lat+.001]];n.current.getSource("route")&&n.current.getSource("route").setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}})},ae=s=>{var t;(t=n.current)==null||t.flyTo({center:s.coordinates,zoom:16,pitch:60,duration:2e3})},Pe=()=>{je(!K)},C=(s,t,o,a)=>{const g=s*Math.PI/180,z=o*Math.PI/180,ce=(o-s)*Math.PI/180,le=(a-t)*Math.PI/180,de=Math.sin(ce/2)*Math.sin(ce/2)+Math.cos(g)*Math.cos(z)*Math.sin(le/2)*Math.sin(le/2);return 6371e3*(2*Math.atan2(Math.sqrt(de),Math.sqrt(1-de)))},se=r.useCallback((s,t)=>{const o=h.filter(a=>C(s,t,a.coordinates[1],a.coordinates[0])<=100).sort((a,c)=>{const g=C(s,t,a.coordinates[1],a.coordinates[0]),z=C(s,t,c.coordinates[1],c.coordinates[0]);return g-z});pe(o),o.forEach(a=>{C(s,t,a.coordinates[1],a.coordinates[0])<=50&&!D.has(a.chapter)&&(he(g=>new Set([...g,a.chapter])),R({title:"🎉 Waypoint Visitado!",description:`Você chegou ao ${a.title} - ${a.occupation}`,duration:5e3}))})},[h,D]),re=r.useCallback(()=>{if(!navigator.geolocation){R({title:"Erro de Geolocalização",description:"Seu dispositivo não suporta geolocalização",variant:"destructive"});return}const s=navigator.geolocation.watchPosition(t=>{const o=[t.coords.latitude,t.coords.longitude];if(M(o),V(t.coords.accuracy),se(o[0],o[1]),n.current){if(L)L.setLngLat([o[1],o[0]]);else{const a=new F({color:"#00ffff",scale:1.5}).setLngLat([o[1],o[0]]).addTo(n.current);P(a)}if(B.current&&B.current.remove(),t.coords.accuracy<=100){const a=document.createElement("div");a.style.cssText=`
              width: ${t.coords.accuracy*2}px;
              height: ${t.coords.accuracy*2}px;
              border-radius: 50%;
              background: rgba(0, 255, 255, 0.1);
              border: 2px solid rgba(0, 255, 255, 0.3);
              transform: translate(-50%, -50%);
            `;const c=new F(a).setLngLat([o[1],o[0]]).addTo(n.current);B.current=c}}},t=>{console.error("Location error:",t),R({title:"Erro de Localização",description:"Não foi possível obter sua localização",variant:"destructive"}),w(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3});$(s),w(!0)},[L,se]),oe=r.useCallback(()=>{N!==null&&(navigator.geolocation.clearWatch(N),$(null)),w(!1)},[N]),ne=r.useCallback(()=>{l&&n.current?n.current.flyTo({center:[l[1],l[0]],zoom:18,pitch:60,duration:2e3}):R({title:"Localização não disponível",description:"Ative o tracking para centralizar no usuário"})},[l]),ie=r.useCallback(()=>!l||h.length===0?null:h.reduce((s,t)=>{const o=C(l[0],l[1],t.coordinates[1],t.coordinates[0]),a=s?C(l[0],l[1],s.coordinates[1],s.coordinates[0]):1/0;return o<a?t:s},null),[l,h]),$e=r.useCallback(()=>{const s=ie();s&&(ae(s),E(s))},[ie]);return r.useEffect(()=>()=>{N!==null&&navigator.geolocation.clearWatch(N)},[N]),e.jsxs("div",{className:`${K?"fixed inset-0 z-50":"h-screen"} relative overflow-hidden bg-background`,children:[e.jsx(U,{children:(ye||T)&&e.jsx(i.div,{initial:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(i.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx(i.h2,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"text-xl font-bold text-primary text-glow",children:T?"Carregando dados do Sutra...":"Iniciando Sistema Techno Sutra..."}),I&&e.jsxs("p",{className:"text-destructive text-sm mt-2",children:["Erro ao carregar dados: ",I]})]})})}),e.jsx("div",{ref:u,className:"absolute inset-0"}),j&&e.jsx("div",{className:"cyberpunk-overlay"}),p&&e.jsx("div",{className:"edit-mode-overlay"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-background/30 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-background/30 to-transparent"}),e.jsx("div",{className:"absolute top-0 left-0 w-32 h-full bg-gradient-to-r from-background/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-full bg-gradient-to-l from-background/20 to-transparent"})]}),e.jsxs(i.div,{initial:{x:-100,opacity:0},animate:{x:0,opacity:1},className:"absolute top-4 left-4 space-y-3 pointer-events-auto max-w-xs",children:[e.jsxs(k,{className:"cyberpunk-card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-primary text-glow font-bold",children:"Techno Sutra"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:Le,className:`${p?"text-yellow-400 bg-yellow-400/20":"text-muted-foreground"} hover:text-yellow-400 transition-colors`,title:p?"Desativar modo de edição":"Ativar modo de edição",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:Pe,className:"text-primary hover:text-accent",children:e.jsx(Ke,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:p?"🔧 Modo de Edição Ativo":"Rota Sagrada Original"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(ue,{className:"w-4 h-4 text-primary"}),e.jsx("span",{children:"Águas da Prata, SP"})]}),p&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-400/10 border border-yellow-400/30 rounded text-xs text-yellow-200",children:"💡 Arraste os pontos no mapa para reposicioná-los na trilha correta"})]}),e.jsxs(k,{className:"cyberpunk-card p-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Ve,{placeholder:"Buscar personagem ou capítulo...",value:b,onChange:s=>ve(s.target.value),className:"pl-10 bg-muted/20 border-border text-foreground"})]}),b&&e.jsxs(i.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-xs text-muted-foreground mt-2",children:[Z.length," pontos encontrados"]})]}),e.jsxs(k,{className:"cyberpunk-card p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-primary text-glow font-bold text-sm",children:"Sistema de Tracking"}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>Ne(!X),className:"text-muted-foreground hover:text-primary",children:X?e.jsx(Je,{className:"w-4 h-4"}):e.jsx(Oe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:f?"default":"outline",size:"sm",onClick:f?oe:re,className:`flex-1 ${f?"gradient-neon text-black font-bold":"neon-glow"}`,children:[e.jsx(Ze,{className:"w-3 h-3 mr-1"}),f?"Parar":"Rastrear"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:ne,className:"flex-1 purple-glow",disabled:!l,children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Centralizar"]})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:$e,className:"w-full border-green-500 text-green-400",disabled:!l,children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Ponto Mais Próximo"]})]}),l&&e.jsxs("div",{className:"mt-2 p-2 bg-primary/10 border border-primary/30 rounded text-xs",children:[e.jsx("div",{className:"text-primary font-bold",children:"📍 Status da Localização"}),e.jsxs("div",{className:"text-muted-foreground",children:["Precisão: ",S?`${Math.round(S)}m`:"N/A"]}),e.jsxs("div",{className:"text-muted-foreground",children:["Próximos: ",x.length," waypoint(s)"]}),e.jsxs("div",{className:"text-green-400",children:["Visitados: ",D.size,"/56"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{variant:"outline",size:"sm",className:`w-full transition-all duration-300 hover:scale-105 ${j?"gradient-neon text-black font-bold":"neon-glow"}`,onClick:()=>q("backdrop",!0),children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Modo Cyberpunk ",j?"🔥":""]}),e.jsxs(d,{variant:"outline",size:"sm",className:`w-full transition-all duration-300 hover:scale-105 ${!j&&W==="backdrop"?"bg-muted text-foreground":"neon-glow"}`,onClick:()=>q("backdrop",!1),children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Modo Sombras"]}),e.jsxs(d,{variant:"outline",size:"sm",className:`w-full purple-glow transition-all duration-300 hover:scale-105 ${!j&&W==="streets-v2"?"bg-muted text-foreground":""}`,onClick:()=>q("streets-v2",!1),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Modo Clássico"]})]})]}),e.jsx(U,{children:m&&e.jsx(i.div,{initial:{x:100,opacity:0,scale:.9},animate:{x:0,opacity:1,scale:1},exit:{x:100,opacity:0,scale:.9},transition:{type:"spring",damping:20,stiffness:300},className:"absolute top-4 right-4 w-80 pointer-events-auto",children:e.jsxs(k,{className:"cyberpunk-card p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-accent/5 animate-pulse"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx(i.h3,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},className:"text-primary text-glow font-bold text-lg",children:m.title}),e.jsxs(i.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"flex items-center gap-2 text-xs text-accent mt-1",children:[e.jsx(_,{className:"w-3 h-3"}),e.jsxs("span",{children:[m.subtitle," • ",m.occupation]})]}),e.jsxs(i.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.15},className:"text-xs text-muted-foreground mt-1",children:["📍 ",m.location]})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>E(null),className:"text-muted-foreground hover:text-primary transition-colors",children:"✕"})]}),e.jsxs(i.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"text-muted-foreground mb-2 text-sm",children:[e.jsx("strong",{className:"text-yellow-400",children:"Significado:"})," ",m.meaning]}),e.jsx(i.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.25},className:"text-muted-foreground mb-4 text-sm",children:m.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},children:e.jsxs(d,{onClick:()=>ae(m),className:"w-full gradient-neon text-black font-bold hover:scale-105 transition-transform",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Voar para Local"]})}),e.jsx(i.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},children:e.jsxs(d,{variant:"outline",className:"w-full border-neon hover:scale-105 transition-transform",onClick:()=>{const s=m.model;window.open(`/model-viewer?url=${encodeURIComponent(s)}&title=${encodeURIComponent(m.title)}`,"_blank")},children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Ver Modelo 3D"]})}),e.jsx(i.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},children:e.jsxs(d,{variant:"outline",className:"w-full border-purple-500 text-purple-400 hover:scale-105 transition-transform",onClick:()=>{m.capUrl&&window.open(m.capUrl,"_blank")},children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Ler Capítulo"]})}),e.jsx(i.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},children:e.jsxs(d,{variant:"outline",className:"w-full border-cyan-500 text-cyan-400 hover:scale-105 transition-transform",onClick:()=>{m.qrCodeUrl&&window.open(m.qrCodeUrl,"_blank")},children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Ver QR Code"]})})]})]})]})})}),e.jsx(Be,{isOpen:!!m,onClose:()=>E(null),character:m}),e.jsx(i.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},className:"absolute bottom-4 left-4 pointer-events-auto",children:e.jsxs(k,{className:"cyberpunk-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs(i.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[e.jsx("div",{className:"text-primary text-glow font-bold text-xl",children:ee}),e.jsx("div",{className:"text-muted-foreground",children:"Visitados"})]}),e.jsxs(i.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[e.jsx("div",{className:"text-accent text-glow font-bold text-xl",children:Z.length}),e.jsx("div",{className:"text-muted-foreground",children:"Filtrados"})]}),e.jsxs(i.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[e.jsxs("div",{className:"text-cyan-400 text-glow font-bold text-xl",children:[Y.toFixed(0),"%"]}),e.jsx("div",{className:"text-muted-foreground",children:"Progresso"})]}),p&&e.jsxs(i.div,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[e.jsx("div",{className:"text-yellow-400 text-glow font-bold text-xl",children:"✏️"}),e.jsx("div",{className:"text-muted-foreground",children:"Editando"})]})]}),p&&e.jsx("div",{className:"mt-2 text-xs text-yellow-400 text-center",children:"Posições sendo salvas automaticamente"})]})}),e.jsx(tt,{isTrackingUser:f,userLocation:l,userAccuracy:S,nearbyWaypoints:x,visitedCount:ee,totalProgress:Y,onStartTracking:re,onStopTracking:oe,onCenterOnUser:ne,onMarkVisited:we})]})};export{bt as default};
