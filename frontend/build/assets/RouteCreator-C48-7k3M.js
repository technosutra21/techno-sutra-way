import{j as e,a as se}from"./ui-CNstozTn.js";import{r as o}from"./vendor-DWZhD1wM.js";import{C as v}from"./card-N_mjhS3w.js";import{c as $,b as re,d as ne,B as m}from"./index-CAhwwkRS.js";import{I as z,S as W}from"./input-6w1Nlqf7.js";import{D as oe,M as ie,t as ce,b as le,a as de}from"./maps-B--tHXM4.js";/* empty css                     */import{l as me}from"./logger-CnUqTrA3.js";import{m as N,A as O}from"./animations-CDP8czNI.js";import{M as H}from"./map-pin-3k3DvKoB.js";import"./query-CJXKl7Sg.js";import"./router-DAaxAjqu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=$("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=$("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=$("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var pe="Label",X=o.forwardRef((u,h)=>e.jsx(se.label,{...u,ref:h,onMouseDown:c=>{var f;c.target.closest("button, input, select, textarea")||((f=u.onMouseDown)==null||f.call(u,c),!c.defaultPrevented&&c.detail>1&&c.preventDefault())}}));X.displayName=pe;var G=X;const he=ne("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),P=o.forwardRef(({className:u,...h},c)=>e.jsx(G,{ref:c,className:re(he(),u),...h}));P.displayName=G.displayName;const Pe=()=>{const[u,h]=o.useState(""),[c,M]=o.useState(""),[f,q]=o.useState(""),[p,b]=o.useState(!1),[x,L]=o.useState(null),[i,w]=o.useState([]),[k,D]=o.useState([]),[n,j]=o.useState("start"),[U,C]=o.useState(!1),E=o.useRef(null),r=o.useRef(null),y=o.useRef([]);o.useEffect(()=>{if(!E.current)return;oe.apiKey="rg7OAqXjLo7cLdwqlrVt",r.current=new ie({container:E.current,style:"backdrop",center:[-46.7167,-21.9427],zoom:10,attributionControl:!1}),r.current.addControl(new ce,"top-right");const t=localStorage.getItem("technosutra-routes");return t&&D(JSON.parse(t)),r.current.on("load",()=>{}),()=>{var a;(a=r.current)==null||a.remove()}},[]),o.useEffect(()=>{if(!r.current)return;const t=a=>{if(!p)return;me.info("Map clicked!",a.lngLat);const s=[a.lngLat.lng,a.lngLat.lat],l={id:`${n}-${Date.now()}`,coordinates:s,name:Y(n,i.length),type:n};let d=i;(n==="start"||n==="end")&&(d=i.filter(R=>R.type!==n));const g=[...d,l];w(g),T(g),n==="start"?j("end"):n==="end"&&j("waypoint")};return r.current.on("click",t),()=>{r.current&&r.current.off("click",t)}},[p,n,i]);const Q=async t=>{if(!t.trim())return null;try{const s=await(await fetch(`https://api.maptiler.com/geocoding/${encodeURIComponent(t)}.json?key=rg7OAqXjLo7cLdwqlrVt&limit=1`)).json();if(s.features&&s.features.length>0){const[l,d]=s.features[0].center;return[l,d]}return null}catch(a){return console.error("Geocoding error:",a),null}},S=async(t,a)=>{const s=await Q(t);s&&r.current?(r.current.flyTo({center:s,zoom:14,duration:2e3}),p&&(j(a),C(!0),setTimeout(()=>C(!1),5e3))):alert('Local nÃ£o encontrado. Tente termos como "SÃ£o Paulo", "Rio de Janeiro", etc.')},Y=(t,a)=>{switch(t){case"start":return"Ponto de Partida";case"end":return"Destino Final";default:return`Ponto ${a}`}},T=t=>{if(y.current.forEach(a=>a.remove()),y.current=[],t.forEach(a=>{const s=document.createElement("div");s.className="custom-waypoint-marker";const l=a.type==="start"?"#00ff00":a.type==="end"?"#ff0040":"#00ffff";s.style.cssText=`
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: ${l};
        border: 3px solid #ffffff;
        cursor: pointer;
        box-shadow: 0 0 20px ${l};
        position: relative;
        z-index: 1000;
      `;const d=document.createElement("div");d.textContent=a.name,d.style.cssText=`
        position: absolute;
        top: -35px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.9);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        white-space: nowrap;
        pointer-events: none;
        border: 1px solid ${l};
      `,s.appendChild(d);const g=new de(s).setLngLat(a.coordinates).addTo(r.current);y.current.push(g)}),t.length>=2&&r.current){r.current.getLayer("custom-route")&&(r.current.removeLayer("custom-route"),r.current.removeSource("custom-route"));const a=[...t.filter(s=>s.type==="start"),...t.filter(s=>s.type==="waypoint"),...t.filter(s=>s.type==="end")];a.length>=2&&(r.current.addSource("custom-route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:a.map(s=>s.coordinates)}}}),r.current.addLayer({id:"custom-route",type:"line",source:"custom-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ff00ff","line-width":4,"line-opacity":.8}}))}},F=t=>{if(t.length<2)return 0;let a=0;for(let s=1;s<t.length;s++){const[l,d]=t[s-1].coordinates,[g,R]=t[s].coordinates,te=6371,V=(R-d)*Math.PI/180,B=(g-l)*Math.PI/180,J=Math.sin(V/2)*Math.sin(V/2)+Math.cos(d*Math.PI/180)*Math.cos(R*Math.PI/180)*Math.sin(B/2)*Math.sin(B/2),ae=2*Math.atan2(Math.sqrt(J),Math.sqrt(1-J));a+=te*ae}return a},A=()=>{b(!0),w([]),j("start"),h(`Nova Rota ${new Date().toLocaleDateString()}`),y.current.forEach(t=>t.remove()),y.current=[],r.current&&r.current.getLayer("custom-route")&&(r.current.removeLayer("custom-route"),r.current.removeSource("custom-route")),C(!0),setTimeout(()=>C(!1),8e3)},Z=()=>{if(i.length<2){alert("Adicione pelo menos um ponto de partida e um destino!");return}const t={id:`route-${Date.now()}`,name:u||`Rota ${new Date().toLocaleDateString()}`,waypoints:i,distance:F(i),created:new Date},a=[...k,t];D(a),localStorage.setItem("technosutra-routes",JSON.stringify(a)),L(t),b(!1),alert("Rota salva com sucesso!")},_=t=>{var a;if(w(t.waypoints),L(t),h(t.name),b(!1),T(t.waypoints),t.waypoints.length>0){const s=new le;t.waypoints.forEach(l=>s.extend(l.coordinates)),(a=r.current)==null||a.fitBounds(s,{padding:50})}},I=()=>{w([]),L(null),b(!1),M(""),q(""),y.current.forEach(t=>t.remove()),y.current=[],r.current&&r.current.getLayer("custom-route")&&(r.current.removeLayer("custom-route"),r.current.removeSource("custom-route"))},ee=t=>{const a=k.filter(s=>s.id!==t);D(a),localStorage.setItem("technosutra-routes",JSON.stringify(a)),(x==null?void 0:x.id)===t&&I()};return e.jsxs("div",{className:"h-screen bg-background flex",children:[e.jsx(N.div,{initial:{x:-400,opacity:0},animate:{x:0,opacity:1},className:"w-96 bg-card border-r border-border overflow-y-auto",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary text-glow mb-2",children:"Criador de Rotas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Crie rotas personalizadas no mundo Techno Sutra"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{className:"text-foreground flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-green-400"}),"Buscar Ponto de Partida"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{value:c,onChange:t=>M(t.target.value),placeholder:"Ex: SÃ£o Paulo, SP",className:"cyberpunk-input flex-1",onKeyPress:t=>t.key==="Enter"&&S(c,"start")}),e.jsx(m,{size:"sm",onClick:()=>S(c,"start"),className:"neon-glow",disabled:!c.trim(),children:e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{className:"text-foreground flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-red-400"}),"Buscar Destino Final"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{value:f,onChange:t=>q(t.target.value),placeholder:"Ex: Rio de Janeiro, RJ",className:"cyberpunk-input flex-1",onKeyPress:t=>t.key==="Enter"&&S(f,"end")}),e.jsx(m,{size:"sm",onClick:()=>S(f,"end"),className:"neon-glow",disabled:!f.trim(),children:e.jsx(W,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"routeName",className:"text-foreground",children:"Nome da Rota"}),e.jsx(z,{id:"routeName",value:u,onChange:t=>h(t.target.value),className:"cyberpunk-input",placeholder:"Digite o nome da rota..."})]}),e.jsxs(O,{mode:"wait",children:[!p&&!x&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-3",children:[e.jsxs(m,{onClick:A,className:"w-full gradient-neon text-black font-bold py-3",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"ComeÃ§ar Nova Rota"]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["1. Busque os locais acima",e.jsx("br",{}),'2. Clique em "ComeÃ§ar Nova Rota"',e.jsx("br",{}),"3. Clique no mapa para adicionar pontos"]})]}),p&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/20 p-4 rounded-lg border border-border",children:[e.jsx("h3",{className:"font-bold text-primary mb-2",children:"Modo CriaÃ§Ã£o Ativo"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Clique no mapa para adicionar pontos:"}),e.jsx("div",{className:"space-y-2",children:[{type:"start",label:"ðŸŸ¢ Ponto de Partida",color:"bg-green-500"},{type:"end",label:"ðŸ”´ Destino Final",color:"bg-red-500"},{type:"waypoint",label:"ðŸ”µ Pontos IntermediÃ¡rios",color:"bg-cyan-500"}].map(({type:t,label:a,color:s})=>e.jsx(m,{variant:n===t?"default":"outline",size:"sm",className:`w-full justify-start text-left ${n===t?"neon-glow":""}`,onClick:()=>j(t),children:a},t))})]}),i.length>0&&e.jsxs(v,{className:"cyberpunk-card p-4",children:[e.jsx("h4",{className:"font-bold text-primary mb-2",children:"Rota Atual"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Pontos: ",i.length]}),e.jsxs("div",{children:["DistÃ¢ncia: ",F(i).toFixed(2)," km"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:[i.filter(t=>t.type==="start").length>0&&"âœ… Partida definida",e.jsx("br",{}),i.filter(t=>t.type==="end").length>0&&"âœ… Destino definido",e.jsx("br",{}),i.filter(t=>t.type==="waypoint").length>0&&`âœ… ${i.filter(t=>t.type==="waypoint").length} pontos intermediÃ¡rios`]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:Z,disabled:i.length<2,className:"flex-1 gradient-neon text-black font-bold",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Salvar"]}),e.jsxs(m,{onClick:I,variant:"outline",className:"flex-1 border-destructive text-destructive",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Limpar"]})]})]}),x&&!p&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[e.jsxs(v,{className:"cyberpunk-card p-4",children:[e.jsx("h3",{className:"font-bold text-primary mb-2",children:x.name}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Pontos: ",x.waypoints.length]}),e.jsxs("div",{children:["DistÃ¢ncia: ",x.distance.toFixed(2)," km"]}),e.jsxs("div",{children:["Criado: ",x.created.toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:A,className:"flex-1 gradient-neon text-black font-bold",children:"Nova Rota"}),e.jsx(m,{onClick:I,variant:"outline",className:"flex-1",children:"Limpar"})]})]})]}),k.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-foreground",children:"Rotas Salvas"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:k.map(t=>e.jsx(v,{className:"cyberpunk-card p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-sm text-primary",children:t.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.waypoints.length," pontos â€¢ ",t.distance.toFixed(1)," km"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>_(t),className:"px-2",children:"Ver"}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>ee(t.id),className:"px-2 text-destructive border-destructive",children:e.jsx(K,{className:"w-3 h-3"})})]})]})},t.id))})]})]})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{ref:E,className:"absolute inset-0"}),e.jsx(O,{children:p&&U&&e.jsx(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-4 left-4 right-4 z-10",children:e.jsxs(v,{className:"cyberpunk-card p-4 text-center border-primary",children:[e.jsx("p",{className:"text-primary text-glow font-bold mb-1",children:"Modo de CriaÃ§Ã£o Ativo"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Clique no mapa para adicionar: ",e.jsx("span",{className:"text-primary font-bold",children:n==="start"?"ðŸŸ¢ Ponto de Partida":n==="end"?"ðŸ”´ Destino Final":"ðŸ”µ Pontos IntermediÃ¡rios"})]})]})})}),p&&e.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:e.jsx(v,{className:"cyberpunk-card p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${n==="start"?"bg-green-500":n==="end"?"bg-red-500":"bg-cyan-500"}`}),e.jsx("span",{className:"text-primary font-medium",children:n==="start"?"Clique para Ponto de Partida":n==="end"?"Clique para Destino Final":"Clique para Pontos IntermediÃ¡rios"})]})})})]})]})};export{Pe as default};
