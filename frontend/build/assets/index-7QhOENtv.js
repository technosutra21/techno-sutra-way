var vP=e=>{throw TypeError(e)};var a1=(e,t,r)=>t.has(e)||vP("Cannot "+r);var et=(e,t,r)=>(a1(e,t,"read from private field"),r?r.call(e):t.get(e)),wr=(e,t,r)=>t.has(e)?vP("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ht=(e,t,r,o)=>(a1(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r),Ti=(e,t,r)=>(a1(e,t,"access private method"),r);var jy=(e,t,r,o)=>({set _(u){Ht(e,t,u,r)},get _(){return et(e,t,o)}});function UN(e,t){for(var r=0;r<t.length;r++){const o=t[r];if(typeof o!="string"&&!Array.isArray(o)){for(const u in o)if(u!=="default"&&!(u in e)){const d=Object.getOwnPropertyDescriptor(o,u);d&&Object.defineProperty(e,u,d.get?d:{enumerable:!0,get:()=>o[u]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function r(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(u){if(u.ep)return;u.ep=!0;const d=r(u);fetch(u.href,d)}})();var GN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var OA={exports:{}},q0={},FA={exports:{}},dr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ag=Symbol.for("react.element"),qN=Symbol.for("react.portal"),ZN=Symbol.for("react.fragment"),WN=Symbol.for("react.strict_mode"),HN=Symbol.for("react.profiler"),KN=Symbol.for("react.provider"),XN=Symbol.for("react.context"),YN=Symbol.for("react.forward_ref"),QN=Symbol.for("react.suspense"),JN=Symbol.for("react.memo"),ej=Symbol.for("react.lazy"),_P=Symbol.iterator;function tj(e){return e===null||typeof e!="object"?null:(e=_P&&e[_P]||e["@@iterator"],typeof e=="function"?e:null)}var BA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$A=Object.assign,VA={};function fp(e,t,r){this.props=e,this.context=t,this.refs=VA,this.updater=r||BA}fp.prototype.isReactComponent={};fp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function UA(){}UA.prototype=fp.prototype;function p2(e,t,r){this.props=e,this.context=t,this.refs=VA,this.updater=r||BA}var f2=p2.prototype=new UA;f2.constructor=p2;$A(f2,fp.prototype);f2.isPureReactComponent=!0;var xP=Array.isArray,GA=Object.prototype.hasOwnProperty,m2={current:null},qA={key:!0,ref:!0,__self:!0,__source:!0};function ZA(e,t,r){var o,u={},d=null,h=null;if(t!=null)for(o in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(d=""+t.key),t)GA.call(t,o)&&!qA.hasOwnProperty(o)&&(u[o]=t[o]);var s=arguments.length-2;if(s===1)u.children=r;else if(1<s){for(var b=Array(s),w=0;w<s;w++)b[w]=arguments[w+2];u.children=b}if(e&&e.defaultProps)for(o in s=e.defaultProps,s)u[o]===void 0&&(u[o]=s[o]);return{$$typeof:ag,type:e,key:d,ref:h,props:u,_owner:m2.current}}function rj(e,t){return{$$typeof:ag,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function g2(e){return typeof e=="object"&&e!==null&&e.$$typeof===ag}function nj(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var bP=/\/+/g;function l1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nj(""+e.key):t.toString(36)}function bv(e,t,r,o,u){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(d){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case ag:case qN:h=!0}}if(h)return h=e,u=u(h),e=o===""?"."+l1(h,0):o,xP(u)?(r="",e!=null&&(r=e.replace(bP,"$&/")+"/"),bv(u,t,r,"",function(w){return w})):u!=null&&(g2(u)&&(u=rj(u,r+(!u.key||h&&h.key===u.key?"":(""+u.key).replace(bP,"$&/")+"/")+e)),t.push(u)),1;if(h=0,o=o===""?".":o+":",xP(e))for(var s=0;s<e.length;s++){d=e[s];var b=o+l1(d,s);h+=bv(d,t,r,b,u)}else if(b=tj(e),typeof b=="function")for(e=b.call(e),s=0;!(d=e.next()).done;)d=d.value,b=o+l1(d,s++),h+=bv(d,t,r,b,u);else if(d==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function Oy(e,t,r){if(e==null)return e;var o=[],u=0;return bv(e,o,"","",function(d){return t.call(r,d,u++)}),o}function ij(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Wi={current:null},wv={transition:null},oj={ReactCurrentDispatcher:Wi,ReactCurrentBatchConfig:wv,ReactCurrentOwner:m2};function WA(){throw Error("act(...) is not supported in production builds of React.")}dr.Children={map:Oy,forEach:function(e,t,r){Oy(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Oy(e,function(){t++}),t},toArray:function(e){return Oy(e,function(t){return t})||[]},only:function(e){if(!g2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dr.Component=fp;dr.Fragment=ZN;dr.Profiler=HN;dr.PureComponent=p2;dr.StrictMode=WN;dr.Suspense=QN;dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oj;dr.act=WA;dr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=$A({},e.props),u=e.key,d=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(d=t.ref,h=m2.current),t.key!==void 0&&(u=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(b in t)GA.call(t,b)&&!qA.hasOwnProperty(b)&&(o[b]=t[b]===void 0&&s!==void 0?s[b]:t[b])}var b=arguments.length-2;if(b===1)o.children=r;else if(1<b){s=Array(b);for(var w=0;w<b;w++)s[w]=arguments[w+2];o.children=s}return{$$typeof:ag,type:e.type,key:u,ref:d,props:o,_owner:h}};dr.createContext=function(e){return e={$$typeof:XN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:KN,_context:e},e.Consumer=e};dr.createElement=ZA;dr.createFactory=function(e){var t=ZA.bind(null,e);return t.type=e,t};dr.createRef=function(){return{current:null}};dr.forwardRef=function(e){return{$$typeof:YN,render:e}};dr.isValidElement=g2;dr.lazy=function(e){return{$$typeof:ej,_payload:{_status:-1,_result:e},_init:ij}};dr.memo=function(e,t){return{$$typeof:JN,type:e,compare:t===void 0?null:t}};dr.startTransition=function(e){var t=wv.transition;wv.transition={};try{e()}finally{wv.transition=t}};dr.unstable_act=WA;dr.useCallback=function(e,t){return Wi.current.useCallback(e,t)};dr.useContext=function(e){return Wi.current.useContext(e)};dr.useDebugValue=function(){};dr.useDeferredValue=function(e){return Wi.current.useDeferredValue(e)};dr.useEffect=function(e,t){return Wi.current.useEffect(e,t)};dr.useId=function(){return Wi.current.useId()};dr.useImperativeHandle=function(e,t,r){return Wi.current.useImperativeHandle(e,t,r)};dr.useInsertionEffect=function(e,t){return Wi.current.useInsertionEffect(e,t)};dr.useLayoutEffect=function(e,t){return Wi.current.useLayoutEffect(e,t)};dr.useMemo=function(e,t){return Wi.current.useMemo(e,t)};dr.useReducer=function(e,t,r){return Wi.current.useReducer(e,t,r)};dr.useRef=function(e){return Wi.current.useRef(e)};dr.useState=function(e){return Wi.current.useState(e)};dr.useSyncExternalStore=function(e,t,r){return Wi.current.useSyncExternalStore(e,t,r)};dr.useTransition=function(){return Wi.current.useTransition()};dr.version="18.3.1";FA.exports=dr;var K=FA.exports;const yt=G0(K),y2=UN({__proto__:null,default:yt},[K]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sj=K,aj=Symbol.for("react.element"),lj=Symbol.for("react.fragment"),cj=Object.prototype.hasOwnProperty,uj=sj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hj={key:!0,ref:!0,__self:!0,__source:!0};function HA(e,t,r){var o,u={},d=null,h=null;r!==void 0&&(d=""+r),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(h=t.ref);for(o in t)cj.call(t,o)&&!hj.hasOwnProperty(o)&&(u[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)u[o]===void 0&&(u[o]=t[o]);return{$$typeof:aj,type:e,key:d,ref:h,props:u,_owner:uj.current}}q0.Fragment=lj;q0.jsx=HA;q0.jsxs=HA;OA.exports=q0;var j=OA.exports,KA={exports:{}},Ao={},XA={exports:{}},YA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ve,De){var Ke=Ve.length;Ve.push(De);e:for(;0<Ke;){var nt=Ke-1>>>1,ot=Ve[nt];if(0<u(ot,De))Ve[nt]=De,Ve[Ke]=ot,Ke=nt;else break e}}function r(Ve){return Ve.length===0?null:Ve[0]}function o(Ve){if(Ve.length===0)return null;var De=Ve[0],Ke=Ve.pop();if(Ke!==De){Ve[0]=Ke;e:for(var nt=0,ot=Ve.length,Et=ot>>>1;nt<Et;){var Rt=2*(nt+1)-1,lr=Ve[Rt],gr=Rt+1,Xt=Ve[gr];if(0>u(lr,Ke))gr<ot&&0>u(Xt,lr)?(Ve[nt]=Xt,Ve[gr]=Ke,nt=gr):(Ve[nt]=lr,Ve[Rt]=Ke,nt=Rt);else if(gr<ot&&0>u(Xt,Ke))Ve[nt]=Xt,Ve[gr]=Ke,nt=gr;else break e}}return De}function u(Ve,De){var Ke=Ve.sortIndex-De.sortIndex;return Ke!==0?Ke:Ve.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var h=Date,s=h.now();e.unstable_now=function(){return h.now()-s}}var b=[],w=[],C=1,k=null,I=3,A=!1,B=!1,F=!1,X=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ve){for(var De=r(w);De!==null;){if(De.callback===null)o(w);else if(De.startTime<=Ve)o(w),De.sortIndex=De.expirationTime,t(b,De);else break;De=r(w)}}function ne(Ve){if(F=!1,U(Ve),!B)if(r(b)!==null)B=!0,tt(de);else{var De=r(w);De!==null&&ut(ne,De.startTime-Ve)}}function de(Ve,De){B=!1,F&&(F=!1,q(ze),ze=-1),A=!0;var Ke=I;try{for(U(De),k=r(b);k!==null&&(!(k.expirationTime>De)||Ve&&!Ze());){var nt=k.callback;if(typeof nt=="function"){k.callback=null,I=k.priorityLevel;var ot=nt(k.expirationTime<=De);De=e.unstable_now(),typeof ot=="function"?k.callback=ot:k===r(b)&&o(b),U(De)}else o(b);k=r(b)}if(k!==null)var Et=!0;else{var Rt=r(w);Rt!==null&&ut(ne,Rt.startTime-De),Et=!1}return Et}finally{k=null,I=Ke,A=!1}}var xe=!1,ke=null,ze=-1,We=5,rt=-1;function Ze(){return!(e.unstable_now()-rt<We)}function He(){if(ke!==null){var Ve=e.unstable_now();rt=Ve;var De=!0;try{De=ke(!0,Ve)}finally{De?Ct():(xe=!1,ke=null)}}else xe=!1}var Ct;if(typeof V=="function")Ct=function(){V(He)};else if(typeof MessageChannel<"u"){var st=new MessageChannel,Ge=st.port2;st.port1.onmessage=He,Ct=function(){Ge.postMessage(null)}}else Ct=function(){X(He,0)};function tt(Ve){ke=Ve,xe||(xe=!0,Ct())}function ut(Ve,De){ze=X(function(){Ve(e.unstable_now())},De)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ve){Ve.callback=null},e.unstable_continueExecution=function(){B||A||(B=!0,tt(de))},e.unstable_forceFrameRate=function(Ve){0>Ve||125<Ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):We=0<Ve?Math.floor(1e3/Ve):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return r(b)},e.unstable_next=function(Ve){switch(I){case 1:case 2:case 3:var De=3;break;default:De=I}var Ke=I;I=De;try{return Ve()}finally{I=Ke}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ve,De){switch(Ve){case 1:case 2:case 3:case 4:case 5:break;default:Ve=3}var Ke=I;I=Ve;try{return De()}finally{I=Ke}},e.unstable_scheduleCallback=function(Ve,De,Ke){var nt=e.unstable_now();switch(typeof Ke=="object"&&Ke!==null?(Ke=Ke.delay,Ke=typeof Ke=="number"&&0<Ke?nt+Ke:nt):Ke=nt,Ve){case 1:var ot=-1;break;case 2:ot=250;break;case 5:ot=1073741823;break;case 4:ot=1e4;break;default:ot=5e3}return ot=Ke+ot,Ve={id:C++,callback:De,priorityLevel:Ve,startTime:Ke,expirationTime:ot,sortIndex:-1},Ke>nt?(Ve.sortIndex=Ke,t(w,Ve),r(b)===null&&Ve===r(w)&&(F?(q(ze),ze=-1):F=!0,ut(ne,Ke-nt))):(Ve.sortIndex=ot,t(b,Ve),B||A||(B=!0,tt(de))),Ve},e.unstable_shouldYield=Ze,e.unstable_wrapCallback=function(Ve){var De=I;return function(){var Ke=I;I=De;try{return Ve.apply(this,arguments)}finally{I=Ke}}}})(YA);XA.exports=YA;var dj=XA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pj=K,Mo=dj;function ft(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var QA=new Set,wm={};function oh(e,t){tp(e,t),tp(e+"Capture",t)}function tp(e,t){for(wm[e]=t,e=0;e<t.length;e++)QA.add(t[e])}var Xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pb=Object.prototype.hasOwnProperty,fj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wP={},SP={};function mj(e){return Pb.call(SP,e)?!0:Pb.call(wP,e)?!1:fj.test(e)?SP[e]=!0:(wP[e]=!0,!1)}function gj(e,t,r,o){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yj(e,t,r,o){if(t===null||typeof t>"u"||gj(e,t,r,o))return!0;if(o)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Hi(e,t,r,o,u,d,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=u,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=d,this.removeEmptyString=h}var gi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gi[e]=new Hi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gi[t]=new Hi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gi[e]=new Hi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gi[e]=new Hi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gi[e]=new Hi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gi[e]=new Hi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gi[e]=new Hi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gi[e]=new Hi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gi[e]=new Hi(e,5,!1,e.toLowerCase(),null,!1,!1)});var v2=/[\-:]([a-z])/g;function _2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v2,_2);gi[t]=new Hi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v2,_2);gi[t]=new Hi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v2,_2);gi[t]=new Hi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gi[e]=new Hi(e,1,!1,e.toLowerCase(),null,!1,!1)});gi.xlinkHref=new Hi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gi[e]=new Hi(e,1,!1,e.toLowerCase(),null,!0,!0)});function x2(e,t,r,o){var u=gi.hasOwnProperty(t)?gi[t]:null;(u!==null?u.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yj(t,r,u,o)&&(r=null),o||u===null?mj(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):u.mustUseProperty?e[u.propertyName]=r===null?u.type===3?!1:"":r:(t=u.attributeName,o=u.attributeNamespace,r===null?e.removeAttribute(t):(u=u.type,r=u===3||u===4&&r===!0?"":""+r,o?e.setAttributeNS(o,t,r):e.setAttribute(t,r))))}var ol=pj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fy=Symbol.for("react.element"),gd=Symbol.for("react.portal"),yd=Symbol.for("react.fragment"),b2=Symbol.for("react.strict_mode"),Eb=Symbol.for("react.profiler"),JA=Symbol.for("react.provider"),eI=Symbol.for("react.context"),w2=Symbol.for("react.forward_ref"),Mb=Symbol.for("react.suspense"),kb=Symbol.for("react.suspense_list"),S2=Symbol.for("react.memo"),ql=Symbol.for("react.lazy"),tI=Symbol.for("react.offscreen"),TP=Symbol.iterator;function jf(e){return e===null||typeof e!="object"?null:(e=TP&&e[TP]||e["@@iterator"],typeof e=="function"?e:null)}var cn=Object.assign,c1;function Xf(e){if(c1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);c1=t&&t[1]||""}return`
`+c1+e}var u1=!1;function h1(e,t){if(!e||u1)return"";u1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var o=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){o=w}e.call(t.prototype)}else{try{throw Error()}catch(w){o=w}e()}}catch(w){if(w&&o&&typeof w.stack=="string"){for(var u=w.stack.split(`
`),d=o.stack.split(`
`),h=u.length-1,s=d.length-1;1<=h&&0<=s&&u[h]!==d[s];)s--;for(;1<=h&&0<=s;h--,s--)if(u[h]!==d[s]){if(h!==1||s!==1)do if(h--,s--,0>s||u[h]!==d[s]){var b=`
`+u[h].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=h&&0<=s);break}}}finally{u1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Xf(e):""}function vj(e){switch(e.tag){case 5:return Xf(e.type);case 16:return Xf("Lazy");case 13:return Xf("Suspense");case 19:return Xf("SuspenseList");case 0:case 2:case 15:return e=h1(e.type,!1),e;case 11:return e=h1(e.type.render,!1),e;case 1:return e=h1(e.type,!0),e;default:return""}}function Ab(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yd:return"Fragment";case gd:return"Portal";case Eb:return"Profiler";case b2:return"StrictMode";case Mb:return"Suspense";case kb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eI:return(e.displayName||"Context")+".Consumer";case JA:return(e._context.displayName||"Context")+".Provider";case w2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case S2:return t=e.displayName||null,t!==null?t:Ab(e.type)||"Memo";case ql:t=e._payload,e=e._init;try{return Ab(e(t))}catch{}}return null}function _j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ab(t);case 8:return t===b2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rI(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xj(e){var t=rI(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var u=r.get,d=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(h){o=""+h,d.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(h){o=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function By(e){e._valueTracker||(e._valueTracker=xj(e))}function nI(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=rI(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Wv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ib(e,t){var r=t.checked;return cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function CP(e,t){var r=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;r=yc(t.value!=null?t.value:r),e._wrapperState={initialChecked:o,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iI(e,t){t=t.checked,t!=null&&x2(e,"checked",t,!1)}function Rb(e,t){iI(e,t);var r=yc(t.value),o=t.type;if(r!=null)o==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Lb(e,t.type,r):t.hasOwnProperty("defaultValue")&&Lb(e,t.type,yc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function PP(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Lb(e,t,r){(t!=="number"||Wv(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Yf=Array.isArray;function Rd(e,t,r,o){if(e=e.options,t){t={};for(var u=0;u<r.length;u++)t["$"+r[u]]=!0;for(r=0;r<e.length;r++)u=t.hasOwnProperty("$"+e[r].value),e[r].selected!==u&&(e[r].selected=u),u&&o&&(e[r].defaultSelected=!0)}else{for(r=""+yc(r),t=null,u=0;u<e.length;u++){if(e[u].value===r){e[u].selected=!0,o&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function Db(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ft(91));return cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function EP(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ft(92));if(Yf(r)){if(1<r.length)throw Error(ft(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yc(r)}}function oI(e,t){var r=yc(t.value),o=yc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),o!=null&&(e.defaultValue=""+o)}function MP(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sI(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sI(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $y,aI=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,o,u){MSApp.execUnsafeLocalFunction(function(){return e(t,r,o,u)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($y=$y||document.createElement("div"),$y.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$y.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Sm(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var nm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bj=["Webkit","ms","Moz","O"];Object.keys(nm).forEach(function(e){bj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),nm[t]=nm[e]})});function lI(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||nm.hasOwnProperty(e)&&nm[e]?(""+t).trim():t+"px"}function cI(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var o=r.indexOf("--")===0,u=lI(r,t[r],o);r==="float"&&(r="cssFloat"),o?e.setProperty(r,u):e[r]=u}}var wj=cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nb(e,t){if(t){if(wj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ft(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ft(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ft(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ft(62))}}function jb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ob=null;function T2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fb=null,Ld=null,Dd=null;function kP(e){if(e=ug(e)){if(typeof Fb!="function")throw Error(ft(280));var t=e.stateNode;t&&(t=X0(t),Fb(e.stateNode,e.type,t))}}function uI(e){Ld?Dd?Dd.push(e):Dd=[e]:Ld=e}function hI(){if(Ld){var e=Ld,t=Dd;if(Dd=Ld=null,kP(e),t)for(e=0;e<t.length;e++)kP(t[e])}}function dI(e,t){return e(t)}function pI(){}var d1=!1;function fI(e,t,r){if(d1)return e(t,r);d1=!0;try{return dI(e,t,r)}finally{d1=!1,(Ld!==null||Dd!==null)&&(pI(),hI())}}function Tm(e,t){var r=e.stateNode;if(r===null)return null;var o=X0(r);if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ft(231,t,typeof r));return r}var Bb=!1;if(Xa)try{var Of={};Object.defineProperty(Of,"passive",{get:function(){Bb=!0}}),window.addEventListener("test",Of,Of),window.removeEventListener("test",Of,Of)}catch{Bb=!1}function Sj(e,t,r,o,u,d,h,s,b){var w=Array.prototype.slice.call(arguments,3);try{t.apply(r,w)}catch(C){this.onError(C)}}var im=!1,Hv=null,Kv=!1,$b=null,Tj={onError:function(e){im=!0,Hv=e}};function Cj(e,t,r,o,u,d,h,s,b){im=!1,Hv=null,Sj.apply(Tj,arguments)}function Pj(e,t,r,o,u,d,h,s,b){if(Cj.apply(this,arguments),im){if(im){var w=Hv;im=!1,Hv=null}else throw Error(ft(198));Kv||(Kv=!0,$b=w)}}function sh(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mI(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function AP(e){if(sh(e)!==e)throw Error(ft(188))}function Ej(e){var t=e.alternate;if(!t){if(t=sh(e),t===null)throw Error(ft(188));return t!==e?null:e}for(var r=e,o=t;;){var u=r.return;if(u===null)break;var d=u.alternate;if(d===null){if(o=u.return,o!==null){r=o;continue}break}if(u.child===d.child){for(d=u.child;d;){if(d===r)return AP(u),e;if(d===o)return AP(u),t;d=d.sibling}throw Error(ft(188))}if(r.return!==o.return)r=u,o=d;else{for(var h=!1,s=u.child;s;){if(s===r){h=!0,r=u,o=d;break}if(s===o){h=!0,o=u,r=d;break}s=s.sibling}if(!h){for(s=d.child;s;){if(s===r){h=!0,r=d,o=u;break}if(s===o){h=!0,o=d,r=u;break}s=s.sibling}if(!h)throw Error(ft(189))}}if(r.alternate!==o)throw Error(ft(190))}if(r.tag!==3)throw Error(ft(188));return r.stateNode.current===r?e:t}function gI(e){return e=Ej(e),e!==null?yI(e):null}function yI(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yI(e);if(t!==null)return t;e=e.sibling}return null}var vI=Mo.unstable_scheduleCallback,IP=Mo.unstable_cancelCallback,Mj=Mo.unstable_shouldYield,kj=Mo.unstable_requestPaint,bn=Mo.unstable_now,Aj=Mo.unstable_getCurrentPriorityLevel,C2=Mo.unstable_ImmediatePriority,_I=Mo.unstable_UserBlockingPriority,Xv=Mo.unstable_NormalPriority,Ij=Mo.unstable_LowPriority,xI=Mo.unstable_IdlePriority,Z0=null,ca=null;function Rj(e){if(ca&&typeof ca.onCommitFiberRoot=="function")try{ca.onCommitFiberRoot(Z0,e,void 0,(e.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:zj,Lj=Math.log,Dj=Math.LN2;function zj(e){return e>>>=0,e===0?32:31-(Lj(e)/Dj|0)|0}var Vy=64,Uy=4194304;function Qf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yv(e,t){var r=e.pendingLanes;if(r===0)return 0;var o=0,u=e.suspendedLanes,d=e.pingedLanes,h=r&268435455;if(h!==0){var s=h&~u;s!==0?o=Qf(s):(d&=h,d!==0&&(o=Qf(d)))}else h=r&~u,h!==0?o=Qf(h):d!==0&&(o=Qf(d));if(o===0)return 0;if(t!==0&&t!==o&&!(t&u)&&(u=o&-o,d=t&-t,u>=d||u===16&&(d&4194240)!==0))return t;if(o&4&&(o|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)r=31-As(t),u=1<<r,o|=e[r],t&=~u;return o}function Nj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jj(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,u=e.expirationTimes,d=e.pendingLanes;0<d;){var h=31-As(d),s=1<<h,b=u[h];b===-1?(!(s&r)||s&o)&&(u[h]=Nj(s,t)):b<=t&&(e.expiredLanes|=s),d&=~s}}function Vb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bI(){var e=Vy;return Vy<<=1,!(Vy&4194240)&&(Vy=64),e}function p1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function lg(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-As(t),e[t]=r}function Oj(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<r;){var u=31-As(r),d=1<<u;t[u]=0,o[u]=-1,e[u]=-1,r&=~d}}function P2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-As(r),u=1<<o;u&t|e[o]&t&&(e[o]|=t),r&=~u}}var Mr=0;function wI(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var SI,E2,TI,CI,PI,Ub=!1,Gy=[],ac=null,lc=null,cc=null,Cm=new Map,Pm=new Map,Hl=[],Fj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RP(e,t){switch(e){case"focusin":case"focusout":ac=null;break;case"dragenter":case"dragleave":lc=null;break;case"mouseover":case"mouseout":cc=null;break;case"pointerover":case"pointerout":Cm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pm.delete(t.pointerId)}}function Ff(e,t,r,o,u,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:d,targetContainers:[u]},t!==null&&(t=ug(t),t!==null&&E2(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function Bj(e,t,r,o,u){switch(t){case"focusin":return ac=Ff(ac,e,t,r,o,u),!0;case"dragenter":return lc=Ff(lc,e,t,r,o,u),!0;case"mouseover":return cc=Ff(cc,e,t,r,o,u),!0;case"pointerover":var d=u.pointerId;return Cm.set(d,Ff(Cm.get(d)||null,e,t,r,o,u)),!0;case"gotpointercapture":return d=u.pointerId,Pm.set(d,Ff(Pm.get(d)||null,e,t,r,o,u)),!0}return!1}function EI(e){var t=Au(e.target);if(t!==null){var r=sh(t);if(r!==null){if(t=r.tag,t===13){if(t=mI(r),t!==null){e.blockedOn=t,PI(e.priority,function(){TI(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);Ob=o,r.target.dispatchEvent(o),Ob=null}else return t=ug(r),t!==null&&E2(t),e.blockedOn=r,!1;t.shift()}return!0}function LP(e,t,r){Sv(e)&&r.delete(t)}function $j(){Ub=!1,ac!==null&&Sv(ac)&&(ac=null),lc!==null&&Sv(lc)&&(lc=null),cc!==null&&Sv(cc)&&(cc=null),Cm.forEach(LP),Pm.forEach(LP)}function Bf(e,t){e.blockedOn===t&&(e.blockedOn=null,Ub||(Ub=!0,Mo.unstable_scheduleCallback(Mo.unstable_NormalPriority,$j)))}function Em(e){function t(u){return Bf(u,e)}if(0<Gy.length){Bf(Gy[0],e);for(var r=1;r<Gy.length;r++){var o=Gy[r];o.blockedOn===e&&(o.blockedOn=null)}}for(ac!==null&&Bf(ac,e),lc!==null&&Bf(lc,e),cc!==null&&Bf(cc,e),Cm.forEach(t),Pm.forEach(t),r=0;r<Hl.length;r++)o=Hl[r],o.blockedOn===e&&(o.blockedOn=null);for(;0<Hl.length&&(r=Hl[0],r.blockedOn===null);)EI(r),r.blockedOn===null&&Hl.shift()}var zd=ol.ReactCurrentBatchConfig,Qv=!0;function Vj(e,t,r,o){var u=Mr,d=zd.transition;zd.transition=null;try{Mr=1,M2(e,t,r,o)}finally{Mr=u,zd.transition=d}}function Uj(e,t,r,o){var u=Mr,d=zd.transition;zd.transition=null;try{Mr=4,M2(e,t,r,o)}finally{Mr=u,zd.transition=d}}function M2(e,t,r,o){if(Qv){var u=Gb(e,t,r,o);if(u===null)S1(e,t,o,Jv,r),RP(e,o);else if(Bj(u,e,t,r,o))o.stopPropagation();else if(RP(e,o),t&4&&-1<Fj.indexOf(e)){for(;u!==null;){var d=ug(u);if(d!==null&&SI(d),d=Gb(e,t,r,o),d===null&&S1(e,t,o,Jv,r),d===u)break;u=d}u!==null&&o.stopPropagation()}else S1(e,t,o,null,r)}}var Jv=null;function Gb(e,t,r,o){if(Jv=null,e=T2(o),e=Au(e),e!==null)if(t=sh(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mI(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jv=e,null}function MI(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Aj()){case C2:return 1;case _I:return 4;case Xv:case Ij:return 16;case xI:return 536870912;default:return 16}default:return 16}}var rc=null,k2=null,Tv=null;function kI(){if(Tv)return Tv;var e,t=k2,r=t.length,o,u="value"in rc?rc.value:rc.textContent,d=u.length;for(e=0;e<r&&t[e]===u[e];e++);var h=r-e;for(o=1;o<=h&&t[r-o]===u[d-o];o++);return Tv=u.slice(e,1<o?1-o:void 0)}function Cv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qy(){return!0}function DP(){return!1}function Io(e){function t(r,o,u,d,h){this._reactName=r,this._targetInst=u,this.type=o,this.nativeEvent=d,this.target=h,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(d):d[s]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?qy:DP,this.isPropagationStopped=DP,this}return cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qy)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qy)},persist:function(){},isPersistent:qy}),t}var mp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},A2=Io(mp),cg=cn({},mp,{view:0,detail:0}),Gj=Io(cg),f1,m1,$f,W0=cn({},cg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$f&&($f&&e.type==="mousemove"?(f1=e.screenX-$f.screenX,m1=e.screenY-$f.screenY):m1=f1=0,$f=e),f1)},movementY:function(e){return"movementY"in e?e.movementY:m1}}),zP=Io(W0),qj=cn({},W0,{dataTransfer:0}),Zj=Io(qj),Wj=cn({},cg,{relatedTarget:0}),g1=Io(Wj),Hj=cn({},mp,{animationName:0,elapsedTime:0,pseudoElement:0}),Kj=Io(Hj),Xj=cn({},mp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Yj=Io(Xj),Qj=cn({},mp,{data:0}),NP=Io(Qj),Jj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rO(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tO[e])?!!t[e]:!1}function I2(){return rO}var nO=cn({},cg,{key:function(e){if(e.key){var t=Jj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eO[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I2,charCode:function(e){return e.type==="keypress"?Cv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iO=Io(nO),oO=cn({},W0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jP=Io(oO),sO=cn({},cg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I2}),aO=Io(sO),lO=cn({},mp,{propertyName:0,elapsedTime:0,pseudoElement:0}),cO=Io(lO),uO=cn({},W0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),hO=Io(uO),dO=[9,13,27,32],R2=Xa&&"CompositionEvent"in window,om=null;Xa&&"documentMode"in document&&(om=document.documentMode);var pO=Xa&&"TextEvent"in window&&!om,AI=Xa&&(!R2||om&&8<om&&11>=om),OP=" ",FP=!1;function II(e,t){switch(e){case"keyup":return dO.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RI(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vd=!1;function fO(e,t){switch(e){case"compositionend":return RI(t);case"keypress":return t.which!==32?null:(FP=!0,OP);case"textInput":return e=t.data,e===OP&&FP?null:e;default:return null}}function mO(e,t){if(vd)return e==="compositionend"||!R2&&II(e,t)?(e=kI(),Tv=k2=rc=null,vd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return AI&&t.locale!=="ko"?null:t.data;default:return null}}var gO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BP(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gO[e.type]:t==="textarea"}function LI(e,t,r,o){uI(o),t=e0(t,"onChange"),0<t.length&&(r=new A2("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var sm=null,Mm=null;function yO(e){GI(e,0)}function H0(e){var t=bd(e);if(nI(t))return e}function vO(e,t){if(e==="change")return t}var DI=!1;if(Xa){var y1;if(Xa){var v1="oninput"in document;if(!v1){var $P=document.createElement("div");$P.setAttribute("oninput","return;"),v1=typeof $P.oninput=="function"}y1=v1}else y1=!1;DI=y1&&(!document.documentMode||9<document.documentMode)}function VP(){sm&&(sm.detachEvent("onpropertychange",zI),Mm=sm=null)}function zI(e){if(e.propertyName==="value"&&H0(Mm)){var t=[];LI(t,Mm,e,T2(e)),fI(yO,t)}}function _O(e,t,r){e==="focusin"?(VP(),sm=t,Mm=r,sm.attachEvent("onpropertychange",zI)):e==="focusout"&&VP()}function xO(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return H0(Mm)}function bO(e,t){if(e==="click")return H0(t)}function wO(e,t){if(e==="input"||e==="change")return H0(t)}function SO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rs=typeof Object.is=="function"?Object.is:SO;function km(e,t){if(Rs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var u=r[o];if(!Pb.call(t,u)||!Rs(e[u],t[u]))return!1}return!0}function UP(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function GP(e,t){var r=UP(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=UP(r)}}function NI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?NI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jI(){for(var e=window,t=Wv();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Wv(e.document)}return t}function L2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TO(e){var t=jI(),r=e.focusedElem,o=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&NI(r.ownerDocument.documentElement,r)){if(o!==null&&L2(r)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var u=r.textContent.length,d=Math.min(o.start,u);o=o.end===void 0?d:Math.min(o.end,u),!e.extend&&d>o&&(u=o,o=d,d=u),u=GP(r,d);var h=GP(r,o);u&&h&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(u.node,u.offset),e.removeAllRanges(),d>o?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var CO=Xa&&"documentMode"in document&&11>=document.documentMode,_d=null,qb=null,am=null,Zb=!1;function qP(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zb||_d==null||_d!==Wv(o)||(o=_d,"selectionStart"in o&&L2(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),am&&km(am,o)||(am=o,o=e0(qb,"onSelect"),0<o.length&&(t=new A2("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=_d)))}function Zy(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xd={animationend:Zy("Animation","AnimationEnd"),animationiteration:Zy("Animation","AnimationIteration"),animationstart:Zy("Animation","AnimationStart"),transitionend:Zy("Transition","TransitionEnd")},_1={},OI={};Xa&&(OI=document.createElement("div").style,"AnimationEvent"in window||(delete xd.animationend.animation,delete xd.animationiteration.animation,delete xd.animationstart.animation),"TransitionEvent"in window||delete xd.transitionend.transition);function K0(e){if(_1[e])return _1[e];if(!xd[e])return e;var t=xd[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in OI)return _1[e]=t[r];return e}var FI=K0("animationend"),BI=K0("animationiteration"),$I=K0("animationstart"),VI=K0("transitionend"),UI=new Map,ZP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sc(e,t){UI.set(e,t),oh(t,[e])}for(var x1=0;x1<ZP.length;x1++){var b1=ZP[x1],PO=b1.toLowerCase(),EO=b1[0].toUpperCase()+b1.slice(1);Sc(PO,"on"+EO)}Sc(FI,"onAnimationEnd");Sc(BI,"onAnimationIteration");Sc($I,"onAnimationStart");Sc("dblclick","onDoubleClick");Sc("focusin","onFocus");Sc("focusout","onBlur");Sc(VI,"onTransitionEnd");tp("onMouseEnter",["mouseout","mouseover"]);tp("onMouseLeave",["mouseout","mouseover"]);tp("onPointerEnter",["pointerout","pointerover"]);tp("onPointerLeave",["pointerout","pointerover"]);oh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oh("onBeforeInput",["compositionend","keypress","textInput","paste"]);oh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jf));function WP(e,t,r){var o=e.type||"unknown-event";e.currentTarget=r,Pj(o,t,void 0,e),e.currentTarget=null}function GI(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],u=o.event;o=o.listeners;e:{var d=void 0;if(t)for(var h=o.length-1;0<=h;h--){var s=o[h],b=s.instance,w=s.currentTarget;if(s=s.listener,b!==d&&u.isPropagationStopped())break e;WP(u,s,w),d=b}else for(h=0;h<o.length;h++){if(s=o[h],b=s.instance,w=s.currentTarget,s=s.listener,b!==d&&u.isPropagationStopped())break e;WP(u,s,w),d=b}}}if(Kv)throw e=$b,Kv=!1,$b=null,e}function Zr(e,t){var r=t[Yb];r===void 0&&(r=t[Yb]=new Set);var o=e+"__bubble";r.has(o)||(qI(t,e,2,!1),r.add(o))}function w1(e,t,r){var o=0;t&&(o|=4),qI(r,e,o,t)}var Wy="_reactListening"+Math.random().toString(36).slice(2);function Am(e){if(!e[Wy]){e[Wy]=!0,QA.forEach(function(r){r!=="selectionchange"&&(MO.has(r)||w1(r,!1,e),w1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Wy]||(t[Wy]=!0,w1("selectionchange",!1,t))}}function qI(e,t,r,o){switch(MI(t)){case 1:var u=Vj;break;case 4:u=Uj;break;default:u=M2}r=u.bind(null,t,r,e),u=void 0,!Bb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),o?u!==void 0?e.addEventListener(t,r,{capture:!0,passive:u}):e.addEventListener(t,r,!0):u!==void 0?e.addEventListener(t,r,{passive:u}):e.addEventListener(t,r,!1)}function S1(e,t,r,o,u){var d=o;if(!(t&1)&&!(t&2)&&o!==null)e:for(;;){if(o===null)return;var h=o.tag;if(h===3||h===4){var s=o.stateNode.containerInfo;if(s===u||s.nodeType===8&&s.parentNode===u)break;if(h===4)for(h=o.return;h!==null;){var b=h.tag;if((b===3||b===4)&&(b=h.stateNode.containerInfo,b===u||b.nodeType===8&&b.parentNode===u))return;h=h.return}for(;s!==null;){if(h=Au(s),h===null)return;if(b=h.tag,b===5||b===6){o=d=h;continue e}s=s.parentNode}}o=o.return}fI(function(){var w=d,C=T2(r),k=[];e:{var I=UI.get(e);if(I!==void 0){var A=A2,B=e;switch(e){case"keypress":if(Cv(r)===0)break e;case"keydown":case"keyup":A=iO;break;case"focusin":B="focus",A=g1;break;case"focusout":B="blur",A=g1;break;case"beforeblur":case"afterblur":A=g1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=zP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=Zj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=aO;break;case FI:case BI:case $I:A=Kj;break;case VI:A=cO;break;case"scroll":A=Gj;break;case"wheel":A=hO;break;case"copy":case"cut":case"paste":A=Yj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=jP}var F=(t&4)!==0,X=!F&&e==="scroll",q=F?I!==null?I+"Capture":null:I;F=[];for(var V=w,U;V!==null;){U=V;var ne=U.stateNode;if(U.tag===5&&ne!==null&&(U=ne,q!==null&&(ne=Tm(V,q),ne!=null&&F.push(Im(V,ne,U)))),X)break;V=V.return}0<F.length&&(I=new A(I,B,null,r,C),k.push({event:I,listeners:F}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",A=e==="mouseout"||e==="pointerout",I&&r!==Ob&&(B=r.relatedTarget||r.fromElement)&&(Au(B)||B[Ya]))break e;if((A||I)&&(I=C.window===C?C:(I=C.ownerDocument)?I.defaultView||I.parentWindow:window,A?(B=r.relatedTarget||r.toElement,A=w,B=B?Au(B):null,B!==null&&(X=sh(B),B!==X||B.tag!==5&&B.tag!==6)&&(B=null)):(A=null,B=w),A!==B)){if(F=zP,ne="onMouseLeave",q="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(F=jP,ne="onPointerLeave",q="onPointerEnter",V="pointer"),X=A==null?I:bd(A),U=B==null?I:bd(B),I=new F(ne,V+"leave",A,r,C),I.target=X,I.relatedTarget=U,ne=null,Au(C)===w&&(F=new F(q,V+"enter",B,r,C),F.target=U,F.relatedTarget=X,ne=F),X=ne,A&&B)t:{for(F=A,q=B,V=0,U=F;U;U=ld(U))V++;for(U=0,ne=q;ne;ne=ld(ne))U++;for(;0<V-U;)F=ld(F),V--;for(;0<U-V;)q=ld(q),U--;for(;V--;){if(F===q||q!==null&&F===q.alternate)break t;F=ld(F),q=ld(q)}F=null}else F=null;A!==null&&HP(k,I,A,F,!1),B!==null&&X!==null&&HP(k,X,B,F,!0)}}e:{if(I=w?bd(w):window,A=I.nodeName&&I.nodeName.toLowerCase(),A==="select"||A==="input"&&I.type==="file")var de=vO;else if(BP(I))if(DI)de=wO;else{de=xO;var xe=_O}else(A=I.nodeName)&&A.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(de=bO);if(de&&(de=de(e,w))){LI(k,de,r,C);break e}xe&&xe(e,I,w),e==="focusout"&&(xe=I._wrapperState)&&xe.controlled&&I.type==="number"&&Lb(I,"number",I.value)}switch(xe=w?bd(w):window,e){case"focusin":(BP(xe)||xe.contentEditable==="true")&&(_d=xe,qb=w,am=null);break;case"focusout":am=qb=_d=null;break;case"mousedown":Zb=!0;break;case"contextmenu":case"mouseup":case"dragend":Zb=!1,qP(k,r,C);break;case"selectionchange":if(CO)break;case"keydown":case"keyup":qP(k,r,C)}var ke;if(R2)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else vd?II(e,r)&&(ze="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ze="onCompositionStart");ze&&(AI&&r.locale!=="ko"&&(vd||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&vd&&(ke=kI()):(rc=C,k2="value"in rc?rc.value:rc.textContent,vd=!0)),xe=e0(w,ze),0<xe.length&&(ze=new NP(ze,e,null,r,C),k.push({event:ze,listeners:xe}),ke?ze.data=ke:(ke=RI(r),ke!==null&&(ze.data=ke)))),(ke=pO?fO(e,r):mO(e,r))&&(w=e0(w,"onBeforeInput"),0<w.length&&(C=new NP("onBeforeInput","beforeinput",null,r,C),k.push({event:C,listeners:w}),C.data=ke))}GI(k,t)})}function Im(e,t,r){return{instance:e,listener:t,currentTarget:r}}function e0(e,t){for(var r=t+"Capture",o=[];e!==null;){var u=e,d=u.stateNode;u.tag===5&&d!==null&&(u=d,d=Tm(e,r),d!=null&&o.unshift(Im(e,d,u)),d=Tm(e,t),d!=null&&o.push(Im(e,d,u))),e=e.return}return o}function ld(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function HP(e,t,r,o,u){for(var d=t._reactName,h=[];r!==null&&r!==o;){var s=r,b=s.alternate,w=s.stateNode;if(b!==null&&b===o)break;s.tag===5&&w!==null&&(s=w,u?(b=Tm(r,d),b!=null&&h.unshift(Im(r,b,s))):u||(b=Tm(r,d),b!=null&&h.push(Im(r,b,s)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var kO=/\r\n?/g,AO=/\u0000|\uFFFD/g;function KP(e){return(typeof e=="string"?e:""+e).replace(kO,`
`).replace(AO,"")}function Hy(e,t,r){if(t=KP(t),KP(e)!==t&&r)throw Error(ft(425))}function t0(){}var Wb=null,Hb=null;function Kb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xb=typeof setTimeout=="function"?setTimeout:void 0,IO=typeof clearTimeout=="function"?clearTimeout:void 0,XP=typeof Promise=="function"?Promise:void 0,RO=typeof queueMicrotask=="function"?queueMicrotask:typeof XP<"u"?function(e){return XP.resolve(null).then(e).catch(LO)}:Xb;function LO(e){setTimeout(function(){throw e})}function T1(e,t){var r=t,o=0;do{var u=r.nextSibling;if(e.removeChild(r),u&&u.nodeType===8)if(r=u.data,r==="/$"){if(o===0){e.removeChild(u),Em(t);return}o--}else r!=="$"&&r!=="$?"&&r!=="$!"||o++;r=u}while(r);Em(t)}function uc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function YP(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var gp=Math.random().toString(36).slice(2),oa="__reactFiber$"+gp,Rm="__reactProps$"+gp,Ya="__reactContainer$"+gp,Yb="__reactEvents$"+gp,DO="__reactListeners$"+gp,zO="__reactHandles$"+gp;function Au(e){var t=e[oa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ya]||r[oa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=YP(e);e!==null;){if(r=e[oa])return r;e=YP(e)}return t}e=r,r=e.parentNode}return null}function ug(e){return e=e[oa]||e[Ya],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ft(33))}function X0(e){return e[Rm]||null}var Qb=[],wd=-1;function Tc(e){return{current:e}}function Wr(e){0>wd||(e.current=Qb[wd],Qb[wd]=null,wd--)}function Br(e,t){wd++,Qb[wd]=e.current,e.current=t}var vc={},Ai=Tc(vc),no=Tc(!1),Ku=vc;function rp(e,t){var r=e.type.contextTypes;if(!r)return vc;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var u={},d;for(d in r)u[d]=t[d];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=u),u}function io(e){return e=e.childContextTypes,e!=null}function r0(){Wr(no),Wr(Ai)}function QP(e,t,r){if(Ai.current!==vc)throw Error(ft(168));Br(Ai,t),Br(no,r)}function ZI(e,t,r){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return r;o=o.getChildContext();for(var u in o)if(!(u in t))throw Error(ft(108,_j(e)||"Unknown",u));return cn({},r,o)}function n0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vc,Ku=Ai.current,Br(Ai,e),Br(no,no.current),!0}function JP(e,t,r){var o=e.stateNode;if(!o)throw Error(ft(169));r?(e=ZI(e,t,Ku),o.__reactInternalMemoizedMergedChildContext=e,Wr(no),Wr(Ai),Br(Ai,e)):Wr(no),Br(no,r)}var Ba=null,Y0=!1,C1=!1;function WI(e){Ba===null?Ba=[e]:Ba.push(e)}function NO(e){Y0=!0,WI(e)}function Cc(){if(!C1&&Ba!==null){C1=!0;var e=0,t=Mr;try{var r=Ba;for(Mr=1;e<r.length;e++){var o=r[e];do o=o(!0);while(o!==null)}Ba=null,Y0=!1}catch(u){throw Ba!==null&&(Ba=Ba.slice(e+1)),vI(C2,Cc),u}finally{Mr=t,C1=!1}}return null}var Sd=[],Td=0,i0=null,o0=0,Wo=[],Ho=0,Xu=null,Va=1,Ua="";function bu(e,t){Sd[Td++]=o0,Sd[Td++]=i0,i0=e,o0=t}function HI(e,t,r){Wo[Ho++]=Va,Wo[Ho++]=Ua,Wo[Ho++]=Xu,Xu=e;var o=Va;e=Ua;var u=32-As(o)-1;o&=~(1<<u),r+=1;var d=32-As(t)+u;if(30<d){var h=u-u%5;d=(o&(1<<h)-1).toString(32),o>>=h,u-=h,Va=1<<32-As(t)+u|r<<u|o,Ua=d+e}else Va=1<<d|r<<u|o,Ua=e}function D2(e){e.return!==null&&(bu(e,1),HI(e,1,0))}function z2(e){for(;e===i0;)i0=Sd[--Td],Sd[Td]=null,o0=Sd[--Td],Sd[Td]=null;for(;e===Xu;)Xu=Wo[--Ho],Wo[Ho]=null,Ua=Wo[--Ho],Wo[Ho]=null,Va=Wo[--Ho],Wo[Ho]=null}var Po=null,To=null,Xr=!1,Ts=null;function KI(e,t){var r=Ko(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function eE(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Po=e,To=uc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Po=e,To=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Xu!==null?{id:Va,overflow:Ua}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ko(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Po=e,To=null,!0):!1;default:return!1}}function Jb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ew(e){if(Xr){var t=To;if(t){var r=t;if(!eE(e,t)){if(Jb(e))throw Error(ft(418));t=uc(r.nextSibling);var o=Po;t&&eE(e,t)?KI(o,r):(e.flags=e.flags&-4097|2,Xr=!1,Po=e)}}else{if(Jb(e))throw Error(ft(418));e.flags=e.flags&-4097|2,Xr=!1,Po=e}}}function tE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Po=e}function Ky(e){if(e!==Po)return!1;if(!Xr)return tE(e),Xr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Kb(e.type,e.memoizedProps)),t&&(t=To)){if(Jb(e))throw XI(),Error(ft(418));for(;t;)KI(e,t),t=uc(t.nextSibling)}if(tE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ft(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){To=uc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}To=null}}else To=Po?uc(e.stateNode.nextSibling):null;return!0}function XI(){for(var e=To;e;)e=uc(e.nextSibling)}function np(){To=Po=null,Xr=!1}function N2(e){Ts===null?Ts=[e]:Ts.push(e)}var jO=ol.ReactCurrentBatchConfig;function Vf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ft(309));var o=r.stateNode}if(!o)throw Error(ft(147,e));var u=o,d=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===d?t.ref:(t=function(h){var s=u.refs;h===null?delete s[d]:s[d]=h},t._stringRef=d,t)}if(typeof e!="string")throw Error(ft(284));if(!r._owner)throw Error(ft(290,e))}return e}function Xy(e,t){throw e=Object.prototype.toString.call(t),Error(ft(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rE(e){var t=e._init;return t(e._payload)}function YI(e){function t(q,V){if(e){var U=q.deletions;U===null?(q.deletions=[V],q.flags|=16):U.push(V)}}function r(q,V){if(!e)return null;for(;V!==null;)t(q,V),V=V.sibling;return null}function o(q,V){for(q=new Map;V!==null;)V.key!==null?q.set(V.key,V):q.set(V.index,V),V=V.sibling;return q}function u(q,V){return q=fc(q,V),q.index=0,q.sibling=null,q}function d(q,V,U){return q.index=U,e?(U=q.alternate,U!==null?(U=U.index,U<V?(q.flags|=2,V):U):(q.flags|=2,V)):(q.flags|=1048576,V)}function h(q){return e&&q.alternate===null&&(q.flags|=2),q}function s(q,V,U,ne){return V===null||V.tag!==6?(V=R1(U,q.mode,ne),V.return=q,V):(V=u(V,U),V.return=q,V)}function b(q,V,U,ne){var de=U.type;return de===yd?C(q,V,U.props.children,ne,U.key):V!==null&&(V.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===ql&&rE(de)===V.type)?(ne=u(V,U.props),ne.ref=Vf(q,V,U),ne.return=q,ne):(ne=Rv(U.type,U.key,U.props,null,q.mode,ne),ne.ref=Vf(q,V,U),ne.return=q,ne)}function w(q,V,U,ne){return V===null||V.tag!==4||V.stateNode.containerInfo!==U.containerInfo||V.stateNode.implementation!==U.implementation?(V=L1(U,q.mode,ne),V.return=q,V):(V=u(V,U.children||[]),V.return=q,V)}function C(q,V,U,ne,de){return V===null||V.tag!==7?(V=Vu(U,q.mode,ne,de),V.return=q,V):(V=u(V,U),V.return=q,V)}function k(q,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return V=R1(""+V,q.mode,U),V.return=q,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Fy:return U=Rv(V.type,V.key,V.props,null,q.mode,U),U.ref=Vf(q,null,V),U.return=q,U;case gd:return V=L1(V,q.mode,U),V.return=q,V;case ql:var ne=V._init;return k(q,ne(V._payload),U)}if(Yf(V)||jf(V))return V=Vu(V,q.mode,U,null),V.return=q,V;Xy(q,V)}return null}function I(q,V,U,ne){var de=V!==null?V.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return de!==null?null:s(q,V,""+U,ne);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Fy:return U.key===de?b(q,V,U,ne):null;case gd:return U.key===de?w(q,V,U,ne):null;case ql:return de=U._init,I(q,V,de(U._payload),ne)}if(Yf(U)||jf(U))return de!==null?null:C(q,V,U,ne,null);Xy(q,U)}return null}function A(q,V,U,ne,de){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return q=q.get(U)||null,s(V,q,""+ne,de);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case Fy:return q=q.get(ne.key===null?U:ne.key)||null,b(V,q,ne,de);case gd:return q=q.get(ne.key===null?U:ne.key)||null,w(V,q,ne,de);case ql:var xe=ne._init;return A(q,V,U,xe(ne._payload),de)}if(Yf(ne)||jf(ne))return q=q.get(U)||null,C(V,q,ne,de,null);Xy(V,ne)}return null}function B(q,V,U,ne){for(var de=null,xe=null,ke=V,ze=V=0,We=null;ke!==null&&ze<U.length;ze++){ke.index>ze?(We=ke,ke=null):We=ke.sibling;var rt=I(q,ke,U[ze],ne);if(rt===null){ke===null&&(ke=We);break}e&&ke&&rt.alternate===null&&t(q,ke),V=d(rt,V,ze),xe===null?de=rt:xe.sibling=rt,xe=rt,ke=We}if(ze===U.length)return r(q,ke),Xr&&bu(q,ze),de;if(ke===null){for(;ze<U.length;ze++)ke=k(q,U[ze],ne),ke!==null&&(V=d(ke,V,ze),xe===null?de=ke:xe.sibling=ke,xe=ke);return Xr&&bu(q,ze),de}for(ke=o(q,ke);ze<U.length;ze++)We=A(ke,q,ze,U[ze],ne),We!==null&&(e&&We.alternate!==null&&ke.delete(We.key===null?ze:We.key),V=d(We,V,ze),xe===null?de=We:xe.sibling=We,xe=We);return e&&ke.forEach(function(Ze){return t(q,Ze)}),Xr&&bu(q,ze),de}function F(q,V,U,ne){var de=jf(U);if(typeof de!="function")throw Error(ft(150));if(U=de.call(U),U==null)throw Error(ft(151));for(var xe=de=null,ke=V,ze=V=0,We=null,rt=U.next();ke!==null&&!rt.done;ze++,rt=U.next()){ke.index>ze?(We=ke,ke=null):We=ke.sibling;var Ze=I(q,ke,rt.value,ne);if(Ze===null){ke===null&&(ke=We);break}e&&ke&&Ze.alternate===null&&t(q,ke),V=d(Ze,V,ze),xe===null?de=Ze:xe.sibling=Ze,xe=Ze,ke=We}if(rt.done)return r(q,ke),Xr&&bu(q,ze),de;if(ke===null){for(;!rt.done;ze++,rt=U.next())rt=k(q,rt.value,ne),rt!==null&&(V=d(rt,V,ze),xe===null?de=rt:xe.sibling=rt,xe=rt);return Xr&&bu(q,ze),de}for(ke=o(q,ke);!rt.done;ze++,rt=U.next())rt=A(ke,q,ze,rt.value,ne),rt!==null&&(e&&rt.alternate!==null&&ke.delete(rt.key===null?ze:rt.key),V=d(rt,V,ze),xe===null?de=rt:xe.sibling=rt,xe=rt);return e&&ke.forEach(function(He){return t(q,He)}),Xr&&bu(q,ze),de}function X(q,V,U,ne){if(typeof U=="object"&&U!==null&&U.type===yd&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Fy:e:{for(var de=U.key,xe=V;xe!==null;){if(xe.key===de){if(de=U.type,de===yd){if(xe.tag===7){r(q,xe.sibling),V=u(xe,U.props.children),V.return=q,q=V;break e}}else if(xe.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===ql&&rE(de)===xe.type){r(q,xe.sibling),V=u(xe,U.props),V.ref=Vf(q,xe,U),V.return=q,q=V;break e}r(q,xe);break}else t(q,xe);xe=xe.sibling}U.type===yd?(V=Vu(U.props.children,q.mode,ne,U.key),V.return=q,q=V):(ne=Rv(U.type,U.key,U.props,null,q.mode,ne),ne.ref=Vf(q,V,U),ne.return=q,q=ne)}return h(q);case gd:e:{for(xe=U.key;V!==null;){if(V.key===xe)if(V.tag===4&&V.stateNode.containerInfo===U.containerInfo&&V.stateNode.implementation===U.implementation){r(q,V.sibling),V=u(V,U.children||[]),V.return=q,q=V;break e}else{r(q,V);break}else t(q,V);V=V.sibling}V=L1(U,q.mode,ne),V.return=q,q=V}return h(q);case ql:return xe=U._init,X(q,V,xe(U._payload),ne)}if(Yf(U))return B(q,V,U,ne);if(jf(U))return F(q,V,U,ne);Xy(q,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,V!==null&&V.tag===6?(r(q,V.sibling),V=u(V,U),V.return=q,q=V):(r(q,V),V=R1(U,q.mode,ne),V.return=q,q=V),h(q)):r(q,V)}return X}var ip=YI(!0),QI=YI(!1),s0=Tc(null),a0=null,Cd=null,j2=null;function O2(){j2=Cd=a0=null}function F2(e){var t=s0.current;Wr(s0),e._currentValue=t}function tw(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function Nd(e,t){a0=e,j2=Cd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ro=!0),e.firstContext=null)}function ts(e){var t=e._currentValue;if(j2!==e)if(e={context:e,memoizedValue:t,next:null},Cd===null){if(a0===null)throw Error(ft(308));Cd=e,a0.dependencies={lanes:0,firstContext:e}}else Cd=Cd.next=e;return t}var Iu=null;function B2(e){Iu===null?Iu=[e]:Iu.push(e)}function JI(e,t,r,o){var u=t.interleaved;return u===null?(r.next=r,B2(t)):(r.next=u.next,u.next=r),t.interleaved=r,Qa(e,o)}function Qa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Zl=!1;function $2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e5(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function hc(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,xr&2){var u=o.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),o.pending=t,Qa(e,r)}return u=o.interleaved,u===null?(t.next=t,B2(o)):(t.next=u.next,u.next=t),o.interleaved=t,Qa(e,r)}function Pv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,P2(e,r)}}function nE(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var u=null,d=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};d===null?u=d=h:d=d.next=h,r=r.next}while(r!==null);d===null?u=d=t:d=d.next=t}else u=d=t;r={baseState:o.baseState,firstBaseUpdate:u,lastBaseUpdate:d,shared:o.shared,effects:o.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function l0(e,t,r,o){var u=e.updateQueue;Zl=!1;var d=u.firstBaseUpdate,h=u.lastBaseUpdate,s=u.shared.pending;if(s!==null){u.shared.pending=null;var b=s,w=b.next;b.next=null,h===null?d=w:h.next=w,h=b;var C=e.alternate;C!==null&&(C=C.updateQueue,s=C.lastBaseUpdate,s!==h&&(s===null?C.firstBaseUpdate=w:s.next=w,C.lastBaseUpdate=b))}if(d!==null){var k=u.baseState;h=0,C=w=b=null,s=d;do{var I=s.lane,A=s.eventTime;if((o&I)===I){C!==null&&(C=C.next={eventTime:A,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var B=e,F=s;switch(I=t,A=r,F.tag){case 1:if(B=F.payload,typeof B=="function"){k=B.call(A,k,I);break e}k=B;break e;case 3:B.flags=B.flags&-65537|128;case 0:if(B=F.payload,I=typeof B=="function"?B.call(A,k,I):B,I==null)break e;k=cn({},k,I);break e;case 2:Zl=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,I=u.effects,I===null?u.effects=[s]:I.push(s))}else A={eventTime:A,lane:I,tag:s.tag,payload:s.payload,callback:s.callback,next:null},C===null?(w=C=A,b=k):C=C.next=A,h|=I;if(s=s.next,s===null){if(s=u.shared.pending,s===null)break;I=s,s=I.next,I.next=null,u.lastBaseUpdate=I,u.shared.pending=null}}while(!0);if(C===null&&(b=k),u.baseState=b,u.firstBaseUpdate=w,u.lastBaseUpdate=C,t=u.shared.interleaved,t!==null){u=t;do h|=u.lane,u=u.next;while(u!==t)}else d===null&&(u.shared.lanes=0);Qu|=h,e.lanes=h,e.memoizedState=k}}function iE(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],u=o.callback;if(u!==null){if(o.callback=null,o=r,typeof u!="function")throw Error(ft(191,u));u.call(o)}}}var hg={},ua=Tc(hg),Lm=Tc(hg),Dm=Tc(hg);function Ru(e){if(e===hg)throw Error(ft(174));return e}function V2(e,t){switch(Br(Dm,t),Br(Lm,e),Br(ua,hg),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zb(t,e)}Wr(ua),Br(ua,t)}function op(){Wr(ua),Wr(Lm),Wr(Dm)}function t5(e){Ru(Dm.current);var t=Ru(ua.current),r=zb(t,e.type);t!==r&&(Br(Lm,e),Br(ua,r))}function U2(e){Lm.current===e&&(Wr(ua),Wr(Lm))}var on=Tc(0);function c0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var P1=[];function G2(){for(var e=0;e<P1.length;e++)P1[e]._workInProgressVersionPrimary=null;P1.length=0}var Ev=ol.ReactCurrentDispatcher,E1=ol.ReactCurrentBatchConfig,Yu=0,ln=null,Hn=null,ti=null,u0=!1,lm=!1,zm=0,OO=0;function Ci(){throw Error(ft(321))}function q2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rs(e[r],t[r]))return!1;return!0}function Z2(e,t,r,o,u,d){if(Yu=d,ln=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ev.current=e===null||e.memoizedState===null?VO:UO,e=r(o,u),lm){d=0;do{if(lm=!1,zm=0,25<=d)throw Error(ft(301));d+=1,ti=Hn=null,t.updateQueue=null,Ev.current=GO,e=r(o,u)}while(lm)}if(Ev.current=h0,t=Hn!==null&&Hn.next!==null,Yu=0,ti=Hn=ln=null,u0=!1,t)throw Error(ft(300));return e}function W2(){var e=zm!==0;return zm=0,e}function ea(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ti===null?ln.memoizedState=ti=e:ti=ti.next=e,ti}function rs(){if(Hn===null){var e=ln.alternate;e=e!==null?e.memoizedState:null}else e=Hn.next;var t=ti===null?ln.memoizedState:ti.next;if(t!==null)ti=t,Hn=e;else{if(e===null)throw Error(ft(310));Hn=e,e={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},ti===null?ln.memoizedState=ti=e:ti=ti.next=e}return ti}function Nm(e,t){return typeof t=="function"?t(e):t}function M1(e){var t=rs(),r=t.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=e;var o=Hn,u=o.baseQueue,d=r.pending;if(d!==null){if(u!==null){var h=u.next;u.next=d.next,d.next=h}o.baseQueue=u=d,r.pending=null}if(u!==null){d=u.next,o=o.baseState;var s=h=null,b=null,w=d;do{var C=w.lane;if((Yu&C)===C)b!==null&&(b=b.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),o=w.hasEagerState?w.eagerState:e(o,w.action);else{var k={lane:C,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};b===null?(s=b=k,h=o):b=b.next=k,ln.lanes|=C,Qu|=C}w=w.next}while(w!==null&&w!==d);b===null?h=o:b.next=s,Rs(o,t.memoizedState)||(ro=!0),t.memoizedState=o,t.baseState=h,t.baseQueue=b,r.lastRenderedState=o}if(e=r.interleaved,e!==null){u=e;do d=u.lane,ln.lanes|=d,Qu|=d,u=u.next;while(u!==e)}else u===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function k1(e){var t=rs(),r=t.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=e;var o=r.dispatch,u=r.pending,d=t.memoizedState;if(u!==null){r.pending=null;var h=u=u.next;do d=e(d,h.action),h=h.next;while(h!==u);Rs(d,t.memoizedState)||(ro=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),r.lastRenderedState=d}return[d,o]}function r5(){}function n5(e,t){var r=ln,o=rs(),u=t(),d=!Rs(o.memoizedState,u);if(d&&(o.memoizedState=u,ro=!0),o=o.queue,H2(s5.bind(null,r,o,e),[e]),o.getSnapshot!==t||d||ti!==null&&ti.memoizedState.tag&1){if(r.flags|=2048,jm(9,o5.bind(null,r,o,u,t),void 0,null),ni===null)throw Error(ft(349));Yu&30||i5(r,t,u)}return u}function i5(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function o5(e,t,r,o){t.value=r,t.getSnapshot=o,a5(t)&&l5(e)}function s5(e,t,r){return r(function(){a5(t)&&l5(e)})}function a5(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rs(e,r)}catch{return!0}}function l5(e){var t=Qa(e,1);t!==null&&Is(t,e,1,-1)}function oE(e){var t=ea();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nm,lastRenderedState:e},t.queue=e,e=e.dispatch=$O.bind(null,ln,e),[t.memoizedState,e]}function jm(e,t,r,o){return e={tag:e,create:t,destroy:r,deps:o,next:null},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e)),e}function c5(){return rs().memoizedState}function Mv(e,t,r,o){var u=ea();ln.flags|=e,u.memoizedState=jm(1|t,r,void 0,o===void 0?null:o)}function Q0(e,t,r,o){var u=rs();o=o===void 0?null:o;var d=void 0;if(Hn!==null){var h=Hn.memoizedState;if(d=h.destroy,o!==null&&q2(o,h.deps)){u.memoizedState=jm(t,r,d,o);return}}ln.flags|=e,u.memoizedState=jm(1|t,r,d,o)}function sE(e,t){return Mv(8390656,8,e,t)}function H2(e,t){return Q0(2048,8,e,t)}function u5(e,t){return Q0(4,2,e,t)}function h5(e,t){return Q0(4,4,e,t)}function d5(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function p5(e,t,r){return r=r!=null?r.concat([e]):null,Q0(4,4,d5.bind(null,t,e),r)}function K2(){}function f5(e,t){var r=rs();t=t===void 0?null:t;var o=r.memoizedState;return o!==null&&t!==null&&q2(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function m5(e,t){var r=rs();t=t===void 0?null:t;var o=r.memoizedState;return o!==null&&t!==null&&q2(t,o[1])?o[0]:(e=e(),r.memoizedState=[e,t],e)}function g5(e,t,r){return Yu&21?(Rs(r,t)||(r=bI(),ln.lanes|=r,Qu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ro=!0),e.memoizedState=r)}function FO(e,t){var r=Mr;Mr=r!==0&&4>r?r:4,e(!0);var o=E1.transition;E1.transition={};try{e(!1),t()}finally{Mr=r,E1.transition=o}}function y5(){return rs().memoizedState}function BO(e,t,r){var o=pc(e);if(r={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null},v5(e))_5(t,r);else if(r=JI(e,t,r,o),r!==null){var u=qi();Is(r,e,o,u),x5(r,t,o)}}function $O(e,t,r){var o=pc(e),u={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null};if(v5(e))_5(t,u);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var h=t.lastRenderedState,s=d(h,r);if(u.hasEagerState=!0,u.eagerState=s,Rs(s,h)){var b=t.interleaved;b===null?(u.next=u,B2(t)):(u.next=b.next,b.next=u),t.interleaved=u;return}}catch{}finally{}r=JI(e,t,u,o),r!==null&&(u=qi(),Is(r,e,o,u),x5(r,t,o))}}function v5(e){var t=e.alternate;return e===ln||t!==null&&t===ln}function _5(e,t){lm=u0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function x5(e,t,r){if(r&4194240){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,P2(e,r)}}var h0={readContext:ts,useCallback:Ci,useContext:Ci,useEffect:Ci,useImperativeHandle:Ci,useInsertionEffect:Ci,useLayoutEffect:Ci,useMemo:Ci,useReducer:Ci,useRef:Ci,useState:Ci,useDebugValue:Ci,useDeferredValue:Ci,useTransition:Ci,useMutableSource:Ci,useSyncExternalStore:Ci,useId:Ci,unstable_isNewReconciler:!1},VO={readContext:ts,useCallback:function(e,t){return ea().memoizedState=[e,t===void 0?null:t],e},useContext:ts,useEffect:sE,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Mv(4194308,4,d5.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mv(4,2,e,t)},useMemo:function(e,t){var r=ea();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var o=ea();return t=r!==void 0?r(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=BO.bind(null,ln,e),[o.memoizedState,e]},useRef:function(e){var t=ea();return e={current:e},t.memoizedState=e},useState:oE,useDebugValue:K2,useDeferredValue:function(e){return ea().memoizedState=e},useTransition:function(){var e=oE(!1),t=e[0];return e=FO.bind(null,e[1]),ea().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var o=ln,u=ea();if(Xr){if(r===void 0)throw Error(ft(407));r=r()}else{if(r=t(),ni===null)throw Error(ft(349));Yu&30||i5(o,t,r)}u.memoizedState=r;var d={value:r,getSnapshot:t};return u.queue=d,sE(s5.bind(null,o,d,e),[e]),o.flags|=2048,jm(9,o5.bind(null,o,d,r,t),void 0,null),r},useId:function(){var e=ea(),t=ni.identifierPrefix;if(Xr){var r=Ua,o=Va;r=(o&~(1<<32-As(o)-1)).toString(32)+r,t=":"+t+"R"+r,r=zm++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=OO++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},UO={readContext:ts,useCallback:f5,useContext:ts,useEffect:H2,useImperativeHandle:p5,useInsertionEffect:u5,useLayoutEffect:h5,useMemo:m5,useReducer:M1,useRef:c5,useState:function(){return M1(Nm)},useDebugValue:K2,useDeferredValue:function(e){var t=rs();return g5(t,Hn.memoizedState,e)},useTransition:function(){var e=M1(Nm)[0],t=rs().memoizedState;return[e,t]},useMutableSource:r5,useSyncExternalStore:n5,useId:y5,unstable_isNewReconciler:!1},GO={readContext:ts,useCallback:f5,useContext:ts,useEffect:H2,useImperativeHandle:p5,useInsertionEffect:u5,useLayoutEffect:h5,useMemo:m5,useReducer:k1,useRef:c5,useState:function(){return k1(Nm)},useDebugValue:K2,useDeferredValue:function(e){var t=rs();return Hn===null?t.memoizedState=e:g5(t,Hn.memoizedState,e)},useTransition:function(){var e=k1(Nm)[0],t=rs().memoizedState;return[e,t]},useMutableSource:r5,useSyncExternalStore:n5,useId:y5,unstable_isNewReconciler:!1};function _s(e,t){if(e&&e.defaultProps){t=cn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function rw(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:cn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var J0={isMounted:function(e){return(e=e._reactInternals)?sh(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var o=qi(),u=pc(e),d=qa(o,u);d.payload=t,r!=null&&(d.callback=r),t=hc(e,d,u),t!==null&&(Is(t,e,u,o),Pv(t,e,u))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=qi(),u=pc(e),d=qa(o,u);d.tag=1,d.payload=t,r!=null&&(d.callback=r),t=hc(e,d,u),t!==null&&(Is(t,e,u,o),Pv(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qi(),o=pc(e),u=qa(r,o);u.tag=2,t!=null&&(u.callback=t),t=hc(e,u,o),t!==null&&(Is(t,e,o,r),Pv(t,e,o))}};function aE(e,t,r,o,u,d,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,d,h):t.prototype&&t.prototype.isPureReactComponent?!km(r,o)||!km(u,d):!0}function b5(e,t,r){var o=!1,u=vc,d=t.contextType;return typeof d=="object"&&d!==null?d=ts(d):(u=io(t)?Ku:Ai.current,o=t.contextTypes,d=(o=o!=null)?rp(e,u):vc),t=new t(r,d),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=J0,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=d),t}function lE(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&J0.enqueueReplaceState(t,t.state,null)}function nw(e,t,r,o){var u=e.stateNode;u.props=r,u.state=e.memoizedState,u.refs={},$2(e);var d=t.contextType;typeof d=="object"&&d!==null?u.context=ts(d):(d=io(t)?Ku:Ai.current,u.context=rp(e,d)),u.state=e.memoizedState,d=t.getDerivedStateFromProps,typeof d=="function"&&(rw(e,t,d,r),u.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(t=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),t!==u.state&&J0.enqueueReplaceState(u,u.state,null),l0(e,r,u,o),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function sp(e,t){try{var r="",o=t;do r+=vj(o),o=o.return;while(o);var u=r}catch(d){u=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:t,stack:u,digest:null}}function A1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function iw(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var qO=typeof WeakMap=="function"?WeakMap:Map;function w5(e,t,r){r=qa(-1,r),r.tag=3,r.payload={element:null};var o=t.value;return r.callback=function(){p0||(p0=!0,fw=o),iw(e,t)},r}function S5(e,t,r){r=qa(-1,r),r.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var u=t.value;r.payload=function(){return o(u)},r.callback=function(){iw(e,t)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(r.callback=function(){iw(e,t),typeof o!="function"&&(dc===null?dc=new Set([this]):dc.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function cE(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new qO;var u=new Set;o.set(t,u)}else u=o.get(t),u===void 0&&(u=new Set,o.set(t,u));u.has(r)||(u.add(r),e=oF.bind(null,e,t,r),t.then(e,e))}function uE(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function hE(e,t,r,o,u){return e.mode&1?(e.flags|=65536,e.lanes=u,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qa(-1,1),t.tag=2,hc(r,t,1))),r.lanes|=1),e)}var ZO=ol.ReactCurrentOwner,ro=!1;function Vi(e,t,r,o){t.child=e===null?QI(t,null,r,o):ip(t,e.child,r,o)}function dE(e,t,r,o,u){r=r.render;var d=t.ref;return Nd(t,u),o=Z2(e,t,r,o,d,u),r=W2(),e!==null&&!ro?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,Ja(e,t,u)):(Xr&&r&&D2(t),t.flags|=1,Vi(e,t,o,u),t.child)}function pE(e,t,r,o,u){if(e===null){var d=r.type;return typeof d=="function"&&!nS(d)&&d.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=d,T5(e,t,d,o,u)):(e=Rv(r.type,null,o,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!(e.lanes&u)){var h=d.memoizedProps;if(r=r.compare,r=r!==null?r:km,r(h,o)&&e.ref===t.ref)return Ja(e,t,u)}return t.flags|=1,e=fc(d,o),e.ref=t.ref,e.return=t,t.child=e}function T5(e,t,r,o,u){if(e!==null){var d=e.memoizedProps;if(km(d,o)&&e.ref===t.ref)if(ro=!1,t.pendingProps=o=d,(e.lanes&u)!==0)e.flags&131072&&(ro=!0);else return t.lanes=e.lanes,Ja(e,t,u)}return ow(e,t,r,o,u)}function C5(e,t,r){var o=t.pendingProps,u=o.children,d=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Br(Ed,bo),bo|=r;else{if(!(r&1073741824))return e=d!==null?d.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Br(Ed,bo),bo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:r,Br(Ed,bo),bo|=o}else d!==null?(o=d.baseLanes|r,t.memoizedState=null):o=r,Br(Ed,bo),bo|=o;return Vi(e,t,u,r),t.child}function P5(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ow(e,t,r,o,u){var d=io(r)?Ku:Ai.current;return d=rp(t,d),Nd(t,u),r=Z2(e,t,r,o,d,u),o=W2(),e!==null&&!ro?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,Ja(e,t,u)):(Xr&&o&&D2(t),t.flags|=1,Vi(e,t,r,u),t.child)}function fE(e,t,r,o,u){if(io(r)){var d=!0;n0(t)}else d=!1;if(Nd(t,u),t.stateNode===null)kv(e,t),b5(t,r,o),nw(t,r,o,u),o=!0;else if(e===null){var h=t.stateNode,s=t.memoizedProps;h.props=s;var b=h.context,w=r.contextType;typeof w=="object"&&w!==null?w=ts(w):(w=io(r)?Ku:Ai.current,w=rp(t,w));var C=r.getDerivedStateFromProps,k=typeof C=="function"||typeof h.getSnapshotBeforeUpdate=="function";k||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(s!==o||b!==w)&&lE(t,h,o,w),Zl=!1;var I=t.memoizedState;h.state=I,l0(t,o,h,u),b=t.memoizedState,s!==o||I!==b||no.current||Zl?(typeof C=="function"&&(rw(t,r,C,o),b=t.memoizedState),(s=Zl||aE(t,r,s,o,I,b,w))?(k||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=b),h.props=o,h.state=b,h.context=w,o=s):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{h=t.stateNode,e5(e,t),s=t.memoizedProps,w=t.type===t.elementType?s:_s(t.type,s),h.props=w,k=t.pendingProps,I=h.context,b=r.contextType,typeof b=="object"&&b!==null?b=ts(b):(b=io(r)?Ku:Ai.current,b=rp(t,b));var A=r.getDerivedStateFromProps;(C=typeof A=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(s!==k||I!==b)&&lE(t,h,o,b),Zl=!1,I=t.memoizedState,h.state=I,l0(t,o,h,u);var B=t.memoizedState;s!==k||I!==B||no.current||Zl?(typeof A=="function"&&(rw(t,r,A,o),B=t.memoizedState),(w=Zl||aE(t,r,w,o,I,B,b)||!1)?(C||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(o,B,b),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(o,B,b)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=B),h.props=o,h.state=B,h.context=b,o=w):(typeof h.componentDidUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),o=!1)}return sw(e,t,r,o,d,u)}function sw(e,t,r,o,u,d){P5(e,t);var h=(t.flags&128)!==0;if(!o&&!h)return u&&JP(t,r,!1),Ja(e,t,d);o=t.stateNode,ZO.current=t;var s=h&&typeof r.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&h?(t.child=ip(t,e.child,null,d),t.child=ip(t,null,s,d)):Vi(e,t,s,d),t.memoizedState=o.state,u&&JP(t,r,!0),t.child}function E5(e){var t=e.stateNode;t.pendingContext?QP(e,t.pendingContext,t.pendingContext!==t.context):t.context&&QP(e,t.context,!1),V2(e,t.containerInfo)}function mE(e,t,r,o,u){return np(),N2(u),t.flags|=256,Vi(e,t,r,o),t.child}var aw={dehydrated:null,treeContext:null,retryLane:0};function lw(e){return{baseLanes:e,cachePool:null,transitions:null}}function M5(e,t,r){var o=t.pendingProps,u=on.current,d=!1,h=(t.flags&128)!==0,s;if((s=h)||(s=e!==null&&e.memoizedState===null?!1:(u&2)!==0),s?(d=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Br(on,u&1),e===null)return ew(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=o.children,e=o.fallback,d?(o=t.mode,d=t.child,h={mode:"hidden",children:h},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=h):d=r_(h,o,0,null),e=Vu(e,o,r,null),d.return=t,e.return=t,d.sibling=e,t.child=d,t.child.memoizedState=lw(r),t.memoizedState=aw,e):X2(t,h));if(u=e.memoizedState,u!==null&&(s=u.dehydrated,s!==null))return WO(e,t,h,o,s,u,r);if(d){d=o.fallback,h=t.mode,u=e.child,s=u.sibling;var b={mode:"hidden",children:o.children};return!(h&1)&&t.child!==u?(o=t.child,o.childLanes=0,o.pendingProps=b,t.deletions=null):(o=fc(u,b),o.subtreeFlags=u.subtreeFlags&14680064),s!==null?d=fc(s,d):(d=Vu(d,h,r,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,h=e.child.memoizedState,h=h===null?lw(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},d.memoizedState=h,d.childLanes=e.childLanes&~r,t.memoizedState=aw,o}return d=e.child,e=d.sibling,o=fc(d,{mode:"visible",children:o.children}),!(t.mode&1)&&(o.lanes=r),o.return=t,o.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function X2(e,t){return t=r_({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Yy(e,t,r,o){return o!==null&&N2(o),ip(t,e.child,null,r),e=X2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function WO(e,t,r,o,u,d,h){if(r)return t.flags&256?(t.flags&=-257,o=A1(Error(ft(422))),Yy(e,t,h,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(d=o.fallback,u=t.mode,o=r_({mode:"visible",children:o.children},u,0,null),d=Vu(d,u,h,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,t.mode&1&&ip(t,e.child,null,h),t.child.memoizedState=lw(h),t.memoizedState=aw,d);if(!(t.mode&1))return Yy(e,t,h,null);if(u.data==="$!"){if(o=u.nextSibling&&u.nextSibling.dataset,o)var s=o.dgst;return o=s,d=Error(ft(419)),o=A1(d,o,void 0),Yy(e,t,h,o)}if(s=(h&e.childLanes)!==0,ro||s){if(o=ni,o!==null){switch(h&-h){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(o.suspendedLanes|h)?0:u,u!==0&&u!==d.retryLane&&(d.retryLane=u,Qa(e,u),Is(o,e,u,-1))}return rS(),o=A1(Error(ft(421))),Yy(e,t,h,o)}return u.data==="$?"?(t.flags|=128,t.child=e.child,t=sF.bind(null,e),u._reactRetry=t,null):(e=d.treeContext,To=uc(u.nextSibling),Po=t,Xr=!0,Ts=null,e!==null&&(Wo[Ho++]=Va,Wo[Ho++]=Ua,Wo[Ho++]=Xu,Va=e.id,Ua=e.overflow,Xu=t),t=X2(t,o.children),t.flags|=4096,t)}function gE(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),tw(e.return,t,r)}function I1(e,t,r,o,u){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:u}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=r,d.tailMode=u)}function k5(e,t,r){var o=t.pendingProps,u=o.revealOrder,d=o.tail;if(Vi(e,t,o.children,r),o=on.current,o&2)o=o&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gE(e,r,t);else if(e.tag===19)gE(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Br(on,o),!(t.mode&1))t.memoizedState=null;else switch(u){case"forwards":for(r=t.child,u=null;r!==null;)e=r.alternate,e!==null&&c0(e)===null&&(u=r),r=r.sibling;r=u,r===null?(u=t.child,t.child=null):(u=r.sibling,r.sibling=null),I1(t,!1,u,r,d);break;case"backwards":for(r=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&c0(e)===null){t.child=u;break}e=u.sibling,u.sibling=r,r=u,u=e}I1(t,!0,r,null,d);break;case"together":I1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function kv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ja(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ft(153));if(t.child!==null){for(e=t.child,r=fc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=fc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function HO(e,t,r){switch(t.tag){case 3:E5(t),np();break;case 5:t5(t);break;case 1:io(t.type)&&n0(t);break;case 4:V2(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,u=t.memoizedProps.value;Br(s0,o._currentValue),o._currentValue=u;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(Br(on,on.current&1),t.flags|=128,null):r&t.child.childLanes?M5(e,t,r):(Br(on,on.current&1),e=Ja(e,t,r),e!==null?e.sibling:null);Br(on,on.current&1);break;case 19:if(o=(r&t.childLanes)!==0,e.flags&128){if(o)return k5(e,t,r);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Br(on,on.current),o)break;return null;case 22:case 23:return t.lanes=0,C5(e,t,r)}return Ja(e,t,r)}var A5,cw,I5,R5;A5=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cw=function(){};I5=function(e,t,r,o){var u=e.memoizedProps;if(u!==o){e=t.stateNode,Ru(ua.current);var d=null;switch(r){case"input":u=Ib(e,u),o=Ib(e,o),d=[];break;case"select":u=cn({},u,{value:void 0}),o=cn({},o,{value:void 0}),d=[];break;case"textarea":u=Db(e,u),o=Db(e,o),d=[];break;default:typeof u.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=t0)}Nb(r,o);var h;r=null;for(w in u)if(!o.hasOwnProperty(w)&&u.hasOwnProperty(w)&&u[w]!=null)if(w==="style"){var s=u[w];for(h in s)s.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(wm.hasOwnProperty(w)?d||(d=[]):(d=d||[]).push(w,null));for(w in o){var b=o[w];if(s=u!=null?u[w]:void 0,o.hasOwnProperty(w)&&b!==s&&(b!=null||s!=null))if(w==="style")if(s){for(h in s)!s.hasOwnProperty(h)||b&&b.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in b)b.hasOwnProperty(h)&&s[h]!==b[h]&&(r||(r={}),r[h]=b[h])}else r||(d||(d=[]),d.push(w,r)),r=b;else w==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,s=s?s.__html:void 0,b!=null&&s!==b&&(d=d||[]).push(w,b)):w==="children"?typeof b!="string"&&typeof b!="number"||(d=d||[]).push(w,""+b):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(wm.hasOwnProperty(w)?(b!=null&&w==="onScroll"&&Zr("scroll",e),d||s===b||(d=[])):(d=d||[]).push(w,b))}r&&(d=d||[]).push("style",r);var w=d;(t.updateQueue=w)&&(t.flags|=4)}};R5=function(e,t,r,o){r!==o&&(t.flags|=4)};function Uf(e,t){if(!Xr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Pi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var u=e.child;u!==null;)r|=u.lanes|u.childLanes,o|=u.subtreeFlags&14680064,o|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)r|=u.lanes|u.childLanes,o|=u.subtreeFlags,o|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function KO(e,t,r){var o=t.pendingProps;switch(z2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pi(t),null;case 1:return io(t.type)&&r0(),Pi(t),null;case 3:return o=t.stateNode,op(),Wr(no),Wr(Ai),G2(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Ky(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ts!==null&&(yw(Ts),Ts=null))),cw(e,t),Pi(t),null;case 5:U2(t);var u=Ru(Dm.current);if(r=t.type,e!==null&&t.stateNode!=null)I5(e,t,r,o,u),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(ft(166));return Pi(t),null}if(e=Ru(ua.current),Ky(t)){o=t.stateNode,r=t.type;var d=t.memoizedProps;switch(o[oa]=t,o[Rm]=d,e=(t.mode&1)!==0,r){case"dialog":Zr("cancel",o),Zr("close",o);break;case"iframe":case"object":case"embed":Zr("load",o);break;case"video":case"audio":for(u=0;u<Jf.length;u++)Zr(Jf[u],o);break;case"source":Zr("error",o);break;case"img":case"image":case"link":Zr("error",o),Zr("load",o);break;case"details":Zr("toggle",o);break;case"input":CP(o,d),Zr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},Zr("invalid",o);break;case"textarea":EP(o,d),Zr("invalid",o)}Nb(r,d),u=null;for(var h in d)if(d.hasOwnProperty(h)){var s=d[h];h==="children"?typeof s=="string"?o.textContent!==s&&(d.suppressHydrationWarning!==!0&&Hy(o.textContent,s,e),u=["children",s]):typeof s=="number"&&o.textContent!==""+s&&(d.suppressHydrationWarning!==!0&&Hy(o.textContent,s,e),u=["children",""+s]):wm.hasOwnProperty(h)&&s!=null&&h==="onScroll"&&Zr("scroll",o)}switch(r){case"input":By(o),PP(o,d,!0);break;case"textarea":By(o),MP(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=t0)}o=u,t.updateQueue=o,o!==null&&(t.flags|=4)}else{h=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sI(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=h.createElement(r,{is:o.is}):(e=h.createElement(r),r==="select"&&(h=e,o.multiple?h.multiple=!0:o.size&&(h.size=o.size))):e=h.createElementNS(e,r),e[oa]=t,e[Rm]=o,A5(e,t,!1,!1),t.stateNode=e;e:{switch(h=jb(r,o),r){case"dialog":Zr("cancel",e),Zr("close",e),u=o;break;case"iframe":case"object":case"embed":Zr("load",e),u=o;break;case"video":case"audio":for(u=0;u<Jf.length;u++)Zr(Jf[u],e);u=o;break;case"source":Zr("error",e),u=o;break;case"img":case"image":case"link":Zr("error",e),Zr("load",e),u=o;break;case"details":Zr("toggle",e),u=o;break;case"input":CP(e,o),u=Ib(e,o),Zr("invalid",e);break;case"option":u=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},u=cn({},o,{value:void 0}),Zr("invalid",e);break;case"textarea":EP(e,o),u=Db(e,o),Zr("invalid",e);break;default:u=o}Nb(r,u),s=u;for(d in s)if(s.hasOwnProperty(d)){var b=s[d];d==="style"?cI(e,b):d==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&aI(e,b)):d==="children"?typeof b=="string"?(r!=="textarea"||b!=="")&&Sm(e,b):typeof b=="number"&&Sm(e,""+b):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(wm.hasOwnProperty(d)?b!=null&&d==="onScroll"&&Zr("scroll",e):b!=null&&x2(e,d,b,h))}switch(r){case"input":By(e),PP(e,o,!1);break;case"textarea":By(e),MP(e);break;case"option":o.value!=null&&e.setAttribute("value",""+yc(o.value));break;case"select":e.multiple=!!o.multiple,d=o.value,d!=null?Rd(e,!!o.multiple,d,!1):o.defaultValue!=null&&Rd(e,!!o.multiple,o.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=t0)}switch(r){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pi(t),null;case 6:if(e&&t.stateNode!=null)R5(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(ft(166));if(r=Ru(Dm.current),Ru(ua.current),Ky(t)){if(o=t.stateNode,r=t.memoizedProps,o[oa]=t,(d=o.nodeValue!==r)&&(e=Po,e!==null))switch(e.tag){case 3:Hy(o.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Hy(o.nodeValue,r,(e.mode&1)!==0)}d&&(t.flags|=4)}else o=(r.nodeType===9?r:r.ownerDocument).createTextNode(o),o[oa]=t,t.stateNode=o}return Pi(t),null;case 13:if(Wr(on),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xr&&To!==null&&t.mode&1&&!(t.flags&128))XI(),np(),t.flags|=98560,d=!1;else if(d=Ky(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(ft(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(ft(317));d[oa]=t}else np(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pi(t),d=!1}else Ts!==null&&(yw(Ts),Ts=null),d=!0;if(!d)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,t.mode&1&&(e===null||on.current&1?Kn===0&&(Kn=3):rS())),t.updateQueue!==null&&(t.flags|=4),Pi(t),null);case 4:return op(),cw(e,t),e===null&&Am(t.stateNode.containerInfo),Pi(t),null;case 10:return F2(t.type._context),Pi(t),null;case 17:return io(t.type)&&r0(),Pi(t),null;case 19:if(Wr(on),d=t.memoizedState,d===null)return Pi(t),null;if(o=(t.flags&128)!==0,h=d.rendering,h===null)if(o)Uf(d,!1);else{if(Kn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=c0(e),h!==null){for(t.flags|=128,Uf(d,!1),o=h.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=r,r=t.child;r!==null;)d=r,e=o,d.flags&=14680066,h=d.alternate,h===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=h.childLanes,d.lanes=h.lanes,d.child=h.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=h.memoizedProps,d.memoizedState=h.memoizedState,d.updateQueue=h.updateQueue,d.type=h.type,e=h.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Br(on,on.current&1|2),t.child}e=e.sibling}d.tail!==null&&bn()>ap&&(t.flags|=128,o=!0,Uf(d,!1),t.lanes=4194304)}else{if(!o)if(e=c0(h),e!==null){if(t.flags|=128,o=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uf(d,!0),d.tail===null&&d.tailMode==="hidden"&&!h.alternate&&!Xr)return Pi(t),null}else 2*bn()-d.renderingStartTime>ap&&r!==1073741824&&(t.flags|=128,o=!0,Uf(d,!1),t.lanes=4194304);d.isBackwards?(h.sibling=t.child,t.child=h):(r=d.last,r!==null?r.sibling=h:t.child=h,d.last=h)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=bn(),t.sibling=null,r=on.current,Br(on,o?r&1|2:r&1),t):(Pi(t),null);case 22:case 23:return tS(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&t.mode&1?bo&1073741824&&(Pi(t),t.subtreeFlags&6&&(t.flags|=8192)):Pi(t),null;case 24:return null;case 25:return null}throw Error(ft(156,t.tag))}function XO(e,t){switch(z2(t),t.tag){case 1:return io(t.type)&&r0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return op(),Wr(no),Wr(Ai),G2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return U2(t),null;case 13:if(Wr(on),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ft(340));np()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wr(on),null;case 4:return op(),null;case 10:return F2(t.type._context),null;case 22:case 23:return tS(),null;case 24:return null;default:return null}}var Qy=!1,ki=!1,YO=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function Pd(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(o){mn(e,t,o)}else r.current=null}function uw(e,t,r){try{r()}catch(o){mn(e,t,o)}}var yE=!1;function QO(e,t){if(Wb=Qv,e=jI(),L2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var u=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{r.nodeType,d.nodeType}catch{r=null;break e}var h=0,s=-1,b=-1,w=0,C=0,k=e,I=null;t:for(;;){for(var A;k!==r||u!==0&&k.nodeType!==3||(s=h+u),k!==d||o!==0&&k.nodeType!==3||(b=h+o),k.nodeType===3&&(h+=k.nodeValue.length),(A=k.firstChild)!==null;)I=k,k=A;for(;;){if(k===e)break t;if(I===r&&++w===u&&(s=h),I===d&&++C===o&&(b=h),(A=k.nextSibling)!==null)break;k=I,I=k.parentNode}k=A}r=s===-1||b===-1?null:{start:s,end:b}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hb={focusedElem:e,selectionRange:r},Qv=!1,Mt=t;Mt!==null;)if(t=Mt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Mt=e;else for(;Mt!==null;){t=Mt;try{var B=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var F=B.memoizedProps,X=B.memoizedState,q=t.stateNode,V=q.getSnapshotBeforeUpdate(t.elementType===t.type?F:_s(t.type,F),X);q.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch(ne){mn(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,Mt=e;break}Mt=t.return}return B=yE,yE=!1,B}function cm(e,t,r){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&e)===e){var d=u.destroy;u.destroy=void 0,d!==void 0&&uw(t,r,d)}u=u.next}while(u!==o)}}function e_(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var o=r.create;r.destroy=o()}r=r.next}while(r!==t)}}function hw(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function L5(e){var t=e.alternate;t!==null&&(e.alternate=null,L5(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[oa],delete t[Rm],delete t[Yb],delete t[DO],delete t[zO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function D5(e){return e.tag===5||e.tag===3||e.tag===4}function vE(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||D5(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dw(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=t0));else if(o!==4&&(e=e.child,e!==null))for(dw(e,t,r),e=e.sibling;e!==null;)dw(e,t,r),e=e.sibling}function pw(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(pw(e,t,r),e=e.sibling;e!==null;)pw(e,t,r),e=e.sibling}var pi=null,Ss=!1;function Ol(e,t,r){for(r=r.child;r!==null;)z5(e,t,r),r=r.sibling}function z5(e,t,r){if(ca&&typeof ca.onCommitFiberUnmount=="function")try{ca.onCommitFiberUnmount(Z0,r)}catch{}switch(r.tag){case 5:ki||Pd(r,t);case 6:var o=pi,u=Ss;pi=null,Ol(e,t,r),pi=o,Ss=u,pi!==null&&(Ss?(e=pi,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):pi.removeChild(r.stateNode));break;case 18:pi!==null&&(Ss?(e=pi,r=r.stateNode,e.nodeType===8?T1(e.parentNode,r):e.nodeType===1&&T1(e,r),Em(e)):T1(pi,r.stateNode));break;case 4:o=pi,u=Ss,pi=r.stateNode.containerInfo,Ss=!0,Ol(e,t,r),pi=o,Ss=u;break;case 0:case 11:case 14:case 15:if(!ki&&(o=r.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){u=o=o.next;do{var d=u,h=d.destroy;d=d.tag,h!==void 0&&(d&2||d&4)&&uw(r,t,h),u=u.next}while(u!==o)}Ol(e,t,r);break;case 1:if(!ki&&(Pd(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=r.memoizedProps,o.state=r.memoizedState,o.componentWillUnmount()}catch(s){mn(r,t,s)}Ol(e,t,r);break;case 21:Ol(e,t,r);break;case 22:r.mode&1?(ki=(o=ki)||r.memoizedState!==null,Ol(e,t,r),ki=o):Ol(e,t,r);break;default:Ol(e,t,r)}}function _E(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new YO),t.forEach(function(o){var u=aF.bind(null,e,o);r.has(o)||(r.add(o),o.then(u,u))})}}function ys(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];try{var d=e,h=t,s=h;e:for(;s!==null;){switch(s.tag){case 5:pi=s.stateNode,Ss=!1;break e;case 3:pi=s.stateNode.containerInfo,Ss=!0;break e;case 4:pi=s.stateNode.containerInfo,Ss=!0;break e}s=s.return}if(pi===null)throw Error(ft(160));z5(d,h,u),pi=null,Ss=!1;var b=u.alternate;b!==null&&(b.return=null),u.return=null}catch(w){mn(u,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)N5(t,e),t=t.sibling}function N5(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ys(t,e),Js(e),o&4){try{cm(3,e,e.return),e_(3,e)}catch(F){mn(e,e.return,F)}try{cm(5,e,e.return)}catch(F){mn(e,e.return,F)}}break;case 1:ys(t,e),Js(e),o&512&&r!==null&&Pd(r,r.return);break;case 5:if(ys(t,e),Js(e),o&512&&r!==null&&Pd(r,r.return),e.flags&32){var u=e.stateNode;try{Sm(u,"")}catch(F){mn(e,e.return,F)}}if(o&4&&(u=e.stateNode,u!=null)){var d=e.memoizedProps,h=r!==null?r.memoizedProps:d,s=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{s==="input"&&d.type==="radio"&&d.name!=null&&iI(u,d),jb(s,h);var w=jb(s,d);for(h=0;h<b.length;h+=2){var C=b[h],k=b[h+1];C==="style"?cI(u,k):C==="dangerouslySetInnerHTML"?aI(u,k):C==="children"?Sm(u,k):x2(u,C,k,w)}switch(s){case"input":Rb(u,d);break;case"textarea":oI(u,d);break;case"select":var I=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!d.multiple;var A=d.value;A!=null?Rd(u,!!d.multiple,A,!1):I!==!!d.multiple&&(d.defaultValue!=null?Rd(u,!!d.multiple,d.defaultValue,!0):Rd(u,!!d.multiple,d.multiple?[]:"",!1))}u[Rm]=d}catch(F){mn(e,e.return,F)}}break;case 6:if(ys(t,e),Js(e),o&4){if(e.stateNode===null)throw Error(ft(162));u=e.stateNode,d=e.memoizedProps;try{u.nodeValue=d}catch(F){mn(e,e.return,F)}}break;case 3:if(ys(t,e),Js(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{Em(t.containerInfo)}catch(F){mn(e,e.return,F)}break;case 4:ys(t,e),Js(e);break;case 13:ys(t,e),Js(e),u=e.child,u.flags&8192&&(d=u.memoizedState!==null,u.stateNode.isHidden=d,!d||u.alternate!==null&&u.alternate.memoizedState!==null||(J2=bn())),o&4&&_E(e);break;case 22:if(C=r!==null&&r.memoizedState!==null,e.mode&1?(ki=(w=ki)||C,ys(t,e),ki=w):ys(t,e),Js(e),o&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!C&&e.mode&1)for(Mt=e,C=e.child;C!==null;){for(k=Mt=C;Mt!==null;){switch(I=Mt,A=I.child,I.tag){case 0:case 11:case 14:case 15:cm(4,I,I.return);break;case 1:Pd(I,I.return);var B=I.stateNode;if(typeof B.componentWillUnmount=="function"){o=I,r=I.return;try{t=o,B.props=t.memoizedProps,B.state=t.memoizedState,B.componentWillUnmount()}catch(F){mn(o,r,F)}}break;case 5:Pd(I,I.return);break;case 22:if(I.memoizedState!==null){bE(k);continue}}A!==null?(A.return=I,Mt=A):bE(k)}C=C.sibling}e:for(C=null,k=e;;){if(k.tag===5){if(C===null){C=k;try{u=k.stateNode,w?(d=u.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(s=k.stateNode,b=k.memoizedProps.style,h=b!=null&&b.hasOwnProperty("display")?b.display:null,s.style.display=lI("display",h))}catch(F){mn(e,e.return,F)}}}else if(k.tag===6){if(C===null)try{k.stateNode.nodeValue=w?"":k.memoizedProps}catch(F){mn(e,e.return,F)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===e)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===e)break e;for(;k.sibling===null;){if(k.return===null||k.return===e)break e;C===k&&(C=null),k=k.return}C===k&&(C=null),k.sibling.return=k.return,k=k.sibling}}break;case 19:ys(t,e),Js(e),o&4&&_E(e);break;case 21:break;default:ys(t,e),Js(e)}}function Js(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(D5(r)){var o=r;break e}r=r.return}throw Error(ft(160))}switch(o.tag){case 5:var u=o.stateNode;o.flags&32&&(Sm(u,""),o.flags&=-33);var d=vE(e);pw(e,d,u);break;case 3:case 4:var h=o.stateNode.containerInfo,s=vE(e);dw(e,s,h);break;default:throw Error(ft(161))}}catch(b){mn(e,e.return,b)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function JO(e,t,r){Mt=e,j5(e)}function j5(e,t,r){for(var o=(e.mode&1)!==0;Mt!==null;){var u=Mt,d=u.child;if(u.tag===22&&o){var h=u.memoizedState!==null||Qy;if(!h){var s=u.alternate,b=s!==null&&s.memoizedState!==null||ki;s=Qy;var w=ki;if(Qy=h,(ki=b)&&!w)for(Mt=u;Mt!==null;)h=Mt,b=h.child,h.tag===22&&h.memoizedState!==null?wE(u):b!==null?(b.return=h,Mt=b):wE(u);for(;d!==null;)Mt=d,j5(d),d=d.sibling;Mt=u,Qy=s,ki=w}xE(e)}else u.subtreeFlags&8772&&d!==null?(d.return=u,Mt=d):xE(e)}}function xE(e){for(;Mt!==null;){var t=Mt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ki||e_(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!ki)if(r===null)o.componentDidMount();else{var u=t.elementType===t.type?r.memoizedProps:_s(t.type,r.memoizedProps);o.componentDidUpdate(u,r.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=t.updateQueue;d!==null&&iE(t,d,o);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}iE(t,h,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var b=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&r.focus();break;case"img":b.src&&(r.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var C=w.memoizedState;if(C!==null){var k=C.dehydrated;k!==null&&Em(k)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}ki||t.flags&512&&hw(t)}catch(I){mn(t,t.return,I)}}if(t===e){Mt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Mt=r;break}Mt=t.return}}function bE(e){for(;Mt!==null;){var t=Mt;if(t===e){Mt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Mt=r;break}Mt=t.return}}function wE(e){for(;Mt!==null;){var t=Mt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{e_(4,t)}catch(b){mn(t,r,b)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var u=t.return;try{o.componentDidMount()}catch(b){mn(t,u,b)}}var d=t.return;try{hw(t)}catch(b){mn(t,d,b)}break;case 5:var h=t.return;try{hw(t)}catch(b){mn(t,h,b)}}}catch(b){mn(t,t.return,b)}if(t===e){Mt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Mt=s;break}Mt=t.return}}var eF=Math.ceil,d0=ol.ReactCurrentDispatcher,Y2=ol.ReactCurrentOwner,es=ol.ReactCurrentBatchConfig,xr=0,ni=null,jn=null,mi=0,bo=0,Ed=Tc(0),Kn=0,Om=null,Qu=0,t_=0,Q2=0,um=null,to=null,J2=0,ap=1/0,Fa=null,p0=!1,fw=null,dc=null,Jy=!1,nc=null,f0=0,hm=0,mw=null,Av=-1,Iv=0;function qi(){return xr&6?bn():Av!==-1?Av:Av=bn()}function pc(e){return e.mode&1?xr&2&&mi!==0?mi&-mi:jO.transition!==null?(Iv===0&&(Iv=bI()),Iv):(e=Mr,e!==0||(e=window.event,e=e===void 0?16:MI(e.type)),e):1}function Is(e,t,r,o){if(50<hm)throw hm=0,mw=null,Error(ft(185));lg(e,r,o),(!(xr&2)||e!==ni)&&(e===ni&&(!(xr&2)&&(t_|=r),Kn===4&&Kl(e,mi)),oo(e,o),r===1&&xr===0&&!(t.mode&1)&&(ap=bn()+500,Y0&&Cc()))}function oo(e,t){var r=e.callbackNode;jj(e,t);var o=Yv(e,e===ni?mi:0);if(o===0)r!==null&&IP(r),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(r!=null&&IP(r),t===1)e.tag===0?NO(SE.bind(null,e)):WI(SE.bind(null,e)),RO(function(){!(xr&6)&&Cc()}),r=null;else{switch(wI(o)){case 1:r=C2;break;case 4:r=_I;break;case 16:r=Xv;break;case 536870912:r=xI;break;default:r=Xv}r=q5(r,O5.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function O5(e,t){if(Av=-1,Iv=0,xr&6)throw Error(ft(327));var r=e.callbackNode;if(jd()&&e.callbackNode!==r)return null;var o=Yv(e,e===ni?mi:0);if(o===0)return null;if(o&30||o&e.expiredLanes||t)t=m0(e,o);else{t=o;var u=xr;xr|=2;var d=B5();(ni!==e||mi!==t)&&(Fa=null,ap=bn()+500,$u(e,t));do try{nF();break}catch(s){F5(e,s)}while(!0);O2(),d0.current=d,xr=u,jn!==null?t=0:(ni=null,mi=0,t=Kn)}if(t!==0){if(t===2&&(u=Vb(e),u!==0&&(o=u,t=gw(e,u))),t===1)throw r=Om,$u(e,0),Kl(e,o),oo(e,bn()),r;if(t===6)Kl(e,o);else{if(u=e.current.alternate,!(o&30)&&!tF(u)&&(t=m0(e,o),t===2&&(d=Vb(e),d!==0&&(o=d,t=gw(e,d))),t===1))throw r=Om,$u(e,0),Kl(e,o),oo(e,bn()),r;switch(e.finishedWork=u,e.finishedLanes=o,t){case 0:case 1:throw Error(ft(345));case 2:wu(e,to,Fa);break;case 3:if(Kl(e,o),(o&130023424)===o&&(t=J2+500-bn(),10<t)){if(Yv(e,0)!==0)break;if(u=e.suspendedLanes,(u&o)!==o){qi(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Xb(wu.bind(null,e,to,Fa),t);break}wu(e,to,Fa);break;case 4:if(Kl(e,o),(o&4194240)===o)break;for(t=e.eventTimes,u=-1;0<o;){var h=31-As(o);d=1<<h,h=t[h],h>u&&(u=h),o&=~d}if(o=u,o=bn()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*eF(o/1960))-o,10<o){e.timeoutHandle=Xb(wu.bind(null,e,to,Fa),o);break}wu(e,to,Fa);break;case 5:wu(e,to,Fa);break;default:throw Error(ft(329))}}}return oo(e,bn()),e.callbackNode===r?O5.bind(null,e):null}function gw(e,t){var r=um;return e.current.memoizedState.isDehydrated&&($u(e,t).flags|=256),e=m0(e,t),e!==2&&(t=to,to=r,t!==null&&yw(t)),e}function yw(e){to===null?to=e:to.push.apply(to,e)}function tF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var o=0;o<r.length;o++){var u=r[o],d=u.getSnapshot;u=u.value;try{if(!Rs(d(),u))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kl(e,t){for(t&=~Q2,t&=~t_,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-As(t),o=1<<r;e[r]=-1,t&=~o}}function SE(e){if(xr&6)throw Error(ft(327));jd();var t=Yv(e,0);if(!(t&1))return oo(e,bn()),null;var r=m0(e,t);if(e.tag!==0&&r===2){var o=Vb(e);o!==0&&(t=o,r=gw(e,o))}if(r===1)throw r=Om,$u(e,0),Kl(e,t),oo(e,bn()),r;if(r===6)throw Error(ft(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,to,Fa),oo(e,bn()),null}function eS(e,t){var r=xr;xr|=1;try{return e(t)}finally{xr=r,xr===0&&(ap=bn()+500,Y0&&Cc())}}function Ju(e){nc!==null&&nc.tag===0&&!(xr&6)&&jd();var t=xr;xr|=1;var r=es.transition,o=Mr;try{if(es.transition=null,Mr=1,e)return e()}finally{Mr=o,es.transition=r,xr=t,!(xr&6)&&Cc()}}function tS(){bo=Ed.current,Wr(Ed)}function $u(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,IO(r)),jn!==null)for(r=jn.return;r!==null;){var o=r;switch(z2(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&r0();break;case 3:op(),Wr(no),Wr(Ai),G2();break;case 5:U2(o);break;case 4:op();break;case 13:Wr(on);break;case 19:Wr(on);break;case 10:F2(o.type._context);break;case 22:case 23:tS()}r=r.return}if(ni=e,jn=e=fc(e.current,null),mi=bo=t,Kn=0,Om=null,Q2=t_=Qu=0,to=um=null,Iu!==null){for(t=0;t<Iu.length;t++)if(r=Iu[t],o=r.interleaved,o!==null){r.interleaved=null;var u=o.next,d=r.pending;if(d!==null){var h=d.next;d.next=u,o.next=h}r.pending=o}Iu=null}return e}function F5(e,t){do{var r=jn;try{if(O2(),Ev.current=h0,u0){for(var o=ln.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}u0=!1}if(Yu=0,ti=Hn=ln=null,lm=!1,zm=0,Y2.current=null,r===null||r.return===null){Kn=1,Om=t,jn=null;break}e:{var d=e,h=r.return,s=r,b=t;if(t=mi,s.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var w=b,C=s,k=C.tag;if(!(C.mode&1)&&(k===0||k===11||k===15)){var I=C.alternate;I?(C.updateQueue=I.updateQueue,C.memoizedState=I.memoizedState,C.lanes=I.lanes):(C.updateQueue=null,C.memoizedState=null)}var A=uE(h);if(A!==null){A.flags&=-257,hE(A,h,s,d,t),A.mode&1&&cE(d,w,t),t=A,b=w;var B=t.updateQueue;if(B===null){var F=new Set;F.add(b),t.updateQueue=F}else B.add(b);break e}else{if(!(t&1)){cE(d,w,t),rS();break e}b=Error(ft(426))}}else if(Xr&&s.mode&1){var X=uE(h);if(X!==null){!(X.flags&65536)&&(X.flags|=256),hE(X,h,s,d,t),N2(sp(b,s));break e}}d=b=sp(b,s),Kn!==4&&(Kn=2),um===null?um=[d]:um.push(d),d=h;do{switch(d.tag){case 3:d.flags|=65536,t&=-t,d.lanes|=t;var q=w5(d,b,t);nE(d,q);break e;case 1:s=b;var V=d.type,U=d.stateNode;if(!(d.flags&128)&&(typeof V.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(dc===null||!dc.has(U)))){d.flags|=65536,t&=-t,d.lanes|=t;var ne=S5(d,s,t);nE(d,ne);break e}}d=d.return}while(d!==null)}V5(r)}catch(de){t=de,jn===r&&r!==null&&(jn=r=r.return);continue}break}while(!0)}function B5(){var e=d0.current;return d0.current=h0,e===null?h0:e}function rS(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),ni===null||!(Qu&268435455)&&!(t_&268435455)||Kl(ni,mi)}function m0(e,t){var r=xr;xr|=2;var o=B5();(ni!==e||mi!==t)&&(Fa=null,$u(e,t));do try{rF();break}catch(u){F5(e,u)}while(!0);if(O2(),xr=r,d0.current=o,jn!==null)throw Error(ft(261));return ni=null,mi=0,Kn}function rF(){for(;jn!==null;)$5(jn)}function nF(){for(;jn!==null&&!Mj();)$5(jn)}function $5(e){var t=G5(e.alternate,e,bo);e.memoizedProps=e.pendingProps,t===null?V5(e):jn=t,Y2.current=null}function V5(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=XO(r,t),r!==null){r.flags&=32767,jn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Kn=6,jn=null;return}}else if(r=KO(r,t,bo),r!==null){jn=r;return}if(t=t.sibling,t!==null){jn=t;return}jn=t=e}while(t!==null);Kn===0&&(Kn=5)}function wu(e,t,r){var o=Mr,u=es.transition;try{es.transition=null,Mr=1,iF(e,t,r,o)}finally{es.transition=u,Mr=o}return null}function iF(e,t,r,o){do jd();while(nc!==null);if(xr&6)throw Error(ft(327));r=e.finishedWork;var u=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ft(177));e.callbackNode=null,e.callbackPriority=0;var d=r.lanes|r.childLanes;if(Oj(e,d),e===ni&&(jn=ni=null,mi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Jy||(Jy=!0,q5(Xv,function(){return jd(),null})),d=(r.flags&15990)!==0,r.subtreeFlags&15990||d){d=es.transition,es.transition=null;var h=Mr;Mr=1;var s=xr;xr|=4,Y2.current=null,QO(e,r),N5(r,e),TO(Hb),Qv=!!Wb,Hb=Wb=null,e.current=r,JO(r),kj(),xr=s,Mr=h,es.transition=d}else e.current=r;if(Jy&&(Jy=!1,nc=e,f0=u),d=e.pendingLanes,d===0&&(dc=null),Rj(r.stateNode),oo(e,bn()),t!==null)for(o=e.onRecoverableError,r=0;r<t.length;r++)u=t[r],o(u.value,{componentStack:u.stack,digest:u.digest});if(p0)throw p0=!1,e=fw,fw=null,e;return f0&1&&e.tag!==0&&jd(),d=e.pendingLanes,d&1?e===mw?hm++:(hm=0,mw=e):hm=0,Cc(),null}function jd(){if(nc!==null){var e=wI(f0),t=es.transition,r=Mr;try{if(es.transition=null,Mr=16>e?16:e,nc===null)var o=!1;else{if(e=nc,nc=null,f0=0,xr&6)throw Error(ft(331));var u=xr;for(xr|=4,Mt=e.current;Mt!==null;){var d=Mt,h=d.child;if(Mt.flags&16){var s=d.deletions;if(s!==null){for(var b=0;b<s.length;b++){var w=s[b];for(Mt=w;Mt!==null;){var C=Mt;switch(C.tag){case 0:case 11:case 15:cm(8,C,d)}var k=C.child;if(k!==null)k.return=C,Mt=k;else for(;Mt!==null;){C=Mt;var I=C.sibling,A=C.return;if(L5(C),C===w){Mt=null;break}if(I!==null){I.return=A,Mt=I;break}Mt=A}}}var B=d.alternate;if(B!==null){var F=B.child;if(F!==null){B.child=null;do{var X=F.sibling;F.sibling=null,F=X}while(F!==null)}}Mt=d}}if(d.subtreeFlags&2064&&h!==null)h.return=d,Mt=h;else e:for(;Mt!==null;){if(d=Mt,d.flags&2048)switch(d.tag){case 0:case 11:case 15:cm(9,d,d.return)}var q=d.sibling;if(q!==null){q.return=d.return,Mt=q;break e}Mt=d.return}}var V=e.current;for(Mt=V;Mt!==null;){h=Mt;var U=h.child;if(h.subtreeFlags&2064&&U!==null)U.return=h,Mt=U;else e:for(h=V;Mt!==null;){if(s=Mt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:e_(9,s)}}catch(de){mn(s,s.return,de)}if(s===h){Mt=null;break e}var ne=s.sibling;if(ne!==null){ne.return=s.return,Mt=ne;break e}Mt=s.return}}if(xr=u,Cc(),ca&&typeof ca.onPostCommitFiberRoot=="function")try{ca.onPostCommitFiberRoot(Z0,e)}catch{}o=!0}return o}finally{Mr=r,es.transition=t}}return!1}function TE(e,t,r){t=sp(r,t),t=w5(e,t,1),e=hc(e,t,1),t=qi(),e!==null&&(lg(e,1,t),oo(e,t))}function mn(e,t,r){if(e.tag===3)TE(e,e,r);else for(;t!==null;){if(t.tag===3){TE(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(dc===null||!dc.has(o))){e=sp(r,e),e=S5(t,e,1),t=hc(t,e,1),e=qi(),t!==null&&(lg(t,1,e),oo(t,e));break}}t=t.return}}function oF(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),t=qi(),e.pingedLanes|=e.suspendedLanes&r,ni===e&&(mi&r)===r&&(Kn===4||Kn===3&&(mi&130023424)===mi&&500>bn()-J2?$u(e,0):Q2|=r),oo(e,t)}function U5(e,t){t===0&&(e.mode&1?(t=Uy,Uy<<=1,!(Uy&130023424)&&(Uy=4194304)):t=1);var r=qi();e=Qa(e,t),e!==null&&(lg(e,t,r),oo(e,r))}function sF(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),U5(e,r)}function aF(e,t){var r=0;switch(e.tag){case 13:var o=e.stateNode,u=e.memoizedState;u!==null&&(r=u.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(ft(314))}o!==null&&o.delete(t),U5(e,r)}var G5;G5=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||no.current)ro=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ro=!1,HO(e,t,r);ro=!!(e.flags&131072)}else ro=!1,Xr&&t.flags&1048576&&HI(t,o0,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;kv(e,t),e=t.pendingProps;var u=rp(t,Ai.current);Nd(t,r),u=Z2(null,t,o,e,u,r);var d=W2();return t.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,io(o)?(d=!0,n0(t)):d=!1,t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,$2(t),u.updater=J0,t.stateNode=u,u._reactInternals=t,nw(t,o,e,r),t=sw(null,t,o,!0,d,r)):(t.tag=0,Xr&&d&&D2(t),Vi(null,t,u,r),t=t.child),t;case 16:o=t.elementType;e:{switch(kv(e,t),e=t.pendingProps,u=o._init,o=u(o._payload),t.type=o,u=t.tag=cF(o),e=_s(o,e),u){case 0:t=ow(null,t,o,e,r);break e;case 1:t=fE(null,t,o,e,r);break e;case 11:t=dE(null,t,o,e,r);break e;case 14:t=pE(null,t,o,_s(o.type,e),r);break e}throw Error(ft(306,o,""))}return t;case 0:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:_s(o,u),ow(e,t,o,u,r);case 1:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:_s(o,u),fE(e,t,o,u,r);case 3:e:{if(E5(t),e===null)throw Error(ft(387));o=t.pendingProps,d=t.memoizedState,u=d.element,e5(e,t),l0(t,o,null,r);var h=t.memoizedState;if(o=h.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){u=sp(Error(ft(423)),t),t=mE(e,t,o,r,u);break e}else if(o!==u){u=sp(Error(ft(424)),t),t=mE(e,t,o,r,u);break e}else for(To=uc(t.stateNode.containerInfo.firstChild),Po=t,Xr=!0,Ts=null,r=QI(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(np(),o===u){t=Ja(e,t,r);break e}Vi(e,t,o,r)}t=t.child}return t;case 5:return t5(t),e===null&&ew(t),o=t.type,u=t.pendingProps,d=e!==null?e.memoizedProps:null,h=u.children,Kb(o,u)?h=null:d!==null&&Kb(o,d)&&(t.flags|=32),P5(e,t),Vi(e,t,h,r),t.child;case 6:return e===null&&ew(t),null;case 13:return M5(e,t,r);case 4:return V2(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=ip(t,null,o,r):Vi(e,t,o,r),t.child;case 11:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:_s(o,u),dE(e,t,o,u,r);case 7:return Vi(e,t,t.pendingProps,r),t.child;case 8:return Vi(e,t,t.pendingProps.children,r),t.child;case 12:return Vi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(o=t.type._context,u=t.pendingProps,d=t.memoizedProps,h=u.value,Br(s0,o._currentValue),o._currentValue=h,d!==null)if(Rs(d.value,h)){if(d.children===u.children&&!no.current){t=Ja(e,t,r);break e}}else for(d=t.child,d!==null&&(d.return=t);d!==null;){var s=d.dependencies;if(s!==null){h=d.child;for(var b=s.firstContext;b!==null;){if(b.context===o){if(d.tag===1){b=qa(-1,r&-r),b.tag=2;var w=d.updateQueue;if(w!==null){w=w.shared;var C=w.pending;C===null?b.next=b:(b.next=C.next,C.next=b),w.pending=b}}d.lanes|=r,b=d.alternate,b!==null&&(b.lanes|=r),tw(d.return,r,t),s.lanes|=r;break}b=b.next}}else if(d.tag===10)h=d.type===t.type?null:d.child;else if(d.tag===18){if(h=d.return,h===null)throw Error(ft(341));h.lanes|=r,s=h.alternate,s!==null&&(s.lanes|=r),tw(h,r,t),h=d.sibling}else h=d.child;if(h!==null)h.return=d;else for(h=d;h!==null;){if(h===t){h=null;break}if(d=h.sibling,d!==null){d.return=h.return,h=d;break}h=h.return}d=h}Vi(e,t,u.children,r),t=t.child}return t;case 9:return u=t.type,o=t.pendingProps.children,Nd(t,r),u=ts(u),o=o(u),t.flags|=1,Vi(e,t,o,r),t.child;case 14:return o=t.type,u=_s(o,t.pendingProps),u=_s(o.type,u),pE(e,t,o,u,r);case 15:return T5(e,t,t.type,t.pendingProps,r);case 17:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:_s(o,u),kv(e,t),t.tag=1,io(o)?(e=!0,n0(t)):e=!1,Nd(t,r),b5(t,o,u),nw(t,o,u,r),sw(null,t,o,!0,e,r);case 19:return k5(e,t,r);case 22:return C5(e,t,r)}throw Error(ft(156,t.tag))};function q5(e,t){return vI(e,t)}function lF(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ko(e,t,r,o){return new lF(e,t,r,o)}function nS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cF(e){if(typeof e=="function")return nS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w2)return 11;if(e===S2)return 14}return 2}function fc(e,t){var r=e.alternate;return r===null?(r=Ko(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rv(e,t,r,o,u,d){var h=2;if(o=e,typeof e=="function")nS(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case yd:return Vu(r.children,u,d,t);case b2:h=8,u|=8;break;case Eb:return e=Ko(12,r,t,u|2),e.elementType=Eb,e.lanes=d,e;case Mb:return e=Ko(13,r,t,u),e.elementType=Mb,e.lanes=d,e;case kb:return e=Ko(19,r,t,u),e.elementType=kb,e.lanes=d,e;case tI:return r_(r,u,d,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case JA:h=10;break e;case eI:h=9;break e;case w2:h=11;break e;case S2:h=14;break e;case ql:h=16,o=null;break e}throw Error(ft(130,e==null?e:typeof e,""))}return t=Ko(h,r,t,u),t.elementType=e,t.type=o,t.lanes=d,t}function Vu(e,t,r,o){return e=Ko(7,e,o,t),e.lanes=r,e}function r_(e,t,r,o){return e=Ko(22,e,o,t),e.elementType=tI,e.lanes=r,e.stateNode={isHidden:!1},e}function R1(e,t,r){return e=Ko(6,e,null,t),e.lanes=r,e}function L1(e,t,r){return t=Ko(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uF(e,t,r,o,u){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=p1(0),this.expirationTimes=p1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=p1(0),this.identifierPrefix=o,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function iS(e,t,r,o,u,d,h,s,b){return e=new uF(e,t,r,s,b),t===1?(t=1,d===!0&&(t|=8)):t=0,d=Ko(3,null,null,t),e.current=d,d.stateNode=e,d.memoizedState={element:o,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$2(d),e}function hF(e,t,r){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gd,key:o==null?null:""+o,children:e,containerInfo:t,implementation:r}}function Z5(e){if(!e)return vc;e=e._reactInternals;e:{if(sh(e)!==e||e.tag!==1)throw Error(ft(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(io(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ft(171))}if(e.tag===1){var r=e.type;if(io(r))return ZI(e,r,t)}return t}function W5(e,t,r,o,u,d,h,s,b){return e=iS(r,o,!0,e,u,d,h,s,b),e.context=Z5(null),r=e.current,o=qi(),u=pc(r),d=qa(o,u),d.callback=t??null,hc(r,d,u),e.current.lanes=u,lg(e,u,o),oo(e,o),e}function n_(e,t,r,o){var u=t.current,d=qi(),h=pc(u);return r=Z5(r),t.context===null?t.context=r:t.pendingContext=r,t=qa(d,h),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=hc(u,t,h),e!==null&&(Is(e,u,h,d),Pv(e,u,h)),h}function g0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function CE(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function oS(e,t){CE(e,t),(e=e.alternate)&&CE(e,t)}function dF(){return null}var H5=typeof reportError=="function"?reportError:function(e){console.error(e)};function sS(e){this._internalRoot=e}i_.prototype.render=sS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ft(409));n_(e,t,null,null)};i_.prototype.unmount=sS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ju(function(){n_(null,e,null,null)}),t[Ya]=null}};function i_(e){this._internalRoot=e}i_.prototype.unstable_scheduleHydration=function(e){if(e){var t=CI();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hl.length&&t!==0&&t<Hl[r].priority;r++);Hl.splice(r,0,e),r===0&&EI(e)}};function aS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function PE(){}function pF(e,t,r,o,u){if(u){if(typeof o=="function"){var d=o;o=function(){var w=g0(h);d.call(w)}}var h=W5(t,o,e,0,null,!1,!1,"",PE);return e._reactRootContainer=h,e[Ya]=h.current,Am(e.nodeType===8?e.parentNode:e),Ju(),h}for(;u=e.lastChild;)e.removeChild(u);if(typeof o=="function"){var s=o;o=function(){var w=g0(b);s.call(w)}}var b=iS(e,0,!1,null,null,!1,!1,"",PE);return e._reactRootContainer=b,e[Ya]=b.current,Am(e.nodeType===8?e.parentNode:e),Ju(function(){n_(t,b,r,o)}),b}function s_(e,t,r,o,u){var d=r._reactRootContainer;if(d){var h=d;if(typeof u=="function"){var s=u;u=function(){var b=g0(h);s.call(b)}}n_(t,h,e,u)}else h=pF(r,t,e,u,o);return g0(h)}SI=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Qf(t.pendingLanes);r!==0&&(P2(t,r|1),oo(t,bn()),!(xr&6)&&(ap=bn()+500,Cc()))}break;case 13:Ju(function(){var o=Qa(e,1);if(o!==null){var u=qi();Is(o,e,1,u)}}),oS(e,1)}};E2=function(e){if(e.tag===13){var t=Qa(e,134217728);if(t!==null){var r=qi();Is(t,e,134217728,r)}oS(e,134217728)}};TI=function(e){if(e.tag===13){var t=pc(e),r=Qa(e,t);if(r!==null){var o=qi();Is(r,e,t,o)}oS(e,t)}};CI=function(){return Mr};PI=function(e,t){var r=Mr;try{return Mr=e,t()}finally{Mr=r}};Fb=function(e,t,r){switch(t){case"input":if(Rb(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var u=X0(o);if(!u)throw Error(ft(90));nI(o),Rb(o,u)}}}break;case"textarea":oI(e,r);break;case"select":t=r.value,t!=null&&Rd(e,!!r.multiple,t,!1)}};dI=eS;pI=Ju;var fF={usingClientEntryPoint:!1,Events:[ug,bd,X0,uI,hI,eS]},Gf={findFiberByHostInstance:Au,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mF={bundleType:Gf.bundleType,version:Gf.version,rendererPackageName:Gf.rendererPackageName,rendererConfig:Gf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ol.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gI(e),e===null?null:e.stateNode},findFiberByHostInstance:Gf.findFiberByHostInstance||dF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ev=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ev.isDisabled&&ev.supportsFiber)try{Z0=ev.inject(mF),ca=ev}catch{}}Ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fF;Ao.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aS(t))throw Error(ft(200));return hF(e,t,null,r)};Ao.createRoot=function(e,t){if(!aS(e))throw Error(ft(299));var r=!1,o="",u=H5;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(u=t.onRecoverableError)),t=iS(e,1,!1,null,null,r,!1,o,u),e[Ya]=t.current,Am(e.nodeType===8?e.parentNode:e),new sS(t)};Ao.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ft(188)):(e=Object.keys(e).join(","),Error(ft(268,e)));return e=gI(t),e=e===null?null:e.stateNode,e};Ao.flushSync=function(e){return Ju(e)};Ao.hydrate=function(e,t,r){if(!o_(t))throw Error(ft(200));return s_(null,e,t,!0,r)};Ao.hydrateRoot=function(e,t,r){if(!aS(e))throw Error(ft(405));var o=r!=null&&r.hydratedSources||null,u=!1,d="",h=H5;if(r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=W5(t,null,e,1,r??null,u,!1,d,h),e[Ya]=t.current,Am(e),o)for(e=0;e<o.length;e++)r=o[e],u=r._getVersion,u=u(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,u]:t.mutableSourceEagerHydrationData.push(r,u);return new i_(t)};Ao.render=function(e,t,r){if(!o_(t))throw Error(ft(200));return s_(null,e,t,!1,r)};Ao.unmountComponentAtNode=function(e){if(!o_(e))throw Error(ft(40));return e._reactRootContainer?(Ju(function(){s_(null,null,e,!1,function(){e._reactRootContainer=null,e[Ya]=null})}),!0):!1};Ao.unstable_batchedUpdates=eS;Ao.unstable_renderSubtreeIntoContainer=function(e,t,r,o){if(!o_(r))throw Error(ft(200));if(e==null||e._reactInternals===void 0)throw Error(ft(38));return s_(e,t,r,!1,o)};Ao.version="18.3.1-next-f1338f8080-20240426";function K5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K5)}catch(e){console.error(e)}}K5(),KA.exports=Ao;var dg=KA.exports;const X5=G0(dg);var Y5,EE=dg;Y5=EE.createRoot,EE.hydrateRoot;const gF=1,yF=1e6;let D1=0;function vF(){return D1=(D1+1)%Number.MAX_SAFE_INTEGER,D1.toString()}const z1=new Map,ME=e=>{if(z1.has(e))return;const t=setTimeout(()=>{z1.delete(e),dm({type:"REMOVE_TOAST",toastId:e})},yF);z1.set(e,t)},_F=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,gF)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?ME(r):e.toasts.forEach(o=>{ME(o.id)}),{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,open:!1}:o)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Lv=[];let Dv={toasts:[]};function dm(e){Dv=_F(Dv,e),Lv.forEach(t=>{t(Dv)})}function xF({...e}){const t=vF(),r=u=>dm({type:"UPDATE_TOAST",toast:{...u,id:t}}),o=()=>dm({type:"DISMISS_TOAST",toastId:t});return dm({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:u=>{u||o()}}}),{id:t,dismiss:o,update:r}}function bF(){const[e,t]=K.useState(Dv);return K.useEffect(()=>(Lv.push(t),()=>{const r=Lv.indexOf(t);r>-1&&Lv.splice(r,1)}),[e]),{...e,toast:xF,dismiss:r=>dm({type:"DISMISS_TOAST",toastId:r})}}function Yr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(u){if(e==null||e(u),r===!1||!u.defaultPrevented)return t==null?void 0:t(u)}}function kE(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Q5(...e){return t=>{let r=!1;const o=e.map(u=>{const d=kE(u,t);return!r&&typeof d=="function"&&(r=!0),d});if(r)return()=>{for(let u=0;u<o.length;u++){const d=o[u];typeof d=="function"?d():kE(e[u],null)}}}}function Zi(...e){return K.useCallback(Q5(...e),e)}function wF(e,t){const r=K.createContext(t),o=d=>{const{children:h,...s}=d,b=K.useMemo(()=>s,Object.values(s));return j.jsx(r.Provider,{value:b,children:h})};o.displayName=e+"Provider";function u(d){const h=K.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${d}\` must be used within \`${e}\``)}return[o,u]}function pg(e,t=[]){let r=[];function o(d,h){const s=K.createContext(h),b=r.length;r=[...r,h];const w=k=>{var q;const{scope:I,children:A,...B}=k,F=((q=I==null?void 0:I[e])==null?void 0:q[b])||s,X=K.useMemo(()=>B,Object.values(B));return j.jsx(F.Provider,{value:X,children:A})};w.displayName=d+"Provider";function C(k,I){var F;const A=((F=I==null?void 0:I[e])==null?void 0:F[b])||s,B=K.useContext(A);if(B)return B;if(h!==void 0)return h;throw new Error(`\`${k}\` must be used within \`${d}\``)}return[w,C]}const u=()=>{const d=r.map(h=>K.createContext(h));return function(s){const b=(s==null?void 0:s[e])||d;return K.useMemo(()=>({[`__scope${e}`]:{...s,[e]:b}}),[s,b])}};return u.scopeName=e,[o,SF(u,...t)]}function SF(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const o=e.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(d){const h=o.reduce((s,{useScope:b,scopeName:w})=>{const k=b(d)[`__scope${w}`];return{...s,...k}},{});return K.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function Fm(e){const t=CF(e),r=K.forwardRef((o,u)=>{const{children:d,...h}=o,s=K.Children.toArray(d),b=s.find(EF);if(b){const w=b.props.children,C=s.map(k=>k===b?K.Children.count(w)>1?K.Children.only(null):K.isValidElement(w)?w.props.children:null:k);return j.jsx(t,{...h,ref:u,children:K.isValidElement(w)?K.cloneElement(w,void 0,C):null})}return j.jsx(t,{...h,ref:u,children:d})});return r.displayName=`${e}.Slot`,r}var TF=Fm("Slot");function CF(e){const t=K.forwardRef((r,o)=>{const{children:u,...d}=r;if(K.isValidElement(u)){const h=kF(u),s=MF(d,u.props);return u.type!==K.Fragment&&(s.ref=o?Q5(o,h):h),K.cloneElement(u,s)}return K.Children.count(u)>1?K.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var J5=Symbol("radix.slottable");function PF(e){const t=({children:r})=>j.jsx(j.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=J5,t}function EF(e){return K.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===J5}function MF(e,t){const r={...t};for(const o in t){const u=e[o],d=t[o];/^on[A-Z]/.test(o)?u&&d?r[o]=(...s)=>{const b=d(...s);return u(...s),b}:u&&(r[o]=u):o==="style"?r[o]={...u,...d}:o==="className"&&(r[o]=[u,d].filter(Boolean).join(" "))}return{...e,...r}}function kF(e){var o,u;let t=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(u=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:u.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function AF(e){const t=e+"CollectionProvider",[r,o]=pg(t),[u,d]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=F=>{const{scope:X,children:q}=F,V=yt.useRef(null),U=yt.useRef(new Map).current;return j.jsx(u,{scope:X,itemMap:U,collectionRef:V,children:q})};h.displayName=t;const s=e+"CollectionSlot",b=Fm(s),w=yt.forwardRef((F,X)=>{const{scope:q,children:V}=F,U=d(s,q),ne=Zi(X,U.collectionRef);return j.jsx(b,{ref:ne,children:V})});w.displayName=s;const C=e+"CollectionItemSlot",k="data-radix-collection-item",I=Fm(C),A=yt.forwardRef((F,X)=>{const{scope:q,children:V,...U}=F,ne=yt.useRef(null),de=Zi(X,ne),xe=d(C,q);return yt.useEffect(()=>(xe.itemMap.set(ne,{ref:ne,...U}),()=>void xe.itemMap.delete(ne))),j.jsx(I,{[k]:"",ref:de,children:V})});A.displayName=C;function B(F){const X=d(e+"CollectionConsumer",F);return yt.useCallback(()=>{const V=X.collectionRef.current;if(!V)return[];const U=Array.from(V.querySelectorAll(`[${k}]`));return Array.from(X.itemMap.values()).sort((xe,ke)=>U.indexOf(xe.ref.current)-U.indexOf(ke.ref.current))},[X.collectionRef,X.itemMap])}return[{Provider:h,Slot:w,ItemSlot:A},B,o]}var IF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Sn=IF.reduce((e,t)=>{const r=Fm(`Primitive.${t}`),o=K.forwardRef((u,d)=>{const{asChild:h,...s}=u,b=h?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),j.jsx(b,{...s,ref:d})});return o.displayName=`Primitive.${t}`,{...e,[t]:o}},{});function eR(e,t){e&&dg.flushSync(()=>e.dispatchEvent(t))}function ya(e){const t=K.useRef(e);return K.useEffect(()=>{t.current=e}),K.useMemo(()=>(...r)=>{var o;return(o=t.current)==null?void 0:o.call(t,...r)},[])}function RF(e,t=globalThis==null?void 0:globalThis.document){const r=ya(e);K.useEffect(()=>{const o=u=>{u.key==="Escape"&&r(u)};return t.addEventListener("keydown",o,{capture:!0}),()=>t.removeEventListener("keydown",o,{capture:!0})},[r,t])}var LF="DismissableLayer",vw="dismissableLayer.update",DF="dismissableLayer.pointerDownOutside",zF="dismissableLayer.focusOutside",AE,tR=K.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),a_=K.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:s,...b}=e,w=K.useContext(tR),[C,k]=K.useState(null),I=(C==null?void 0:C.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=K.useState({}),B=Zi(t,ke=>k(ke)),F=Array.from(w.layers),[X]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),q=F.indexOf(X),V=C?F.indexOf(C):-1,U=w.layersWithOutsidePointerEventsDisabled.size>0,ne=V>=q,de=jF(ke=>{const ze=ke.target,We=[...w.branches].some(rt=>rt.contains(ze));!ne||We||(u==null||u(ke),h==null||h(ke),ke.defaultPrevented||s==null||s())},I),xe=OF(ke=>{const ze=ke.target;[...w.branches].some(rt=>rt.contains(ze))||(d==null||d(ke),h==null||h(ke),ke.defaultPrevented||s==null||s())},I);return RF(ke=>{V===w.layers.size-1&&(o==null||o(ke),!ke.defaultPrevented&&s&&(ke.preventDefault(),s()))},I),K.useEffect(()=>{if(C)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(AE=I.body.style.pointerEvents,I.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(C)),w.layers.add(C),IE(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(I.body.style.pointerEvents=AE)}},[C,I,r,w]),K.useEffect(()=>()=>{C&&(w.layers.delete(C),w.layersWithOutsidePointerEventsDisabled.delete(C),IE())},[C,w]),K.useEffect(()=>{const ke=()=>A({});return document.addEventListener(vw,ke),()=>document.removeEventListener(vw,ke)},[]),j.jsx(Sn.div,{...b,ref:B,style:{pointerEvents:U?ne?"auto":"none":void 0,...e.style},onFocusCapture:Yr(e.onFocusCapture,xe.onFocusCapture),onBlurCapture:Yr(e.onBlurCapture,xe.onBlurCapture),onPointerDownCapture:Yr(e.onPointerDownCapture,de.onPointerDownCapture)})});a_.displayName=LF;var NF="DismissableLayerBranch",rR=K.forwardRef((e,t)=>{const r=K.useContext(tR),o=K.useRef(null),u=Zi(t,o);return K.useEffect(()=>{const d=o.current;if(d)return r.branches.add(d),()=>{r.branches.delete(d)}},[r.branches]),j.jsx(Sn.div,{...e,ref:u})});rR.displayName=NF;function jF(e,t=globalThis==null?void 0:globalThis.document){const r=ya(e),o=K.useRef(!1),u=K.useRef(()=>{});return K.useEffect(()=>{const d=s=>{if(s.target&&!o.current){let b=function(){nR(DF,r,w,{discrete:!0})};const w={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",u.current),u.current=b,t.addEventListener("click",u.current,{once:!0})):b()}else t.removeEventListener("click",u.current);o.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",d)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",d),t.removeEventListener("click",u.current)}},[t,r]),{onPointerDownCapture:()=>o.current=!0}}function OF(e,t=globalThis==null?void 0:globalThis.document){const r=ya(e),o=K.useRef(!1);return K.useEffect(()=>{const u=d=>{d.target&&!o.current&&nR(zF,r,{originalEvent:d},{discrete:!1})};return t.addEventListener("focusin",u),()=>t.removeEventListener("focusin",u)},[t,r]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function IE(){const e=new CustomEvent(vw);document.dispatchEvent(e)}function nR(e,t,r,{discrete:o}){const u=r.originalEvent.target,d=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&u.addEventListener(e,t,{once:!0}),o?eR(u,d):u.dispatchEvent(d)}var FF=a_,BF=rR,el=globalThis!=null&&globalThis.document?K.useLayoutEffect:()=>{},$F="Portal",lS=K.forwardRef((e,t)=>{var s;const{container:r,...o}=e,[u,d]=K.useState(!1);el(()=>d(!0),[]);const h=r||u&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return h?X5.createPortal(j.jsx(Sn.div,{...o,ref:t}),h):null});lS.displayName=$F;function VF(e,t){return K.useReducer((r,o)=>t[r][o]??r,e)}var yp=e=>{const{present:t,children:r}=e,o=UF(t),u=typeof r=="function"?r({present:o.isPresent}):K.Children.only(r),d=Zi(o.ref,GF(u));return typeof r=="function"||o.isPresent?K.cloneElement(u,{ref:d}):null};yp.displayName="Presence";function UF(e){const[t,r]=K.useState(),o=K.useRef(null),u=K.useRef(e),d=K.useRef("none"),h=e?"mounted":"unmounted",[s,b]=VF(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return K.useEffect(()=>{const w=tv(o.current);d.current=s==="mounted"?w:"none"},[s]),el(()=>{const w=o.current,C=u.current;if(C!==e){const I=d.current,A=tv(w);e?b("MOUNT"):A==="none"||(w==null?void 0:w.display)==="none"?b("UNMOUNT"):b(C&&I!==A?"ANIMATION_OUT":"UNMOUNT"),u.current=e}},[e,b]),el(()=>{if(t){let w;const C=t.ownerDocument.defaultView??window,k=A=>{const F=tv(o.current).includes(A.animationName);if(A.target===t&&F&&(b("ANIMATION_END"),!u.current)){const X=t.style.animationFillMode;t.style.animationFillMode="forwards",w=C.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=X)})}},I=A=>{A.target===t&&(d.current=tv(o.current))};return t.addEventListener("animationstart",I),t.addEventListener("animationcancel",k),t.addEventListener("animationend",k),()=>{C.clearTimeout(w),t.removeEventListener("animationstart",I),t.removeEventListener("animationcancel",k),t.removeEventListener("animationend",k)}}else b("ANIMATION_END")},[t,b]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:K.useCallback(w=>{o.current=w?getComputedStyle(w):null,r(w)},[])}}function tv(e){return(e==null?void 0:e.animationName)||"none"}function GF(e){var o,u;let t=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(u=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:u.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var qF=y2[" useInsertionEffect ".trim().toString()]||el;function iR({prop:e,defaultProp:t,onChange:r=()=>{},caller:o}){const[u,d,h]=ZF({defaultProp:t,onChange:r}),s=e!==void 0,b=s?e:u;{const C=K.useRef(e!==void 0);K.useEffect(()=>{const k=C.current;k!==s&&console.warn(`${o} is changing from ${k?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),C.current=s},[s,o])}const w=K.useCallback(C=>{var k;if(s){const I=WF(C)?C(e):C;I!==e&&((k=h.current)==null||k.call(h,I))}else d(C)},[s,e,d,h]);return[b,w]}function ZF({defaultProp:e,onChange:t}){const[r,o]=K.useState(e),u=K.useRef(r),d=K.useRef(t);return qF(()=>{d.current=t},[t]),K.useEffect(()=>{var h;u.current!==r&&((h=d.current)==null||h.call(d,r),u.current=r)},[r,u]),[r,o,d]}function WF(e){return typeof e=="function"}var HF=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),KF="VisuallyHidden",l_=K.forwardRef((e,t)=>j.jsx(Sn.span,{...e,ref:t,style:{...HF,...e.style}}));l_.displayName=KF;var XF=l_,cS="ToastProvider",[uS,YF,QF]=AF("Toast"),[oR,bY]=pg("Toast",[QF]),[JF,c_]=oR(cS),sR=e=>{const{__scopeToast:t,label:r="Notification",duration:o=5e3,swipeDirection:u="right",swipeThreshold:d=50,children:h}=e,[s,b]=K.useState(null),[w,C]=K.useState(0),k=K.useRef(!1),I=K.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${cS}\`. Expected non-empty \`string\`.`),j.jsx(uS.Provider,{scope:t,children:j.jsx(JF,{scope:t,label:r,duration:o,swipeDirection:u,swipeThreshold:d,toastCount:w,viewport:s,onViewportChange:b,onToastAdd:K.useCallback(()=>C(A=>A+1),[]),onToastRemove:K.useCallback(()=>C(A=>A-1),[]),isFocusedToastEscapeKeyDownRef:k,isClosePausedRef:I,children:h})})};sR.displayName=cS;var aR="ToastViewport",eB=["F8"],_w="toast.viewportPause",xw="toast.viewportResume",lR=K.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:o=eB,label:u="Notifications ({hotkey})",...d}=e,h=c_(aR,r),s=YF(r),b=K.useRef(null),w=K.useRef(null),C=K.useRef(null),k=K.useRef(null),I=Zi(t,k,h.onViewportChange),A=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),B=h.toastCount>0;K.useEffect(()=>{const X=q=>{var U;o.length!==0&&o.every(ne=>q[ne]||q.code===ne)&&((U=k.current)==null||U.focus())};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[o]),K.useEffect(()=>{const X=b.current,q=k.current;if(B&&X&&q){const V=()=>{if(!h.isClosePausedRef.current){const xe=new CustomEvent(_w);q.dispatchEvent(xe),h.isClosePausedRef.current=!0}},U=()=>{if(h.isClosePausedRef.current){const xe=new CustomEvent(xw);q.dispatchEvent(xe),h.isClosePausedRef.current=!1}},ne=xe=>{!X.contains(xe.relatedTarget)&&U()},de=()=>{X.contains(document.activeElement)||U()};return X.addEventListener("focusin",V),X.addEventListener("focusout",ne),X.addEventListener("pointermove",V),X.addEventListener("pointerleave",de),window.addEventListener("blur",V),window.addEventListener("focus",U),()=>{X.removeEventListener("focusin",V),X.removeEventListener("focusout",ne),X.removeEventListener("pointermove",V),X.removeEventListener("pointerleave",de),window.removeEventListener("blur",V),window.removeEventListener("focus",U)}}},[B,h.isClosePausedRef]);const F=K.useCallback(({tabbingDirection:X})=>{const V=s().map(U=>{const ne=U.ref.current,de=[ne,...pB(ne)];return X==="forwards"?de:de.reverse()});return(X==="forwards"?V.reverse():V).flat()},[s]);return K.useEffect(()=>{const X=k.current;if(X){const q=V=>{var de,xe,ke;const U=V.altKey||V.ctrlKey||V.metaKey;if(V.key==="Tab"&&!U){const ze=document.activeElement,We=V.shiftKey;if(V.target===X&&We){(de=w.current)==null||de.focus();return}const He=F({tabbingDirection:We?"backwards":"forwards"}),Ct=He.findIndex(st=>st===ze);N1(He.slice(Ct+1))?V.preventDefault():We?(xe=w.current)==null||xe.focus():(ke=C.current)==null||ke.focus()}};return X.addEventListener("keydown",q),()=>X.removeEventListener("keydown",q)}},[s,F]),j.jsxs(BF,{ref:b,role:"region","aria-label":u.replace("{hotkey}",A),tabIndex:-1,style:{pointerEvents:B?void 0:"none"},children:[B&&j.jsx(bw,{ref:w,onFocusFromOutsideViewport:()=>{const X=F({tabbingDirection:"forwards"});N1(X)}}),j.jsx(uS.Slot,{scope:r,children:j.jsx(Sn.ol,{tabIndex:-1,...d,ref:I})}),B&&j.jsx(bw,{ref:C,onFocusFromOutsideViewport:()=>{const X=F({tabbingDirection:"backwards"});N1(X)}})]})});lR.displayName=aR;var cR="ToastFocusProxy",bw=K.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:o,...u}=e,d=c_(cR,r);return j.jsx(l_,{"aria-hidden":!0,tabIndex:0,...u,ref:t,style:{position:"fixed"},onFocus:h=>{var w;const s=h.relatedTarget;!((w=d.viewport)!=null&&w.contains(s))&&o()}})});bw.displayName=cR;var fg="Toast",tB="toast.swipeStart",rB="toast.swipeMove",nB="toast.swipeCancel",iB="toast.swipeEnd",uR=K.forwardRef((e,t)=>{const{forceMount:r,open:o,defaultOpen:u,onOpenChange:d,...h}=e,[s,b]=iR({prop:o,defaultProp:u??!0,onChange:d,caller:fg});return j.jsx(yp,{present:r||s,children:j.jsx(aB,{open:s,...h,ref:t,onClose:()=>b(!1),onPause:ya(e.onPause),onResume:ya(e.onResume),onSwipeStart:Yr(e.onSwipeStart,w=>{w.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Yr(e.onSwipeMove,w=>{const{x:C,y:k}=w.detail.delta;w.currentTarget.setAttribute("data-swipe","move"),w.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${C}px`),w.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${k}px`)}),onSwipeCancel:Yr(e.onSwipeCancel,w=>{w.currentTarget.setAttribute("data-swipe","cancel"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),w.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Yr(e.onSwipeEnd,w=>{const{x:C,y:k}=w.detail.delta;w.currentTarget.setAttribute("data-swipe","end"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),w.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),w.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${C}px`),w.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${k}px`),b(!1)})})})});uR.displayName=fg;var[oB,sB]=oR(fg,{onClose(){}}),aB=K.forwardRef((e,t)=>{const{__scopeToast:r,type:o="foreground",duration:u,open:d,onClose:h,onEscapeKeyDown:s,onPause:b,onResume:w,onSwipeStart:C,onSwipeMove:k,onSwipeCancel:I,onSwipeEnd:A,...B}=e,F=c_(fg,r),[X,q]=K.useState(null),V=Zi(t,st=>q(st)),U=K.useRef(null),ne=K.useRef(null),de=u||F.duration,xe=K.useRef(0),ke=K.useRef(de),ze=K.useRef(0),{onToastAdd:We,onToastRemove:rt}=F,Ze=ya(()=>{var Ge;(X==null?void 0:X.contains(document.activeElement))&&((Ge=F.viewport)==null||Ge.focus()),h()}),He=K.useCallback(st=>{!st||st===1/0||(window.clearTimeout(ze.current),xe.current=new Date().getTime(),ze.current=window.setTimeout(Ze,st))},[Ze]);K.useEffect(()=>{const st=F.viewport;if(st){const Ge=()=>{He(ke.current),w==null||w()},tt=()=>{const ut=new Date().getTime()-xe.current;ke.current=ke.current-ut,window.clearTimeout(ze.current),b==null||b()};return st.addEventListener(_w,tt),st.addEventListener(xw,Ge),()=>{st.removeEventListener(_w,tt),st.removeEventListener(xw,Ge)}}},[F.viewport,de,b,w,He]),K.useEffect(()=>{d&&!F.isClosePausedRef.current&&He(de)},[d,de,F.isClosePausedRef,He]),K.useEffect(()=>(We(),()=>rt()),[We,rt]);const Ct=K.useMemo(()=>X?yR(X):null,[X]);return F.viewport?j.jsxs(j.Fragment,{children:[Ct&&j.jsx(lB,{__scopeToast:r,role:"status","aria-live":o==="foreground"?"assertive":"polite","aria-atomic":!0,children:Ct}),j.jsx(oB,{scope:r,onClose:Ze,children:dg.createPortal(j.jsx(uS.ItemSlot,{scope:r,children:j.jsx(FF,{asChild:!0,onEscapeKeyDown:Yr(s,()=>{F.isFocusedToastEscapeKeyDownRef.current||Ze(),F.isFocusedToastEscapeKeyDownRef.current=!1}),children:j.jsx(Sn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":d?"open":"closed","data-swipe-direction":F.swipeDirection,...B,ref:V,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Yr(e.onKeyDown,st=>{st.key==="Escape"&&(s==null||s(st.nativeEvent),st.nativeEvent.defaultPrevented||(F.isFocusedToastEscapeKeyDownRef.current=!0,Ze()))}),onPointerDown:Yr(e.onPointerDown,st=>{st.button===0&&(U.current={x:st.clientX,y:st.clientY})}),onPointerMove:Yr(e.onPointerMove,st=>{if(!U.current)return;const Ge=st.clientX-U.current.x,tt=st.clientY-U.current.y,ut=!!ne.current,Ve=["left","right"].includes(F.swipeDirection),De=["left","up"].includes(F.swipeDirection)?Math.min:Math.max,Ke=Ve?De(0,Ge):0,nt=Ve?0:De(0,tt),ot=st.pointerType==="touch"?10:2,Et={x:Ke,y:nt},Rt={originalEvent:st,delta:Et};ut?(ne.current=Et,rv(rB,k,Rt,{discrete:!1})):RE(Et,F.swipeDirection,ot)?(ne.current=Et,rv(tB,C,Rt,{discrete:!1}),st.target.setPointerCapture(st.pointerId)):(Math.abs(Ge)>ot||Math.abs(tt)>ot)&&(U.current=null)}),onPointerUp:Yr(e.onPointerUp,st=>{const Ge=ne.current,tt=st.target;if(tt.hasPointerCapture(st.pointerId)&&tt.releasePointerCapture(st.pointerId),ne.current=null,U.current=null,Ge){const ut=st.currentTarget,Ve={originalEvent:st,delta:Ge};RE(Ge,F.swipeDirection,F.swipeThreshold)?rv(iB,A,Ve,{discrete:!0}):rv(nB,I,Ve,{discrete:!0}),ut.addEventListener("click",De=>De.preventDefault(),{once:!0})}})})})}),F.viewport)})]}):null}),lB=e=>{const{__scopeToast:t,children:r,...o}=e,u=c_(fg,t),[d,h]=K.useState(!1),[s,b]=K.useState(!1);return hB(()=>h(!0)),K.useEffect(()=>{const w=window.setTimeout(()=>b(!0),1e3);return()=>window.clearTimeout(w)},[]),s?null:j.jsx(lS,{asChild:!0,children:j.jsx(l_,{...o,children:d&&j.jsxs(j.Fragment,{children:[u.label," ",r]})})})},cB="ToastTitle",hR=K.forwardRef((e,t)=>{const{__scopeToast:r,...o}=e;return j.jsx(Sn.div,{...o,ref:t})});hR.displayName=cB;var uB="ToastDescription",dR=K.forwardRef((e,t)=>{const{__scopeToast:r,...o}=e;return j.jsx(Sn.div,{...o,ref:t})});dR.displayName=uB;var pR="ToastAction",fR=K.forwardRef((e,t)=>{const{altText:r,...o}=e;return r.trim()?j.jsx(gR,{altText:r,asChild:!0,children:j.jsx(hS,{...o,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${pR}\`. Expected non-empty \`string\`.`),null)});fR.displayName=pR;var mR="ToastClose",hS=K.forwardRef((e,t)=>{const{__scopeToast:r,...o}=e,u=sB(mR,r);return j.jsx(gR,{asChild:!0,children:j.jsx(Sn.button,{type:"button",...o,ref:t,onClick:Yr(e.onClick,u.onClose)})})});hS.displayName=mR;var gR=K.forwardRef((e,t)=>{const{__scopeToast:r,altText:o,...u}=e;return j.jsx(Sn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":o||void 0,...u,ref:t})});function yR(e){const t=[];return Array.from(e.childNodes).forEach(o=>{if(o.nodeType===o.TEXT_NODE&&o.textContent&&t.push(o.textContent),dB(o)){const u=o.ariaHidden||o.hidden||o.style.display==="none",d=o.dataset.radixToastAnnounceExclude==="";if(!u)if(d){const h=o.dataset.radixToastAnnounceAlt;h&&t.push(h)}else t.push(...yR(o))}}),t}function rv(e,t,r,{discrete:o}){const u=r.originalEvent.currentTarget,d=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&u.addEventListener(e,t,{once:!0}),o?eR(u,d):u.dispatchEvent(d)}var RE=(e,t,r=0)=>{const o=Math.abs(e.x),u=Math.abs(e.y),d=o>u;return t==="left"||t==="right"?d&&o>r:!d&&u>r};function hB(e=()=>{}){const t=ya(e);el(()=>{let r=0,o=0;return r=window.requestAnimationFrame(()=>o=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(o)}},[t])}function dB(e){return e.nodeType===e.ELEMENT_NODE}function pB(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const u=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||u?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function N1(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var fB=sR,vR=lR,_R=uR,xR=hR,bR=dR,wR=fR,SR=hS;function TR(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var u=e.length;for(t=0;t<u;t++)e[t]&&(r=TR(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function CR(){for(var e,t,r=0,o="",u=arguments.length;r<u;r++)(e=arguments[r])&&(t=TR(e))&&(o&&(o+=" "),o+=t);return o}const LE=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,DE=CR,mg=(e,t)=>r=>{var o;if((t==null?void 0:t.variants)==null)return DE(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:u,defaultVariants:d}=t,h=Object.keys(u).map(w=>{const C=r==null?void 0:r[w],k=d==null?void 0:d[w];if(C===null)return null;const I=LE(C)||LE(k);return u[w][I]}),s=r&&Object.entries(r).reduce((w,C)=>{let[k,I]=C;return I===void 0||(w[k]=I),w},{}),b=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((w,C)=>{let{class:k,className:I,...A}=C;return Object.entries(A).every(B=>{let[F,X]=B;return Array.isArray(X)?X.includes({...d,...s}[F]):{...d,...s}[F]===X})?[...w,k,I]:w},[]);return DE(e,h,b,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),PR=(...e)=>e.filter((t,r,o)=>!!t&&t.trim()!==""&&o.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=K.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:h,...s},b)=>K.createElement("svg",{ref:b,...gB,width:t,height:t,stroke:e,strokeWidth:o?Number(r)*24/Number(t):r,className:PR("lucide",u),...s},[...h.map(([w,C])=>K.createElement(w,C)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=(e,t)=>{const r=K.forwardRef(({className:o,...u},d)=>K.createElement(yB,{ref:d,iconNode:t,className:PR(`lucide-${mB(e)}`,o),...u}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Jr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=Jr("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=Jr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=Jr("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=Jr("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=Jr("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=Jr("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=Jr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Jr("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=Jr("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=Jr("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=Jr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Jr("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=Jr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=Jr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=Jr("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=Jr("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=Jr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=Jr("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=Jr("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Jr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=Jr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=Jr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=Jr("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),mS="-",kB=e=>{const t=IB(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:h=>{const s=h.split(mS);return s[0]===""&&s.length!==1&&s.shift(),kR(s,t)||AB(h)},getConflictingClassGroupIds:(h,s)=>{const b=r[h]||[];return s&&o[h]?[...b,...o[h]]:b}}},kR=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],o=t.nextPart.get(r),u=o?kR(e.slice(1),o):void 0;if(u)return u;if(t.validators.length===0)return;const d=e.join(mS);return(h=t.validators.find(({validator:s})=>s(d)))==null?void 0:h.classGroupId},jE=/^\[(.+)\]$/,AB=e=>{if(jE.test(e)){const t=jE.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},IB=e=>{const{theme:t,prefix:r}=e,o={nextPart:new Map,validators:[]};return LB(Object.entries(e.classGroups),r).forEach(([d,h])=>{Tw(h,o,d,t)}),o},Tw=(e,t,r,o)=>{e.forEach(u=>{if(typeof u=="string"){const d=u===""?t:OE(t,u);d.classGroupId=r;return}if(typeof u=="function"){if(RB(u)){Tw(u(o),t,r,o);return}t.validators.push({validator:u,classGroupId:r});return}Object.entries(u).forEach(([d,h])=>{Tw(h,OE(t,d),r,o)})})},OE=(e,t)=>{let r=e;return t.split(mS).forEach(o=>{r.nextPart.has(o)||r.nextPart.set(o,{nextPart:new Map,validators:[]}),r=r.nextPart.get(o)}),r},RB=e=>e.isThemeGetter,LB=(e,t)=>t?e.map(([r,o])=>{const u=o.map(d=>typeof d=="string"?t+d:typeof d=="object"?Object.fromEntries(Object.entries(d).map(([h,s])=>[t+h,s])):d);return[r,u]}):e,DB=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,o=new Map;const u=(d,h)=>{r.set(d,h),t++,t>e&&(t=0,o=r,r=new Map)};return{get(d){let h=r.get(d);if(h!==void 0)return h;if((h=o.get(d))!==void 0)return u(d,h),h},set(d,h){r.has(d)?r.set(d,h):u(d,h)}}},AR="!",zB=e=>{const{separator:t,experimentalParseClassName:r}=e,o=t.length===1,u=t[0],d=t.length,h=s=>{const b=[];let w=0,C=0,k;for(let X=0;X<s.length;X++){let q=s[X];if(w===0){if(q===u&&(o||s.slice(X,X+d)===t)){b.push(s.slice(C,X)),C=X+d;continue}if(q==="/"){k=X;continue}}q==="["?w++:q==="]"&&w--}const I=b.length===0?s:s.substring(C),A=I.startsWith(AR),B=A?I.substring(1):I,F=k&&k>C?k-C:void 0;return{modifiers:b,hasImportantModifier:A,baseClassName:B,maybePostfixModifierPosition:F}};return r?s=>r({className:s,parseClassName:h}):h},NB=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(o=>{o[0]==="["?(t.push(...r.sort(),o),r=[]):r.push(o)}),t.push(...r.sort()),t},jB=e=>({cache:DB(e.cacheSize),parseClassName:zB(e),...kB(e)}),OB=/\s+/,FB=(e,t)=>{const{parseClassName:r,getClassGroupId:o,getConflictingClassGroupIds:u}=t,d=[],h=e.trim().split(OB);let s="";for(let b=h.length-1;b>=0;b-=1){const w=h[b],{modifiers:C,hasImportantModifier:k,baseClassName:I,maybePostfixModifierPosition:A}=r(w);let B=!!A,F=o(B?I.substring(0,A):I);if(!F){if(!B){s=w+(s.length>0?" "+s:s);continue}if(F=o(I),!F){s=w+(s.length>0?" "+s:s);continue}B=!1}const X=NB(C).join(":"),q=k?X+AR:X,V=q+F;if(d.includes(V))continue;d.push(V);const U=u(F,B);for(let ne=0;ne<U.length;++ne){const de=U[ne];d.push(q+de)}s=w+(s.length>0?" "+s:s)}return s};function BB(){let e=0,t,r,o="";for(;e<arguments.length;)(t=arguments[e++])&&(r=IR(t))&&(o&&(o+=" "),o+=r);return o}const IR=e=>{if(typeof e=="string")return e;let t,r="";for(let o=0;o<e.length;o++)e[o]&&(t=IR(e[o]))&&(r&&(r+=" "),r+=t);return r};function $B(e,...t){let r,o,u,d=h;function h(b){const w=t.reduce((C,k)=>k(C),e());return r=jB(w),o=r.cache.get,u=r.cache.set,d=s,s(b)}function s(b){const w=o(b);if(w)return w;const C=FB(b,r);return u(b,C),C}return function(){return d(BB.apply(null,arguments))}}const qr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},RR=/^\[(?:([a-z-]+):)?(.+)\]$/i,VB=/^\d+\/\d+$/,UB=new Set(["px","full","screen"]),GB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,qB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ZB=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,WB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,HB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ja=e=>Od(e)||UB.has(e)||VB.test(e),Fl=e=>vp(e,"length",r6),Od=e=>!!e&&!Number.isNaN(Number(e)),j1=e=>vp(e,"number",Od),qf=e=>!!e&&Number.isInteger(Number(e)),KB=e=>e.endsWith("%")&&Od(e.slice(0,-1)),nr=e=>RR.test(e),Bl=e=>GB.test(e),XB=new Set(["length","size","percentage"]),YB=e=>vp(e,XB,LR),QB=e=>vp(e,"position",LR),JB=new Set(["image","url"]),e6=e=>vp(e,JB,i6),t6=e=>vp(e,"",n6),Zf=()=>!0,vp=(e,t,r)=>{const o=RR.exec(e);return o?o[1]?typeof t=="string"?o[1]===t:t.has(o[1]):r(o[2]):!1},r6=e=>qB.test(e)&&!ZB.test(e),LR=()=>!1,n6=e=>WB.test(e),i6=e=>HB.test(e),o6=()=>{const e=qr("colors"),t=qr("spacing"),r=qr("blur"),o=qr("brightness"),u=qr("borderColor"),d=qr("borderRadius"),h=qr("borderSpacing"),s=qr("borderWidth"),b=qr("contrast"),w=qr("grayscale"),C=qr("hueRotate"),k=qr("invert"),I=qr("gap"),A=qr("gradientColorStops"),B=qr("gradientColorStopPositions"),F=qr("inset"),X=qr("margin"),q=qr("opacity"),V=qr("padding"),U=qr("saturate"),ne=qr("scale"),de=qr("sepia"),xe=qr("skew"),ke=qr("space"),ze=qr("translate"),We=()=>["auto","contain","none"],rt=()=>["auto","hidden","clip","visible","scroll"],Ze=()=>["auto",nr,t],He=()=>[nr,t],Ct=()=>["",ja,Fl],st=()=>["auto",Od,nr],Ge=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],tt=()=>["solid","dashed","dotted","double","none"],ut=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ve=()=>["start","end","center","between","around","evenly","stretch"],De=()=>["","0",nr],Ke=()=>["auto","avoid","all","avoid-page","page","left","right","column"],nt=()=>[Od,nr];return{cacheSize:500,separator:":",theme:{colors:[Zf],spacing:[ja,Fl],blur:["none","",Bl,nr],brightness:nt(),borderColor:[e],borderRadius:["none","","full",Bl,nr],borderSpacing:He(),borderWidth:Ct(),contrast:nt(),grayscale:De(),hueRotate:nt(),invert:De(),gap:He(),gradientColorStops:[e],gradientColorStopPositions:[KB,Fl],inset:Ze(),margin:Ze(),opacity:nt(),padding:He(),saturate:nt(),scale:nt(),sepia:De(),skew:nt(),space:He(),translate:He()},classGroups:{aspect:[{aspect:["auto","square","video",nr]}],container:["container"],columns:[{columns:[Bl]}],"break-after":[{"break-after":Ke()}],"break-before":[{"break-before":Ke()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ge(),nr]}],overflow:[{overflow:rt()}],"overflow-x":[{"overflow-x":rt()}],"overflow-y":[{"overflow-y":rt()}],overscroll:[{overscroll:We()}],"overscroll-x":[{"overscroll-x":We()}],"overscroll-y":[{"overscroll-y":We()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[F]}],"inset-x":[{"inset-x":[F]}],"inset-y":[{"inset-y":[F]}],start:[{start:[F]}],end:[{end:[F]}],top:[{top:[F]}],right:[{right:[F]}],bottom:[{bottom:[F]}],left:[{left:[F]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",qf,nr]}],basis:[{basis:Ze()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",nr]}],grow:[{grow:De()}],shrink:[{shrink:De()}],order:[{order:["first","last","none",qf,nr]}],"grid-cols":[{"grid-cols":[Zf]}],"col-start-end":[{col:["auto",{span:["full",qf,nr]},nr]}],"col-start":[{"col-start":st()}],"col-end":[{"col-end":st()}],"grid-rows":[{"grid-rows":[Zf]}],"row-start-end":[{row:["auto",{span:[qf,nr]},nr]}],"row-start":[{"row-start":st()}],"row-end":[{"row-end":st()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",nr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",nr]}],gap:[{gap:[I]}],"gap-x":[{"gap-x":[I]}],"gap-y":[{"gap-y":[I]}],"justify-content":[{justify:["normal",...Ve()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ve(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ve(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[V]}],px:[{px:[V]}],py:[{py:[V]}],ps:[{ps:[V]}],pe:[{pe:[V]}],pt:[{pt:[V]}],pr:[{pr:[V]}],pb:[{pb:[V]}],pl:[{pl:[V]}],m:[{m:[X]}],mx:[{mx:[X]}],my:[{my:[X]}],ms:[{ms:[X]}],me:[{me:[X]}],mt:[{mt:[X]}],mr:[{mr:[X]}],mb:[{mb:[X]}],ml:[{ml:[X]}],"space-x":[{"space-x":[ke]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ke]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",nr,t]}],"min-w":[{"min-w":[nr,t,"min","max","fit"]}],"max-w":[{"max-w":[nr,t,"none","full","min","max","fit","prose",{screen:[Bl]},Bl]}],h:[{h:[nr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[nr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[nr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[nr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Bl,Fl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",j1]}],"font-family":[{font:[Zf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",nr]}],"line-clamp":[{"line-clamp":["none",Od,j1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ja,nr]}],"list-image":[{"list-image":["none",nr]}],"list-style-type":[{list:["none","disc","decimal",nr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[q]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[q]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...tt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ja,Fl]}],"underline-offset":[{"underline-offset":["auto",ja,nr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:He()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",nr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",nr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[q]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ge(),QB]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",YB]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},e6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[B]}],"gradient-via-pos":[{via:[B]}],"gradient-to-pos":[{to:[B]}],"gradient-from":[{from:[A]}],"gradient-via":[{via:[A]}],"gradient-to":[{to:[A]}],rounded:[{rounded:[d]}],"rounded-s":[{"rounded-s":[d]}],"rounded-e":[{"rounded-e":[d]}],"rounded-t":[{"rounded-t":[d]}],"rounded-r":[{"rounded-r":[d]}],"rounded-b":[{"rounded-b":[d]}],"rounded-l":[{"rounded-l":[d]}],"rounded-ss":[{"rounded-ss":[d]}],"rounded-se":[{"rounded-se":[d]}],"rounded-ee":[{"rounded-ee":[d]}],"rounded-es":[{"rounded-es":[d]}],"rounded-tl":[{"rounded-tl":[d]}],"rounded-tr":[{"rounded-tr":[d]}],"rounded-br":[{"rounded-br":[d]}],"rounded-bl":[{"rounded-bl":[d]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[q]}],"border-style":[{border:[...tt(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[q]}],"divide-style":[{divide:tt()}],"border-color":[{border:[u]}],"border-color-x":[{"border-x":[u]}],"border-color-y":[{"border-y":[u]}],"border-color-s":[{"border-s":[u]}],"border-color-e":[{"border-e":[u]}],"border-color-t":[{"border-t":[u]}],"border-color-r":[{"border-r":[u]}],"border-color-b":[{"border-b":[u]}],"border-color-l":[{"border-l":[u]}],"divide-color":[{divide:[u]}],"outline-style":[{outline:["",...tt()]}],"outline-offset":[{"outline-offset":[ja,nr]}],"outline-w":[{outline:[ja,Fl]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ct()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[q]}],"ring-offset-w":[{"ring-offset":[ja,Fl]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Bl,t6]}],"shadow-color":[{shadow:[Zf]}],opacity:[{opacity:[q]}],"mix-blend":[{"mix-blend":[...ut(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ut()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[o]}],contrast:[{contrast:[b]}],"drop-shadow":[{"drop-shadow":["","none",Bl,nr]}],grayscale:[{grayscale:[w]}],"hue-rotate":[{"hue-rotate":[C]}],invert:[{invert:[k]}],saturate:[{saturate:[U]}],sepia:[{sepia:[de]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[b]}],"backdrop-grayscale":[{"backdrop-grayscale":[w]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[C]}],"backdrop-invert":[{"backdrop-invert":[k]}],"backdrop-opacity":[{"backdrop-opacity":[q]}],"backdrop-saturate":[{"backdrop-saturate":[U]}],"backdrop-sepia":[{"backdrop-sepia":[de]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",nr]}],duration:[{duration:nt()}],ease:[{ease:["linear","in","out","in-out",nr]}],delay:[{delay:nt()}],animate:[{animate:["none","spin","ping","pulse","bounce",nr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[ne]}],"scale-x":[{"scale-x":[ne]}],"scale-y":[{"scale-y":[ne]}],rotate:[{rotate:[qf,nr]}],"translate-x":[{"translate-x":[ze]}],"translate-y":[{"translate-y":[ze]}],"skew-x":[{"skew-x":[xe]}],"skew-y":[{"skew-y":[xe]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",nr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",nr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":He()}],"scroll-mx":[{"scroll-mx":He()}],"scroll-my":[{"scroll-my":He()}],"scroll-ms":[{"scroll-ms":He()}],"scroll-me":[{"scroll-me":He()}],"scroll-mt":[{"scroll-mt":He()}],"scroll-mr":[{"scroll-mr":He()}],"scroll-mb":[{"scroll-mb":He()}],"scroll-ml":[{"scroll-ml":He()}],"scroll-p":[{"scroll-p":He()}],"scroll-px":[{"scroll-px":He()}],"scroll-py":[{"scroll-py":He()}],"scroll-ps":[{"scroll-ps":He()}],"scroll-pe":[{"scroll-pe":He()}],"scroll-pt":[{"scroll-pt":He()}],"scroll-pr":[{"scroll-pr":He()}],"scroll-pb":[{"scroll-pb":He()}],"scroll-pl":[{"scroll-pl":He()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",nr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ja,Fl,j1]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},s6=$B(o6);function Tn(...e){return s6(CR(e))}const a6=fB,DR=K.forwardRef(({className:e,...t},r)=>j.jsx(vR,{ref:r,className:Tn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));DR.displayName=vR.displayName;const l6=mg("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),zR=K.forwardRef(({className:e,variant:t,...r},o)=>j.jsx(_R,{ref:o,className:Tn(l6({variant:t}),e),...r}));zR.displayName=_R.displayName;const c6=K.forwardRef(({className:e,...t},r)=>j.jsx(wR,{ref:r,className:Tn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));c6.displayName=wR.displayName;const NR=K.forwardRef(({className:e,...t},r)=>j.jsx(SR,{ref:r,className:Tn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:j.jsx(fS,{className:"h-4 w-4"})}));NR.displayName=SR.displayName;const jR=K.forwardRef(({className:e,...t},r)=>j.jsx(xR,{ref:r,className:Tn("text-sm font-semibold",e),...t}));jR.displayName=xR.displayName;const OR=K.forwardRef(({className:e,...t},r)=>j.jsx(bR,{ref:r,className:Tn("text-sm opacity-90",e),...t}));OR.displayName=bR.displayName;function u6(){const{toasts:e}=bF();return j.jsxs(a6,{children:[e.map(function({id:t,title:r,description:o,action:u,...d}){return j.jsxs(zR,{...d,children:[j.jsxs("div",{className:"grid gap-1",children:[r&&j.jsx(jR,{children:r}),o&&j.jsx(OR,{children:o})]}),u,j.jsx(NR,{})]},t)}),j.jsx(DR,{})]})}var FE=["light","dark"],h6="(prefers-color-scheme: dark)",d6=K.createContext(void 0),p6={setTheme:e=>{},themes:[]},f6=()=>{var e;return(e=K.useContext(d6))!=null?e:p6};K.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:o,enableColorScheme:u,defaultTheme:d,value:h,attrs:s,nonce:b})=>{let w=d==="system",C=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(B=>`'${B}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,k=u?FE.includes(d)&&d?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${d}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",I=(B,F=!1,X=!0)=>{let q=h?h[B]:B,V=F?B+"|| ''":`'${q}'`,U="";return u&&X&&!F&&FE.includes(B)&&(U+=`d.style.colorScheme = '${B}';`),r==="class"?F||q?U+=`c.add(${V})`:U+="null":q&&(U+=`d[s](n,${V})`),U},A=e?`!function(){${C}${I(e)}}()`:o?`!function(){try{${C}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${w})){var t='${h6}',m=window.matchMedia(t);if(m.media!==t||m.matches){${I("dark")}}else{${I("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${I(h?"x[e]":"e",!0)}}${w?"":"else{"+I(d,!1,!1)+"}"}${k}}catch(e){}}()`:`!function(){try{${C}var e=localStorage.getItem('${t}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${I(h?"x[e]":"e",!0)}}else{${I(d,!1,!1)};}${k}}catch(t){}}();`;return K.createElement("script",{nonce:b,dangerouslySetInnerHTML:{__html:A}})});var m6=e=>{switch(e){case"success":return v6;case"info":return x6;case"warning":return _6;case"error":return b6;default:return null}},g6=Array(12).fill(0),y6=({visible:e,className:t})=>yt.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},yt.createElement("div",{className:"sonner-spinner"},g6.map((r,o)=>yt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${o}`})))),v6=yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},yt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),_6=yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},yt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),x6=yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},yt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),b6=yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},yt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),w6=yt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},yt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),yt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),S6=()=>{let[e,t]=yt.useState(document.hidden);return yt.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Cw=1,T6=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...o}=e,u=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Cw++,d=this.toasts.find(s=>s.id===u),h=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(u)&&this.dismissedToasts.delete(u),d?this.toasts=this.toasts.map(s=>s.id===u?(this.publish({...s,...e,id:u,title:r}),{...s,...e,id:u,dismissible:h,title:r}):s):this.addToast({title:r,...o,dismissible:h,id:u}),u},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let o=e instanceof Promise?e:e(),u=r!==void 0,d,h=o.then(async b=>{if(d=["resolve",b],yt.isValidElement(b))u=!1,this.create({id:r,type:"default",message:b});else if(P6(b)&&!b.ok){u=!1;let w=typeof t.error=="function"?await t.error(`HTTP error! status: ${b.status}`):t.error,C=typeof t.description=="function"?await t.description(`HTTP error! status: ${b.status}`):t.description;this.create({id:r,type:"error",message:w,description:C})}else if(t.success!==void 0){u=!1;let w=typeof t.success=="function"?await t.success(b):t.success,C=typeof t.description=="function"?await t.description(b):t.description;this.create({id:r,type:"success",message:w,description:C})}}).catch(async b=>{if(d=["reject",b],t.error!==void 0){u=!1;let w=typeof t.error=="function"?await t.error(b):t.error,C=typeof t.description=="function"?await t.description(b):t.description;this.create({id:r,type:"error",message:w,description:C})}}).finally(()=>{var b;u&&(this.dismiss(r),r=void 0),(b=t.finally)==null||b.call(t)}),s=()=>new Promise((b,w)=>h.then(()=>d[0]==="reject"?w(d[1]):b(d[1])).catch(w));return typeof r!="string"&&typeof r!="number"?{unwrap:s}:Object.assign(r,{unwrap:s})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Cw++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},eo=new T6,C6=(e,t)=>{let r=(t==null?void 0:t.id)||Cw++;return eo.addToast({title:e,...t,id:r}),r},P6=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",E6=C6,M6=()=>eo.toasts,k6=()=>eo.getActiveToasts();Object.assign(E6,{success:eo.success,info:eo.info,warning:eo.warning,error:eo.error,custom:eo.custom,message:eo.message,promise:eo.promise,dismiss:eo.dismiss,loading:eo.loading},{getHistory:M6,getToasts:k6});function A6(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",t==="top"&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}A6(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function nv(e){return e.label!==void 0}var I6=3,R6="32px",L6="16px",BE=4e3,D6=356,z6=14,N6=20,j6=200;function vs(...e){return e.filter(Boolean).join(" ")}function O6(e){let[t,r]=e.split("-"),o=[];return t&&o.push(t),r&&o.push(r),o}var F6=e=>{var t,r,o,u,d,h,s,b,w,C,k;let{invert:I,toast:A,unstyled:B,interacting:F,setHeights:X,visibleToasts:q,heights:V,index:U,toasts:ne,expanded:de,removeToast:xe,defaultRichColors:ke,closeButton:ze,style:We,cancelButtonStyle:rt,actionButtonStyle:Ze,className:He="",descriptionClassName:Ct="",duration:st,position:Ge,gap:tt,loadingIcon:ut,expandByDefault:Ve,classNames:De,icons:Ke,closeButtonAriaLabel:nt="Close toast",pauseWhenPageIsHidden:ot}=e,[Et,Rt]=yt.useState(null),[lr,gr]=yt.useState(null),[Xt,Ii]=yt.useState(!1),[yr,Cn]=yt.useState(!1),[br,Ri]=yt.useState(!1),[vr,ii]=yt.useState(!1),[Xn,ao]=yt.useState(!1),[en,yn]=yt.useState(0),[tn,Lo]=yt.useState(0),yi=yt.useRef(A.duration||st||BE),Os=yt.useRef(null),oi=yt.useRef(null),lo=U===0,ns=U+1<=q,Hr=A.type,un=A.dismissible!==!1,Ki=A.className||"",xa=A.descriptionClassName||"",is=yt.useMemo(()=>V.findIndex(pe=>pe.toastId===A.id)||0,[V,A.id]),co=yt.useMemo(()=>{var pe;return(pe=A.closeButton)!=null?pe:ze},[A.closeButton,ze]),Ee=yt.useMemo(()=>A.duration||st||BE,[A.duration,st]),ee=yt.useRef(0),te=yt.useRef(0),oe=yt.useRef(0),fe=yt.useRef(null),[we,Pe]=Ge.split("-"),Re=yt.useMemo(()=>V.reduce((pe,Je,vt)=>vt>=is?pe:pe+Je.height,0),[V,is]),Te=S6(),$e=A.invert||I,Fe=Hr==="loading";te.current=yt.useMemo(()=>is*tt+Re,[is,Re]),yt.useEffect(()=>{yi.current=Ee},[Ee]),yt.useEffect(()=>{Ii(!0)},[]),yt.useEffect(()=>{let pe=oi.current;if(pe){let Je=pe.getBoundingClientRect().height;return Lo(Je),X(vt=>[{toastId:A.id,height:Je,position:A.position},...vt]),()=>X(vt=>vt.filter(mt=>mt.toastId!==A.id))}},[X,A.id]),yt.useLayoutEffect(()=>{if(!Xt)return;let pe=oi.current,Je=pe.style.height;pe.style.height="auto";let vt=pe.getBoundingClientRect().height;pe.style.height=Je,Lo(vt),X(mt=>mt.find(xt=>xt.toastId===A.id)?mt.map(xt=>xt.toastId===A.id?{...xt,height:vt}:xt):[{toastId:A.id,height:vt,position:A.position},...mt])},[Xt,A.title,A.description,X,A.id]);let Me=yt.useCallback(()=>{Cn(!0),yn(te.current),X(pe=>pe.filter(Je=>Je.toastId!==A.id)),setTimeout(()=>{xe(A)},j6)},[A,xe,X,te]);yt.useEffect(()=>{if(A.promise&&Hr==="loading"||A.duration===1/0||A.type==="loading")return;let pe;return de||F||ot&&Te?(()=>{if(oe.current<ee.current){let Je=new Date().getTime()-ee.current;yi.current=yi.current-Je}oe.current=new Date().getTime()})():yi.current!==1/0&&(ee.current=new Date().getTime(),pe=setTimeout(()=>{var Je;(Je=A.onAutoClose)==null||Je.call(A,A),Me()},yi.current)),()=>clearTimeout(pe)},[de,F,A,Hr,ot,Te,Me]),yt.useEffect(()=>{A.delete&&Me()},[Me,A.delete]);function qe(){var pe,Je,vt;return Ke!=null&&Ke.loading?yt.createElement("div",{className:vs(De==null?void 0:De.loader,(pe=A==null?void 0:A.classNames)==null?void 0:pe.loader,"sonner-loader"),"data-visible":Hr==="loading"},Ke.loading):ut?yt.createElement("div",{className:vs(De==null?void 0:De.loader,(Je=A==null?void 0:A.classNames)==null?void 0:Je.loader,"sonner-loader"),"data-visible":Hr==="loading"},ut):yt.createElement(y6,{className:vs(De==null?void 0:De.loader,(vt=A==null?void 0:A.classNames)==null?void 0:vt.loader),visible:Hr==="loading"})}return yt.createElement("li",{tabIndex:0,ref:oi,className:vs(He,Ki,De==null?void 0:De.toast,(t=A==null?void 0:A.classNames)==null?void 0:t.toast,De==null?void 0:De.default,De==null?void 0:De[Hr],(r=A==null?void 0:A.classNames)==null?void 0:r[Hr]),"data-sonner-toast":"","data-rich-colors":(o=A.richColors)!=null?o:ke,"data-styled":!(A.jsx||A.unstyled||B),"data-mounted":Xt,"data-promise":!!A.promise,"data-swiped":Xn,"data-removed":yr,"data-visible":ns,"data-y-position":we,"data-x-position":Pe,"data-index":U,"data-front":lo,"data-swiping":br,"data-dismissible":un,"data-type":Hr,"data-invert":$e,"data-swipe-out":vr,"data-swipe-direction":lr,"data-expanded":!!(de||Ve&&Xt),style:{"--index":U,"--toasts-before":U,"--z-index":ne.length-U,"--offset":`${yr?en:te.current}px`,"--initial-height":Ve?"auto":`${tn}px`,...We,...A.style},onDragEnd:()=>{Ri(!1),Rt(null),fe.current=null},onPointerDown:pe=>{Fe||!un||(Os.current=new Date,yn(te.current),pe.target.setPointerCapture(pe.pointerId),pe.target.tagName!=="BUTTON"&&(Ri(!0),fe.current={x:pe.clientX,y:pe.clientY}))},onPointerUp:()=>{var pe,Je,vt,mt;if(vr||!un)return;fe.current=null;let xt=Number(((pe=oi.current)==null?void 0:pe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),At=Number(((Je=oi.current)==null?void 0:Je.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ur=new Date().getTime()-((vt=Os.current)==null?void 0:vt.getTime()),Ut=Et==="x"?xt:At,Gt=Math.abs(Ut)/ur;if(Math.abs(Ut)>=N6||Gt>.11){yn(te.current),(mt=A.onDismiss)==null||mt.call(A,A),gr(Et==="x"?xt>0?"right":"left":At>0?"down":"up"),Me(),ii(!0),ao(!1);return}Ri(!1),Rt(null)},onPointerMove:pe=>{var Je,vt,mt,xt;if(!fe.current||!un||((Je=window.getSelection())==null?void 0:Je.toString().length)>0)return;let At=pe.clientY-fe.current.y,ur=pe.clientX-fe.current.x,Ut=(vt=e.swipeDirections)!=null?vt:O6(Ge);!Et&&(Math.abs(ur)>1||Math.abs(At)>1)&&Rt(Math.abs(ur)>Math.abs(At)?"x":"y");let Gt={x:0,y:0};Et==="y"?(Ut.includes("top")||Ut.includes("bottom"))&&(Ut.includes("top")&&At<0||Ut.includes("bottom")&&At>0)&&(Gt.y=At):Et==="x"&&(Ut.includes("left")||Ut.includes("right"))&&(Ut.includes("left")&&ur<0||Ut.includes("right")&&ur>0)&&(Gt.x=ur),(Math.abs(Gt.x)>0||Math.abs(Gt.y)>0)&&ao(!0),(mt=oi.current)==null||mt.style.setProperty("--swipe-amount-x",`${Gt.x}px`),(xt=oi.current)==null||xt.style.setProperty("--swipe-amount-y",`${Gt.y}px`)}},co&&!A.jsx?yt.createElement("button",{"aria-label":nt,"data-disabled":Fe,"data-close-button":!0,onClick:Fe||!un?()=>{}:()=>{var pe;Me(),(pe=A.onDismiss)==null||pe.call(A,A)},className:vs(De==null?void 0:De.closeButton,(u=A==null?void 0:A.classNames)==null?void 0:u.closeButton)},(d=Ke==null?void 0:Ke.close)!=null?d:w6):null,A.jsx||K.isValidElement(A.title)?A.jsx?A.jsx:typeof A.title=="function"?A.title():A.title:yt.createElement(yt.Fragment,null,Hr||A.icon||A.promise?yt.createElement("div",{"data-icon":"",className:vs(De==null?void 0:De.icon,(h=A==null?void 0:A.classNames)==null?void 0:h.icon)},A.promise||A.type==="loading"&&!A.icon?A.icon||qe():null,A.type!=="loading"?A.icon||(Ke==null?void 0:Ke[Hr])||m6(Hr):null):null,yt.createElement("div",{"data-content":"",className:vs(De==null?void 0:De.content,(s=A==null?void 0:A.classNames)==null?void 0:s.content)},yt.createElement("div",{"data-title":"",className:vs(De==null?void 0:De.title,(b=A==null?void 0:A.classNames)==null?void 0:b.title)},typeof A.title=="function"?A.title():A.title),A.description?yt.createElement("div",{"data-description":"",className:vs(Ct,xa,De==null?void 0:De.description,(w=A==null?void 0:A.classNames)==null?void 0:w.description)},typeof A.description=="function"?A.description():A.description):null),K.isValidElement(A.cancel)?A.cancel:A.cancel&&nv(A.cancel)?yt.createElement("button",{"data-button":!0,"data-cancel":!0,style:A.cancelButtonStyle||rt,onClick:pe=>{var Je,vt;nv(A.cancel)&&un&&((vt=(Je=A.cancel).onClick)==null||vt.call(Je,pe),Me())},className:vs(De==null?void 0:De.cancelButton,(C=A==null?void 0:A.classNames)==null?void 0:C.cancelButton)},A.cancel.label):null,K.isValidElement(A.action)?A.action:A.action&&nv(A.action)?yt.createElement("button",{"data-button":!0,"data-action":!0,style:A.actionButtonStyle||Ze,onClick:pe=>{var Je,vt;nv(A.action)&&((vt=(Je=A.action).onClick)==null||vt.call(Je,pe),!pe.defaultPrevented&&Me())},className:vs(De==null?void 0:De.actionButton,(k=A==null?void 0:A.classNames)==null?void 0:k.actionButton)},A.action.label):null))};function $E(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function B6(e,t){let r={};return[e,t].forEach((o,u)=>{let d=u===1,h=d?"--mobile-offset":"--offset",s=d?L6:R6;function b(w){["top","right","bottom","left"].forEach(C=>{r[`${h}-${C}`]=typeof w=="number"?`${w}px`:w})}typeof o=="number"||typeof o=="string"?b(o):typeof o=="object"?["top","right","bottom","left"].forEach(w=>{o[w]===void 0?r[`${h}-${w}`]=s:r[`${h}-${w}`]=typeof o[w]=="number"?`${o[w]}px`:o[w]}):b(s)}),r}var $6=K.forwardRef(function(e,t){let{invert:r,position:o="bottom-right",hotkey:u=["altKey","KeyT"],expand:d,closeButton:h,className:s,offset:b,mobileOffset:w,theme:C="light",richColors:k,duration:I,style:A,visibleToasts:B=I6,toastOptions:F,dir:X=$E(),gap:q=z6,loadingIcon:V,icons:U,containerAriaLabel:ne="Notifications",pauseWhenPageIsHidden:de}=e,[xe,ke]=yt.useState([]),ze=yt.useMemo(()=>Array.from(new Set([o].concat(xe.filter(ot=>ot.position).map(ot=>ot.position)))),[xe,o]),[We,rt]=yt.useState([]),[Ze,He]=yt.useState(!1),[Ct,st]=yt.useState(!1),[Ge,tt]=yt.useState(C!=="system"?C:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ut=yt.useRef(null),Ve=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),De=yt.useRef(null),Ke=yt.useRef(!1),nt=yt.useCallback(ot=>{ke(Et=>{var Rt;return(Rt=Et.find(lr=>lr.id===ot.id))!=null&&Rt.delete||eo.dismiss(ot.id),Et.filter(({id:lr})=>lr!==ot.id)})},[]);return yt.useEffect(()=>eo.subscribe(ot=>{if(ot.dismiss){ke(Et=>Et.map(Rt=>Rt.id===ot.id?{...Rt,delete:!0}:Rt));return}setTimeout(()=>{X5.flushSync(()=>{ke(Et=>{let Rt=Et.findIndex(lr=>lr.id===ot.id);return Rt!==-1?[...Et.slice(0,Rt),{...Et[Rt],...ot},...Et.slice(Rt+1)]:[ot,...Et]})})})}),[]),yt.useEffect(()=>{if(C!=="system"){tt(C);return}if(C==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?tt("dark"):tt("light")),typeof window>"u")return;let ot=window.matchMedia("(prefers-color-scheme: dark)");try{ot.addEventListener("change",({matches:Et})=>{tt(Et?"dark":"light")})}catch{ot.addListener(({matches:Rt})=>{try{tt(Rt?"dark":"light")}catch(lr){console.error(lr)}})}},[C]),yt.useEffect(()=>{xe.length<=1&&He(!1)},[xe]),yt.useEffect(()=>{let ot=Et=>{var Rt,lr;u.every(gr=>Et[gr]||Et.code===gr)&&(He(!0),(Rt=ut.current)==null||Rt.focus()),Et.code==="Escape"&&(document.activeElement===ut.current||(lr=ut.current)!=null&&lr.contains(document.activeElement))&&He(!1)};return document.addEventListener("keydown",ot),()=>document.removeEventListener("keydown",ot)},[u]),yt.useEffect(()=>{if(ut.current)return()=>{De.current&&(De.current.focus({preventScroll:!0}),De.current=null,Ke.current=!1)}},[ut.current]),yt.createElement("section",{ref:t,"aria-label":`${ne} ${Ve}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ze.map((ot,Et)=>{var Rt;let[lr,gr]=ot.split("-");return xe.length?yt.createElement("ol",{key:ot,dir:X==="auto"?$E():X,tabIndex:-1,ref:ut,className:s,"data-sonner-toaster":!0,"data-theme":Ge,"data-y-position":lr,"data-lifted":Ze&&xe.length>1&&!d,"data-x-position":gr,style:{"--front-toast-height":`${((Rt=We[0])==null?void 0:Rt.height)||0}px`,"--width":`${D6}px`,"--gap":`${q}px`,...A,...B6(b,w)},onBlur:Xt=>{Ke.current&&!Xt.currentTarget.contains(Xt.relatedTarget)&&(Ke.current=!1,De.current&&(De.current.focus({preventScroll:!0}),De.current=null))},onFocus:Xt=>{Xt.target instanceof HTMLElement&&Xt.target.dataset.dismissible==="false"||Ke.current||(Ke.current=!0,De.current=Xt.relatedTarget)},onMouseEnter:()=>He(!0),onMouseMove:()=>He(!0),onMouseLeave:()=>{Ct||He(!1)},onDragEnd:()=>He(!1),onPointerDown:Xt=>{Xt.target instanceof HTMLElement&&Xt.target.dataset.dismissible==="false"||st(!0)},onPointerUp:()=>st(!1)},xe.filter(Xt=>!Xt.position&&Et===0||Xt.position===ot).map((Xt,Ii)=>{var yr,Cn;return yt.createElement(F6,{key:Xt.id,icons:U,index:Ii,toast:Xt,defaultRichColors:k,duration:(yr=F==null?void 0:F.duration)!=null?yr:I,className:F==null?void 0:F.className,descriptionClassName:F==null?void 0:F.descriptionClassName,invert:r,visibleToasts:B,closeButton:(Cn=F==null?void 0:F.closeButton)!=null?Cn:h,interacting:Ct,position:ot,style:F==null?void 0:F.style,unstyled:F==null?void 0:F.unstyled,classNames:F==null?void 0:F.classNames,cancelButtonStyle:F==null?void 0:F.cancelButtonStyle,actionButtonStyle:F==null?void 0:F.actionButtonStyle,removeToast:nt,toasts:xe.filter(br=>br.position==Xt.position),heights:We.filter(br=>br.position==Xt.position),setHeights:rt,expandByDefault:d,gap:q,loadingIcon:V,expanded:Ze,pauseWhenPageIsHidden:de,swipeDirections:e.swipeDirections})})):null}))});const V6=({...e})=>{const{theme:t="system"}=f6();return j.jsx($6,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var U6=y2[" useId ".trim().toString()]||(()=>{}),G6=0;function O1(e){const[t,r]=K.useState(U6());return el(()=>{r(o=>o??String(G6++))},[e]),e||(t?`radix-${t}`:"")}const q6=["top","right","bottom","left"],_c=Math.min,wo=Math.max,x0=Math.round,iv=Math.floor,ha=e=>({x:e,y:e}),Z6={left:"right",right:"left",bottom:"top",top:"bottom"},W6={start:"end",end:"start"};function Pw(e,t,r){return wo(e,_c(t,r))}function tl(e,t){return typeof e=="function"?e(t):e}function rl(e){return e.split("-")[0]}function _p(e){return e.split("-")[1]}function gS(e){return e==="x"?"y":"x"}function yS(e){return e==="y"?"height":"width"}const H6=new Set(["top","bottom"]);function la(e){return H6.has(rl(e))?"y":"x"}function vS(e){return gS(la(e))}function K6(e,t,r){r===void 0&&(r=!1);const o=_p(e),u=vS(e),d=yS(u);let h=u==="x"?o===(r?"end":"start")?"right":"left":o==="start"?"bottom":"top";return t.reference[d]>t.floating[d]&&(h=b0(h)),[h,b0(h)]}function X6(e){const t=b0(e);return[Ew(e),t,Ew(t)]}function Ew(e){return e.replace(/start|end/g,t=>W6[t])}const VE=["left","right"],UE=["right","left"],Y6=["top","bottom"],Q6=["bottom","top"];function J6(e,t,r){switch(e){case"top":case"bottom":return r?t?UE:VE:t?VE:UE;case"left":case"right":return t?Y6:Q6;default:return[]}}function e8(e,t,r,o){const u=_p(e);let d=J6(rl(e),r==="start",o);return u&&(d=d.map(h=>h+"-"+u),t&&(d=d.concat(d.map(Ew)))),d}function b0(e){return e.replace(/left|right|bottom|top/g,t=>Z6[t])}function t8(e){return{top:0,right:0,bottom:0,left:0,...e}}function FR(e){return typeof e!="number"?t8(e):{top:e,right:e,bottom:e,left:e}}function w0(e){const{x:t,y:r,width:o,height:u}=e;return{width:o,height:u,top:r,left:t,right:t+o,bottom:r+u,x:t,y:r}}function GE(e,t,r){let{reference:o,floating:u}=e;const d=la(t),h=vS(t),s=yS(h),b=rl(t),w=d==="y",C=o.x+o.width/2-u.width/2,k=o.y+o.height/2-u.height/2,I=o[s]/2-u[s]/2;let A;switch(b){case"top":A={x:C,y:o.y-u.height};break;case"bottom":A={x:C,y:o.y+o.height};break;case"right":A={x:o.x+o.width,y:k};break;case"left":A={x:o.x-u.width,y:k};break;default:A={x:o.x,y:o.y}}switch(_p(t)){case"start":A[h]-=I*(r&&w?-1:1);break;case"end":A[h]+=I*(r&&w?-1:1);break}return A}const r8=async(e,t,r)=>{const{placement:o="bottom",strategy:u="absolute",middleware:d=[],platform:h}=r,s=d.filter(Boolean),b=await(h.isRTL==null?void 0:h.isRTL(t));let w=await h.getElementRects({reference:e,floating:t,strategy:u}),{x:C,y:k}=GE(w,o,b),I=o,A={},B=0;for(let F=0;F<s.length;F++){const{name:X,fn:q}=s[F],{x:V,y:U,data:ne,reset:de}=await q({x:C,y:k,initialPlacement:o,placement:I,strategy:u,middlewareData:A,rects:w,platform:h,elements:{reference:e,floating:t}});C=V??C,k=U??k,A={...A,[X]:{...A[X],...ne}},de&&B<=50&&(B++,typeof de=="object"&&(de.placement&&(I=de.placement),de.rects&&(w=de.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:u}):de.rects),{x:C,y:k}=GE(w,I,b)),F=-1)}return{x:C,y:k,placement:I,strategy:u,middlewareData:A}};async function Bm(e,t){var r;t===void 0&&(t={});const{x:o,y:u,platform:d,rects:h,elements:s,strategy:b}=e,{boundary:w="clippingAncestors",rootBoundary:C="viewport",elementContext:k="floating",altBoundary:I=!1,padding:A=0}=tl(t,e),B=FR(A),X=s[I?k==="floating"?"reference":"floating":k],q=w0(await d.getClippingRect({element:(r=await(d.isElement==null?void 0:d.isElement(X)))==null||r?X:X.contextElement||await(d.getDocumentElement==null?void 0:d.getDocumentElement(s.floating)),boundary:w,rootBoundary:C,strategy:b})),V=k==="floating"?{x:o,y:u,width:h.floating.width,height:h.floating.height}:h.reference,U=await(d.getOffsetParent==null?void 0:d.getOffsetParent(s.floating)),ne=await(d.isElement==null?void 0:d.isElement(U))?await(d.getScale==null?void 0:d.getScale(U))||{x:1,y:1}:{x:1,y:1},de=w0(d.convertOffsetParentRelativeRectToViewportRelativeRect?await d.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:V,offsetParent:U,strategy:b}):V);return{top:(q.top-de.top+B.top)/ne.y,bottom:(de.bottom-q.bottom+B.bottom)/ne.y,left:(q.left-de.left+B.left)/ne.x,right:(de.right-q.right+B.right)/ne.x}}const n8=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:o,placement:u,rects:d,platform:h,elements:s,middlewareData:b}=t,{element:w,padding:C=0}=tl(e,t)||{};if(w==null)return{};const k=FR(C),I={x:r,y:o},A=vS(u),B=yS(A),F=await h.getDimensions(w),X=A==="y",q=X?"top":"left",V=X?"bottom":"right",U=X?"clientHeight":"clientWidth",ne=d.reference[B]+d.reference[A]-I[A]-d.floating[B],de=I[A]-d.reference[A],xe=await(h.getOffsetParent==null?void 0:h.getOffsetParent(w));let ke=xe?xe[U]:0;(!ke||!await(h.isElement==null?void 0:h.isElement(xe)))&&(ke=s.floating[U]||d.floating[B]);const ze=ne/2-de/2,We=ke/2-F[B]/2-1,rt=_c(k[q],We),Ze=_c(k[V],We),He=rt,Ct=ke-F[B]-Ze,st=ke/2-F[B]/2+ze,Ge=Pw(He,st,Ct),tt=!b.arrow&&_p(u)!=null&&st!==Ge&&d.reference[B]/2-(st<He?rt:Ze)-F[B]/2<0,ut=tt?st<He?st-He:st-Ct:0;return{[A]:I[A]+ut,data:{[A]:Ge,centerOffset:st-Ge-ut,...tt&&{alignmentOffset:ut}},reset:tt}}}),i8=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,o;const{placement:u,middlewareData:d,rects:h,initialPlacement:s,platform:b,elements:w}=t,{mainAxis:C=!0,crossAxis:k=!0,fallbackPlacements:I,fallbackStrategy:A="bestFit",fallbackAxisSideDirection:B="none",flipAlignment:F=!0,...X}=tl(e,t);if((r=d.arrow)!=null&&r.alignmentOffset)return{};const q=rl(u),V=la(s),U=rl(s)===s,ne=await(b.isRTL==null?void 0:b.isRTL(w.floating)),de=I||(U||!F?[b0(s)]:X6(s)),xe=B!=="none";!I&&xe&&de.push(...e8(s,F,B,ne));const ke=[s,...de],ze=await Bm(t,X),We=[];let rt=((o=d.flip)==null?void 0:o.overflows)||[];if(C&&We.push(ze[q]),k){const st=K6(u,h,ne);We.push(ze[st[0]],ze[st[1]])}if(rt=[...rt,{placement:u,overflows:We}],!We.every(st=>st<=0)){var Ze,He;const st=(((Ze=d.flip)==null?void 0:Ze.index)||0)+1,Ge=ke[st];if(Ge&&(!(k==="alignment"?V!==la(Ge):!1)||rt.every(Ve=>Ve.overflows[0]>0&&la(Ve.placement)===V)))return{data:{index:st,overflows:rt},reset:{placement:Ge}};let tt=(He=rt.filter(ut=>ut.overflows[0]<=0).sort((ut,Ve)=>ut.overflows[1]-Ve.overflows[1])[0])==null?void 0:He.placement;if(!tt)switch(A){case"bestFit":{var Ct;const ut=(Ct=rt.filter(Ve=>{if(xe){const De=la(Ve.placement);return De===V||De==="y"}return!0}).map(Ve=>[Ve.placement,Ve.overflows.filter(De=>De>0).reduce((De,Ke)=>De+Ke,0)]).sort((Ve,De)=>Ve[1]-De[1])[0])==null?void 0:Ct[0];ut&&(tt=ut);break}case"initialPlacement":tt=s;break}if(u!==tt)return{reset:{placement:tt}}}return{}}}};function qE(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ZE(e){return q6.some(t=>e[t]>=0)}const o8=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:o="referenceHidden",...u}=tl(e,t);switch(o){case"referenceHidden":{const d=await Bm(t,{...u,elementContext:"reference"}),h=qE(d,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:ZE(h)}}}case"escaped":{const d=await Bm(t,{...u,altBoundary:!0}),h=qE(d,r.floating);return{data:{escapedOffsets:h,escaped:ZE(h)}}}default:return{}}}}},BR=new Set(["left","top"]);async function s8(e,t){const{placement:r,platform:o,elements:u}=e,d=await(o.isRTL==null?void 0:o.isRTL(u.floating)),h=rl(r),s=_p(r),b=la(r)==="y",w=BR.has(h)?-1:1,C=d&&b?-1:1,k=tl(t,e);let{mainAxis:I,crossAxis:A,alignmentAxis:B}=typeof k=="number"?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:k.mainAxis||0,crossAxis:k.crossAxis||0,alignmentAxis:k.alignmentAxis};return s&&typeof B=="number"&&(A=s==="end"?B*-1:B),b?{x:A*C,y:I*w}:{x:I*w,y:A*C}}const a8=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,o;const{x:u,y:d,placement:h,middlewareData:s}=t,b=await s8(t,e);return h===((r=s.offset)==null?void 0:r.placement)&&(o=s.arrow)!=null&&o.alignmentOffset?{}:{x:u+b.x,y:d+b.y,data:{...b,placement:h}}}}},l8=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:o,placement:u}=t,{mainAxis:d=!0,crossAxis:h=!1,limiter:s={fn:X=>{let{x:q,y:V}=X;return{x:q,y:V}}},...b}=tl(e,t),w={x:r,y:o},C=await Bm(t,b),k=la(rl(u)),I=gS(k);let A=w[I],B=w[k];if(d){const X=I==="y"?"top":"left",q=I==="y"?"bottom":"right",V=A+C[X],U=A-C[q];A=Pw(V,A,U)}if(h){const X=k==="y"?"top":"left",q=k==="y"?"bottom":"right",V=B+C[X],U=B-C[q];B=Pw(V,B,U)}const F=s.fn({...t,[I]:A,[k]:B});return{...F,data:{x:F.x-r,y:F.y-o,enabled:{[I]:d,[k]:h}}}}}},c8=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:o,placement:u,rects:d,middlewareData:h}=t,{offset:s=0,mainAxis:b=!0,crossAxis:w=!0}=tl(e,t),C={x:r,y:o},k=la(u),I=gS(k);let A=C[I],B=C[k];const F=tl(s,t),X=typeof F=="number"?{mainAxis:F,crossAxis:0}:{mainAxis:0,crossAxis:0,...F};if(b){const U=I==="y"?"height":"width",ne=d.reference[I]-d.floating[U]+X.mainAxis,de=d.reference[I]+d.reference[U]-X.mainAxis;A<ne?A=ne:A>de&&(A=de)}if(w){var q,V;const U=I==="y"?"width":"height",ne=BR.has(rl(u)),de=d.reference[k]-d.floating[U]+(ne&&((q=h.offset)==null?void 0:q[k])||0)+(ne?0:X.crossAxis),xe=d.reference[k]+d.reference[U]+(ne?0:((V=h.offset)==null?void 0:V[k])||0)-(ne?X.crossAxis:0);B<de?B=de:B>xe&&(B=xe)}return{[I]:A,[k]:B}}}},u8=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,o;const{placement:u,rects:d,platform:h,elements:s}=t,{apply:b=()=>{},...w}=tl(e,t),C=await Bm(t,w),k=rl(u),I=_p(u),A=la(u)==="y",{width:B,height:F}=d.floating;let X,q;k==="top"||k==="bottom"?(X=k,q=I===(await(h.isRTL==null?void 0:h.isRTL(s.floating))?"start":"end")?"left":"right"):(q=k,X=I==="end"?"top":"bottom");const V=F-C.top-C.bottom,U=B-C.left-C.right,ne=_c(F-C[X],V),de=_c(B-C[q],U),xe=!t.middlewareData.shift;let ke=ne,ze=de;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ze=U),(o=t.middlewareData.shift)!=null&&o.enabled.y&&(ke=V),xe&&!I){const rt=wo(C.left,0),Ze=wo(C.right,0),He=wo(C.top,0),Ct=wo(C.bottom,0);A?ze=B-2*(rt!==0||Ze!==0?rt+Ze:wo(C.left,C.right)):ke=F-2*(He!==0||Ct!==0?He+Ct:wo(C.top,C.bottom))}await b({...t,availableWidth:ze,availableHeight:ke});const We=await h.getDimensions(s.floating);return B!==We.width||F!==We.height?{reset:{rects:!0}}:{}}}};function u_(){return typeof window<"u"}function xp(e){return $R(e)?(e.nodeName||"").toLowerCase():"#document"}function Eo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function _a(e){var t;return(t=($R(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function $R(e){return u_()?e instanceof Node||e instanceof Eo(e).Node:!1}function Ls(e){return u_()?e instanceof Element||e instanceof Eo(e).Element:!1}function va(e){return u_()?e instanceof HTMLElement||e instanceof Eo(e).HTMLElement:!1}function WE(e){return!u_()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Eo(e).ShadowRoot}const h8=new Set(["inline","contents"]);function gg(e){const{overflow:t,overflowX:r,overflowY:o,display:u}=Ds(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+r)&&!h8.has(u)}const d8=new Set(["table","td","th"]);function p8(e){return d8.has(xp(e))}const f8=[":popover-open",":modal"];function h_(e){return f8.some(t=>{try{return e.matches(t)}catch{return!1}})}const m8=["transform","translate","scale","rotate","perspective"],g8=["transform","translate","scale","rotate","perspective","filter"],y8=["paint","layout","strict","content"];function _S(e){const t=xS(),r=Ls(e)?Ds(e):e;return m8.some(o=>r[o]?r[o]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||g8.some(o=>(r.willChange||"").includes(o))||y8.some(o=>(r.contain||"").includes(o))}function v8(e){let t=xc(e);for(;va(t)&&!lp(t);){if(_S(t))return t;if(h_(t))return null;t=xc(t)}return null}function xS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const _8=new Set(["html","body","#document"]);function lp(e){return _8.has(xp(e))}function Ds(e){return Eo(e).getComputedStyle(e)}function d_(e){return Ls(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function xc(e){if(xp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||WE(e)&&e.host||_a(e);return WE(t)?t.host:t}function VR(e){const t=xc(e);return lp(t)?e.ownerDocument?e.ownerDocument.body:e.body:va(t)&&gg(t)?t:VR(t)}function $m(e,t,r){var o;t===void 0&&(t=[]),r===void 0&&(r=!0);const u=VR(e),d=u===((o=e.ownerDocument)==null?void 0:o.body),h=Eo(u);if(d){const s=Mw(h);return t.concat(h,h.visualViewport||[],gg(u)?u:[],s&&r?$m(s):[])}return t.concat(u,$m(u,[],r))}function Mw(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function UR(e){const t=Ds(e);let r=parseFloat(t.width)||0,o=parseFloat(t.height)||0;const u=va(e),d=u?e.offsetWidth:r,h=u?e.offsetHeight:o,s=x0(r)!==d||x0(o)!==h;return s&&(r=d,o=h),{width:r,height:o,$:s}}function bS(e){return Ls(e)?e:e.contextElement}function Fd(e){const t=bS(e);if(!va(t))return ha(1);const r=t.getBoundingClientRect(),{width:o,height:u,$:d}=UR(t);let h=(d?x0(r.width):r.width)/o,s=(d?x0(r.height):r.height)/u;return(!h||!Number.isFinite(h))&&(h=1),(!s||!Number.isFinite(s))&&(s=1),{x:h,y:s}}const x8=ha(0);function GR(e){const t=Eo(e);return!xS()||!t.visualViewport?x8:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function b8(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Eo(e)?!1:t}function th(e,t,r,o){t===void 0&&(t=!1),r===void 0&&(r=!1);const u=e.getBoundingClientRect(),d=bS(e);let h=ha(1);t&&(o?Ls(o)&&(h=Fd(o)):h=Fd(e));const s=b8(d,r,o)?GR(d):ha(0);let b=(u.left+s.x)/h.x,w=(u.top+s.y)/h.y,C=u.width/h.x,k=u.height/h.y;if(d){const I=Eo(d),A=o&&Ls(o)?Eo(o):o;let B=I,F=Mw(B);for(;F&&o&&A!==B;){const X=Fd(F),q=F.getBoundingClientRect(),V=Ds(F),U=q.left+(F.clientLeft+parseFloat(V.paddingLeft))*X.x,ne=q.top+(F.clientTop+parseFloat(V.paddingTop))*X.y;b*=X.x,w*=X.y,C*=X.x,k*=X.y,b+=U,w+=ne,B=Eo(F),F=Mw(B)}}return w0({width:C,height:k,x:b,y:w})}function wS(e,t){const r=d_(e).scrollLeft;return t?t.left+r:th(_a(e)).left+r}function qR(e,t,r){r===void 0&&(r=!1);const o=e.getBoundingClientRect(),u=o.left+t.scrollLeft-(r?0:wS(e,o)),d=o.top+t.scrollTop;return{x:u,y:d}}function w8(e){let{elements:t,rect:r,offsetParent:o,strategy:u}=e;const d=u==="fixed",h=_a(o),s=t?h_(t.floating):!1;if(o===h||s&&d)return r;let b={scrollLeft:0,scrollTop:0},w=ha(1);const C=ha(0),k=va(o);if((k||!k&&!d)&&((xp(o)!=="body"||gg(h))&&(b=d_(o)),va(o))){const A=th(o);w=Fd(o),C.x=A.x+o.clientLeft,C.y=A.y+o.clientTop}const I=h&&!k&&!d?qR(h,b,!0):ha(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-b.scrollLeft*w.x+C.x+I.x,y:r.y*w.y-b.scrollTop*w.y+C.y+I.y}}function S8(e){return Array.from(e.getClientRects())}function T8(e){const t=_a(e),r=d_(e),o=e.ownerDocument.body,u=wo(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),d=wo(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let h=-r.scrollLeft+wS(e);const s=-r.scrollTop;return Ds(o).direction==="rtl"&&(h+=wo(t.clientWidth,o.clientWidth)-u),{width:u,height:d,x:h,y:s}}function C8(e,t){const r=Eo(e),o=_a(e),u=r.visualViewport;let d=o.clientWidth,h=o.clientHeight,s=0,b=0;if(u){d=u.width,h=u.height;const w=xS();(!w||w&&t==="fixed")&&(s=u.offsetLeft,b=u.offsetTop)}return{width:d,height:h,x:s,y:b}}const P8=new Set(["absolute","fixed"]);function E8(e,t){const r=th(e,!0,t==="fixed"),o=r.top+e.clientTop,u=r.left+e.clientLeft,d=va(e)?Fd(e):ha(1),h=e.clientWidth*d.x,s=e.clientHeight*d.y,b=u*d.x,w=o*d.y;return{width:h,height:s,x:b,y:w}}function HE(e,t,r){let o;if(t==="viewport")o=C8(e,r);else if(t==="document")o=T8(_a(e));else if(Ls(t))o=E8(t,r);else{const u=GR(e);o={x:t.x-u.x,y:t.y-u.y,width:t.width,height:t.height}}return w0(o)}function ZR(e,t){const r=xc(e);return r===t||!Ls(r)||lp(r)?!1:Ds(r).position==="fixed"||ZR(r,t)}function M8(e,t){const r=t.get(e);if(r)return r;let o=$m(e,[],!1).filter(s=>Ls(s)&&xp(s)!=="body"),u=null;const d=Ds(e).position==="fixed";let h=d?xc(e):e;for(;Ls(h)&&!lp(h);){const s=Ds(h),b=_S(h);!b&&s.position==="fixed"&&(u=null),(d?!b&&!u:!b&&s.position==="static"&&!!u&&P8.has(u.position)||gg(h)&&!b&&ZR(e,h))?o=o.filter(C=>C!==h):u=s,h=xc(h)}return t.set(e,o),o}function k8(e){let{element:t,boundary:r,rootBoundary:o,strategy:u}=e;const h=[...r==="clippingAncestors"?h_(t)?[]:M8(t,this._c):[].concat(r),o],s=h[0],b=h.reduce((w,C)=>{const k=HE(t,C,u);return w.top=wo(k.top,w.top),w.right=_c(k.right,w.right),w.bottom=_c(k.bottom,w.bottom),w.left=wo(k.left,w.left),w},HE(t,s,u));return{width:b.right-b.left,height:b.bottom-b.top,x:b.left,y:b.top}}function A8(e){const{width:t,height:r}=UR(e);return{width:t,height:r}}function I8(e,t,r){const o=va(t),u=_a(t),d=r==="fixed",h=th(e,!0,d,t);let s={scrollLeft:0,scrollTop:0};const b=ha(0);function w(){b.x=wS(u)}if(o||!o&&!d)if((xp(t)!=="body"||gg(u))&&(s=d_(t)),o){const A=th(t,!0,d,t);b.x=A.x+t.clientLeft,b.y=A.y+t.clientTop}else u&&w();d&&!o&&u&&w();const C=u&&!o&&!d?qR(u,s):ha(0),k=h.left+s.scrollLeft-b.x-C.x,I=h.top+s.scrollTop-b.y-C.y;return{x:k,y:I,width:h.width,height:h.height}}function F1(e){return Ds(e).position==="static"}function KE(e,t){if(!va(e)||Ds(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return _a(e)===r&&(r=r.ownerDocument.body),r}function WR(e,t){const r=Eo(e);if(h_(e))return r;if(!va(e)){let u=xc(e);for(;u&&!lp(u);){if(Ls(u)&&!F1(u))return u;u=xc(u)}return r}let o=KE(e,t);for(;o&&p8(o)&&F1(o);)o=KE(o,t);return o&&lp(o)&&F1(o)&&!_S(o)?r:o||v8(e)||r}const R8=async function(e){const t=this.getOffsetParent||WR,r=this.getDimensions,o=await r(e.floating);return{reference:I8(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}};function L8(e){return Ds(e).direction==="rtl"}const D8={convertOffsetParentRelativeRectToViewportRelativeRect:w8,getDocumentElement:_a,getClippingRect:k8,getOffsetParent:WR,getElementRects:R8,getClientRects:S8,getDimensions:A8,getScale:Fd,isElement:Ls,isRTL:L8};function HR(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function z8(e,t){let r=null,o;const u=_a(e);function d(){var s;clearTimeout(o),(s=r)==null||s.disconnect(),r=null}function h(s,b){s===void 0&&(s=!1),b===void 0&&(b=1),d();const w=e.getBoundingClientRect(),{left:C,top:k,width:I,height:A}=w;if(s||t(),!I||!A)return;const B=iv(k),F=iv(u.clientWidth-(C+I)),X=iv(u.clientHeight-(k+A)),q=iv(C),U={rootMargin:-B+"px "+-F+"px "+-X+"px "+-q+"px",threshold:wo(0,_c(1,b))||1};let ne=!0;function de(xe){const ke=xe[0].intersectionRatio;if(ke!==b){if(!ne)return h();ke?h(!1,ke):o=setTimeout(()=>{h(!1,1e-7)},1e3)}ke===1&&!HR(w,e.getBoundingClientRect())&&h(),ne=!1}try{r=new IntersectionObserver(de,{...U,root:u.ownerDocument})}catch{r=new IntersectionObserver(de,U)}r.observe(e)}return h(!0),d}function N8(e,t,r,o){o===void 0&&(o={});const{ancestorScroll:u=!0,ancestorResize:d=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:b=!1}=o,w=bS(e),C=u||d?[...w?$m(w):[],...$m(t)]:[];C.forEach(q=>{u&&q.addEventListener("scroll",r,{passive:!0}),d&&q.addEventListener("resize",r)});const k=w&&s?z8(w,r):null;let I=-1,A=null;h&&(A=new ResizeObserver(q=>{let[V]=q;V&&V.target===w&&A&&(A.unobserve(t),cancelAnimationFrame(I),I=requestAnimationFrame(()=>{var U;(U=A)==null||U.observe(t)})),r()}),w&&!b&&A.observe(w),A.observe(t));let B,F=b?th(e):null;b&&X();function X(){const q=th(e);F&&!HR(F,q)&&r(),F=q,B=requestAnimationFrame(X)}return r(),()=>{var q;C.forEach(V=>{u&&V.removeEventListener("scroll",r),d&&V.removeEventListener("resize",r)}),k==null||k(),(q=A)==null||q.disconnect(),A=null,b&&cancelAnimationFrame(B)}}const j8=a8,O8=l8,F8=i8,B8=u8,$8=o8,XE=n8,V8=c8,U8=(e,t,r)=>{const o=new Map,u={platform:D8,...r},d={...u.platform,_c:o};return r8(e,t,{...u,platform:d})};var G8=typeof document<"u",q8=function(){},zv=G8?K.useLayoutEffect:q8;function S0(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,o,u;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(o=r;o--!==0;)if(!S0(e[o],t[o]))return!1;return!0}if(u=Object.keys(e),r=u.length,r!==Object.keys(t).length)return!1;for(o=r;o--!==0;)if(!{}.hasOwnProperty.call(t,u[o]))return!1;for(o=r;o--!==0;){const d=u[o];if(!(d==="_owner"&&e.$$typeof)&&!S0(e[d],t[d]))return!1}return!0}return e!==e&&t!==t}function KR(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function YE(e,t){const r=KR(e);return Math.round(t*r)/r}function B1(e){const t=K.useRef(e);return zv(()=>{t.current=e}),t}function Z8(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:o=[],platform:u,elements:{reference:d,floating:h}={},transform:s=!0,whileElementsMounted:b,open:w}=e,[C,k]=K.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[I,A]=K.useState(o);S0(I,o)||A(o);const[B,F]=K.useState(null),[X,q]=K.useState(null),V=K.useCallback(Ve=>{Ve!==xe.current&&(xe.current=Ve,F(Ve))},[]),U=K.useCallback(Ve=>{Ve!==ke.current&&(ke.current=Ve,q(Ve))},[]),ne=d||B,de=h||X,xe=K.useRef(null),ke=K.useRef(null),ze=K.useRef(C),We=b!=null,rt=B1(b),Ze=B1(u),He=B1(w),Ct=K.useCallback(()=>{if(!xe.current||!ke.current)return;const Ve={placement:t,strategy:r,middleware:I};Ze.current&&(Ve.platform=Ze.current),U8(xe.current,ke.current,Ve).then(De=>{const Ke={...De,isPositioned:He.current!==!1};st.current&&!S0(ze.current,Ke)&&(ze.current=Ke,dg.flushSync(()=>{k(Ke)}))})},[I,t,r,Ze,He]);zv(()=>{w===!1&&ze.current.isPositioned&&(ze.current.isPositioned=!1,k(Ve=>({...Ve,isPositioned:!1})))},[w]);const st=K.useRef(!1);zv(()=>(st.current=!0,()=>{st.current=!1}),[]),zv(()=>{if(ne&&(xe.current=ne),de&&(ke.current=de),ne&&de){if(rt.current)return rt.current(ne,de,Ct);Ct()}},[ne,de,Ct,rt,We]);const Ge=K.useMemo(()=>({reference:xe,floating:ke,setReference:V,setFloating:U}),[V,U]),tt=K.useMemo(()=>({reference:ne,floating:de}),[ne,de]),ut=K.useMemo(()=>{const Ve={position:r,left:0,top:0};if(!tt.floating)return Ve;const De=YE(tt.floating,C.x),Ke=YE(tt.floating,C.y);return s?{...Ve,transform:"translate("+De+"px, "+Ke+"px)",...KR(tt.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:De,top:Ke}},[r,s,tt.floating,C.x,C.y]);return K.useMemo(()=>({...C,update:Ct,refs:Ge,elements:tt,floatingStyles:ut}),[C,Ct,Ge,tt,ut])}const W8=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:o,padding:u}=typeof e=="function"?e(r):e;return o&&t(o)?o.current!=null?XE({element:o.current,padding:u}).fn(r):{}:o?XE({element:o,padding:u}).fn(r):{}}}},H8=(e,t)=>({...j8(e),options:[e,t]}),K8=(e,t)=>({...O8(e),options:[e,t]}),X8=(e,t)=>({...V8(e),options:[e,t]}),Y8=(e,t)=>({...F8(e),options:[e,t]}),Q8=(e,t)=>({...B8(e),options:[e,t]}),J8=(e,t)=>({...$8(e),options:[e,t]}),e$=(e,t)=>({...W8(e),options:[e,t]});var t$="Arrow",XR=K.forwardRef((e,t)=>{const{children:r,width:o=10,height:u=5,...d}=e;return j.jsx(Sn.svg,{...d,ref:t,width:o,height:u,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:j.jsx("polygon",{points:"0,0 30,0 15,10"})})});XR.displayName=t$;var r$=XR;function n$(e){const[t,r]=K.useState(void 0);return el(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(u=>{if(!Array.isArray(u)||!u.length)return;const d=u[0];let h,s;if("borderBoxSize"in d){const b=d.borderBoxSize,w=Array.isArray(b)?b[0]:b;h=w.inlineSize,s=w.blockSize}else h=e.offsetWidth,s=e.offsetHeight;r({width:h,height:s})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else r(void 0)},[e]),t}var YR="Popper",[QR,JR]=pg(YR),[wY,eL]=QR(YR),tL="PopperAnchor",rL=K.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:o,...u}=e,d=eL(tL,r),h=K.useRef(null),s=Zi(t,h);return K.useEffect(()=>{d.onAnchorChange((o==null?void 0:o.current)||h.current)}),o?null:j.jsx(Sn.div,{...u,ref:s})});rL.displayName=tL;var SS="PopperContent",[i$,o$]=QR(SS),nL=K.forwardRef((e,t)=>{var Xt,Ii,yr,Cn,br,Ri;const{__scopePopper:r,side:o="bottom",sideOffset:u=0,align:d="center",alignOffset:h=0,arrowPadding:s=0,avoidCollisions:b=!0,collisionBoundary:w=[],collisionPadding:C=0,sticky:k="partial",hideWhenDetached:I=!1,updatePositionStrategy:A="optimized",onPlaced:B,...F}=e,X=eL(SS,r),[q,V]=K.useState(null),U=Zi(t,vr=>V(vr)),[ne,de]=K.useState(null),xe=n$(ne),ke=(xe==null?void 0:xe.width)??0,ze=(xe==null?void 0:xe.height)??0,We=o+(d!=="center"?"-"+d:""),rt=typeof C=="number"?C:{top:0,right:0,bottom:0,left:0,...C},Ze=Array.isArray(w)?w:[w],He=Ze.length>0,Ct={padding:rt,boundary:Ze.filter(a$),altBoundary:He},{refs:st,floatingStyles:Ge,placement:tt,isPositioned:ut,middlewareData:Ve}=Z8({strategy:"fixed",placement:We,whileElementsMounted:(...vr)=>N8(...vr,{animationFrame:A==="always"}),elements:{reference:X.anchor},middleware:[H8({mainAxis:u+ze,alignmentAxis:h}),b&&K8({mainAxis:!0,crossAxis:!1,limiter:k==="partial"?X8():void 0,...Ct}),b&&Y8({...Ct}),Q8({...Ct,apply:({elements:vr,rects:ii,availableWidth:Xn,availableHeight:ao})=>{const{width:en,height:yn}=ii.reference,tn=vr.floating.style;tn.setProperty("--radix-popper-available-width",`${Xn}px`),tn.setProperty("--radix-popper-available-height",`${ao}px`),tn.setProperty("--radix-popper-anchor-width",`${en}px`),tn.setProperty("--radix-popper-anchor-height",`${yn}px`)}}),ne&&e$({element:ne,padding:s}),l$({arrowWidth:ke,arrowHeight:ze}),I&&J8({strategy:"referenceHidden",...Ct})]}),[De,Ke]=sL(tt),nt=ya(B);el(()=>{ut&&(nt==null||nt())},[ut,nt]);const ot=(Xt=Ve.arrow)==null?void 0:Xt.x,Et=(Ii=Ve.arrow)==null?void 0:Ii.y,Rt=((yr=Ve.arrow)==null?void 0:yr.centerOffset)!==0,[lr,gr]=K.useState();return el(()=>{q&&gr(window.getComputedStyle(q).zIndex)},[q]),j.jsx("div",{ref:st.setFloating,"data-radix-popper-content-wrapper":"",style:{...Ge,transform:ut?Ge.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:lr,"--radix-popper-transform-origin":[(Cn=Ve.transformOrigin)==null?void 0:Cn.x,(br=Ve.transformOrigin)==null?void 0:br.y].join(" "),...((Ri=Ve.hide)==null?void 0:Ri.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:j.jsx(i$,{scope:r,placedSide:De,onArrowChange:de,arrowX:ot,arrowY:Et,shouldHideArrow:Rt,children:j.jsx(Sn.div,{"data-side":De,"data-align":Ke,...F,ref:U,style:{...F.style,animation:ut?void 0:"none"}})})})});nL.displayName=SS;var iL="PopperArrow",s$={top:"bottom",right:"left",bottom:"top",left:"right"},oL=K.forwardRef(function(t,r){const{__scopePopper:o,...u}=t,d=o$(iL,o),h=s$[d.placedSide];return j.jsx("span",{ref:d.onArrowChange,style:{position:"absolute",left:d.arrowX,top:d.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[d.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[d.placedSide],visibility:d.shouldHideArrow?"hidden":void 0},children:j.jsx(r$,{...u,ref:r,style:{...u.style,display:"block"}})})});oL.displayName=iL;function a$(e){return e!==null}var l$=e=>({name:"transformOrigin",options:e,fn(t){var X,q,V;const{placement:r,rects:o,middlewareData:u}=t,h=((X=u.arrow)==null?void 0:X.centerOffset)!==0,s=h?0:e.arrowWidth,b=h?0:e.arrowHeight,[w,C]=sL(r),k={start:"0%",center:"50%",end:"100%"}[C],I=(((q=u.arrow)==null?void 0:q.x)??0)+s/2,A=(((V=u.arrow)==null?void 0:V.y)??0)+b/2;let B="",F="";return w==="bottom"?(B=h?k:`${I}px`,F=`${-b}px`):w==="top"?(B=h?k:`${I}px`,F=`${o.floating.height+b}px`):w==="right"?(B=`${-b}px`,F=h?k:`${A}px`):w==="left"&&(B=`${o.floating.width+b}px`,F=h?k:`${A}px`),{data:{x:B,y:F}}}});function sL(e){const[t,r="center"]=e.split("-");return[t,r]}var c$=rL,u$=nL,h$=oL,[p_,SY]=pg("Tooltip",[JR]),TS=JR(),aL="TooltipProvider",d$=700,QE="tooltip.open",[p$,lL]=p_(aL),cL=e=>{const{__scopeTooltip:t,delayDuration:r=d$,skipDelayDuration:o=300,disableHoverableContent:u=!1,children:d}=e,h=K.useRef(!0),s=K.useRef(!1),b=K.useRef(0);return K.useEffect(()=>{const w=b.current;return()=>window.clearTimeout(w)},[]),j.jsx(p$,{scope:t,isOpenDelayedRef:h,delayDuration:r,onOpen:K.useCallback(()=>{window.clearTimeout(b.current),h.current=!1},[]),onClose:K.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>h.current=!0,o)},[o]),isPointerInTransitRef:s,onPointerInTransitChange:K.useCallback(w=>{s.current=w},[]),disableHoverableContent:u,children:d})};cL.displayName=aL;var uL="Tooltip",[TY,f_]=p_(uL),kw="TooltipTrigger",f$=K.forwardRef((e,t)=>{const{__scopeTooltip:r,...o}=e,u=f_(kw,r),d=lL(kw,r),h=TS(r),s=K.useRef(null),b=Zi(t,s,u.onTriggerChange),w=K.useRef(!1),C=K.useRef(!1),k=K.useCallback(()=>w.current=!1,[]);return K.useEffect(()=>()=>document.removeEventListener("pointerup",k),[k]),j.jsx(c$,{asChild:!0,...h,children:j.jsx(Sn.button,{"aria-describedby":u.open?u.contentId:void 0,"data-state":u.stateAttribute,...o,ref:b,onPointerMove:Yr(e.onPointerMove,I=>{I.pointerType!=="touch"&&!C.current&&!d.isPointerInTransitRef.current&&(u.onTriggerEnter(),C.current=!0)}),onPointerLeave:Yr(e.onPointerLeave,()=>{u.onTriggerLeave(),C.current=!1}),onPointerDown:Yr(e.onPointerDown,()=>{u.open&&u.onClose(),w.current=!0,document.addEventListener("pointerup",k,{once:!0})}),onFocus:Yr(e.onFocus,()=>{w.current||u.onOpen()}),onBlur:Yr(e.onBlur,u.onClose),onClick:Yr(e.onClick,u.onClose)})})});f$.displayName=kw;var m$="TooltipPortal",[CY,g$]=p_(m$,{forceMount:void 0}),cp="TooltipContent",hL=K.forwardRef((e,t)=>{const r=g$(cp,e.__scopeTooltip),{forceMount:o=r.forceMount,side:u="top",...d}=e,h=f_(cp,e.__scopeTooltip);return j.jsx(yp,{present:o||h.open,children:h.disableHoverableContent?j.jsx(dL,{side:u,...d,ref:t}):j.jsx(y$,{side:u,...d,ref:t})})}),y$=K.forwardRef((e,t)=>{const r=f_(cp,e.__scopeTooltip),o=lL(cp,e.__scopeTooltip),u=K.useRef(null),d=Zi(t,u),[h,s]=K.useState(null),{trigger:b,onClose:w}=r,C=u.current,{onPointerInTransitChange:k}=o,I=K.useCallback(()=>{s(null),k(!1)},[k]),A=K.useCallback((B,F)=>{const X=B.currentTarget,q={x:B.clientX,y:B.clientY},V=w$(q,X.getBoundingClientRect()),U=S$(q,V),ne=T$(F.getBoundingClientRect()),de=P$([...U,...ne]);s(de),k(!0)},[k]);return K.useEffect(()=>()=>I(),[I]),K.useEffect(()=>{if(b&&C){const B=X=>A(X,C),F=X=>A(X,b);return b.addEventListener("pointerleave",B),C.addEventListener("pointerleave",F),()=>{b.removeEventListener("pointerleave",B),C.removeEventListener("pointerleave",F)}}},[b,C,A,I]),K.useEffect(()=>{if(h){const B=F=>{const X=F.target,q={x:F.clientX,y:F.clientY},V=(b==null?void 0:b.contains(X))||(C==null?void 0:C.contains(X)),U=!C$(q,h);V?I():U&&(I(),w())};return document.addEventListener("pointermove",B),()=>document.removeEventListener("pointermove",B)}},[b,C,h,w,I]),j.jsx(dL,{...e,ref:d})}),[v$,_$]=p_(uL,{isInside:!1}),x$=PF("TooltipContent"),dL=K.forwardRef((e,t)=>{const{__scopeTooltip:r,children:o,"aria-label":u,onEscapeKeyDown:d,onPointerDownOutside:h,...s}=e,b=f_(cp,r),w=TS(r),{onClose:C}=b;return K.useEffect(()=>(document.addEventListener(QE,C),()=>document.removeEventListener(QE,C)),[C]),K.useEffect(()=>{if(b.trigger){const k=I=>{const A=I.target;A!=null&&A.contains(b.trigger)&&C()};return window.addEventListener("scroll",k,{capture:!0}),()=>window.removeEventListener("scroll",k,{capture:!0})}},[b.trigger,C]),j.jsx(a_,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:k=>k.preventDefault(),onDismiss:C,children:j.jsxs(u$,{"data-state":b.stateAttribute,...w,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[j.jsx(x$,{children:o}),j.jsx(v$,{scope:r,isInside:!0,children:j.jsx(XF,{id:b.contentId,role:"tooltip",children:u||o})})]})})});hL.displayName=cp;var pL="TooltipArrow",b$=K.forwardRef((e,t)=>{const{__scopeTooltip:r,...o}=e,u=TS(r);return _$(pL,r).isInside?null:j.jsx(h$,{...u,...o,ref:t})});b$.displayName=pL;function w$(e,t){const r=Math.abs(t.top-e.y),o=Math.abs(t.bottom-e.y),u=Math.abs(t.right-e.x),d=Math.abs(t.left-e.x);switch(Math.min(r,o,u,d)){case d:return"left";case u:return"right";case r:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function S$(e,t,r=5){const o=[];switch(t){case"top":o.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":o.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":o.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":o.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return o}function T$(e){const{top:t,right:r,bottom:o,left:u}=e;return[{x:u,y:t},{x:r,y:t},{x:r,y:o},{x:u,y:o}]}function C$(e,t){const{x:r,y:o}=e;let u=!1;for(let d=0,h=t.length-1;d<t.length;h=d++){const s=t[d],b=t[h],w=s.x,C=s.y,k=b.x,I=b.y;C>o!=I>o&&r<(k-w)*(o-C)/(I-C)+w&&(u=!u)}return u}function P$(e){const t=e.slice();return t.sort((r,o)=>r.x<o.x?-1:r.x>o.x?1:r.y<o.y?-1:r.y>o.y?1:0),E$(t)}function E$(e){if(e.length<=1)return e.slice();const t=[];for(let o=0;o<e.length;o++){const u=e[o];for(;t.length>=2;){const d=t[t.length-1],h=t[t.length-2];if((d.x-h.x)*(u.y-h.y)>=(d.y-h.y)*(u.x-h.x))t.pop();else break}t.push(u)}t.pop();const r=[];for(let o=e.length-1;o>=0;o--){const u=e[o];for(;r.length>=2;){const d=r[r.length-1],h=r[r.length-2];if((d.x-h.x)*(u.y-h.y)>=(d.y-h.y)*(u.x-h.x))r.pop();else break}r.push(u)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var M$=cL,fL=hL;const k$=M$,A$=K.forwardRef(({className:e,sideOffset:t=4,...r},o)=>j.jsx(fL,{ref:o,sideOffset:t,className:Tn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));A$.displayName=fL.displayName;var m_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},g_=typeof window>"u"||"Deno"in globalThis;function xs(){}function I$(e,t){return typeof e=="function"?e(t):e}function R$(e){return typeof e=="number"&&e>=0&&e!==1/0}function L$(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Aw(e,t){return typeof e=="function"?e(t):e}function D$(e,t){return typeof e=="function"?e(t):e}function JE(e,t){const{type:r="all",exact:o,fetchStatus:u,predicate:d,queryKey:h,stale:s}=e;if(h){if(o){if(t.queryHash!==CS(h,t.options))return!1}else if(!Um(t.queryKey,h))return!1}if(r!=="all"){const b=t.isActive();if(r==="active"&&!b||r==="inactive"&&b)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||u&&u!==t.state.fetchStatus||d&&!d(t))}function eM(e,t){const{exact:r,status:o,predicate:u,mutationKey:d}=e;if(d){if(!t.options.mutationKey)return!1;if(r){if(Vm(t.options.mutationKey)!==Vm(d))return!1}else if(!Um(t.options.mutationKey,d))return!1}return!(o&&t.state.status!==o||u&&!u(t))}function CS(e,t){return((t==null?void 0:t.queryKeyHashFn)||Vm)(e)}function Vm(e){return JSON.stringify(e,(t,r)=>Iw(r)?Object.keys(r).sort().reduce((o,u)=>(o[u]=r[u],o),{}):r)}function Um(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Um(e[r],t[r])):!1}function mL(e,t){if(e===t)return e;const r=tM(e)&&tM(t);if(r||Iw(e)&&Iw(t)){const o=r?e:Object.keys(e),u=o.length,d=r?t:Object.keys(t),h=d.length,s=r?[]:{},b=new Set(o);let w=0;for(let C=0;C<h;C++){const k=r?C:d[C];(!r&&b.has(k)||r)&&e[k]===void 0&&t[k]===void 0?(s[k]=void 0,w++):(s[k]=mL(e[k],t[k]),s[k]===e[k]&&e[k]!==void 0&&w++)}return u===h&&w===u?e:s}return t}function tM(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Iw(e){if(!rM(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!rM(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function rM(e){return Object.prototype.toString.call(e)==="[object Object]"}function z$(e){return new Promise(t=>{setTimeout(t,e)})}function N$(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?mL(e,t):t}function j$(e,t,r=0){const o=[...e,t];return r&&o.length>r?o.slice(1):o}function O$(e,t,r=0){const o=[t,...e];return r&&o.length>r?o.slice(0,-1):o}var PS=Symbol();function gL(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===PS?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var zu,Yl,Wd,AA,F$=(AA=class extends m_{constructor(){super();wr(this,zu);wr(this,Yl);wr(this,Wd);Ht(this,Wd,t=>{if(!g_&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){et(this,Yl)||this.setEventListener(et(this,Wd))}onUnsubscribe(){var t;this.hasListeners()||((t=et(this,Yl))==null||t.call(this),Ht(this,Yl,void 0))}setEventListener(t){var r;Ht(this,Wd,t),(r=et(this,Yl))==null||r.call(this),Ht(this,Yl,t(o=>{typeof o=="boolean"?this.setFocused(o):this.onFocus()}))}setFocused(t){et(this,zu)!==t&&(Ht(this,zu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof et(this,zu)=="boolean"?et(this,zu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},zu=new WeakMap,Yl=new WeakMap,Wd=new WeakMap,AA),yL=new F$,Hd,Ql,Kd,IA,B$=(IA=class extends m_{constructor(){super();wr(this,Hd,!0);wr(this,Ql);wr(this,Kd);Ht(this,Kd,t=>{if(!g_&&window.addEventListener){const r=()=>t(!0),o=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",o,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",o)}}})}onSubscribe(){et(this,Ql)||this.setEventListener(et(this,Kd))}onUnsubscribe(){var t;this.hasListeners()||((t=et(this,Ql))==null||t.call(this),Ht(this,Ql,void 0))}setEventListener(t){var r;Ht(this,Kd,t),(r=et(this,Ql))==null||r.call(this),Ht(this,Ql,t(this.setOnline.bind(this)))}setOnline(t){et(this,Hd)!==t&&(Ht(this,Hd,t),this.listeners.forEach(o=>{o(t)}))}isOnline(){return et(this,Hd)}},Hd=new WeakMap,Ql=new WeakMap,Kd=new WeakMap,IA),T0=new B$;function $$(){let e,t;const r=new Promise((u,d)=>{e=u,t=d});r.status="pending",r.catch(()=>{});function o(u){Object.assign(r,u),delete r.resolve,delete r.reject}return r.resolve=u=>{o({status:"fulfilled",value:u}),e(u)},r.reject=u=>{o({status:"rejected",reason:u}),t(u)},r}function V$(e){return Math.min(1e3*2**e,3e4)}function vL(e){return(e??"online")==="online"?T0.isOnline():!0}var _L=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function $1(e){return e instanceof _L}function xL(e){let t=!1,r=0,o=!1,u;const d=$$(),h=F=>{var X;o||(I(new _L(F)),(X=e.abort)==null||X.call(e))},s=()=>{t=!0},b=()=>{t=!1},w=()=>yL.isFocused()&&(e.networkMode==="always"||T0.isOnline())&&e.canRun(),C=()=>vL(e.networkMode)&&e.canRun(),k=F=>{var X;o||(o=!0,(X=e.onSuccess)==null||X.call(e,F),u==null||u(),d.resolve(F))},I=F=>{var X;o||(o=!0,(X=e.onError)==null||X.call(e,F),u==null||u(),d.reject(F))},A=()=>new Promise(F=>{var X;u=q=>{(o||w())&&F(q)},(X=e.onPause)==null||X.call(e)}).then(()=>{var F;u=void 0,o||(F=e.onContinue)==null||F.call(e)}),B=()=>{if(o)return;let F;const X=r===0?e.initialPromise:void 0;try{F=X??e.fn()}catch(q){F=Promise.reject(q)}Promise.resolve(F).then(k).catch(q=>{var xe;if(o)return;const V=e.retry??(g_?0:3),U=e.retryDelay??V$,ne=typeof U=="function"?U(r,q):U,de=V===!0||typeof V=="number"&&r<V||typeof V=="function"&&V(r,q);if(t||!de){I(q);return}r++,(xe=e.onFail)==null||xe.call(e,r,q),z$(ne).then(()=>w()?void 0:A()).then(()=>{t?I(q):B()})})};return{promise:d,cancel:h,continue:()=>(u==null||u(),d),cancelRetry:s,continueRetry:b,canStart:C,start:()=>(C()?B():A().then(B),d)}}var U$=e=>setTimeout(e,0);function G$(){let e=[],t=0,r=s=>{s()},o=s=>{s()},u=U$;const d=s=>{t?e.push(s):u(()=>{r(s)})},h=()=>{const s=e;e=[],s.length&&u(()=>{o(()=>{s.forEach(b=>{r(b)})})})};return{batch:s=>{let b;t++;try{b=s()}finally{t--,t||h()}return b},batchCalls:s=>(...b)=>{d(()=>{s(...b)})},schedule:d,setNotifyFunction:s=>{r=s},setBatchNotifyFunction:s=>{o=s},setScheduler:s=>{u=s}}}var Gi=G$(),Nu,RA,bL=(RA=class{constructor(){wr(this,Nu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),R$(this.gcTime)&&Ht(this,Nu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(g_?1/0:5*60*1e3))}clearGcTimeout(){et(this,Nu)&&(clearTimeout(et(this,Nu)),Ht(this,Nu,void 0))}},Nu=new WeakMap,RA),Xd,ju,Zo,Ou,Ei,og,Fu,bs,Oa,LA,q$=(LA=class extends bL{constructor(t){super();wr(this,bs);wr(this,Xd);wr(this,ju);wr(this,Zo);wr(this,Ou);wr(this,Ei);wr(this,og);wr(this,Fu);Ht(this,Fu,!1),Ht(this,og,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ht(this,Ou,t.client),Ht(this,Zo,et(this,Ou).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ht(this,Xd,W$(this.options)),this.state=t.state??et(this,Xd),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=et(this,Ei))==null?void 0:t.promise}setOptions(t){this.options={...et(this,og),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&et(this,Zo).remove(this)}setData(t,r){const o=N$(this.state.data,t,this.options);return Ti(this,bs,Oa).call(this,{data:o,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),o}setState(t,r){Ti(this,bs,Oa).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var o,u;const r=(o=et(this,Ei))==null?void 0:o.promise;return(u=et(this,Ei))==null||u.cancel(t),r?r.then(xs).catch(xs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(et(this,Xd))}isActive(){return this.observers.some(t=>D$(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===PS||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Aw(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!L$(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(o=>o.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=et(this,Ei))==null||r.continue()}onOnline(){var r;const t=this.observers.find(o=>o.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=et(this,Ei))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),et(this,Zo).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(et(this,Ei)&&(et(this,Fu)?et(this,Ei).cancel({revert:!0}):et(this,Ei).cancelRetry()),this.scheduleGc()),et(this,Zo).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ti(this,bs,Oa).call(this,{type:"invalidate"})}fetch(t,r){var w,C,k;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(et(this,Ei))return et(this,Ei).continueRetry(),et(this,Ei).promise}if(t&&this.setOptions(t),!this.options.queryFn){const I=this.observers.find(A=>A.options.queryFn);I&&this.setOptions(I.options)}const o=new AbortController,u=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(Ht(this,Fu,!0),o.signal)})},d=()=>{const I=gL(this.options,r),B=(()=>{const F={client:et(this,Ou),queryKey:this.queryKey,meta:this.meta};return u(F),F})();return Ht(this,Fu,!1),this.options.persister?this.options.persister(I,B,this):I(B)},s=(()=>{const I={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:et(this,Ou),state:this.state,fetchFn:d};return u(I),I})();(w=this.options.behavior)==null||w.onFetch(s,this),Ht(this,ju,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((C=s.fetchOptions)==null?void 0:C.meta))&&Ti(this,bs,Oa).call(this,{type:"fetch",meta:(k=s.fetchOptions)==null?void 0:k.meta});const b=I=>{var A,B,F,X;$1(I)&&I.silent||Ti(this,bs,Oa).call(this,{type:"error",error:I}),$1(I)||((B=(A=et(this,Zo).config).onError)==null||B.call(A,I,this),(X=(F=et(this,Zo).config).onSettled)==null||X.call(F,this.state.data,I,this)),this.scheduleGc()};return Ht(this,Ei,xL({initialPromise:r==null?void 0:r.initialPromise,fn:s.fetchFn,abort:o.abort.bind(o),onSuccess:I=>{var A,B,F,X;if(I===void 0){b(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(I)}catch(q){b(q);return}(B=(A=et(this,Zo).config).onSuccess)==null||B.call(A,I,this),(X=(F=et(this,Zo).config).onSettled)==null||X.call(F,I,this.state.error,this),this.scheduleGc()},onError:b,onFail:(I,A)=>{Ti(this,bs,Oa).call(this,{type:"failed",failureCount:I,error:A})},onPause:()=>{Ti(this,bs,Oa).call(this,{type:"pause"})},onContinue:()=>{Ti(this,bs,Oa).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),et(this,Ei).start()}},Xd=new WeakMap,ju=new WeakMap,Zo=new WeakMap,Ou=new WeakMap,Ei=new WeakMap,og=new WeakMap,Fu=new WeakMap,bs=new WeakSet,Oa=function(t){const r=o=>{switch(t.type){case"failed":return{...o,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...o,fetchStatus:"paused"};case"continue":return{...o,fetchStatus:"fetching"};case"fetch":return{...o,...Z$(o.data,this.options),fetchMeta:t.meta??null};case"success":return Ht(this,ju,void 0),{...o,data:t.data,dataUpdateCount:o.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const u=t.error;return $1(u)&&u.revert&&et(this,ju)?{...et(this,ju),fetchStatus:"idle"}:{...o,error:u,errorUpdateCount:o.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:o.fetchFailureCount+1,fetchFailureReason:u,fetchStatus:"idle",status:"error"};case"invalidate":return{...o,isInvalidated:!0};case"setState":return{...o,...t.state}}};this.state=r(this.state),Gi.batch(()=>{this.observers.forEach(o=>{o.onQueryUpdate()}),et(this,Zo).notify({query:this,type:"updated",action:t})})},LA);function Z$(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:vL(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function W$(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,o=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ra,DA,H$=(DA=class extends m_{constructor(t={}){super();wr(this,ra);this.config=t,Ht(this,ra,new Map)}build(t,r,o){const u=r.queryKey,d=r.queryHash??CS(u,r);let h=this.get(d);return h||(h=new q$({client:t,queryKey:u,queryHash:d,options:t.defaultQueryOptions(r),state:o,defaultOptions:t.getQueryDefaults(u)}),this.add(h)),h}add(t){et(this,ra).has(t.queryHash)||(et(this,ra).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=et(this,ra).get(t.queryHash);r&&(t.destroy(),r===t&&et(this,ra).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Gi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return et(this,ra).get(t)}getAll(){return[...et(this,ra).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(o=>JE(r,o))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(o=>JE(t,o)):r}notify(t){Gi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Gi.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Gi.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ra=new WeakMap,DA),na,Bi,Bu,ia,Vl,zA,K$=(zA=class extends bL{constructor(t){super();wr(this,ia);wr(this,na);wr(this,Bi);wr(this,Bu);this.mutationId=t.mutationId,Ht(this,Bi,t.mutationCache),Ht(this,na,[]),this.state=t.state||X$(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){et(this,na).includes(t)||(et(this,na).push(t),this.clearGcTimeout(),et(this,Bi).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ht(this,na,et(this,na).filter(r=>r!==t)),this.scheduleGc(),et(this,Bi).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){et(this,na).length||(this.state.status==="pending"?this.scheduleGc():et(this,Bi).remove(this))}continue(){var t;return((t=et(this,Bu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var d,h,s,b,w,C,k,I,A,B,F,X,q,V,U,ne,de,xe,ke,ze;const r=()=>{Ti(this,ia,Vl).call(this,{type:"continue"})};Ht(this,Bu,xL({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(We,rt)=>{Ti(this,ia,Vl).call(this,{type:"failed",failureCount:We,error:rt})},onPause:()=>{Ti(this,ia,Vl).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>et(this,Bi).canRun(this)}));const o=this.state.status==="pending",u=!et(this,Bu).canStart();try{if(o)r();else{Ti(this,ia,Vl).call(this,{type:"pending",variables:t,isPaused:u}),await((h=(d=et(this,Bi).config).onMutate)==null?void 0:h.call(d,t,this));const rt=await((b=(s=this.options).onMutate)==null?void 0:b.call(s,t));rt!==this.state.context&&Ti(this,ia,Vl).call(this,{type:"pending",context:rt,variables:t,isPaused:u})}const We=await et(this,Bu).start();return await((C=(w=et(this,Bi).config).onSuccess)==null?void 0:C.call(w,We,t,this.state.context,this)),await((I=(k=this.options).onSuccess)==null?void 0:I.call(k,We,t,this.state.context)),await((B=(A=et(this,Bi).config).onSettled)==null?void 0:B.call(A,We,null,this.state.variables,this.state.context,this)),await((X=(F=this.options).onSettled)==null?void 0:X.call(F,We,null,t,this.state.context)),Ti(this,ia,Vl).call(this,{type:"success",data:We}),We}catch(We){try{throw await((V=(q=et(this,Bi).config).onError)==null?void 0:V.call(q,We,t,this.state.context,this)),await((ne=(U=this.options).onError)==null?void 0:ne.call(U,We,t,this.state.context)),await((xe=(de=et(this,Bi).config).onSettled)==null?void 0:xe.call(de,void 0,We,this.state.variables,this.state.context,this)),await((ze=(ke=this.options).onSettled)==null?void 0:ze.call(ke,void 0,We,t,this.state.context)),We}finally{Ti(this,ia,Vl).call(this,{type:"error",error:We})}}finally{et(this,Bi).runNext(this)}}},na=new WeakMap,Bi=new WeakMap,Bu=new WeakMap,ia=new WeakSet,Vl=function(t){const r=o=>{switch(t.type){case"failed":return{...o,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...o,isPaused:!0};case"continue":return{...o,isPaused:!1};case"pending":return{...o,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...o,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...o,data:void 0,error:t.error,failureCount:o.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Gi.batch(()=>{et(this,na).forEach(o=>{o.onMutationUpdate(t)}),et(this,Bi).notify({mutation:this,type:"updated",action:t})})},zA);function X$(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $a,ws,sg,NA,Y$=(NA=class extends m_{constructor(t={}){super();wr(this,$a);wr(this,ws);wr(this,sg);this.config=t,Ht(this,$a,new Set),Ht(this,ws,new Map),Ht(this,sg,0)}build(t,r,o){const u=new K$({mutationCache:this,mutationId:++jy(this,sg)._,options:t.defaultMutationOptions(r),state:o});return this.add(u),u}add(t){et(this,$a).add(t);const r=ov(t);if(typeof r=="string"){const o=et(this,ws).get(r);o?o.push(t):et(this,ws).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(et(this,$a).delete(t)){const r=ov(t);if(typeof r=="string"){const o=et(this,ws).get(r);if(o)if(o.length>1){const u=o.indexOf(t);u!==-1&&o.splice(u,1)}else o[0]===t&&et(this,ws).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=ov(t);if(typeof r=="string"){const o=et(this,ws).get(r),u=o==null?void 0:o.find(d=>d.state.status==="pending");return!u||u===t}else return!0}runNext(t){var o;const r=ov(t);if(typeof r=="string"){const u=(o=et(this,ws).get(r))==null?void 0:o.find(d=>d!==t&&d.state.isPaused);return(u==null?void 0:u.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Gi.batch(()=>{et(this,$a).forEach(t=>{this.notify({type:"removed",mutation:t})}),et(this,$a).clear(),et(this,ws).clear()})}getAll(){return Array.from(et(this,$a))}find(t){const r={exact:!0,...t};return this.getAll().find(o=>eM(r,o))}findAll(t={}){return this.getAll().filter(r=>eM(t,r))}notify(t){Gi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Gi.batch(()=>Promise.all(t.map(r=>r.continue().catch(xs))))}},$a=new WeakMap,ws=new WeakMap,sg=new WeakMap,NA);function ov(e){var t;return(t=e.options.scope)==null?void 0:t.id}function nM(e){return{onFetch:(t,r)=>{var C,k,I,A,B;const o=t.options,u=(I=(k=(C=t.fetchOptions)==null?void 0:C.meta)==null?void 0:k.fetchMore)==null?void 0:I.direction,d=((A=t.state.data)==null?void 0:A.pages)||[],h=((B=t.state.data)==null?void 0:B.pageParams)||[];let s={pages:[],pageParams:[]},b=0;const w=async()=>{let F=!1;const X=U=>{Object.defineProperty(U,"signal",{enumerable:!0,get:()=>(t.signal.aborted?F=!0:t.signal.addEventListener("abort",()=>{F=!0}),t.signal)})},q=gL(t.options,t.fetchOptions),V=async(U,ne,de)=>{if(F)return Promise.reject();if(ne==null&&U.pages.length)return Promise.resolve(U);const ke=(()=>{const Ze={client:t.client,queryKey:t.queryKey,pageParam:ne,direction:de?"backward":"forward",meta:t.options.meta};return X(Ze),Ze})(),ze=await q(ke),{maxPages:We}=t.options,rt=de?O$:j$;return{pages:rt(U.pages,ze,We),pageParams:rt(U.pageParams,ne,We)}};if(u&&d.length){const U=u==="backward",ne=U?Q$:iM,de={pages:d,pageParams:h},xe=ne(o,de);s=await V(de,xe,U)}else{const U=e??d.length;do{const ne=b===0?h[0]??o.initialPageParam:iM(o,s);if(b>0&&ne==null)break;s=await V(s,ne),b++}while(b<U)}return s};t.options.persister?t.fetchFn=()=>{var F,X;return(X=(F=t.options).persister)==null?void 0:X.call(F,w,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=w}}}function iM(e,{pages:t,pageParams:r}){const o=t.length-1;return t.length>0?e.getNextPageParam(t[o],t,r[o],r):void 0}function Q$(e,{pages:t,pageParams:r}){var o;return t.length>0?(o=e.getPreviousPageParam)==null?void 0:o.call(e,t[0],t,r[0],r):void 0}var fn,Jl,ec,Yd,Qd,tc,Jd,ep,jA,J$=(jA=class{constructor(e={}){wr(this,fn);wr(this,Jl);wr(this,ec);wr(this,Yd);wr(this,Qd);wr(this,tc);wr(this,Jd);wr(this,ep);Ht(this,fn,e.queryCache||new H$),Ht(this,Jl,e.mutationCache||new Y$),Ht(this,ec,e.defaultOptions||{}),Ht(this,Yd,new Map),Ht(this,Qd,new Map),Ht(this,tc,0)}mount(){jy(this,tc)._++,et(this,tc)===1&&(Ht(this,Jd,yL.subscribe(async e=>{e&&(await this.resumePausedMutations(),et(this,fn).onFocus())})),Ht(this,ep,T0.subscribe(async e=>{e&&(await this.resumePausedMutations(),et(this,fn).onOnline())})))}unmount(){var e,t;jy(this,tc)._--,et(this,tc)===0&&((e=et(this,Jd))==null||e.call(this),Ht(this,Jd,void 0),(t=et(this,ep))==null||t.call(this),Ht(this,ep,void 0))}isFetching(e){return et(this,fn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return et(this,Jl).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=et(this,fn).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=et(this,fn).build(this,t),o=r.state.data;return o===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Aw(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(o))}getQueriesData(e){return et(this,fn).findAll(e).map(({queryKey:t,state:r})=>{const o=r.data;return[t,o]})}setQueryData(e,t,r){const o=this.defaultQueryOptions({queryKey:e}),u=et(this,fn).get(o.queryHash),d=u==null?void 0:u.state.data,h=I$(t,d);if(h!==void 0)return et(this,fn).build(this,o).setData(h,{...r,manual:!0})}setQueriesData(e,t,r){return Gi.batch(()=>et(this,fn).findAll(e).map(({queryKey:o})=>[o,this.setQueryData(o,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=et(this,fn).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=et(this,fn);Gi.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=et(this,fn);return Gi.batch(()=>(r.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},o=Gi.batch(()=>et(this,fn).findAll(e).map(u=>u.cancel(r)));return Promise.all(o).then(xs).catch(xs)}invalidateQueries(e,t={}){return Gi.batch(()=>(et(this,fn).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},o=Gi.batch(()=>et(this,fn).findAll(e).filter(u=>!u.isDisabled()&&!u.isStatic()).map(u=>{let d=u.fetch(void 0,r);return r.throwOnError||(d=d.catch(xs)),u.state.fetchStatus==="paused"?Promise.resolve():d}));return Promise.all(o).then(xs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=et(this,fn).build(this,t);return r.isStaleByTime(Aw(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(xs).catch(xs)}fetchInfiniteQuery(e){return e.behavior=nM(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(xs).catch(xs)}ensureInfiniteQueryData(e){return e.behavior=nM(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return T0.isOnline()?et(this,Jl).resumePausedMutations():Promise.resolve()}getQueryCache(){return et(this,fn)}getMutationCache(){return et(this,Jl)}getDefaultOptions(){return et(this,ec)}setDefaultOptions(e){Ht(this,ec,e)}setQueryDefaults(e,t){et(this,Yd).set(Vm(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...et(this,Yd).values()],r={};return t.forEach(o=>{Um(e,o.queryKey)&&Object.assign(r,o.defaultOptions)}),r}setMutationDefaults(e,t){et(this,Qd).set(Vm(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...et(this,Qd).values()],r={};return t.forEach(o=>{Um(e,o.mutationKey)&&Object.assign(r,o.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...et(this,ec).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=CS(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===PS&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...et(this,ec).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){et(this,fn).clear(),et(this,Jl).clear()}},fn=new WeakMap,Jl=new WeakMap,ec=new WeakMap,Yd=new WeakMap,Qd=new WeakMap,tc=new WeakMap,Jd=new WeakMap,ep=new WeakMap,jA),eV=K.createContext(void 0),tV=({client:e,children:t})=>(K.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),j.jsx(eV.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Gm.apply(this,arguments)}var ic;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ic||(ic={}));const oM="popstate";function rV(e){e===void 0&&(e={});function t(o,u){let{pathname:d,search:h,hash:s}=o.location;return Rw("",{pathname:d,search:h,hash:s},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function r(o,u){return typeof u=="string"?u:C0(u)}return iV(t,r,null,e)}function Fn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function wL(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function nV(){return Math.random().toString(36).substr(2,8)}function sM(e,t){return{usr:e.state,key:e.key,idx:t}}function Rw(e,t,r,o){return r===void 0&&(r=null),Gm({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?bp(t):t,{state:r,key:t&&t.key||o||nV()})}function C0(e){let{pathname:t="/",search:r="",hash:o=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),o&&o!=="#"&&(t+=o.charAt(0)==="#"?o:"#"+o),t}function bp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}function iV(e,t,r,o){o===void 0&&(o={});let{window:u=document.defaultView,v5Compat:d=!1}=o,h=u.history,s=ic.Pop,b=null,w=C();w==null&&(w=0,h.replaceState(Gm({},h.state,{idx:w}),""));function C(){return(h.state||{idx:null}).idx}function k(){s=ic.Pop;let X=C(),q=X==null?null:X-w;w=X,b&&b({action:s,location:F.location,delta:q})}function I(X,q){s=ic.Push;let V=Rw(F.location,X,q);w=C()+1;let U=sM(V,w),ne=F.createHref(V);try{h.pushState(U,"",ne)}catch(de){if(de instanceof DOMException&&de.name==="DataCloneError")throw de;u.location.assign(ne)}d&&b&&b({action:s,location:F.location,delta:1})}function A(X,q){s=ic.Replace;let V=Rw(F.location,X,q);w=C();let U=sM(V,w),ne=F.createHref(V);h.replaceState(U,"",ne),d&&b&&b({action:s,location:F.location,delta:0})}function B(X){let q=u.location.origin!=="null"?u.location.origin:u.location.href,V=typeof X=="string"?X:C0(X);return V=V.replace(/ $/,"%20"),Fn(q,"No window.location.(origin|href) available to create URL for href: "+V),new URL(V,q)}let F={get action(){return s},get location(){return e(u,h)},listen(X){if(b)throw new Error("A history only accepts one active listener");return u.addEventListener(oM,k),b=X,()=>{u.removeEventListener(oM,k),b=null}},createHref(X){return t(u,X)},createURL:B,encodeLocation(X){let q=B(X);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:I,replace:A,go(X){return h.go(X)}};return F}var aM;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(aM||(aM={}));function oV(e,t,r){return r===void 0&&(r="/"),sV(e,t,r)}function sV(e,t,r,o){let u=typeof t=="string"?bp(t):t,d=ES(u.pathname||"/",r);if(d==null)return null;let h=SL(e);aV(h);let s=null;for(let b=0;s==null&&b<h.length;++b){let w=_V(d);s=gV(h[b],w)}return s}function SL(e,t,r,o){t===void 0&&(t=[]),r===void 0&&(r=[]),o===void 0&&(o="");let u=(d,h,s)=>{let b={relativePath:s===void 0?d.path||"":s,caseSensitive:d.caseSensitive===!0,childrenIndex:h,route:d};b.relativePath.startsWith("/")&&(Fn(b.relativePath.startsWith(o),'Absolute route path "'+b.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),b.relativePath=b.relativePath.slice(o.length));let w=mc([o,b.relativePath]),C=r.concat(b);d.children&&d.children.length>0&&(Fn(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),SL(d.children,t,C,w)),!(d.path==null&&!d.index)&&t.push({path:w,score:fV(w,d.index),routesMeta:C})};return e.forEach((d,h)=>{var s;if(d.path===""||!((s=d.path)!=null&&s.includes("?")))u(d,h);else for(let b of TL(d.path))u(d,h,b)}),t}function TL(e){let t=e.split("/");if(t.length===0)return[];let[r,...o]=t,u=r.endsWith("?"),d=r.replace(/\?$/,"");if(o.length===0)return u?[d,""]:[d];let h=TL(o.join("/")),s=[];return s.push(...h.map(b=>b===""?d:[d,b].join("/"))),u&&s.push(...h),s.map(b=>e.startsWith("/")&&b===""?"/":b)}function aV(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:mV(t.routesMeta.map(o=>o.childrenIndex),r.routesMeta.map(o=>o.childrenIndex)))}const lV=/^:[\w-]+$/,cV=3,uV=2,hV=1,dV=10,pV=-2,lM=e=>e==="*";function fV(e,t){let r=e.split("/"),o=r.length;return r.some(lM)&&(o+=pV),t&&(o+=uV),r.filter(u=>!lM(u)).reduce((u,d)=>u+(lV.test(d)?cV:d===""?hV:dV),o)}function mV(e,t){return e.length===t.length&&e.slice(0,-1).every((o,u)=>o===t[u])?e[e.length-1]-t[t.length-1]:0}function gV(e,t,r){let{routesMeta:o}=e,u={},d="/",h=[];for(let s=0;s<o.length;++s){let b=o[s],w=s===o.length-1,C=d==="/"?t:t.slice(d.length)||"/",k=yV({path:b.relativePath,caseSensitive:b.caseSensitive,end:w},C),I=b.route;if(!k)return null;Object.assign(u,k.params),h.push({params:u,pathname:mc([d,k.pathname]),pathnameBase:SV(mc([d,k.pathnameBase])),route:I}),k.pathnameBase!=="/"&&(d=mc([d,k.pathnameBase]))}return h}function yV(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,o]=vV(e.path,e.caseSensitive,e.end),u=t.match(r);if(!u)return null;let d=u[0],h=d.replace(/(.)\/+$/,"$1"),s=u.slice(1);return{params:o.reduce((w,C,k)=>{let{paramName:I,isOptional:A}=C;if(I==="*"){let F=s[k]||"";h=d.slice(0,d.length-F.length).replace(/(.)\/+$/,"$1")}const B=s[k];return A&&!B?w[I]=void 0:w[I]=(B||"").replace(/%2F/g,"/"),w},{}),pathname:d,pathnameBase:h,pattern:e}}function vV(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),wL(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,s,b)=>(o.push({paramName:s,isOptional:b!=null}),b?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?u+="\\/*$":e!==""&&e!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,t?void 0:"i"),o]}function _V(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return wL(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ES(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,o=e.charAt(r);return o&&o!=="/"?null:e.slice(r)||"/"}function xV(e,t){t===void 0&&(t="/");let{pathname:r,search:o="",hash:u=""}=typeof e=="string"?bp(e):e;return{pathname:r?r.startsWith("/")?r:bV(r,t):t,search:TV(o),hash:CV(u)}}function bV(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?r.length>1&&r.pop():u!=="."&&r.push(u)}),r.length>1?r.join("/"):"/"}function V1(e,t,r,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wV(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function CL(e,t){let r=wV(e);return t?r.map((o,u)=>u===r.length-1?o.pathname:o.pathnameBase):r.map(o=>o.pathnameBase)}function PL(e,t,r,o){o===void 0&&(o=!1);let u;typeof e=="string"?u=bp(e):(u=Gm({},e),Fn(!u.pathname||!u.pathname.includes("?"),V1("?","pathname","search",u)),Fn(!u.pathname||!u.pathname.includes("#"),V1("#","pathname","hash",u)),Fn(!u.search||!u.search.includes("#"),V1("#","search","hash",u)));let d=e===""||u.pathname==="",h=d?"/":u.pathname,s;if(h==null)s=r;else{let k=t.length-1;if(!o&&h.startsWith("..")){let I=h.split("/");for(;I[0]==="..";)I.shift(),k-=1;u.pathname=I.join("/")}s=k>=0?t[k]:"/"}let b=xV(u,s),w=h&&h!=="/"&&h.endsWith("/"),C=(d||h===".")&&r.endsWith("/");return!b.pathname.endsWith("/")&&(w||C)&&(b.pathname+="/"),b}const mc=e=>e.join("/").replace(/\/\/+/g,"/"),SV=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),TV=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,CV=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function PV(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const EL=["post","put","patch","delete"];new Set(EL);const EV=["get",...EL];new Set(EV);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},qm.apply(this,arguments)}const MS=K.createContext(null),MV=K.createContext(null),ah=K.createContext(null),y_=K.createContext(null),lh=K.createContext({outlet:null,matches:[],isDataRoute:!1}),ML=K.createContext(null);function kV(e,t){let{relative:r}=t===void 0?{}:t;yg()||Fn(!1);let{basename:o,navigator:u}=K.useContext(ah),{hash:d,pathname:h,search:s}=AL(e,{relative:r}),b=h;return o!=="/"&&(b=h==="/"?o:mc([o,h])),u.createHref({pathname:b,search:s,hash:d})}function yg(){return K.useContext(y_)!=null}function ch(){return yg()||Fn(!1),K.useContext(y_).location}function kL(e){K.useContext(ah).static||K.useLayoutEffect(e)}function kS(){let{isDataRoute:e}=K.useContext(lh);return e?VV():AV()}function AV(){yg()||Fn(!1);let e=K.useContext(MS),{basename:t,future:r,navigator:o}=K.useContext(ah),{matches:u}=K.useContext(lh),{pathname:d}=ch(),h=JSON.stringify(CL(u,r.v7_relativeSplatPath)),s=K.useRef(!1);return kL(()=>{s.current=!0}),K.useCallback(function(w,C){if(C===void 0&&(C={}),!s.current)return;if(typeof w=="number"){o.go(w);return}let k=PL(w,JSON.parse(h),d,C.relative==="path");e==null&&t!=="/"&&(k.pathname=k.pathname==="/"?t:mc([t,k.pathname])),(C.replace?o.replace:o.push)(k,C.state,C)},[t,o,h,d,e])}function AL(e,t){let{relative:r}=t===void 0?{}:t,{future:o}=K.useContext(ah),{matches:u}=K.useContext(lh),{pathname:d}=ch(),h=JSON.stringify(CL(u,o.v7_relativeSplatPath));return K.useMemo(()=>PL(e,JSON.parse(h),d,r==="path"),[e,h,d,r])}function IV(e,t){return RV(e,t)}function RV(e,t,r,o){yg()||Fn(!1);let{navigator:u}=K.useContext(ah),{matches:d}=K.useContext(lh),h=d[d.length-1],s=h?h.params:{};h&&h.pathname;let b=h?h.pathnameBase:"/";h&&h.route;let w=ch(),C;if(t){var k;let X=typeof t=="string"?bp(t):t;b==="/"||(k=X.pathname)!=null&&k.startsWith(b)||Fn(!1),C=X}else C=w;let I=C.pathname||"/",A=I;if(b!=="/"){let X=b.replace(/^\//,"").split("/");A="/"+I.replace(/^\//,"").split("/").slice(X.length).join("/")}let B=oV(e,{pathname:A}),F=jV(B&&B.map(X=>Object.assign({},X,{params:Object.assign({},s,X.params),pathname:mc([b,u.encodeLocation?u.encodeLocation(X.pathname).pathname:X.pathname]),pathnameBase:X.pathnameBase==="/"?b:mc([b,u.encodeLocation?u.encodeLocation(X.pathnameBase).pathname:X.pathnameBase])})),d,r,o);return t&&F?K.createElement(y_.Provider,{value:{location:qm({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:ic.Pop}},F):F}function LV(){let e=$V(),t=PV(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},t),r?K.createElement("pre",{style:u},r):null,null)}const DV=K.createElement(LV,null);class zV extends K.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?K.createElement(lh.Provider,{value:this.props.routeContext},K.createElement(ML.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function NV(e){let{routeContext:t,match:r,children:o}=e,u=K.useContext(MS);return u&&u.static&&u.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=r.route.id),K.createElement(lh.Provider,{value:t},o)}function jV(e,t,r,o){var u;if(t===void 0&&(t=[]),r===void 0&&(r=null),o===void 0&&(o=null),e==null){var d;if(!r)return null;if(r.errors)e=r.matches;else if((d=o)!=null&&d.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,s=(u=r)==null?void 0:u.errors;if(s!=null){let C=h.findIndex(k=>k.route.id&&(s==null?void 0:s[k.route.id])!==void 0);C>=0||Fn(!1),h=h.slice(0,Math.min(h.length,C+1))}let b=!1,w=-1;if(r&&o&&o.v7_partialHydration)for(let C=0;C<h.length;C++){let k=h[C];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(w=C),k.route.id){let{loaderData:I,errors:A}=r,B=k.route.loader&&I[k.route.id]===void 0&&(!A||A[k.route.id]===void 0);if(k.route.lazy||B){b=!0,w>=0?h=h.slice(0,w+1):h=[h[0]];break}}}return h.reduceRight((C,k,I)=>{let A,B=!1,F=null,X=null;r&&(A=s&&k.route.id?s[k.route.id]:void 0,F=k.route.errorElement||DV,b&&(w<0&&I===0?(UV("route-fallback"),B=!0,X=null):w===I&&(B=!0,X=k.route.hydrateFallbackElement||null)));let q=t.concat(h.slice(0,I+1)),V=()=>{let U;return A?U=F:B?U=X:k.route.Component?U=K.createElement(k.route.Component,null):k.route.element?U=k.route.element:U=C,K.createElement(NV,{match:k,routeContext:{outlet:C,matches:q,isDataRoute:r!=null},children:U})};return r&&(k.route.ErrorBoundary||k.route.errorElement||I===0)?K.createElement(zV,{location:r.location,revalidation:r.revalidation,component:F,error:A,children:V(),routeContext:{outlet:null,matches:q,isDataRoute:!0}}):V()},null)}var IL=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(IL||{}),RL=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(RL||{});function OV(e){let t=K.useContext(MS);return t||Fn(!1),t}function FV(e){let t=K.useContext(MV);return t||Fn(!1),t}function BV(e){let t=K.useContext(lh);return t||Fn(!1),t}function LL(e){let t=BV(),r=t.matches[t.matches.length-1];return r.route.id||Fn(!1),r.route.id}function $V(){var e;let t=K.useContext(ML),r=FV(),o=LL();return t!==void 0?t:(e=r.errors)==null?void 0:e[o]}function VV(){let{router:e}=OV(IL.UseNavigateStable),t=LL(RL.UseNavigateStable),r=K.useRef(!1);return kL(()=>{r.current=!0}),K.useCallback(function(u,d){d===void 0&&(d={}),r.current&&(typeof u=="number"?e.navigate(u):e.navigate(u,qm({fromRouteId:t},d)))},[e,t])}const cM={};function UV(e,t,r){cM[e]||(cM[e]=!0)}function GV(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Su(e){Fn(!1)}function qV(e){let{basename:t="/",children:r=null,location:o,navigationType:u=ic.Pop,navigator:d,static:h=!1,future:s}=e;yg()&&Fn(!1);let b=t.replace(/^\/*/,"/"),w=K.useMemo(()=>({basename:b,navigator:d,static:h,future:qm({v7_relativeSplatPath:!1},s)}),[b,s,d,h]);typeof o=="string"&&(o=bp(o));let{pathname:C="/",search:k="",hash:I="",state:A=null,key:B="default"}=o,F=K.useMemo(()=>{let X=ES(C,b);return X==null?null:{location:{pathname:X,search:k,hash:I,state:A,key:B},navigationType:u}},[b,C,k,I,A,B,u]);return F==null?null:K.createElement(ah.Provider,{value:w},K.createElement(y_.Provider,{children:r,value:F}))}function ZV(e){let{children:t,location:r}=e;return IV(Lw(t),r)}new Promise(()=>{});function Lw(e,t){t===void 0&&(t=[]);let r=[];return K.Children.forEach(e,(o,u)=>{if(!K.isValidElement(o))return;let d=[...t,u];if(o.type===K.Fragment){r.push.apply(r,Lw(o.props.children,d));return}o.type!==Su&&Fn(!1),!o.props.index||!o.props.children||Fn(!1);let h={id:o.props.id||d.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(h.children=Lw(o.props.children,d)),r.push(h)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dw(){return Dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Dw.apply(this,arguments)}function WV(e,t){if(e==null)return{};var r={},o=Object.keys(e),u,d;for(d=0;d<o.length;d++)u=o[d],!(t.indexOf(u)>=0)&&(r[u]=e[u]);return r}function HV(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function KV(e,t){return e.button===0&&(!t||t==="_self")&&!HV(e)}function zw(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let o=e[r];return t.concat(Array.isArray(o)?o.map(u=>[r,u]):[[r,o]])},[]))}function XV(e,t){let r=zw(e);return t&&t.forEach((o,u)=>{r.has(u)||t.getAll(u).forEach(d=>{r.append(u,d)})}),r}const YV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],QV="6";try{window.__reactRouterVersion=QV}catch{}const JV="startTransition",uM=y2[JV];function eU(e){let{basename:t,children:r,future:o,window:u}=e,d=K.useRef();d.current==null&&(d.current=rV({window:u,v5Compat:!0}));let h=d.current,[s,b]=K.useState({action:h.action,location:h.location}),{v7_startTransition:w}=o||{},C=K.useCallback(k=>{w&&uM?uM(()=>b(k)):b(k)},[b,w]);return K.useLayoutEffect(()=>h.listen(C),[h,C]),K.useEffect(()=>GV(o),[o]),K.createElement(qV,{basename:t,children:r,location:s.location,navigationType:s.action,navigator:h,future:o})}const tU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xl=K.forwardRef(function(t,r){let{onClick:o,relative:u,reloadDocument:d,replace:h,state:s,target:b,to:w,preventScrollReset:C,viewTransition:k}=t,I=WV(t,YV),{basename:A}=K.useContext(ah),B,F=!1;if(typeof w=="string"&&rU.test(w)&&(B=w,tU))try{let U=new URL(window.location.href),ne=w.startsWith("//")?new URL(U.protocol+w):new URL(w),de=ES(ne.pathname,A);ne.origin===U.origin&&de!=null?w=de+ne.search+ne.hash:F=!0}catch{}let X=kV(w,{relative:u}),q=nU(w,{replace:h,state:s,target:b,preventScrollReset:C,relative:u,viewTransition:k});function V(U){o&&o(U),U.defaultPrevented||q(U)}return K.createElement("a",Dw({},I,{href:B||X,onClick:F||d?o:V,ref:r,target:b}))});var hM;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(hM||(hM={}));var dM;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(dM||(dM={}));function nU(e,t){let{target:r,replace:o,state:u,preventScrollReset:d,relative:h,viewTransition:s}=t===void 0?{}:t,b=kS(),w=ch(),C=AL(e,{relative:h});return K.useCallback(k=>{if(KV(k,r)){k.preventDefault();let I=o!==void 0?o:C0(w)===C0(C);b(e,{replace:I,state:u,preventScrollReset:d,relative:h,viewTransition:s})}},[w,b,C,o,u,r,e,d,h,s])}function iU(e){let t=K.useRef(zw(e)),r=K.useRef(!1),o=ch(),u=K.useMemo(()=>XV(o.search,r.current?null:t.current),[o.search]),d=kS(),h=K.useCallback((s,b)=>{const w=zw(typeof s=="function"?s(u):s);r.current=!0,d("?"+w,b)},[d,u]);return[u,h]}const oU=mg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ar=K.forwardRef(({className:e,variant:t,size:r,asChild:o=!1,...u},d)=>{const h=o?TF:"button";return j.jsx(h,{className:Tn(oU({variant:t,size:r,className:e})),ref:d,...u})});ar.displayName="Button";const DL=K.createContext(void 0),sU={pt:{"nav.home":"Início","nav.map":"Mapa","nav.gallery":"Galeria","nav.routeCreator":"Criar Rota","home.title":"Techno Sutra","home.subtitle":"A jornada espiritual ancestral encontra a tecnologia cyberpunk. Explore os 56 capítulos sagrados do Sutra Stem Array em uma experiência imersiva única.","home.startJourney":"Iniciar Jornada","home.exploreGallery":"Explorar Galeria","home.originalRoute":"Rota Original","home.originalRouteDesc":"Explore os 56 pontos sagrados da peregrinação original em Águas da Prata, SP","home.gallery3d":"Galeria 3D","home.gallery3dDesc":"Visualize os personagens místicos em realidade aumentada","home.createRoute":"Criar Rota","home.createRouteDesc":"Crie sua própria jornada espiritual em qualquer lugar do mundo","home.journeyNumbers":"A Jornada em Números","home.sacredChapters":"Capítulos Sagrados","home.models3d":"Modelos 3D","home.possibleRoutes":"Rotas Possíveis","home.spiritualDestination":"Destino Espiritual","home.readyToStart":"Pronto para Começar?","home.readyToStartDesc":"Embarque em uma jornada que transcende tempo e espaço. O caminho da iluminação aguarda.","home.startPilgrimage":"Iniciar Peregrinação Sagrada","map.technoSutra":"Techno Sutra","map.originalRoute":"Rota Sagrada Original","map.location":"Águas da Prata, SP","map.searchChapter":"Buscar personagem ou capítulo...","map.shadowsMode":"Modo Sombras","map.cyberpunkMode":"Modo Cyberpunk","map.neuralNetwork":"Neural Network","map.points":"Pontos","map.filtered":"Filtrados","map.located":"Localizado","map.flyToLocation":"Voar para Local","map.view3dModel":"Ver Modelo 3D","map.readChapter":"Ler Capítulo","map.viewQrCode":"Ver QR Code","map.meaning":"Significado","gallery.title":"Galeria de Personagens 3D","gallery.subtitle":"Explore os personagens místicos do Sutra Stem Array","gallery.search":"Buscar personagens, ocupações, locais...","gallery.all":"Todos","gallery.viewIn3d":"Ver em 3D","gallery.meaning":"Significado","modelViewer.back":"Voltar","modelViewer.reset":"Reset","modelViewer.download":"Download","modelViewer.loading":"Carregando Modelo 3D...","modelViewer.controls":"Controles: Arraste para rotacionar • Scroll para zoom • Clique duplo para focar","modelViewer.partOf":"Modelo 3D do {title} - Parte da jornada sagrada Techno Sutra","common.loading":"Carregando...","common.error":"Erro","common.chapter":"Capítulo","common.occupation":"Ocupação","common.location":"Local","common.teaching":"Ensinamento"},en:{"nav.home":"Home","nav.map":"Map","nav.gallery":"Gallery","nav.routeCreator":"Create Route","home.title":"Techno Sutra","home.subtitle":"Ancient spiritual journey meets cyberpunk technology. Explore the 56 sacred chapters of the Stem Array Sutra in a unique immersive experience.","home.startJourney":"Start Journey","home.exploreGallery":"Explore Gallery","home.originalRoute":"Original Route","home.originalRouteDesc":"Explore the 56 sacred points of the original pilgrimage in Águas da Prata, SP","home.gallery3d":"3D Gallery","home.gallery3dDesc":"Visualize mystical characters in augmented reality","home.createRoute":"Create Route","home.createRouteDesc":"Create your own spiritual journey anywhere in the world","home.journeyNumbers":"The Journey in Numbers","home.sacredChapters":"Sacred Chapters","home.models3d":"3D Models","home.possibleRoutes":"Possible Routes","home.spiritualDestination":"Spiritual Destination","home.readyToStart":"Ready to Begin?","home.readyToStartDesc":"Embark on a journey that transcends time and space. The path to enlightenment awaits.","home.startPilgrimage":"Start Sacred Pilgrimage","map.technoSutra":"Techno Sutra","map.originalRoute":"Original Sacred Route","map.location":"Águas da Prata, SP","map.searchChapter":"Search character or chapter...","map.shadowsMode":"Shadows Mode","map.cyberpunkMode":"Cyberpunk Mode","map.neuralNetwork":"Neural Network","map.points":"Points","map.filtered":"Filtered","map.located":"Located","map.flyToLocation":"Fly to Location","map.view3dModel":"View 3D Model","map.readChapter":"Read Chapter","map.viewQrCode":"View QR Code","map.meaning":"Meaning","gallery.title":"3D Characters Gallery","gallery.subtitle":"Explore the mystical characters of the Stem Array Sutra","gallery.search":"Search characters, occupations, locations...","gallery.all":"All","gallery.viewIn3d":"View in 3D","gallery.meaning":"Meaning","modelViewer.back":"Back","modelViewer.reset":"Reset","modelViewer.download":"Download","modelViewer.loading":"Loading 3D Model...","modelViewer.controls":"Controls: Drag to rotate • Scroll to zoom • Double-click to focus","modelViewer.partOf":"3D model of {title} - Part of the sacred Techno Sutra journey","common.loading":"Loading...","common.error":"Error","common.chapter":"Chapter","common.occupation":"Occupation","common.location":"Location","common.teaching":"Teaching"}},aU=({children:e})=>{const[t,r]=K.useState("pt"),o=u=>{const d=u.split(".");let h=sU[t];for(const s of d)h=h==null?void 0:h[s];return h||u};return j.jsx(DL.Provider,{value:{language:t,setLanguage:r,t:o},children:e})},zL=()=>{const e=K.useContext(DL);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e},pM=()=>{const{language:e,setLanguage:t}=zL();return j.jsxs(ar,{variant:"ghost",size:"sm",onClick:()=>t(e==="pt"?"en":"pt"),className:"text-muted-foreground hover:text-primary transition-colors",children:[j.jsx(_B,{className:"w-4 h-4 mr-2"}),e==="pt"?"EN":"PT"]})},ri=K.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));ri.displayName="Card";const lU=K.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tn("flex flex-col space-y-1.5 p-6",e),...t}));lU.displayName="CardHeader";const cU=K.forwardRef(({className:e,...t},r)=>j.jsx("h3",{ref:r,className:Tn("text-2xl font-semibold leading-none tracking-tight",e),...t}));cU.displayName="CardTitle";const uU=K.forwardRef(({className:e,...t},r)=>j.jsx("p",{ref:r,className:Tn("text-sm text-muted-foreground",e),...t}));uU.displayName="CardDescription";const hU=K.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tn("p-6 pt-0",e),...t}));hU.displayName="CardContent";const dU=K.forwardRef(({className:e,...t},r)=>j.jsx("div",{ref:r,className:Tn("flex items-center p-6 pt-0",e),...t}));dU.displayName="CardFooter";const NL=K.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),v_=K.createContext({}),__=K.createContext(null),x_=typeof document<"u",AS=x_?K.useLayoutEffect:K.useEffect,jL=K.createContext({strict:!1}),IS=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),pU="framerAppearId",OL="data-"+IS(pU);function fU(e,t,r,o){const{visualElement:u}=K.useContext(v_),d=K.useContext(jL),h=K.useContext(__),s=K.useContext(NL).reducedMotion,b=K.useRef();o=o||d.renderer,!b.current&&o&&(b.current=o(e,{visualState:t,parent:u,props:r,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:s}));const w=b.current;K.useInsertionEffect(()=>{w&&w.update(r,h)});const C=K.useRef(!!(r[OL]&&!window.HandoffComplete));return AS(()=>{w&&(w.render(),C.current&&w.animationState&&w.animationState.animateChanges())}),K.useEffect(()=>{w&&(w.updateFeatures(),!C.current&&w.animationState&&w.animationState.animateChanges(),C.current&&(C.current=!1,window.HandoffComplete=!0))}),w}function Md(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function mU(e,t,r){return K.useCallback(o=>{o&&e.mount&&e.mount(o),t&&(o?t.mount(o):t.unmount()),r&&(typeof r=="function"?r(o):Md(r)&&(r.current=o))},[t])}function Zm(e){return typeof e=="string"||Array.isArray(e)}function b_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const RS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],LS=["initial",...RS];function w_(e){return b_(e.animate)||LS.some(t=>Zm(e[t]))}function FL(e){return!!(w_(e)||e.variants)}function gU(e,t){if(w_(e)){const{initial:r,animate:o}=e;return{initial:r===!1||Zm(r)?r:void 0,animate:Zm(o)?o:void 0}}return e.inherit!==!1?t:{}}function yU(e){const{initial:t,animate:r}=gU(e,K.useContext(v_));return K.useMemo(()=>({initial:t,animate:r}),[fM(t),fM(r)])}function fM(e){return Array.isArray(e)?e.join(" "):e}const mM={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Wm={};for(const e in mM)Wm[e]={isEnabled:t=>mM[e].some(r=>!!t[r])};function vU(e){for(const t in e)Wm[t]={...Wm[t],...e[t]}}const DS=K.createContext({}),BL=K.createContext({}),_U=Symbol.for("motionComponentSymbol");function xU({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:o,Component:u}){e&&vU(e);function d(s,b){let w;const C={...K.useContext(NL),...s,layoutId:bU(s)},{isStatic:k}=C,I=yU(s),A=o(s,k);if(!k&&x_){I.visualElement=fU(u,A,C,t);const B=K.useContext(BL),F=K.useContext(jL).strict;I.visualElement&&(w=I.visualElement.loadFeatures(C,F,e,B))}return K.createElement(v_.Provider,{value:I},w&&I.visualElement?K.createElement(w,{visualElement:I.visualElement,...C}):null,r(u,s,mU(A,I.visualElement,b),A,k,I.visualElement))}const h=K.forwardRef(d);return h[_U]=u,h}function bU({layoutId:e}){const t=K.useContext(DS).id;return t&&e!==void 0?t+"-"+e:e}function wU(e){function t(o,u={}){return xU(e(o,u))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(o,u)=>(r.has(u)||r.set(u,t(u)),r.get(u))})}const SU=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zS(e){return typeof e!="string"||e.includes("-")?!1:!!(SU.indexOf(e)>-1||/[A-Z]/.test(e))}const P0={};function TU(e){Object.assign(P0,e)}const vg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],uh=new Set(vg);function $L(e,{layout:t,layoutId:r}){return uh.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!P0[e]||e==="opacity")}const so=e=>!!(e&&e.getVelocity),CU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PU=vg.length;function EU(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},o,u){let d="";for(let h=0;h<PU;h++){const s=vg[h];if(e[s]!==void 0){const b=CU[s]||s;d+=`${b}(${e[s]}) `}}return t&&!e.z&&(d+="translateZ(0)"),d=d.trim(),u?d=u(e,o?"":d):r&&o&&(d="none"),d}const VL=e=>t=>typeof t=="string"&&t.startsWith(e),UL=VL("--"),Nw=VL("var(--"),MU=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,kU=(e,t)=>t&&typeof e=="number"?t.transform(e):e,bc=(e,t,r)=>Math.min(Math.max(r,e),t),hh={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},pm={...hh,transform:e=>bc(0,1,e)},sv={...hh,default:1},fm=e=>Math.round(e*1e5)/1e5,S_=/(-)?([\d]*\.?[\d])+/g,GL=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,AU=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function _g(e){return typeof e=="string"}const xg=e=>({test:t=>_g(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ul=xg("deg"),da=xg("%"),Ft=xg("px"),IU=xg("vh"),RU=xg("vw"),gM={...da,parse:e=>da.parse(e)/100,transform:e=>da.transform(e*100)},yM={...hh,transform:Math.round},qL={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Ul,rotateX:Ul,rotateY:Ul,rotateZ:Ul,scale:sv,scaleX:sv,scaleY:sv,scaleZ:sv,skew:Ul,skewX:Ul,skewY:Ul,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:pm,originX:gM,originY:gM,originZ:Ft,zIndex:yM,fillOpacity:pm,strokeOpacity:pm,numOctaves:yM};function NS(e,t,r,o){const{style:u,vars:d,transform:h,transformOrigin:s}=e;let b=!1,w=!1,C=!0;for(const k in t){const I=t[k];if(UL(k)){d[k]=I;continue}const A=qL[k],B=kU(I,A);if(uh.has(k)){if(b=!0,h[k]=B,!C)continue;I!==(A.default||0)&&(C=!1)}else k.startsWith("origin")?(w=!0,s[k]=B):u[k]=B}if(t.transform||(b||o?u.transform=EU(e.transform,r,C,o):u.transform&&(u.transform="none")),w){const{originX:k="50%",originY:I="50%",originZ:A=0}=s;u.transformOrigin=`${k} ${I} ${A}`}}const jS=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ZL(e,t,r){for(const o in t)!so(t[o])&&!$L(o,r)&&(e[o]=t[o])}function LU({transformTemplate:e},t,r){return K.useMemo(()=>{const o=jS();return NS(o,t,{enableHardwareAcceleration:!r},e),Object.assign({},o.vars,o.style)},[t])}function DU(e,t,r){const o=e.style||{},u={};return ZL(u,o,e),Object.assign(u,LU(e,t,r)),e.transformValues?e.transformValues(u):u}function zU(e,t,r){const o={},u=DU(e,t,r);return e.drag&&e.dragListener!==!1&&(o.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(o.tabIndex=0),o.style=u,o}const NU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function E0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||NU.has(e)}let WL=e=>!E0(e);function jU(e){e&&(WL=t=>t.startsWith("on")?!E0(t):e(t))}try{jU(require("@emotion/is-prop-valid").default)}catch{}function OU(e,t,r){const o={};for(const u in e)u==="values"&&typeof e.values=="object"||(WL(u)||r===!0&&E0(u)||!t&&!E0(u)||e.draggable&&u.startsWith("onDrag"))&&(o[u]=e[u]);return o}function vM(e,t,r){return typeof e=="string"?e:Ft.transform(t+r*e)}function FU(e,t,r){const o=vM(t,e.x,e.width),u=vM(r,e.y,e.height);return`${o} ${u}`}const BU={offset:"stroke-dashoffset",array:"stroke-dasharray"},$U={offset:"strokeDashoffset",array:"strokeDasharray"};function VU(e,t,r=1,o=0,u=!0){e.pathLength=1;const d=u?BU:$U;e[d.offset]=Ft.transform(-o);const h=Ft.transform(t),s=Ft.transform(r);e[d.array]=`${h} ${s}`}function OS(e,{attrX:t,attrY:r,attrScale:o,originX:u,originY:d,pathLength:h,pathSpacing:s=1,pathOffset:b=0,...w},C,k,I){if(NS(e,w,C,I),k){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:A,style:B,dimensions:F}=e;A.transform&&(F&&(B.transform=A.transform),delete A.transform),F&&(u!==void 0||d!==void 0||B.transform)&&(B.transformOrigin=FU(F,u!==void 0?u:.5,d!==void 0?d:.5)),t!==void 0&&(A.x=t),r!==void 0&&(A.y=r),o!==void 0&&(A.scale=o),h!==void 0&&VU(A,h,s,b,!1)}const HL=()=>({...jS(),attrs:{}}),FS=e=>typeof e=="string"&&e.toLowerCase()==="svg";function UU(e,t,r,o){const u=K.useMemo(()=>{const d=HL();return OS(d,t,{enableHardwareAcceleration:!1},FS(o),e.transformTemplate),{...d.attrs,style:{...d.style}}},[t]);if(e.style){const d={};ZL(d,e.style,e),u.style={...d,...u.style}}return u}function GU(e=!1){return(r,o,u,{latestValues:d},h)=>{const b=(zS(r)?UU:zU)(o,d,h,r),C={...OU(o,typeof r=="string",e),...b,ref:u},{children:k}=o,I=K.useMemo(()=>so(k)?k.get():k,[k]);return K.createElement(r,{...C,children:I})}}function KL(e,{style:t,vars:r},o,u){Object.assign(e.style,t,u&&u.getProjectionStyles(o));for(const d in r)e.style.setProperty(d,r[d])}const XL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function YL(e,t,r,o){KL(e,t,void 0,o);for(const u in t.attrs)e.setAttribute(XL.has(u)?u:IS(u),t.attrs[u])}function BS(e,t){const{style:r}=e,o={};for(const u in r)(so(r[u])||t.style&&so(t.style[u])||$L(u,e))&&(o[u]=r[u]);return o}function QL(e,t){const r=BS(e,t);for(const o in e)if(so(e[o])||so(t[o])){const u=vg.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[u]=e[o]}return r}function $S(e,t,r,o={},u={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,o,u)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,o,u)),t}function JL(e){const t=K.useRef(null);return t.current===null&&(t.current=e()),t.current}const M0=e=>Array.isArray(e),qU=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ZU=e=>M0(e)?e[e.length-1]||0:e;function Nv(e){const t=so(e)?e.get():e;return qU(t)?t.toValue():t}function WU({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},o,u,d){const h={latestValues:HU(o,u,d,e),renderState:t()};return r&&(h.mount=s=>r(o,s,h)),h}const eD=e=>(t,r)=>{const o=K.useContext(v_),u=K.useContext(__),d=()=>WU(e,t,o,u);return r?d():JL(d)};function HU(e,t,r,o){const u={},d=o(e,{});for(const I in d)u[I]=Nv(d[I]);let{initial:h,animate:s}=e;const b=w_(e),w=FL(e);t&&w&&!b&&e.inherit!==!1&&(h===void 0&&(h=t.initial),s===void 0&&(s=t.animate));let C=r?r.initial===!1:!1;C=C||h===!1;const k=C?s:h;return k&&typeof k!="boolean"&&!b_(k)&&(Array.isArray(k)?k:[k]).forEach(A=>{const B=$S(e,A);if(!B)return;const{transitionEnd:F,transition:X,...q}=B;for(const V in q){let U=q[V];if(Array.isArray(U)){const ne=C?U.length-1:0;U=U[ne]}U!==null&&(u[V]=U)}for(const V in F)u[V]=F[V]}),u}const wn=e=>e;class _M{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function KU(e){let t=new _M,r=new _M,o=0,u=!1,d=!1;const h=new WeakSet,s={schedule:(b,w=!1,C=!1)=>{const k=C&&u,I=k?t:r;return w&&h.add(b),I.add(b)&&k&&u&&(o=t.order.length),b},cancel:b=>{r.remove(b),h.delete(b)},process:b=>{if(u){d=!0;return}if(u=!0,[t,r]=[r,t],r.clear(),o=t.order.length,o)for(let w=0;w<o;w++){const C=t.order[w];C(b),h.has(C)&&(s.schedule(C),e())}u=!1,d&&(d=!1,s.process(b))}};return s}const av=["prepare","read","update","preRender","render","postRender"],XU=40;function YU(e,t){let r=!1,o=!0;const u={delta:0,timestamp:0,isProcessing:!1},d=av.reduce((k,I)=>(k[I]=KU(()=>r=!0),k),{}),h=k=>d[k].process(u),s=()=>{const k=performance.now();r=!1,u.delta=o?1e3/60:Math.max(Math.min(k-u.timestamp,XU),1),u.timestamp=k,u.isProcessing=!0,av.forEach(h),u.isProcessing=!1,r&&t&&(o=!1,e(s))},b=()=>{r=!0,o=!0,u.isProcessing||e(s)};return{schedule:av.reduce((k,I)=>{const A=d[I];return k[I]=(B,F=!1,X=!1)=>(r||b(),A.schedule(B,F,X)),k},{}),cancel:k=>av.forEach(I=>d[I].cancel(k)),state:u,steps:d}}const{schedule:$r,cancel:nl,state:Mi,steps:U1}=YU(typeof requestAnimationFrame<"u"?requestAnimationFrame:wn,!0),QU={useVisualState:eD({scrapeMotionValuesFromProps:QL,createRenderState:HL,onMount:(e,t,{renderState:r,latestValues:o})=>{$r.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),$r.render(()=>{OS(r,o,{enableHardwareAcceleration:!1},FS(t.tagName),e.transformTemplate),YL(t,r)})}})},JU={useVisualState:eD({scrapeMotionValuesFromProps:BS,createRenderState:jS})};function e7(e,{forwardMotionProps:t=!1},r,o){return{...zS(e)?QU:JU,preloadedFeatures:r,useRender:GU(t),createVisualElement:o,Component:e}}function Ga(e,t,r,o={passive:!0}){return e.addEventListener(t,r,o),()=>e.removeEventListener(t,r)}const tD=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function T_(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const t7=e=>t=>tD(t)&&e(t,T_(t));function Za(e,t,r,o){return Ga(e,t,t7(r),o)}const r7=(e,t)=>r=>t(e(r)),gc=(...e)=>e.reduce(r7);function rD(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const xM=rD("dragHorizontal"),bM=rD("dragVertical");function nD(e){let t=!1;if(e==="y")t=bM();else if(e==="x")t=xM();else{const r=xM(),o=bM();r&&o?t=()=>{r(),o()}:(r&&r(),o&&o())}return t}function iD(){const e=nD(!0);return e?(e(),!1):!0}class Pc{constructor(t){this.isMounted=!1,this.node=t}update(){}}function wM(e,t){const r="pointer"+(t?"enter":"leave"),o="onHover"+(t?"Start":"End"),u=(d,h)=>{if(d.pointerType==="touch"||iD())return;const s=e.getProps();e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",t),s[o]&&$r.update(()=>s[o](d,h))};return Za(e.current,r,u,{passive:!e.getProps()[o]})}class n7 extends Pc{mount(){this.unmount=gc(wM(this.node,!0),wM(this.node,!1))}unmount(){}}class i7 extends Pc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gc(Ga(this.node.current,"focus",()=>this.onFocus()),Ga(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const oD=(e,t)=>t?e===t?!0:oD(e,t.parentElement):!1;function G1(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,T_(r))}class o7 extends Pc{constructor(){super(...arguments),this.removeStartListeners=wn,this.removeEndListeners=wn,this.removeAccessibleListeners=wn,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const o=this.node.getProps(),d=Za(window,"pointerup",(s,b)=>{if(!this.checkPressEnd())return;const{onTap:w,onTapCancel:C,globalTapTarget:k}=this.node.getProps();$r.update(()=>{!k&&!oD(this.node.current,s.target)?C&&C(s,b):w&&w(s,b)})},{passive:!(o.onTap||o.onPointerUp)}),h=Za(window,"pointercancel",(s,b)=>this.cancelPress(s,b),{passive:!(o.onTapCancel||o.onPointerCancel)});this.removeEndListeners=gc(d,h),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=d=>{if(d.key!=="Enter"||this.isPressing)return;const h=s=>{s.key!=="Enter"||!this.checkPressEnd()||G1("up",(b,w)=>{const{onTap:C}=this.node.getProps();C&&$r.update(()=>C(b,w))})};this.removeEndListeners(),this.removeEndListeners=Ga(this.node.current,"keyup",h),G1("down",(s,b)=>{this.startPress(s,b)})},r=Ga(this.node.current,"keydown",t),o=()=>{this.isPressing&&G1("cancel",(d,h)=>this.cancelPress(d,h))},u=Ga(this.node.current,"blur",o);this.removeAccessibleListeners=gc(r,u)}}startPress(t,r){this.isPressing=!0;const{onTapStart:o,whileTap:u}=this.node.getProps();u&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),o&&$r.update(()=>o(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!iD()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:o}=this.node.getProps();o&&$r.update(()=>o(t,r))}mount(){const t=this.node.getProps(),r=Za(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),o=Ga(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=gc(r,o)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const jw=new WeakMap,q1=new WeakMap,s7=e=>{const t=jw.get(e.target);t&&t(e)},a7=e=>{e.forEach(s7)};function l7({root:e,...t}){const r=e||document;q1.has(r)||q1.set(r,{});const o=q1.get(r),u=JSON.stringify(t);return o[u]||(o[u]=new IntersectionObserver(a7,{root:e,...t})),o[u]}function c7(e,t,r){const o=l7(t);return jw.set(e,r),o.observe(e),()=>{jw.delete(e),o.unobserve(e)}}const u7={some:0,all:1};class h7 extends Pc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:o,amount:u="some",once:d}=t,h={root:r?r.current:void 0,rootMargin:o,threshold:typeof u=="number"?u:u7[u]},s=b=>{const{isIntersecting:w}=b;if(this.isInView===w||(this.isInView=w,d&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:C,onViewportLeave:k}=this.node.getProps(),I=w?C:k;I&&I(b)};return c7(this.node.current,h,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(d7(t,r))&&this.startObserver()}unmount(){}}function d7({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const p7={inView:{Feature:h7},tap:{Feature:o7},focus:{Feature:i7},hover:{Feature:n7}};function sD(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let o=0;o<r;o++)if(t[o]!==e[o])return!1;return!0}function f7(e){const t={};return e.values.forEach((r,o)=>t[o]=r.get()),t}function m7(e){const t={};return e.values.forEach((r,o)=>t[o]=r.getVelocity()),t}function C_(e,t,r){const o=e.getProps();return $S(o,t,r!==void 0?r:o.custom,f7(e),m7(e))}let VS=wn;const Uu=e=>e*1e3,Wa=e=>e/1e3,g7={current:!1},aD=e=>Array.isArray(e)&&typeof e[0]=="number";function lD(e){return!!(!e||typeof e=="string"&&cD[e]||aD(e)||Array.isArray(e)&&e.every(lD))}const em=([e,t,r,o])=>`cubic-bezier(${e}, ${t}, ${r}, ${o})`,cD={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:em([0,.65,.55,1]),circOut:em([.55,0,1,.45]),backIn:em([.31,.01,.66,-.59]),backOut:em([.33,1.53,.69,.99])};function uD(e){if(e)return aD(e)?em(e):Array.isArray(e)?e.map(uD):cD[e]}function y7(e,t,r,{delay:o=0,duration:u,repeat:d=0,repeatType:h="loop",ease:s,times:b}={}){const w={[t]:r};b&&(w.offset=b);const C=uD(s);return Array.isArray(C)&&(w.easing=C),e.animate(w,{delay:o,duration:u,easing:Array.isArray(C)?"linear":C,fill:"both",iterations:d+1,direction:h==="reverse"?"alternate":"normal"})}function v7(e,{repeat:t,repeatType:r="loop"}){const o=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[o]}const hD=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,_7=1e-7,x7=12;function b7(e,t,r,o,u){let d,h,s=0;do h=t+(r-t)/2,d=hD(h,o,u)-e,d>0?r=h:t=h;while(Math.abs(d)>_7&&++s<x7);return h}function bg(e,t,r,o){if(e===t&&r===o)return wn;const u=d=>b7(d,0,1,e,r);return d=>d===0||d===1?d:hD(u(d),t,o)}const w7=bg(.42,0,1,1),S7=bg(0,0,.58,1),dD=bg(.42,0,.58,1),T7=e=>Array.isArray(e)&&typeof e[0]!="number",pD=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,fD=e=>t=>1-e(1-t),US=e=>1-Math.sin(Math.acos(e)),mD=fD(US),C7=pD(US),gD=bg(.33,1.53,.69,.99),GS=fD(gD),P7=pD(GS),E7=e=>(e*=2)<1?.5*GS(e):.5*(2-Math.pow(2,-10*(e-1))),M7={linear:wn,easeIn:w7,easeInOut:dD,easeOut:S7,circIn:US,circInOut:C7,circOut:mD,backIn:GS,backInOut:P7,backOut:gD,anticipate:E7},SM=e=>{if(Array.isArray(e)){VS(e.length===4);const[t,r,o,u]=e;return bg(t,r,o,u)}else if(typeof e=="string")return M7[e];return e},qS=(e,t)=>r=>!!(_g(r)&&AU.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),yD=(e,t,r)=>o=>{if(!_g(o))return o;const[u,d,h,s]=o.match(S_);return{[e]:parseFloat(u),[t]:parseFloat(d),[r]:parseFloat(h),alpha:s!==void 0?parseFloat(s):1}},k7=e=>bc(0,255,e),Z1={...hh,transform:e=>Math.round(k7(e))},Lu={test:qS("rgb","red"),parse:yD("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:o=1})=>"rgba("+Z1.transform(e)+", "+Z1.transform(t)+", "+Z1.transform(r)+", "+fm(pm.transform(o))+")"};function A7(e){let t="",r="",o="",u="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),o=e.substring(5,7),u=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),o=e.substring(3,4),u=e.substring(4,5),t+=t,r+=r,o+=o,u+=u),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(o,16),alpha:u?parseInt(u,16)/255:1}}const Ow={test:qS("#"),parse:A7,transform:Lu.transform},kd={test:qS("hsl","hue"),parse:yD("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:o=1})=>"hsla("+Math.round(e)+", "+da.transform(fm(t))+", "+da.transform(fm(r))+", "+fm(pm.transform(o))+")"},$i={test:e=>Lu.test(e)||Ow.test(e)||kd.test(e),parse:e=>Lu.test(e)?Lu.parse(e):kd.test(e)?kd.parse(e):Ow.parse(e),transform:e=>_g(e)?e:e.hasOwnProperty("red")?Lu.transform(e):kd.transform(e)},an=(e,t,r)=>-r*e+r*t+e;function W1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function I7({hue:e,saturation:t,lightness:r,alpha:o}){e/=360,t/=100,r/=100;let u=0,d=0,h=0;if(!t)u=d=h=r;else{const s=r<.5?r*(1+t):r+t-r*t,b=2*r-s;u=W1(b,s,e+1/3),d=W1(b,s,e),h=W1(b,s,e-1/3)}return{red:Math.round(u*255),green:Math.round(d*255),blue:Math.round(h*255),alpha:o}}const H1=(e,t,r)=>{const o=e*e;return Math.sqrt(Math.max(0,r*(t*t-o)+o))},R7=[Ow,Lu,kd],L7=e=>R7.find(t=>t.test(e));function TM(e){const t=L7(e);let r=t.parse(e);return t===kd&&(r=I7(r)),r}const vD=(e,t)=>{const r=TM(e),o=TM(t),u={...r};return d=>(u.red=H1(r.red,o.red,d),u.green=H1(r.green,o.green,d),u.blue=H1(r.blue,o.blue,d),u.alpha=an(r.alpha,o.alpha,d),Lu.transform(u))};function D7(e){var t,r;return isNaN(e)&&_g(e)&&(((t=e.match(S_))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(GL))===null||r===void 0?void 0:r.length)||0)>0}const _D={regex:MU,countKey:"Vars",token:"${v}",parse:wn},xD={regex:GL,countKey:"Colors",token:"${c}",parse:$i.parse},bD={regex:S_,countKey:"Numbers",token:"${n}",parse:hh.parse};function K1(e,{regex:t,countKey:r,token:o,parse:u}){const d=e.tokenised.match(t);d&&(e["num"+r]=d.length,e.tokenised=e.tokenised.replace(t,o),e.values.push(...d.map(u)))}function k0(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&K1(r,_D),K1(r,xD),K1(r,bD),r}function wD(e){return k0(e).values}function SD(e){const{values:t,numColors:r,numVars:o,tokenised:u}=k0(e),d=t.length;return h=>{let s=u;for(let b=0;b<d;b++)b<o?s=s.replace(_D.token,h[b]):b<o+r?s=s.replace(xD.token,$i.transform(h[b])):s=s.replace(bD.token,fm(h[b]));return s}}const z7=e=>typeof e=="number"?0:e;function N7(e){const t=wD(e);return SD(e)(t.map(z7))}const wc={test:D7,parse:wD,createTransformer:SD,getAnimatableNone:N7},TD=(e,t)=>r=>`${r>0?t:e}`;function CD(e,t){return typeof e=="number"?r=>an(e,t,r):$i.test(e)?vD(e,t):e.startsWith("var(")?TD(e,t):ED(e,t)}const PD=(e,t)=>{const r=[...e],o=r.length,u=e.map((d,h)=>CD(d,t[h]));return d=>{for(let h=0;h<o;h++)r[h]=u[h](d);return r}},j7=(e,t)=>{const r={...e,...t},o={};for(const u in r)e[u]!==void 0&&t[u]!==void 0&&(o[u]=CD(e[u],t[u]));return u=>{for(const d in o)r[d]=o[d](u);return r}},ED=(e,t)=>{const r=wc.createTransformer(t),o=k0(e),u=k0(t);return o.numVars===u.numVars&&o.numColors===u.numColors&&o.numNumbers>=u.numNumbers?gc(PD(o.values,u.values),r):TD(e,t)},Hm=(e,t,r)=>{const o=t-e;return o===0?1:(r-e)/o},CM=(e,t)=>r=>an(e,t,r);function O7(e){return typeof e=="number"?CM:typeof e=="string"?$i.test(e)?vD:ED:Array.isArray(e)?PD:typeof e=="object"?j7:CM}function F7(e,t,r){const o=[],u=r||O7(e[0]),d=e.length-1;for(let h=0;h<d;h++){let s=u(e[h],e[h+1]);if(t){const b=Array.isArray(t)?t[h]||wn:t;s=gc(b,s)}o.push(s)}return o}function MD(e,t,{clamp:r=!0,ease:o,mixer:u}={}){const d=e.length;if(VS(d===t.length),d===1)return()=>t[0];e[0]>e[d-1]&&(e=[...e].reverse(),t=[...t].reverse());const h=F7(t,o,u),s=h.length,b=w=>{let C=0;if(s>1)for(;C<e.length-2&&!(w<e[C+1]);C++);const k=Hm(e[C],e[C+1],w);return h[C](k)};return r?w=>b(bc(e[0],e[d-1],w)):b}function B7(e,t){const r=e[e.length-1];for(let o=1;o<=t;o++){const u=Hm(0,t,o);e.push(an(r,1,u))}}function $7(e){const t=[0];return B7(t,e.length-1),t}function V7(e,t){return e.map(r=>r*t)}function U7(e,t){return e.map(()=>t||dD).splice(0,e.length-1)}function A0({duration:e=300,keyframes:t,times:r,ease:o="easeInOut"}){const u=T7(o)?o.map(SM):SM(o),d={done:!1,value:t[0]},h=V7(r&&r.length===t.length?r:$7(t),e),s=MD(h,t,{ease:Array.isArray(u)?u:U7(t,u)});return{calculatedDuration:e,next:b=>(d.value=s(b),d.done=b>=e,d)}}function kD(e,t){return t?e*(1e3/t):0}const G7=5;function AD(e,t,r){const o=Math.max(t-G7,0);return kD(r-e(o),t-o)}const X1=.001,q7=.01,Z7=10,W7=.05,H7=1;function K7({duration:e=800,bounce:t=.25,velocity:r=0,mass:o=1}){let u,d,h=1-t;h=bc(W7,H7,h),e=bc(q7,Z7,Wa(e)),h<1?(u=w=>{const C=w*h,k=C*e,I=C-r,A=Fw(w,h),B=Math.exp(-k);return X1-I/A*B},d=w=>{const k=w*h*e,I=k*r+r,A=Math.pow(h,2)*Math.pow(w,2)*e,B=Math.exp(-k),F=Fw(Math.pow(w,2),h);return(-u(w)+X1>0?-1:1)*((I-A)*B)/F}):(u=w=>{const C=Math.exp(-w*e),k=(w-r)*e+1;return-X1+C*k},d=w=>{const C=Math.exp(-w*e),k=(r-w)*(e*e);return C*k});const s=5/e,b=Y7(u,d,s);if(e=Uu(e),isNaN(b))return{stiffness:100,damping:10,duration:e};{const w=Math.pow(b,2)*o;return{stiffness:w,damping:h*2*Math.sqrt(o*w),duration:e}}}const X7=12;function Y7(e,t,r){let o=r;for(let u=1;u<X7;u++)o=o-e(o)/t(o);return o}function Fw(e,t){return e*Math.sqrt(1-t*t)}const Q7=["duration","bounce"],J7=["stiffness","damping","mass"];function PM(e,t){return t.some(r=>e[r]!==void 0)}function e9(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!PM(e,J7)&&PM(e,Q7)){const r=K7(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function ID({keyframes:e,restDelta:t,restSpeed:r,...o}){const u=e[0],d=e[e.length-1],h={done:!1,value:u},{stiffness:s,damping:b,mass:w,duration:C,velocity:k,isResolvedFromDuration:I}=e9({...o,velocity:-Wa(o.velocity||0)}),A=k||0,B=b/(2*Math.sqrt(s*w)),F=d-u,X=Wa(Math.sqrt(s/w)),q=Math.abs(F)<5;r||(r=q?.01:2),t||(t=q?.005:.5);let V;if(B<1){const U=Fw(X,B);V=ne=>{const de=Math.exp(-B*X*ne);return d-de*((A+B*X*F)/U*Math.sin(U*ne)+F*Math.cos(U*ne))}}else if(B===1)V=U=>d-Math.exp(-X*U)*(F+(A+X*F)*U);else{const U=X*Math.sqrt(B*B-1);V=ne=>{const de=Math.exp(-B*X*ne),xe=Math.min(U*ne,300);return d-de*((A+B*X*F)*Math.sinh(xe)+U*F*Math.cosh(xe))/U}}return{calculatedDuration:I&&C||null,next:U=>{const ne=V(U);if(I)h.done=U>=C;else{let de=A;U!==0&&(B<1?de=AD(V,U,ne):de=0);const xe=Math.abs(de)<=r,ke=Math.abs(d-ne)<=t;h.done=xe&&ke}return h.value=h.done?d:ne,h}}}function EM({keyframes:e,velocity:t=0,power:r=.8,timeConstant:o=325,bounceDamping:u=10,bounceStiffness:d=500,modifyTarget:h,min:s,max:b,restDelta:w=.5,restSpeed:C}){const k=e[0],I={done:!1,value:k},A=ze=>s!==void 0&&ze<s||b!==void 0&&ze>b,B=ze=>s===void 0?b:b===void 0||Math.abs(s-ze)<Math.abs(b-ze)?s:b;let F=r*t;const X=k+F,q=h===void 0?X:h(X);q!==X&&(F=q-k);const V=ze=>-F*Math.exp(-ze/o),U=ze=>q+V(ze),ne=ze=>{const We=V(ze),rt=U(ze);I.done=Math.abs(We)<=w,I.value=I.done?q:rt};let de,xe;const ke=ze=>{A(I.value)&&(de=ze,xe=ID({keyframes:[I.value,B(I.value)],velocity:AD(U,ze,I.value),damping:u,stiffness:d,restDelta:w,restSpeed:C}))};return ke(0),{calculatedDuration:null,next:ze=>{let We=!1;return!xe&&de===void 0&&(We=!0,ne(ze),ke(ze)),de!==void 0&&ze>de?xe.next(ze-de):(!We&&ne(ze),I)}}}const t9=e=>{const t=({timestamp:r})=>e(r);return{start:()=>$r.update(t,!0),stop:()=>nl(t),now:()=>Mi.isProcessing?Mi.timestamp:performance.now()}},MM=2e4;function kM(e){let t=0;const r=50;let o=e.next(t);for(;!o.done&&t<MM;)t+=r,o=e.next(t);return t>=MM?1/0:t}const r9={decay:EM,inertia:EM,tween:A0,keyframes:A0,spring:ID};function I0({autoplay:e=!0,delay:t=0,driver:r=t9,keyframes:o,type:u="keyframes",repeat:d=0,repeatDelay:h=0,repeatType:s="loop",onPlay:b,onStop:w,onComplete:C,onUpdate:k,...I}){let A=1,B=!1,F,X;const q=()=>{X=new Promise(nt=>{F=nt})};q();let V;const U=r9[u]||A0;let ne;U!==A0&&typeof o[0]!="number"&&(ne=MD([0,100],o,{clamp:!1}),o=[0,100]);const de=U({...I,keyframes:o});let xe;s==="mirror"&&(xe=U({...I,keyframes:[...o].reverse(),velocity:-(I.velocity||0)}));let ke="idle",ze=null,We=null,rt=null;de.calculatedDuration===null&&d&&(de.calculatedDuration=kM(de));const{calculatedDuration:Ze}=de;let He=1/0,Ct=1/0;Ze!==null&&(He=Ze+h,Ct=He*(d+1)-h);let st=0;const Ge=nt=>{if(We===null)return;A>0&&(We=Math.min(We,nt)),A<0&&(We=Math.min(nt-Ct/A,We)),ze!==null?st=ze:st=Math.round(nt-We)*A;const ot=st-t*(A>=0?1:-1),Et=A>=0?ot<0:ot>Ct;st=Math.max(ot,0),ke==="finished"&&ze===null&&(st=Ct);let Rt=st,lr=de;if(d){const yr=Math.min(st,Ct)/He;let Cn=Math.floor(yr),br=yr%1;!br&&yr>=1&&(br=1),br===1&&Cn--,Cn=Math.min(Cn,d+1),!!(Cn%2)&&(s==="reverse"?(br=1-br,h&&(br-=h/He)):s==="mirror"&&(lr=xe)),Rt=bc(0,1,br)*He}const gr=Et?{done:!1,value:o[0]}:lr.next(Rt);ne&&(gr.value=ne(gr.value));let{done:Xt}=gr;!Et&&Ze!==null&&(Xt=A>=0?st>=Ct:st<=0);const Ii=ze===null&&(ke==="finished"||ke==="running"&&Xt);return k&&k(gr.value),Ii&&Ve(),gr},tt=()=>{V&&V.stop(),V=void 0},ut=()=>{ke="idle",tt(),F(),q(),We=rt=null},Ve=()=>{ke="finished",C&&C(),tt(),F()},De=()=>{if(B)return;V||(V=r(Ge));const nt=V.now();b&&b(),ze!==null?We=nt-ze:(!We||ke==="finished")&&(We=nt),ke==="finished"&&q(),rt=We,ze=null,ke="running",V.start()};e&&De();const Ke={then(nt,ot){return X.then(nt,ot)},get time(){return Wa(st)},set time(nt){nt=Uu(nt),st=nt,ze!==null||!V||A===0?ze=nt:We=V.now()-nt/A},get duration(){const nt=de.calculatedDuration===null?kM(de):de.calculatedDuration;return Wa(nt)},get speed(){return A},set speed(nt){nt===A||!V||(A=nt,Ke.time=Wa(st))},get state(){return ke},play:De,pause:()=>{ke="paused",ze=st},stop:()=>{B=!0,ke!=="idle"&&(ke="idle",w&&w(),ut())},cancel:()=>{rt!==null&&Ge(rt),ut()},complete:()=>{ke="finished"},sample:nt=>(We=0,Ge(nt))};return Ke}function n9(e){let t;return()=>(t===void 0&&(t=e()),t)}const i9=n9(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),o9=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),lv=10,s9=2e4,a9=(e,t)=>t.type==="spring"||e==="backgroundColor"||!lD(t.ease);function l9(e,t,{onUpdate:r,onComplete:o,...u}){if(!(i9()&&o9.has(t)&&!u.repeatDelay&&u.repeatType!=="mirror"&&u.damping!==0&&u.type!=="inertia"))return!1;let h=!1,s,b,w=!1;const C=()=>{b=new Promise(U=>{s=U})};C();let{keyframes:k,duration:I=300,ease:A,times:B}=u;if(a9(t,u)){const U=I0({...u,repeat:0,delay:0});let ne={done:!1,value:k[0]};const de=[];let xe=0;for(;!ne.done&&xe<s9;)ne=U.sample(xe),de.push(ne.value),xe+=lv;B=void 0,k=de,I=xe-lv,A="linear"}const F=y7(e.owner.current,t,k,{...u,duration:I,ease:A,times:B}),X=()=>{w=!1,F.cancel()},q=()=>{w=!0,$r.update(X),s(),C()};return F.onfinish=()=>{w||(e.set(v7(k,u)),o&&o(),q())},{then(U,ne){return b.then(U,ne)},attachTimeline(U){return F.timeline=U,F.onfinish=null,wn},get time(){return Wa(F.currentTime||0)},set time(U){F.currentTime=Uu(U)},get speed(){return F.playbackRate},set speed(U){F.playbackRate=U},get duration(){return Wa(I)},play:()=>{h||(F.play(),nl(X))},pause:()=>F.pause(),stop:()=>{if(h=!0,F.playState==="idle")return;const{currentTime:U}=F;if(U){const ne=I0({...u,autoplay:!1});e.setWithVelocity(ne.sample(U-lv).value,ne.sample(U).value,lv)}q()},complete:()=>{w||F.finish()},cancel:q}}function c9({keyframes:e,delay:t,onUpdate:r,onComplete:o}){const u=()=>(r&&r(e[e.length-1]),o&&o(),{time:0,speed:1,duration:0,play:wn,pause:wn,stop:wn,then:d=>(d(),Promise.resolve()),cancel:wn,complete:wn});return t?I0({keyframes:[0,1],duration:0,delay:t,onComplete:u}):u()}const u9={type:"spring",stiffness:500,damping:25,restSpeed:10},h9=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),d9={type:"keyframes",duration:.8},p9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},f9=(e,{keyframes:t})=>t.length>2?d9:uh.has(e)?e.startsWith("scale")?h9(t[1]):u9:p9,Bw=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(wc.test(t)||t==="0")&&!t.startsWith("url(")),m9=new Set(["brightness","contrast","saturate","opacity"]);function g9(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[o]=r.match(S_)||[];if(!o)return e;const u=r.replace(o,"");let d=m9.has(t)?1:0;return o!==r&&(d*=100),t+"("+d+u+")"}const y9=/([a-z-]*)\(.*?\)/g,$w={...wc,getAnimatableNone:e=>{const t=e.match(y9);return t?t.map(g9).join(" "):e}},v9={...qL,color:$i,backgroundColor:$i,outlineColor:$i,fill:$i,stroke:$i,borderColor:$i,borderTopColor:$i,borderRightColor:$i,borderBottomColor:$i,borderLeftColor:$i,filter:$w,WebkitFilter:$w},ZS=e=>v9[e];function RD(e,t){let r=ZS(e);return r!==$w&&(r=wc),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const LD=e=>/^0[^.\s]+$/.test(e);function _9(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||LD(e)}function x9(e,t,r,o){const u=Bw(t,r);let d;Array.isArray(r)?d=[...r]:d=[null,r];const h=o.from!==void 0?o.from:e.get();let s;const b=[];for(let w=0;w<d.length;w++)d[w]===null&&(d[w]=w===0?h:d[w-1]),_9(d[w])&&b.push(w),typeof d[w]=="string"&&d[w]!=="none"&&d[w]!=="0"&&(s=d[w]);if(u&&b.length&&s)for(let w=0;w<b.length;w++){const C=b[w];d[C]=RD(t,s)}return d}function b9({when:e,delay:t,delayChildren:r,staggerChildren:o,staggerDirection:u,repeat:d,repeatType:h,repeatDelay:s,from:b,elapsed:w,...C}){return!!Object.keys(C).length}function WS(e,t){return e[t]||e.default||e}const w9={skipAnimations:!1},HS=(e,t,r,o={})=>u=>{const d=WS(o,e)||{},h=d.delay||o.delay||0;let{elapsed:s=0}=o;s=s-Uu(h);const b=x9(t,e,r,d),w=b[0],C=b[b.length-1],k=Bw(e,w),I=Bw(e,C);let A={keyframes:b,velocity:t.getVelocity(),ease:"easeOut",...d,delay:-s,onUpdate:B=>{t.set(B),d.onUpdate&&d.onUpdate(B)},onComplete:()=>{u(),d.onComplete&&d.onComplete()}};if(b9(d)||(A={...A,...f9(e,A)}),A.duration&&(A.duration=Uu(A.duration)),A.repeatDelay&&(A.repeatDelay=Uu(A.repeatDelay)),!k||!I||g7.current||d.type===!1||w9.skipAnimations)return c9(A);if(!o.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const B=l9(t,e,A);if(B)return B}return I0(A)};function R0(e){return!!(so(e)&&e.add)}const DD=e=>/^\-?\d*\.?\d+$/.test(e);function KS(e,t){e.indexOf(t)===-1&&e.push(t)}function XS(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class YS{constructor(){this.subscriptions=[]}add(t){return KS(this.subscriptions,t),()=>XS(this.subscriptions,t)}notify(t,r,o){const u=this.subscriptions.length;if(u)if(u===1)this.subscriptions[0](t,r,o);else for(let d=0;d<u;d++){const h=this.subscriptions[d];h&&h(t,r,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const S9=e=>!isNaN(parseFloat(e));class T9{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(o,u=!0)=>{this.prev=this.current,this.current=o;const{delta:d,timestamp:h}=Mi;this.lastUpdated!==h&&(this.timeDelta=d,this.lastUpdated=h,$r.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),u&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>$r.postRender(this.velocityCheck),this.velocityCheck=({timestamp:o})=>{o!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=S9(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new YS);const o=this.events[t].add(r);return t==="change"?()=>{o(),$r.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,o){this.set(r),this.prev=t,this.timeDelta=o}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?kD(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function up(e,t){return new T9(e,t)}const zD=e=>t=>t.test(e),C9={test:e=>e==="auto",parse:e=>e},ND=[hh,Ft,da,Ul,RU,IU,C9],Wf=e=>ND.find(zD(e)),P9=[...ND,$i,wc],E9=e=>P9.find(zD(e));function M9(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,up(r))}function k9(e,t){const r=C_(e,t);let{transitionEnd:o={},transition:u={},...d}=r?e.makeTargetAnimatable(r,!1):{};d={...d,...o};for(const h in d){const s=ZU(d[h]);M9(e,h,s)}}function A9(e,t,r){var o,u;const d=Object.keys(t).filter(s=>!e.hasValue(s)),h=d.length;if(h)for(let s=0;s<h;s++){const b=d[s],w=t[b];let C=null;Array.isArray(w)&&(C=w[0]),C===null&&(C=(u=(o=r[b])!==null&&o!==void 0?o:e.readValue(b))!==null&&u!==void 0?u:t[b]),C!=null&&(typeof C=="string"&&(DD(C)||LD(C))?C=parseFloat(C):!E9(C)&&wc.test(w)&&(C=RD(b,w)),e.addValue(b,up(C,{owner:e})),r[b]===void 0&&(r[b]=C),C!==null&&e.setBaseTarget(b,C))}}function I9(e,t){return t?(t[e]||t.default||t).from:void 0}function R9(e,t,r){const o={};for(const u in e){const d=I9(u,t);if(d!==void 0)o[u]=d;else{const h=r.getValue(u);h&&(o[u]=h.get())}}return o}function L9({protectedKeys:e,needsAnimating:t},r){const o=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,o}function D9(e,t){const r=e.get();if(Array.isArray(t)){for(let o=0;o<t.length;o++)if(t[o]!==r)return!0}else return r!==t}function jD(e,t,{delay:r=0,transitionOverride:o,type:u}={}){let{transition:d=e.getDefaultTransition(),transitionEnd:h,...s}=e.makeTargetAnimatable(t);const b=e.getValue("willChange");o&&(d=o);const w=[],C=u&&e.animationState&&e.animationState.getState()[u];for(const k in s){const I=e.getValue(k),A=s[k];if(!I||A===void 0||C&&L9(C,k))continue;const B={delay:r,elapsed:0,...WS(d||{},k)};if(window.HandoffAppearAnimations){const q=e.getProps()[OL];if(q){const V=window.HandoffAppearAnimations(q,k,I,$r);V!==null&&(B.elapsed=V,B.isHandoff=!0)}}let F=!B.isHandoff&&!D9(I,A);if(B.type==="spring"&&(I.getVelocity()||B.velocity)&&(F=!1),I.animation&&(F=!1),F)continue;I.start(HS(k,I,A,e.shouldReduceMotion&&uh.has(k)?{type:!1}:B));const X=I.animation;R0(b)&&(b.add(k),X.then(()=>b.remove(k))),w.push(X)}return h&&Promise.all(w).then(()=>{h&&k9(e,h)}),w}function Vw(e,t,r={}){const o=C_(e,t,r.custom);let{transition:u=e.getDefaultTransition()||{}}=o||{};r.transitionOverride&&(u=r.transitionOverride);const d=o?()=>Promise.all(jD(e,o,r)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(b=0)=>{const{delayChildren:w=0,staggerChildren:C,staggerDirection:k}=u;return z9(e,t,w+b,C,k,r)}:()=>Promise.resolve(),{when:s}=u;if(s){const[b,w]=s==="beforeChildren"?[d,h]:[h,d];return b().then(()=>w())}else return Promise.all([d(),h(r.delay)])}function z9(e,t,r=0,o=0,u=1,d){const h=[],s=(e.variantChildren.size-1)*o,b=u===1?(w=0)=>w*o:(w=0)=>s-w*o;return Array.from(e.variantChildren).sort(N9).forEach((w,C)=>{w.notify("AnimationStart",t),h.push(Vw(w,t,{...d,delay:r+b(C)}).then(()=>w.notify("AnimationComplete",t)))}),Promise.all(h)}function N9(e,t){return e.sortNodePosition(t)}function j9(e,t,r={}){e.notify("AnimationStart",t);let o;if(Array.isArray(t)){const u=t.map(d=>Vw(e,d,r));o=Promise.all(u)}else if(typeof t=="string")o=Vw(e,t,r);else{const u=typeof t=="function"?C_(e,t,r.custom):t;o=Promise.all(jD(e,u,r))}return o.then(()=>e.notify("AnimationComplete",t))}const O9=[...RS].reverse(),F9=RS.length;function B9(e){return t=>Promise.all(t.map(({animation:r,options:o})=>j9(e,r,o)))}function $9(e){let t=B9(e);const r=U9();let o=!0;const u=(b,w)=>{const C=C_(e,w);if(C){const{transition:k,transitionEnd:I,...A}=C;b={...b,...A,...I}}return b};function d(b){t=b(e)}function h(b,w){const C=e.getProps(),k=e.getVariantContext(!0)||{},I=[],A=new Set;let B={},F=1/0;for(let q=0;q<F9;q++){const V=O9[q],U=r[V],ne=C[V]!==void 0?C[V]:k[V],de=Zm(ne),xe=V===w?U.isActive:null;xe===!1&&(F=q);let ke=ne===k[V]&&ne!==C[V]&&de;if(ke&&o&&e.manuallyAnimateOnMount&&(ke=!1),U.protectedKeys={...B},!U.isActive&&xe===null||!ne&&!U.prevProp||b_(ne)||typeof ne=="boolean")continue;let We=V9(U.prevProp,ne)||V===w&&U.isActive&&!ke&&de||q>F&&de,rt=!1;const Ze=Array.isArray(ne)?ne:[ne];let He=Ze.reduce(u,{});xe===!1&&(He={});const{prevResolvedValues:Ct={}}=U,st={...Ct,...He},Ge=tt=>{We=!0,A.has(tt)&&(rt=!0,A.delete(tt)),U.needsAnimating[tt]=!0};for(const tt in st){const ut=He[tt],Ve=Ct[tt];if(B.hasOwnProperty(tt))continue;let De=!1;M0(ut)&&M0(Ve)?De=!sD(ut,Ve):De=ut!==Ve,De?ut!==void 0?Ge(tt):A.add(tt):ut!==void 0&&A.has(tt)?Ge(tt):U.protectedKeys[tt]=!0}U.prevProp=ne,U.prevResolvedValues=He,U.isActive&&(B={...B,...He}),o&&e.blockInitialAnimation&&(We=!1),We&&(!ke||rt)&&I.push(...Ze.map(tt=>({animation:tt,options:{type:V,...b}})))}if(A.size){const q={};A.forEach(V=>{const U=e.getBaseTarget(V);U!==void 0&&(q[V]=U)}),I.push({animation:q})}let X=!!I.length;return o&&(C.initial===!1||C.initial===C.animate)&&!e.manuallyAnimateOnMount&&(X=!1),o=!1,X?t(I):Promise.resolve()}function s(b,w,C){var k;if(r[b].isActive===w)return Promise.resolve();(k=e.variantChildren)===null||k===void 0||k.forEach(A=>{var B;return(B=A.animationState)===null||B===void 0?void 0:B.setActive(b,w)}),r[b].isActive=w;const I=h(C,b);for(const A in r)r[A].protectedKeys={};return I}return{animateChanges:h,setActive:s,setAnimateFunction:d,getState:()=>r}}function V9(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!sD(t,e):!1}function vu(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function U9(){return{animate:vu(!0),whileInView:vu(),whileHover:vu(),whileTap:vu(),whileDrag:vu(),whileFocus:vu(),exit:vu()}}class G9 extends Pc{constructor(t){super(t),t.animationState||(t.animationState=$9(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),b_(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let q9=0;class Z9 extends Pc{constructor(){super(...arguments),this.id=q9++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:o}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===u)return;const d=this.node.animationState.setActive("exit",!t,{custom:o??this.node.getProps().custom});r&&!t&&d.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const W9={animation:{Feature:G9},exit:{Feature:Z9}},AM=(e,t)=>Math.abs(e-t);function H9(e,t){const r=AM(e.x,t.x),o=AM(e.y,t.y);return Math.sqrt(r**2+o**2)}class OD{constructor(t,r,{transformPagePoint:o,contextWindow:u,dragSnapToOrigin:d=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=Q1(this.lastMoveEventInfo,this.history),I=this.startEvent!==null,A=H9(k.offset,{x:0,y:0})>=3;if(!I&&!A)return;const{point:B}=k,{timestamp:F}=Mi;this.history.push({...B,timestamp:F});const{onStart:X,onMove:q}=this.handlers;I||(X&&X(this.lastMoveEvent,k),this.startEvent=this.lastMoveEvent),q&&q(this.lastMoveEvent,k)},this.handlePointerMove=(k,I)=>{this.lastMoveEvent=k,this.lastMoveEventInfo=Y1(I,this.transformPagePoint),$r.update(this.updatePoint,!0)},this.handlePointerUp=(k,I)=>{this.end();const{onEnd:A,onSessionEnd:B,resumeAnimation:F}=this.handlers;if(this.dragSnapToOrigin&&F&&F(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const X=Q1(k.type==="pointercancel"?this.lastMoveEventInfo:Y1(I,this.transformPagePoint),this.history);this.startEvent&&A&&A(k,X),B&&B(k,X)},!tD(t))return;this.dragSnapToOrigin=d,this.handlers=r,this.transformPagePoint=o,this.contextWindow=u||window;const h=T_(t),s=Y1(h,this.transformPagePoint),{point:b}=s,{timestamp:w}=Mi;this.history=[{...b,timestamp:w}];const{onSessionStart:C}=r;C&&C(t,Q1(s,this.history)),this.removeListeners=gc(Za(this.contextWindow,"pointermove",this.handlePointerMove),Za(this.contextWindow,"pointerup",this.handlePointerUp),Za(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),nl(this.updatePoint)}}function Y1(e,t){return t?{point:t(e.point)}:e}function IM(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Q1({point:e},t){return{point:e,delta:IM(e,FD(t)),offset:IM(e,K9(t)),velocity:X9(t,.1)}}function K9(e){return e[0]}function FD(e){return e[e.length-1]}function X9(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,o=null;const u=FD(e);for(;r>=0&&(o=e[r],!(u.timestamp-o.timestamp>Uu(t)));)r--;if(!o)return{x:0,y:0};const d=Wa(u.timestamp-o.timestamp);if(d===0)return{x:0,y:0};const h={x:(u.x-o.x)/d,y:(u.y-o.y)/d};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function ko(e){return e.max-e.min}function Uw(e,t=0,r=.01){return Math.abs(e-t)<=r}function RM(e,t,r,o=.5){e.origin=o,e.originPoint=an(t.min,t.max,e.origin),e.scale=ko(r)/ko(t),(Uw(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=an(r.min,r.max,e.origin)-e.originPoint,(Uw(e.translate)||isNaN(e.translate))&&(e.translate=0)}function mm(e,t,r,o){RM(e.x,t.x,r.x,o?o.originX:void 0),RM(e.y,t.y,r.y,o?o.originY:void 0)}function LM(e,t,r){e.min=r.min+t.min,e.max=e.min+ko(t)}function Y9(e,t,r){LM(e.x,t.x,r.x),LM(e.y,t.y,r.y)}function DM(e,t,r){e.min=t.min-r.min,e.max=e.min+ko(t)}function gm(e,t,r){DM(e.x,t.x,r.x),DM(e.y,t.y,r.y)}function Q9(e,{min:t,max:r},o){return t!==void 0&&e<t?e=o?an(t,e,o.min):Math.max(e,t):r!==void 0&&e>r&&(e=o?an(r,e,o.max):Math.min(e,r)),e}function zM(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function J9(e,{top:t,left:r,bottom:o,right:u}){return{x:zM(e.x,r,u),y:zM(e.y,t,o)}}function NM(e,t){let r=t.min-e.min,o=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,o]=[o,r]),{min:r,max:o}}function eG(e,t){return{x:NM(e.x,t.x),y:NM(e.y,t.y)}}function tG(e,t){let r=.5;const o=ko(e),u=ko(t);return u>o?r=Hm(t.min,t.max-o,e.min):o>u&&(r=Hm(e.min,e.max-u,t.min)),bc(0,1,r)}function rG(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Gw=.35;function nG(e=Gw){return e===!1?e=0:e===!0&&(e=Gw),{x:jM(e,"left","right"),y:jM(e,"top","bottom")}}function jM(e,t,r){return{min:OM(e,t),max:OM(e,r)}}function OM(e,t){return typeof e=="number"?e:e[t]||0}const FM=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ad=()=>({x:FM(),y:FM()}),BM=()=>({min:0,max:0}),zn=()=>({x:BM(),y:BM()});function Go(e){return[e("x"),e("y")]}function BD({top:e,left:t,right:r,bottom:o}){return{x:{min:t,max:r},y:{min:e,max:o}}}function iG({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function oG(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),o=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:o.y,right:o.x}}function J1(e){return e===void 0||e===1}function qw({scale:e,scaleX:t,scaleY:r}){return!J1(e)||!J1(t)||!J1(r)}function Tu(e){return qw(e)||$D(e)||e.z||e.rotate||e.rotateX||e.rotateY}function $D(e){return $M(e.x)||$M(e.y)}function $M(e){return e&&e!=="0%"}function L0(e,t,r){const o=e-r,u=t*o;return r+u}function VM(e,t,r,o,u){return u!==void 0&&(e=L0(e,u,o)),L0(e,r,o)+t}function Zw(e,t=0,r=1,o,u){e.min=VM(e.min,t,r,o,u),e.max=VM(e.max,t,r,o,u)}function VD(e,{x:t,y:r}){Zw(e.x,t.translate,t.scale,t.originPoint),Zw(e.y,r.translate,r.scale,r.originPoint)}function sG(e,t,r,o=!1){const u=r.length;if(!u)return;t.x=t.y=1;let d,h;for(let s=0;s<u;s++){d=r[s],h=d.projectionDelta;const b=d.instance;b&&b.style&&b.style.display==="contents"||(o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Id(e,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,VD(e,h)),o&&Tu(d.latestValues)&&Id(e,d.latestValues))}t.x=UM(t.x),t.y=UM(t.y)}function UM(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Wl(e,t){e.min=e.min+t,e.max=e.max+t}function GM(e,t,[r,o,u]){const d=t[u]!==void 0?t[u]:.5,h=an(e.min,e.max,d);Zw(e,t[r],t[o],h,t.scale)}const aG=["x","scaleX","originX"],lG=["y","scaleY","originY"];function Id(e,t){GM(e.x,t,aG),GM(e.y,t,lG)}function UD(e,t){return BD(oG(e.getBoundingClientRect(),t))}function cG(e,t,r){const o=UD(e,r),{scroll:u}=t;return u&&(Wl(o.x,u.offset.x),Wl(o.y,u.offset.y)),o}const GD=({current:e})=>e?e.ownerDocument.defaultView:null,uG=new WeakMap;class hG{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=zn(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const u=C=>{const{dragSnapToOrigin:k}=this.getProps();k?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(T_(C,"page").point)},d=(C,k)=>{const{drag:I,dragPropagation:A,onDragStart:B}=this.getProps();if(I&&!A&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=nD(I),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Go(X=>{let q=this.getAxisMotionValue(X).get()||0;if(da.test(q)){const{projection:V}=this.visualElement;if(V&&V.layout){const U=V.layout.layoutBox[X];U&&(q=ko(U)*(parseFloat(q)/100))}}this.originPoint[X]=q}),B&&$r.update(()=>B(C,k),!1,!0);const{animationState:F}=this.visualElement;F&&F.setActive("whileDrag",!0)},h=(C,k)=>{const{dragPropagation:I,dragDirectionLock:A,onDirectionLock:B,onDrag:F}=this.getProps();if(!I&&!this.openGlobalLock)return;const{offset:X}=k;if(A&&this.currentDirection===null){this.currentDirection=dG(X),this.currentDirection!==null&&B&&B(this.currentDirection);return}this.updateAxis("x",k.point,X),this.updateAxis("y",k.point,X),this.visualElement.render(),F&&F(C,k)},s=(C,k)=>this.stop(C,k),b=()=>Go(C=>{var k;return this.getAnimationState(C)==="paused"&&((k=this.getAxisMotionValue(C).animation)===null||k===void 0?void 0:k.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new OD(t,{onSessionStart:u,onStart:d,onMove:h,onSessionEnd:s,resumeAnimation:b},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:GD(this.visualElement)})}stop(t,r){const o=this.isDragging;if(this.cancel(),!o)return;const{velocity:u}=r;this.startAnimation(u);const{onDragEnd:d}=this.getProps();d&&$r.update(()=>d(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:o}=this.getProps();!o&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,o){const{drag:u}=this.getProps();if(!o||!cv(t,u,this.currentDirection))return;const d=this.getAxisMotionValue(t);let h=this.originPoint[t]+o[t];this.constraints&&this.constraints[t]&&(h=Q9(h,this.constraints[t],this.elastic[t])),d.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:o}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,d=this.constraints;r&&Md(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&u?this.constraints=J9(u.layoutBox,r):this.constraints=!1,this.elastic=nG(o),d!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&Go(h=>{this.getAxisMotionValue(h)&&(this.constraints[h]=rG(u.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Md(t))return!1;const o=t.current,{projection:u}=this.visualElement;if(!u||!u.layout)return!1;const d=cG(o,u.root,this.visualElement.getTransformPagePoint());let h=eG(u.layout.layoutBox,d);if(r){const s=r(iG(h));this.hasMutatedConstraints=!!s,s&&(h=BD(s))}return h}startAnimation(t){const{drag:r,dragMomentum:o,dragElastic:u,dragTransition:d,dragSnapToOrigin:h,onDragTransitionEnd:s}=this.getProps(),b=this.constraints||{},w=Go(C=>{if(!cv(C,r,this.currentDirection))return;let k=b&&b[C]||{};h&&(k={min:0,max:0});const I=u?200:1e6,A=u?40:1e7,B={type:"inertia",velocity:o?t[C]:0,bounceStiffness:I,bounceDamping:A,timeConstant:750,restDelta:1,restSpeed:10,...d,...k};return this.startAxisValueAnimation(C,B)});return Promise.all(w).then(s)}startAxisValueAnimation(t,r){const o=this.getAxisMotionValue(t);return o.start(HS(t,o,0,r))}stopAnimation(){Go(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Go(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),o=this.visualElement.getProps(),u=o[r];return u||this.visualElement.getValue(t,(o.initial?o.initial[t]:void 0)||0)}snapToCursor(t){Go(r=>{const{drag:o}=this.getProps();if(!cv(r,o,this.currentDirection))return;const{projection:u}=this.visualElement,d=this.getAxisMotionValue(r);if(u&&u.layout){const{min:h,max:s}=u.layout.layoutBox[r];d.set(t[r]-an(h,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:o}=this.visualElement;if(!Md(r)||!o||!this.constraints)return;this.stopAnimation();const u={x:0,y:0};Go(h=>{const s=this.getAxisMotionValue(h);if(s){const b=s.get();u[h]=tG({min:b,max:b},this.constraints[h])}});const{transformTemplate:d}=this.visualElement.getProps();this.visualElement.current.style.transform=d?d({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.resolveConstraints(),Go(h=>{if(!cv(h,t,null))return;const s=this.getAxisMotionValue(h),{min:b,max:w}=this.constraints[h];s.set(an(b,w,u[h]))})}addListeners(){if(!this.visualElement.current)return;uG.set(this.visualElement,this);const t=this.visualElement.current,r=Za(t,"pointerdown",b=>{const{drag:w,dragListener:C=!0}=this.getProps();w&&C&&this.start(b)}),o=()=>{const{dragConstraints:b}=this.getProps();Md(b)&&(this.constraints=this.resolveRefConstraints())},{projection:u}=this.visualElement,d=u.addEventListener("measure",o);u&&!u.layout&&(u.root&&u.root.updateScroll(),u.updateLayout()),o();const h=Ga(window,"resize",()=>this.scalePositionWithinConstraints()),s=u.addEventListener("didUpdate",({delta:b,hasLayoutChanged:w})=>{this.isDragging&&w&&(Go(C=>{const k=this.getAxisMotionValue(C);k&&(this.originPoint[C]+=b[C].translate,k.set(k.get()+b[C].translate))}),this.visualElement.render())});return()=>{h(),r(),d(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:o=!1,dragPropagation:u=!1,dragConstraints:d=!1,dragElastic:h=Gw,dragMomentum:s=!0}=t;return{...t,drag:r,dragDirectionLock:o,dragPropagation:u,dragConstraints:d,dragElastic:h,dragMomentum:s}}}function cv(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function dG(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class pG extends Pc{constructor(t){super(t),this.removeGroupControls=wn,this.removeListeners=wn,this.controls=new hG(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wn}unmount(){this.removeGroupControls(),this.removeListeners()}}const qM=e=>(t,r)=>{e&&$r.update(()=>e(t,r))};class fG extends Pc{constructor(){super(...arguments),this.removePointerDownListener=wn}onPointerDown(t){this.session=new OD(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:GD(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:o,onPanEnd:u}=this.node.getProps();return{onSessionStart:qM(t),onStart:qM(r),onMove:o,onEnd:(d,h)=>{delete this.session,u&&$r.update(()=>u(d,h))}}}mount(){this.removePointerDownListener=Za(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function mG(){const e=K.useContext(__);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:o}=e,u=K.useId();return K.useEffect(()=>o(u),[]),!t&&r?[!1,()=>r&&r(u)]:[!0]}const jv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ZM(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Hf={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ft.test(e))e=parseFloat(e);else return e;const r=ZM(e,t.target.x),o=ZM(e,t.target.y);return`${r}% ${o}%`}},gG={correct:(e,{treeScale:t,projectionDelta:r})=>{const o=e,u=wc.parse(e);if(u.length>5)return o;const d=wc.createTransformer(e),h=typeof u[0]!="number"?1:0,s=r.x.scale*t.x,b=r.y.scale*t.y;u[0+h]/=s,u[1+h]/=b;const w=an(s,b,.5);return typeof u[2+h]=="number"&&(u[2+h]/=w),typeof u[3+h]=="number"&&(u[3+h]/=w),d(u)}};class yG extends yt.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:o,layoutId:u}=this.props,{projection:d}=t;TU(vG),d&&(r.group&&r.group.add(d),o&&o.register&&u&&o.register(d),d.root.didUpdate(),d.addEventListener("animationComplete",()=>{this.safeToRemove()}),d.setOptions({...d.options,onExitComplete:()=>this.safeToRemove()})),jv.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:o,drag:u,isPresent:d}=this.props,h=o.projection;return h&&(h.isPresent=d,u||t.layoutDependency!==r||r===void 0?h.willUpdate():this.safeToRemove(),t.isPresent!==d&&(d?h.promote():h.relegate()||$r.postRender(()=>{const s=h.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:o}=this.props,{projection:u}=t;u&&(u.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(u),o&&o.deregister&&o.deregister(u))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function qD(e){const[t,r]=mG(),o=K.useContext(DS);return yt.createElement(yG,{...e,layoutGroup:o,switchLayoutGroup:K.useContext(BL),isPresent:t,safeToRemove:r})}const vG={borderRadius:{...Hf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Hf,borderTopRightRadius:Hf,borderBottomLeftRadius:Hf,borderBottomRightRadius:Hf,boxShadow:gG},ZD=["TopLeft","TopRight","BottomLeft","BottomRight"],_G=ZD.length,WM=e=>typeof e=="string"?parseFloat(e):e,HM=e=>typeof e=="number"||Ft.test(e);function xG(e,t,r,o,u,d){u?(e.opacity=an(0,r.opacity!==void 0?r.opacity:1,bG(o)),e.opacityExit=an(t.opacity!==void 0?t.opacity:1,0,wG(o))):d&&(e.opacity=an(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,o));for(let h=0;h<_G;h++){const s=`border${ZD[h]}Radius`;let b=KM(t,s),w=KM(r,s);if(b===void 0&&w===void 0)continue;b||(b=0),w||(w=0),b===0||w===0||HM(b)===HM(w)?(e[s]=Math.max(an(WM(b),WM(w),o),0),(da.test(w)||da.test(b))&&(e[s]+="%")):e[s]=w}(t.rotate||r.rotate)&&(e.rotate=an(t.rotate||0,r.rotate||0,o))}function KM(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const bG=WD(0,.5,mD),wG=WD(.5,.95,wn);function WD(e,t,r){return o=>o<e?0:o>t?1:r(Hm(e,t,o))}function XM(e,t){e.min=t.min,e.max=t.max}function $o(e,t){XM(e.x,t.x),XM(e.y,t.y)}function YM(e,t,r,o,u){return e-=t,e=L0(e,1/r,o),u!==void 0&&(e=L0(e,1/u,o)),e}function SG(e,t=0,r=1,o=.5,u,d=e,h=e){if(da.test(t)&&(t=parseFloat(t),t=an(h.min,h.max,t/100)-h.min),typeof t!="number")return;let s=an(d.min,d.max,o);e===d&&(s-=t),e.min=YM(e.min,t,r,s,u),e.max=YM(e.max,t,r,s,u)}function QM(e,t,[r,o,u],d,h){SG(e,t[r],t[o],t[u],t.scale,d,h)}const TG=["x","scaleX","originX"],CG=["y","scaleY","originY"];function JM(e,t,r,o){QM(e.x,t,TG,r?r.x:void 0,o?o.x:void 0),QM(e.y,t,CG,r?r.y:void 0,o?o.y:void 0)}function ek(e){return e.translate===0&&e.scale===1}function HD(e){return ek(e.x)&&ek(e.y)}function PG(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function KD(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function tk(e){return ko(e.x)/ko(e.y)}class EG{constructor(){this.members=[]}add(t){KS(this.members,t),t.scheduleRender()}remove(t){if(XS(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(u=>t===u);if(r===0)return!1;let o;for(let u=r;u>=0;u--){const d=this.members[u];if(d.isPresent!==!1){o=d;break}}return o?(this.promote(o),!0):!1}promote(t,r){const o=this.lead;if(t!==o&&(this.prevLead=o,this.lead=t,t.show(),o)){o.instance&&o.scheduleRender(),t.scheduleRender(),t.resumeFrom=o,r&&(t.resumeFrom.preserveOpacity=!0),o.snapshot&&(t.snapshot=o.snapshot,t.snapshot.latestValues=o.animationValues||o.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:u}=t.options;u===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:o}=t;r.onExitComplete&&r.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function rk(e,t,r){let o="";const u=e.x.translate/t.x,d=e.y.translate/t.y;if((u||d)&&(o=`translate3d(${u}px, ${d}px, 0) `),(t.x!==1||t.y!==1)&&(o+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:b,rotateX:w,rotateY:C}=r;b&&(o+=`rotate(${b}deg) `),w&&(o+=`rotateX(${w}deg) `),C&&(o+=`rotateY(${C}deg) `)}const h=e.x.scale*t.x,s=e.y.scale*t.y;return(h!==1||s!==1)&&(o+=`scale(${h}, ${s})`),o||"none"}const MG=(e,t)=>e.depth-t.depth;class kG{constructor(){this.children=[],this.isDirty=!1}add(t){KS(this.children,t),this.isDirty=!0}remove(t){XS(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(MG),this.isDirty=!1,this.children.forEach(t)}}function AG(e,t){const r=performance.now(),o=({timestamp:u})=>{const d=u-r;d>=t&&(nl(o),e(d-t))};return $r.read(o,!0),()=>nl(o)}function IG(e){window.MotionDebug&&window.MotionDebug.record(e)}function RG(e){return e instanceof SVGElement&&e.tagName!=="svg"}function LG(e,t,r){const o=so(e)?e:up(e);return o.start(HS("",o,t,r)),o.animation}const nk=["","X","Y","Z"],DG={visibility:"hidden"},ik=1e3;let zG=0;const Cu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function XD({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:o,resetTransform:u}){return class{constructor(h={},s=t==null?void 0:t()){this.id=zG++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Cu.totalNodes=Cu.resolvedTargetDeltas=Cu.recalculatedProjection=0,this.nodes.forEach(OG),this.nodes.forEach(UG),this.nodes.forEach(GG),this.nodes.forEach(FG),IG(Cu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let b=0;b<this.path.length;b++)this.path[b].shouldResetTransform=!0;this.root===this&&(this.nodes=new kG)}addEventListener(h,s){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new YS),this.eventHandlers.get(h).add(s)}notifyListeners(h,...s){const b=this.eventHandlers.get(h);b&&b.notify(...s)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,s=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=RG(h),this.instance=h;const{layoutId:b,layout:w,visualElement:C}=this.options;if(C&&!C.current&&C.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(w||b)&&(this.isLayoutDirty=!0),e){let k;const I=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,k&&k(),k=AG(I,250),jv.hasAnimatedSinceResize&&(jv.hasAnimatedSinceResize=!1,this.nodes.forEach(sk))})}b&&this.root.registerSharedNode(b,this),this.options.animate!==!1&&C&&(b||w)&&this.addEventListener("didUpdate",({delta:k,hasLayoutChanged:I,hasRelativeTargetChanged:A,layout:B})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const F=this.options.transition||C.getDefaultTransition()||KG,{onLayoutAnimationStart:X,onLayoutAnimationComplete:q}=C.getProps(),V=!this.targetLayout||!KD(this.targetLayout,B)||A,U=!I&&A;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||U||I&&(V||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(k,U);const ne={...WS(F,"layout"),onPlay:X,onComplete:q};(C.shouldReduceMotion||this.options.layoutRoot)&&(ne.delay=0,ne.type=!1),this.startAnimation(ne)}else I||sk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=B})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,nl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qG),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let C=0;C<this.path.length;C++){const k=this.path[C];k.shouldResetTransform=!0,k.updateScroll("snapshot"),k.options.layoutRoot&&k.willUpdate(!1)}const{layoutId:s,layout:b}=this.options;if(s===void 0&&!b)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ok);return}this.isUpdating||this.nodes.forEach($G),this.isUpdating=!1,this.nodes.forEach(VG),this.nodes.forEach(NG),this.nodes.forEach(jG),this.clearAllSnapshots();const s=performance.now();Mi.delta=bc(0,1e3/60,s-Mi.timestamp),Mi.timestamp=s,Mi.isProcessing=!0,U1.update.process(Mi),U1.preRender.process(Mi),U1.render.process(Mi),Mi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(BG),this.sharedNodes.forEach(ZG)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$r.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$r.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let b=0;b<this.path.length;b++)this.path[b].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=zn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let s=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(s=!1),s&&(this.scroll={animationId:this.root.animationId,phase:h,isRoot:o(this.instance),offset:r(this.instance)})}resetTransform(){if(!u)return;const h=this.isLayoutDirty||this.shouldResetTransform,s=this.projectionDelta&&!HD(this.projectionDelta),b=this.getTransformTemplate(),w=b?b(this.latestValues,""):void 0,C=w!==this.prevTransformTemplateValue;h&&(s||Tu(this.latestValues)||C)&&(u(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const s=this.measurePageBox();let b=this.removeElementScroll(s);return h&&(b=this.removeTransform(b)),XG(b),{animationId:this.root.animationId,measuredBox:s,layoutBox:b,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:h}=this.options;if(!h)return zn();const s=h.measureViewportBox(),{scroll:b}=this.root;return b&&(Wl(s.x,b.offset.x),Wl(s.y,b.offset.y)),s}removeElementScroll(h){const s=zn();$o(s,h);for(let b=0;b<this.path.length;b++){const w=this.path[b],{scroll:C,options:k}=w;if(w!==this.root&&C&&k.layoutScroll){if(C.isRoot){$o(s,h);const{scroll:I}=this.root;I&&(Wl(s.x,-I.offset.x),Wl(s.y,-I.offset.y))}Wl(s.x,C.offset.x),Wl(s.y,C.offset.y)}}return s}applyTransform(h,s=!1){const b=zn();$o(b,h);for(let w=0;w<this.path.length;w++){const C=this.path[w];!s&&C.options.layoutScroll&&C.scroll&&C!==C.root&&Id(b,{x:-C.scroll.offset.x,y:-C.scroll.offset.y}),Tu(C.latestValues)&&Id(b,C.latestValues)}return Tu(this.latestValues)&&Id(b,this.latestValues),b}removeTransform(h){const s=zn();$o(s,h);for(let b=0;b<this.path.length;b++){const w=this.path[b];if(!w.instance||!Tu(w.latestValues))continue;qw(w.latestValues)&&w.updateSnapshot();const C=zn(),k=w.measurePageBox();$o(C,k),JM(s,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,C)}return Tu(this.latestValues)&&JM(s,this.latestValues),s}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Mi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var s;const b=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=b.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=b.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=b.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==b;if(!(h||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:k,layoutId:I}=this.options;if(!(!this.layout||!(k||I))){if(this.resolvedRelativeTargetAt=Mi.timestamp,!this.targetDelta&&!this.relativeTarget){const A=this.getClosestProjectingParent();A&&A.layout&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),gm(this.relativeTargetOrigin,this.layout.layoutBox,A.layout.layoutBox),$o(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=zn(),this.targetWithTransforms=zn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Y9(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):$o(this.target,this.layout.layoutBox),VD(this.target,this.targetDelta)):$o(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const A=this.getClosestProjectingParent();A&&!!A.resumingFrom==!!this.resumingFrom&&!A.options.layoutScroll&&A.target&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),gm(this.relativeTargetOrigin,this.target,A.target),$o(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Cu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||qw(this.parent.latestValues)||$D(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const s=this.getLead(),b=!!this.resumingFrom||this!==s;let w=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(w=!1),b&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===Mi.timestamp&&(w=!1),w)return;const{layout:C,layoutId:k}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(C||k))return;$o(this.layoutCorrected,this.layout.layoutBox);const I=this.treeScale.x,A=this.treeScale.y;sG(this.layoutCorrected,this.treeScale,this.path,b),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox);const{target:B}=s;if(!B){this.projectionTransform&&(this.projectionDelta=Ad(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Ad(),this.projectionDeltaWithTransform=Ad());const F=this.projectionTransform;mm(this.projectionDelta,this.layoutCorrected,B,this.latestValues),this.projectionTransform=rk(this.projectionDelta,this.treeScale),(this.projectionTransform!==F||this.treeScale.x!==I||this.treeScale.y!==A)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",B)),Cu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),h){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(h,s=!1){const b=this.snapshot,w=b?b.latestValues:{},C={...this.latestValues},k=Ad();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const I=zn(),A=b?b.source:void 0,B=this.layout?this.layout.source:void 0,F=A!==B,X=this.getStack(),q=!X||X.members.length<=1,V=!!(F&&!q&&this.options.crossfade===!0&&!this.path.some(HG));this.animationProgress=0;let U;this.mixTargetDelta=ne=>{const de=ne/1e3;ak(k.x,h.x,de),ak(k.y,h.y,de),this.setTargetDelta(k),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(gm(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),WG(this.relativeTarget,this.relativeTargetOrigin,I,de),U&&PG(this.relativeTarget,U)&&(this.isProjectionDirty=!1),U||(U=zn()),$o(U,this.relativeTarget)),F&&(this.animationValues=C,xG(C,w,this.latestValues,de,V,q)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=de},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(nl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$r.update(()=>{jv.hasAnimatedSinceResize=!0,this.currentAnimation=LG(0,ik,{...h,onUpdate:s=>{this.mixTargetDelta(s),h.onUpdate&&h.onUpdate(s)},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ik),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:s,target:b,layout:w,latestValues:C}=h;if(!(!s||!b||!w)){if(this!==h&&this.layout&&w&&YD(this.options.animationType,this.layout.layoutBox,w.layoutBox)){b=this.target||zn();const k=ko(this.layout.layoutBox.x);b.x.min=h.target.x.min,b.x.max=b.x.min+k;const I=ko(this.layout.layoutBox.y);b.y.min=h.target.y.min,b.y.max=b.y.min+I}$o(s,b),Id(s,C),mm(this.projectionDeltaWithTransform,this.layoutCorrected,s,C)}}registerSharedNode(h,s){this.sharedNodes.has(h)||this.sharedNodes.set(h,new EG),this.sharedNodes.get(h).add(s);const w=s.options.initialPromotionConfig;s.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(s):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:s}=this.options;return s?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:s}=this.options;return s?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:s,preserveFollowOpacity:b}={}){const w=this.getStack();w&&w.promote(this,b),h&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetRotation(){const{visualElement:h}=this.options;if(!h)return;let s=!1;const{latestValues:b}=h;if((b.rotate||b.rotateX||b.rotateY||b.rotateZ)&&(s=!0),!s)return;const w={};for(let C=0;C<nk.length;C++){const k="rotate"+nk[C];b[k]&&(w[k]=b[k],h.setStaticValue(k,0))}h.render();for(const C in w)h.setStaticValue(C,w[C]);h.scheduleRender()}getProjectionStyles(h){var s,b;if(!this.instance||this.isSVG)return;if(!this.isVisible)return DG;const w={visibility:""},C=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=Nv(h==null?void 0:h.pointerEvents)||"",w.transform=C?C(this.latestValues,""):"none",w;const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){const F={};return this.options.layoutId&&(F.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,F.pointerEvents=Nv(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!Tu(this.latestValues)&&(F.transform=C?C({},""):"none",this.hasProjected=!1),F}const I=k.animationValues||k.latestValues;this.applyTransformsToTarget(),w.transform=rk(this.projectionDeltaWithTransform,this.treeScale,I),C&&(w.transform=C(I,w.transform));const{x:A,y:B}=this.projectionDelta;w.transformOrigin=`${A.origin*100}% ${B.origin*100}% 0`,k.animationValues?w.opacity=k===this?(b=(s=I.opacity)!==null&&s!==void 0?s:this.latestValues.opacity)!==null&&b!==void 0?b:1:this.preserveOpacity?this.latestValues.opacity:I.opacityExit:w.opacity=k===this?I.opacity!==void 0?I.opacity:"":I.opacityExit!==void 0?I.opacityExit:0;for(const F in P0){if(I[F]===void 0)continue;const{correct:X,applyTo:q}=P0[F],V=w.transform==="none"?I[F]:X(I[F],k);if(q){const U=q.length;for(let ne=0;ne<U;ne++)w[q[ne]]=V}else w[F]=V}return this.options.layoutId&&(w.pointerEvents=k===this?Nv(h==null?void 0:h.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var s;return(s=h.currentAnimation)===null||s===void 0?void 0:s.stop()}),this.root.nodes.forEach(ok),this.root.sharedNodes.clear()}}}function NG(e){e.updateLayout()}function jG(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:o,measuredBox:u}=e.layout,{animationType:d}=e.options,h=r.source!==e.layout.source;d==="size"?Go(k=>{const I=h?r.measuredBox[k]:r.layoutBox[k],A=ko(I);I.min=o[k].min,I.max=I.min+A}):YD(d,r.layoutBox,o)&&Go(k=>{const I=h?r.measuredBox[k]:r.layoutBox[k],A=ko(o[k]);I.max=I.min+A,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[k].max=e.relativeTarget[k].min+A)});const s=Ad();mm(s,o,r.layoutBox);const b=Ad();h?mm(b,e.applyTransform(u,!0),r.measuredBox):mm(b,o,r.layoutBox);const w=!HD(s);let C=!1;if(!e.resumeFrom){const k=e.getClosestProjectingParent();if(k&&!k.resumeFrom){const{snapshot:I,layout:A}=k;if(I&&A){const B=zn();gm(B,r.layoutBox,I.layoutBox);const F=zn();gm(F,o,A.layoutBox),KD(B,F)||(C=!0),k.options.layoutRoot&&(e.relativeTarget=F,e.relativeTargetOrigin=B,e.relativeParent=k)}}}e.notifyListeners("didUpdate",{layout:o,snapshot:r,delta:b,layoutDelta:s,hasLayoutChanged:w,hasRelativeTargetChanged:C})}else if(e.isLead()){const{onExitComplete:o}=e.options;o&&o()}e.options.transition=void 0}function OG(e){Cu.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function FG(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function BG(e){e.clearSnapshot()}function ok(e){e.clearMeasurements()}function $G(e){e.isLayoutDirty=!1}function VG(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function sk(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function UG(e){e.resolveTargetDelta()}function GG(e){e.calcProjection()}function qG(e){e.resetRotation()}function ZG(e){e.removeLeadSnapshot()}function ak(e,t,r){e.translate=an(t.translate,0,r),e.scale=an(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function lk(e,t,r,o){e.min=an(t.min,r.min,o),e.max=an(t.max,r.max,o)}function WG(e,t,r,o){lk(e.x,t.x,r.x,o),lk(e.y,t.y,r.y,o)}function HG(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const KG={duration:.45,ease:[.4,0,.1,1]},ck=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),uk=ck("applewebkit/")&&!ck("chrome/")?Math.round:wn;function hk(e){e.min=uk(e.min),e.max=uk(e.max)}function XG(e){hk(e.x),hk(e.y)}function YD(e,t,r){return e==="position"||e==="preserve-aspect"&&!Uw(tk(t),tk(r),.2)}const YG=XD({attachResizeListener:(e,t)=>Ga(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),eb={current:void 0},QD=XD({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!eb.current){const e=new YG({});e.mount(window),e.setOptions({layoutScroll:!0}),eb.current=e}return eb.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),QG={pan:{Feature:fG},drag:{Feature:pG,ProjectionNode:QD,MeasureLayout:qD}},JG=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function eq(e){const t=JG.exec(e);if(!t)return[,];const[,r,o]=t;return[r,o]}function Ww(e,t,r=1){const[o,u]=eq(e);if(!o)return;const d=window.getComputedStyle(t).getPropertyValue(o);if(d){const h=d.trim();return DD(h)?parseFloat(h):h}else return Nw(u)?Ww(u,t,r+1):u}function tq(e,{...t},r){const o=e.current;if(!(o instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(u=>{const d=u.get();if(!Nw(d))return;const h=Ww(d,o);h&&u.set(h)});for(const u in t){const d=t[u];if(!Nw(d))continue;const h=Ww(d,o);h&&(t[u]=h,r||(r={}),r[u]===void 0&&(r[u]=d))}return{target:t,transitionEnd:r}}const rq=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),JD=e=>rq.has(e),nq=e=>Object.keys(e).some(JD),dk=e=>e===hh||e===Ft,pk=(e,t)=>parseFloat(e.split(", ")[t]),fk=(e,t)=>(r,{transform:o})=>{if(o==="none"||!o)return 0;const u=o.match(/^matrix3d\((.+)\)$/);if(u)return pk(u[1],t);{const d=o.match(/^matrix\((.+)\)$/);return d?pk(d[1],e):0}},iq=new Set(["x","y","z"]),oq=vg.filter(e=>!iq.has(e));function sq(e){const t=[];return oq.forEach(r=>{const o=e.getValue(r);o!==void 0&&(t.push([r,o.get()]),o.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const hp={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:fk(4,13),y:fk(5,14)};hp.translateX=hp.x;hp.translateY=hp.y;const aq=(e,t,r)=>{const o=t.measureViewportBox(),u=t.current,d=getComputedStyle(u),{display:h}=d,s={};h==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(w=>{s[w]=hp[w](o,d)}),t.render();const b=t.measureViewportBox();return r.forEach(w=>{const C=t.getValue(w);C&&C.jump(s[w]),e[w]=hp[w](b,d)}),e},lq=(e,t,r={},o={})=>{t={...t},o={...o};const u=Object.keys(t).filter(JD);let d=[],h=!1;const s=[];if(u.forEach(b=>{const w=e.getValue(b);if(!e.hasValue(b))return;let C=r[b],k=Wf(C);const I=t[b];let A;if(M0(I)){const B=I.length,F=I[0]===null?1:0;C=I[F],k=Wf(C);for(let X=F;X<B&&I[X]!==null;X++)A?VS(Wf(I[X])===A):A=Wf(I[X])}else A=Wf(I);if(k!==A)if(dk(k)&&dk(A)){const B=w.get();typeof B=="string"&&w.set(parseFloat(B)),typeof I=="string"?t[b]=parseFloat(I):Array.isArray(I)&&A===Ft&&(t[b]=I.map(parseFloat))}else k!=null&&k.transform&&(A!=null&&A.transform)&&(C===0||I===0)?C===0?w.set(A.transform(C)):t[b]=k.transform(I):(h||(d=sq(e),h=!0),s.push(b),o[b]=o[b]!==void 0?o[b]:t[b],w.jump(I))}),s.length){const b=s.indexOf("height")>=0?window.pageYOffset:null,w=aq(t,e,s);return d.length&&d.forEach(([C,k])=>{e.getValue(C).set(k)}),e.render(),x_&&b!==null&&window.scrollTo({top:b}),{target:w,transitionEnd:o}}else return{target:t,transitionEnd:o}};function cq(e,t,r,o){return nq(t)?lq(e,t,r,o):{target:t,transitionEnd:o}}const uq=(e,t,r,o)=>{const u=tq(e,t,o);return t=u.target,o=u.transitionEnd,cq(e,t,r,o)},Hw={current:null},e3={current:!1};function hq(){if(e3.current=!0,!!x_)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Hw.current=e.matches;e.addListener(t),t()}else Hw.current=!1}function dq(e,t,r){const{willChange:o}=t;for(const u in t){const d=t[u],h=r[u];if(so(d))e.addValue(u,d),R0(o)&&o.add(u);else if(so(h))e.addValue(u,up(d,{owner:e})),R0(o)&&o.remove(u);else if(h!==d)if(e.hasValue(u)){const s=e.getValue(u);!s.hasAnimated&&s.set(d)}else{const s=e.getStaticValue(u);e.addValue(u,up(s!==void 0?s:d,{owner:e}))}}for(const u in r)t[u]===void 0&&e.removeValue(u);return t}const mk=new WeakMap,t3=Object.keys(Wm),pq=t3.length,gk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],fq=LS.length;class mq{constructor({parent:t,props:r,presenceContext:o,reducedMotionConfig:u,visualState:d},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>$r.render(this.render,!1,!0);const{latestValues:s,renderState:b}=d;this.latestValues=s,this.baseTarget={...s},this.initialValues=r.initial?{...s}:{},this.renderState=b,this.parent=t,this.props=r,this.presenceContext=o,this.depth=t?t.depth+1:0,this.reducedMotionConfig=u,this.options=h,this.isControllingVariants=w_(r),this.isVariantNode=FL(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:w,...C}=this.scrapeMotionValuesFromProps(r,{});for(const k in C){const I=C[k];s[k]!==void 0&&so(I)&&(I.set(s[k],!1),R0(w)&&w.add(k))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,mk.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),e3.current||hq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Hw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){mk.delete(this.current),this.projection&&this.projection.unmount(),nl(this.notifyUpdate),nl(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const o=uh.has(t),u=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&$r.update(this.notifyUpdate,!1,!0),o&&this.projection&&(this.projection.isTransformDirty=!0)}),d=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{u(),d()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},o,u,d){let h,s;for(let b=0;b<pq;b++){const w=t3[b],{isEnabled:C,Feature:k,ProjectionNode:I,MeasureLayout:A}=Wm[w];I&&(h=I),C(r)&&(!this.features[w]&&k&&(this.features[w]=new k(this)),A&&(s=A))}if((this.type==="html"||this.type==="svg")&&!this.projection&&h){this.projection=new h(this.latestValues,this.parent&&this.parent.projection);const{layoutId:b,layout:w,drag:C,dragConstraints:k,layoutScroll:I,layoutRoot:A}=r;this.projection.setOptions({layoutId:b,layout:w,alwaysMeasureLayout:!!C||k&&Md(k),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof w=="string"?w:"both",initialPromotionConfig:d,layoutScroll:I,layoutRoot:A})}return s}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):zn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let o=0;o<gk.length;o++){const u=gk[o];this.propEventSubscriptions[u]&&(this.propEventSubscriptions[u](),delete this.propEventSubscriptions[u]);const d=t["on"+u];d&&(this.propEventSubscriptions[u]=this.on(u,d))}this.prevMotionValues=dq(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const o=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(o.initial=this.props.initial),o}const r={};for(let o=0;o<fq;o++){const u=LS[o],d=this.props[u];(Zm(d)||d===!1)&&(r[u]=d)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let o=this.values.get(t);return o===void 0&&r!==void 0&&(o=up(r,{owner:this}),this.addValue(t,o)),o}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:o}=this.props,u=typeof o=="string"||typeof o=="object"?(r=$S(this.props,o))===null||r===void 0?void 0:r[t]:void 0;if(o&&u!==void 0)return u;const d=this.getBaseTargetFromProps(this.props,t);return d!==void 0&&!so(d)?d:this.initialValues[t]!==void 0&&u===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new YS),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class r3 extends mq{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:o}){delete r[t],delete o[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...o},{transformValues:u},d){let h=R9(o,t||{},this);if(u&&(r&&(r=u(r)),o&&(o=u(o)),h&&(h=u(h))),d){A9(this,o,h);const s=uq(this,o,h,r);r=s.transitionEnd,o=s.target}return{transition:t,transitionEnd:r,...o}}}function gq(e){return window.getComputedStyle(e)}class yq extends r3{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(uh.has(r)){const o=ZS(r);return o&&o.default||0}else{const o=gq(t),u=(UL(r)?o.getPropertyValue(r):o[r])||0;return typeof u=="string"?u.trim():u}}measureInstanceViewportBox(t,{transformPagePoint:r}){return UD(t,r)}build(t,r,o,u){NS(t,r,o,u.transformTemplate)}scrapeMotionValuesFromProps(t,r){return BS(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;so(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,o,u){KL(t,r,o,u)}}class vq extends r3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(uh.has(r)){const o=ZS(r);return o&&o.default||0}return r=XL.has(r)?r:IS(r),t.getAttribute(r)}measureInstanceViewportBox(){return zn()}scrapeMotionValuesFromProps(t,r){return QL(t,r)}build(t,r,o,u){OS(t,r,o,this.isSVGTag,u.transformTemplate)}renderInstance(t,r,o,u){YL(t,r,o,u)}mount(t){this.isSVGTag=FS(t.tagName),super.mount(t)}}const _q=(e,t)=>zS(e)?new vq(t,{enableHardwareAcceleration:!1}):new yq(t,{enableHardwareAcceleration:!0}),xq={layout:{ProjectionNode:QD,MeasureLayout:qD}},bq={...W9,...p7,...QG,...xq},Vt=wU((e,t)=>e7(e,t,bq,_q));function n3(){const e=K.useRef(!1);return AS(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function wq(){const e=n3(),[t,r]=K.useState(0),o=K.useCallback(()=>{e.current&&r(t+1)},[t]);return[K.useCallback(()=>$r.postRender(o),[o]),t]}class Sq extends K.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Tq({children:e,isPresent:t}){const r=K.useId(),o=K.useRef(null),u=K.useRef({width:0,height:0,top:0,left:0});return K.useInsertionEffect(()=>{const{width:d,height:h,top:s,left:b}=u.current;if(t||!o.current||!d||!h)return;o.current.dataset.motionPopId=r;const w=document.createElement("style");return document.head.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            top: ${s}px !important;
            left: ${b}px !important;
          }
        `),()=>{document.head.removeChild(w)}},[t]),K.createElement(Sq,{isPresent:t,childRef:o,sizeRef:u},K.cloneElement(e,{ref:o}))}const tb=({children:e,initial:t,isPresent:r,onExitComplete:o,custom:u,presenceAffectsLayout:d,mode:h})=>{const s=JL(Cq),b=K.useId(),w=K.useMemo(()=>({id:b,initial:t,isPresent:r,custom:u,onExitComplete:C=>{s.set(C,!0);for(const k of s.values())if(!k)return;o&&o()},register:C=>(s.set(C,!1),()=>s.delete(C))}),d?void 0:[r]);return K.useMemo(()=>{s.forEach((C,k)=>s.set(k,!1))},[r]),K.useEffect(()=>{!r&&!s.size&&o&&o()},[r]),h==="popLayout"&&(e=K.createElement(Tq,{isPresent:r},e)),K.createElement(__.Provider,{value:w},e)};function Cq(){return new Map}function Pq(e){return K.useEffect(()=>()=>e(),[])}const Pu=e=>e.key||"";function Eq(e,t){e.forEach(r=>{const o=Pu(r);t.set(o,r)})}function Mq(e){const t=[];return K.Children.forEach(e,r=>{K.isValidElement(r)&&t.push(r)}),t}const Km=({children:e,custom:t,initial:r=!0,onExitComplete:o,exitBeforeEnter:u,presenceAffectsLayout:d=!0,mode:h="sync"})=>{const s=K.useContext(DS).forceRender||wq()[0],b=n3(),w=Mq(e);let C=w;const k=K.useRef(new Map).current,I=K.useRef(C),A=K.useRef(new Map).current,B=K.useRef(!0);if(AS(()=>{B.current=!1,Eq(w,A),I.current=C}),Pq(()=>{B.current=!0,A.clear(),k.clear()}),B.current)return K.createElement(K.Fragment,null,C.map(V=>K.createElement(tb,{key:Pu(V),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:d,mode:h},V)));C=[...C];const F=I.current.map(Pu),X=w.map(Pu),q=F.length;for(let V=0;V<q;V++){const U=F[V];X.indexOf(U)===-1&&!k.has(U)&&k.set(U,void 0)}return h==="wait"&&k.size&&(C=[]),k.forEach((V,U)=>{if(X.indexOf(U)!==-1)return;const ne=A.get(U);if(!ne)return;const de=F.indexOf(U);let xe=V;if(!xe){const ke=()=>{k.delete(U);const ze=Array.from(A.keys()).filter(We=>!X.includes(We));if(ze.forEach(We=>A.delete(We)),I.current=w.filter(We=>{const rt=Pu(We);return rt===U||ze.includes(rt)}),!k.size){if(b.current===!1)return;s(),o&&o()}};xe=K.createElement(tb,{key:Pu(ne),isPresent:!1,onExitComplete:ke,custom:t,presenceAffectsLayout:d,mode:h},ne),k.set(U,xe)}C.splice(de,0,xe)}),C=C.map(V=>{const U=V.key;return k.has(U)?V:K.createElement(tb,{key:Pu(V),isPresent:!0,presenceAffectsLayout:d,mode:h},V)}),K.createElement(K.Fragment,null,k.size?C:C.map(V=>K.cloneElement(V)))},uv=e=>{const t=e.split(`
`);if(t.length<2)return[];const r=t[0].split(",").map(u=>u.replace(/^"/,"").replace(/"$/,"").trim()),o=[];for(let u=1;u<t.length;u++){const d=t[u].trim();if(!d)continue;const h=[];let s="",b=!1;for(let C=0;C<d.length;C++){const k=d[C],I=d[C+1];k==='"'?b&&I==='"'?(s+='"',C++):b=!b:k===","&&!b?(h.push(s.trim()),s=""):s+=k}h.push(s.trim());const w={};r.forEach((C,k)=>{w[C]=h[k]||""}),o.push(w)}return o},kq=e=>e.map(t=>({id:t.ID||"",createdDate:t["Created Date"]||"",updatedDate:t["Updated Date"]||"",owner:t.Owner||"",capitulo:parseInt(t.capitulo||"0"),nome:t.Nome||"",ensinamento:t.Ensinamento||"",descPersonagem:t["Desc. Personagem"]||"",ocupacao:t.Ocupação||t.Ocupacao||"",significado:t.Significado||"",local:t.Local||"",resumoCap:t["Resumo do Cap. (84000.co)"]||"",capFileName:t["Cap. FILE NAME"]||"",capUrl:t["Cap. URL"]||"",qrCodeUrl:t["QR Code URL"]||"",linkModel:t["LINK MODEL"]||""})),Aq=e=>e.map(t=>({id:t.ID||"",createdDate:t["Created Date"]||"",updatedDate:t["Updated Date"]||"",owner:t.Owner||"",chapter:parseInt(t.chapter||"0"),name:t.Name||"",teaching:t.Teaching||"",characterDesc:t["Character Desc"]||"",occupation:t.Occupation||"",meaning:t.Meaning||"",location:t.Location||"",chapterSummary:t["Chapter Summary"]||"",capFileName:t["Cap. FILE NAME"]||"",capUrl:t["Cap. URL"]||"",qrCodeUrl:t["QR Code URL"]||"",linkModel:t["LINK MODEL"]||""})),Iq=e=>e.map(t=>({id:t.ID||"",createdDate:t["Created Date"]||"",updatedDate:t["Updated Date"]||"",owner:t.Owner||"",chapter:parseInt(t.chapter||"0"),character:t.Character||"",meaning:t.Meaning||"",location:t.Location||"",encounter:t.Encounter||"",assembly:t.Assembly||"",dialogue:t.Dialogue||"",teaching:t.Teaching||"",manifestation:t.Manifestation||"",learning:t.Learning||"",direction:t.Direction||"",literaryStructure:t["Literary Structure"]||""})),Rq=e=>e.map(t=>({id:t.ID||"",createdDate:t["Created Date"]||"",updatedDate:t["Updated Date"]||"",owner:t.Owner||"",chapter:parseInt(t.chapter||"0"),character:t.Character||"",meaning:t.Meaning||"",location:t.Location||"",encounter:t.Encounter||"",assembly:t.Assembly||"",dialogue:t.Dialogue||"",teaching:t.Teaching||"",manifestation:t.Manifestation||"",learning:t.Learning||"",direction:t.Direction||"",literaryStructure:t["Literary Structure"]||""})),QS=()=>{const[e,t]=K.useState(null),[r,o]=K.useState(!0),[u,d]=K.useState(null);K.useEffect(()=>{(async()=>{try{o(!0);const[w,C,k,I]=await Promise.all([fetch("/characters.csv"),fetch("/characters_en.csv"),fetch("/chapters.csv"),fetch("/chapters_en.csv")]);if(!w.ok||!C.ok||!k.ok||!I.ok)throw new Error("Failed to load CSV files");const[A,B,F,X]=await Promise.all([w.text(),C.text(),k.text(),I.text()]),q=uv(A),V=uv(B),U=uv(F),ne=uv(X),de=kq(q),xe=Aq(V),ke=Iq(U),ze=Rq(ne);t({characters:de,charactersEN:xe,chapters:ke,chaptersEN:ze}),console.log("Sutra data loaded successfully:",{characters:de.length,charactersEN:xe.length,chapters:ke.length,chaptersEN:ze.length})}catch(w){console.error("Error loading CSV data:",w),d(w instanceof Error?w.message:"Unknown error")}finally{o(!1)}})()},[]);const h=(b="pt")=>{if(!e)return[];const w=b==="pt"?e.characters:e.charactersEN,C=b==="pt"?e.chapters:e.chaptersEN;return w.map(k=>{var A,B,F,X,q,V,U,ne,de,xe,ke,ze,We,rt;const I=C.find(Ze=>Ze.chapter===(b==="pt"?k.capitulo:k.chapter));if(b==="pt"){const Ze=k;return{id:Ze.id,chapter:Ze.capitulo,nome:Ze.nome,name:((A=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:A.name)||Ze.nome,ocupacao:Ze.ocupacao,occupation:((B=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:B.occupation)||Ze.ocupacao,significado:Ze.significado,meaning:((F=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:F.meaning)||Ze.significado,local:Ze.local,location:((X=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:X.location)||Ze.local,ensinamento:Ze.ensinamento,teaching:((q=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:q.teaching)||Ze.ensinamento,descPersonagem:Ze.descPersonagem,characterDesc:((V=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:V.characterDesc)||Ze.descPersonagem,resumoCap:Ze.resumoCap,chapterSummary:((U=e.charactersEN.find(He=>He.chapter===Ze.capitulo))==null?void 0:U.chapterSummary)||Ze.resumoCap,linkModel:Ze.linkModel,capUrl:Ze.capUrl,qrCodeUrl:Ze.qrCodeUrl,encounter:I==null?void 0:I.encounter,assembly:I==null?void 0:I.assembly,dialogue:I==null?void 0:I.dialogue,manifestation:I==null?void 0:I.manifestation,learning:I==null?void 0:I.learning,direction:I==null?void 0:I.direction,literaryStructure:I==null?void 0:I.literaryStructure}}else{const Ze=k;return{id:Ze.id,chapter:Ze.chapter,nome:((ne=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:ne.nome)||Ze.name,name:Ze.name,ocupacao:((de=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:de.ocupacao)||Ze.occupation,occupation:Ze.occupation,significado:((xe=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:xe.significado)||Ze.meaning,meaning:Ze.meaning,local:((ke=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:ke.local)||Ze.location,location:Ze.location,ensinamento:((ze=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:ze.ensinamento)||Ze.teaching,teaching:Ze.teaching,descPersonagem:((We=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:We.descPersonagem)||Ze.characterDesc,characterDesc:Ze.characterDesc,resumoCap:((rt=e.characters.find(He=>He.capitulo===Ze.chapter))==null?void 0:rt.resumoCap)||Ze.chapterSummary,chapterSummary:Ze.chapterSummary,linkModel:Ze.linkModel,capUrl:Ze.capUrl,qrCodeUrl:Ze.qrCodeUrl,encounter:I==null?void 0:I.encounter,assembly:I==null?void 0:I.assembly,dialogue:I==null?void 0:I.dialogue,manifestation:I==null?void 0:I.manifestation,learning:I==null?void 0:I.learning,direction:I==null?void 0:I.direction,literaryStructure:I==null?void 0:I.literaryStructure}}}).sort((k,I)=>k.chapter-I.chapter)};return{data:e,loading:r,error:u,getCombinedData:h,getCharacterByChapter:(b,w="pt")=>h(w).find(C=>C.chapter===b)}},Lq=()=>{const{getCombinedData:e,loading:t}=QS(),[r,o]=K.useState([]);K.useEffect(()=>{if(!t){const s=e("pt");if(s.length>0){const b=[...s].sort(()=>.5-Math.random());o(b.slice(0,3))}}},[t]);const u=[{icon:eh,title:"Rota Original",description:"Explore os 56 pontos sagrados da peregrinação original em Águas da Prata, SP",link:"/map",color:"text-primary",gradient:"gradient-neon"},{icon:_0,title:"Galeria 3D",description:"Visualize os personagens místicos em realidade aumentada",link:"/gallery",color:"text-accent",gradient:"bg-gradient-to-r from-purple-500 to-pink-500"},{icon:pS,title:"Criar Rota",description:"Crie sua própria jornada espiritual em qualquer lugar do mundo",link:"/route-creator",color:"text-yellow-400",gradient:"bg-gradient-to-r from-yellow-400 to-orange-500"}],d={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},h={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}};return j.jsxs("div",{className:"min-h-screen bg-background relative overflow-hidden",children:[j.jsxs("div",{className:"absolute inset-0",children:[j.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-card"}),j.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-primary/5 rounded-full blur-3xl animate-pulse"}),j.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent/5 rounded-full blur-3xl animate-pulse delay-700"})]}),j.jsxs("div",{className:"relative z-10 container mx-auto px-6 py-12",children:[j.jsxs(Vt.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},transition:{duration:.8},className:"text-center mb-16",children:[j.jsxs("div",{className:"mb-8",children:[j.jsx("h1",{className:"text-6xl md:text-8xl font-bold text-primary text-glow mb-4",children:"Techno Sutra"}),j.jsx("div",{className:"h-1 w-32 gradient-neon mx-auto mb-6 rounded-full"}),j.jsx("p",{className:"text-xl md:text-2xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:"A jornada espiritual ancestral encontra a tecnologia cyberpunk. Explore os 56 capítulos sagrados do Sutra Stem Array em uma experiência imersiva única."})]}),j.jsxs(Vt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.5},className:"flex flex-wrap justify-center gap-4",children:[j.jsx(ar,{asChild:!0,className:"gradient-neon text-black font-bold text-lg px-8 py-3 neon-glow",children:j.jsxs(Xl,{to:"/map",children:[j.jsx(ww,{className:"w-5 h-5 mr-2"}),"Iniciar Jornada"]})}),j.jsx(ar,{asChild:!0,variant:"outline",className:"border-neon text-lg px-8 py-3",children:j.jsxs(Xl,{to:"/gallery",children:[j.jsx(dS,{className:"w-5 h-5 mr-2"}),"Explorar Galeria"]})})]})]}),j.jsx(Vt.div,{variants:d,initial:"hidden",animate:"visible",className:"grid md:grid-cols-3 gap-8 mb-16",children:u.map((s,b)=>{const w=s.icon;return j.jsx(Vt.div,{variants:h,children:j.jsx(ri,{className:"cyberpunk-card p-8 h-full group cursor-pointer",children:j.jsx(Xl,{to:s.link,className:"block h-full",children:j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:`inline-flex p-4 rounded-full ${s.gradient} mb-6 group-hover:scale-110 transition-transform`,children:j.jsx(w,{className:"w-8 h-8 text-black"})}),j.jsx("h3",{className:`text-2xl font-bold mb-4 ${s.color} text-glow`,children:s.title}),j.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description}),j.jsx("div",{className:"mt-6",children:j.jsx(ar,{variant:"ghost",className:`${s.color} hover:bg-current/10`,children:"Explorar →"})})]})})})},b)})}),j.jsx(Vt.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.8,duration:.6},className:"text-center mb-16",children:j.jsxs(ri,{className:"cyberpunk-card p-8 max-w-4xl mx-auto",children:[j.jsx("h2",{className:"text-3xl font-bold text-primary text-glow mb-8",children:"A Jornada em Números"}),j.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[{number:"56",label:"Capítulos Sagrados",color:"text-primary"},{number:"56",label:"Modelos 3D",color:"text-accent"},{number:"∞",label:"Rotas Possíveis",color:"text-yellow-400"},{number:"1",label:"Destino Espiritual",color:"text-green-400"}].map((s,b)=>j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:`text-4xl md:text-5xl font-bold ${s.color} text-glow mb-2`,children:s.number}),j.jsx("div",{className:"text-muted-foreground text-sm",children:s.label})]},b))})]})}),j.jsx(Vt.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:1,duration:.6},className:"text-center mb-16",children:j.jsxs(ri,{className:"cyberpunk-card p-12 max-w-2xl mx-auto",children:[j.jsx(MR,{className:"w-16 h-16 text-primary mx-auto mb-6"}),j.jsx("h2",{className:"text-3xl font-bold text-primary text-glow mb-4",children:"Pronto para Começar?"}),j.jsx("p",{className:"text-muted-foreground mb-8 text-lg",children:"Embarque em uma jornada que transcende tempo e espaço. O caminho da iluminação aguarda."}),j.jsx(ar,{asChild:!0,className:"gradient-neon text-black font-bold text-xl px-12 py-4 neon-glow",children:j.jsx(Xl,{to:"/map",children:"Iniciar Peregrinação Sagrada"})})]})}),r.length>0&&j.jsxs(Vt.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:1.2,duration:.6},className:"mb-16",children:[j.jsx("h2",{className:"text-3xl font-bold text-primary text-glow text-center mb-8",children:"Personagens Destacados"}),j.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:r.map((s,b)=>j.jsx(Vt.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:1.4+b*.1},children:j.jsx(ri,{className:"cyberpunk-card p-6 h-full group cursor-pointer",children:j.jsxs(Xl,{to:"/gallery",className:"block h-full",children:[j.jsxs("div",{className:"text-center mb-4",children:[j.jsx("div",{className:"inline-flex p-3 rounded-full bg-gradient-to-r from-primary/20 to-accent/20 mb-4 group-hover:scale-110 transition-transform",children:j.jsx(y0,{className:"w-6 h-6 text-primary"})}),j.jsx("h3",{className:"text-lg font-bold text-primary text-glow mb-2",children:s.nome}),j.jsxs("p",{className:"text-sm text-accent mb-2",children:["Capítulo ",s.chapter," • ",s.ocupacao]}),j.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["📍 ",s.local]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs("div",{className:"text-xs",children:[j.jsx("span",{className:"text-yellow-400 font-bold",children:"Significado:"}),j.jsx("p",{className:"text-muted-foreground line-clamp-2",children:s.significado})]}),j.jsxs("div",{className:"text-xs",children:[j.jsx("span",{className:"text-cyan-400 font-bold",children:"Ensinamento:"}),j.jsxs("p",{className:"text-muted-foreground line-clamp-3",children:[s.ensinamento.substring(0,120),"..."]})]})]}),j.jsx("div",{className:"mt-4",children:j.jsx(ar,{variant:"ghost",size:"sm",className:"w-full text-primary hover:bg-primary/10",children:"Explorar Personagem →"})})]})})},s.chapter))})]}),j.jsx(Vt.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:1.6,duration:.6},className:"text-center",children:j.jsxs(ri,{className:"cyberpunk-card p-8 max-w-4xl mx-auto",children:[j.jsx("h2",{className:"text-2xl font-bold text-primary text-glow mb-6",children:"Tecnologia Avançada"}),j.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[j.jsxs("div",{className:"text-center",children:[j.jsx(Sw,{className:"w-8 h-8 text-cyan-400 mx-auto mb-3"}),j.jsx("h3",{className:"font-bold text-accent mb-2",children:"Modo Cyberpunk"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Visualização com inversão de cores e efeitos neon para uma experiência imersiva"})]}),j.jsxs("div",{className:"text-center",children:[j.jsx(_0,{className:"w-8 h-8 text-purple-400 mx-auto mb-3"}),j.jsx("h3",{className:"font-bold text-accent mb-2",children:"Modelos 3D"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Personagens em alta qualidade com suporte a realidade aumentada"})]}),j.jsxs("div",{className:"text-center",children:[j.jsx(eh,{className:"w-8 h-8 text-yellow-400 mx-auto mb-3"}),j.jsx("h3",{className:"font-bold text-accent mb-2",children:"Edição Interativa"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Reposicione pontos da trilha com arrastar e soltar intuitivo"})]})]})]})})]})]})};var i3={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */(function(e,t){(function(r,o){e.exports=o()})(GN,function(){var r={},o={};function u(h,s,b){if(o[h]=b,h==="index"){var w="var sharedModule = {}; ("+o.shared+")(sharedModule); ("+o.worker+")(sharedModule);",C={};return o.shared(C),o.index(r,C),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([w],{type:"text/javascript"}))),r}}u("shared",["exports"],function(h){function s(c,i,l,p){return new(l||(l=Promise))(function(g,_){function x(R){try{E(p.next(R))}catch(D){_(D)}}function T(R){try{E(p.throw(R))}catch(D){_(D)}}function E(R){var D;R.done?g(R.value):(D=R.value,D instanceof l?D:new l(function(N){N(D)})).then(x,T)}E((p=p.apply(c,i||[])).next())})}function b(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var w,C;function k(){if(C)return w;function c(i,l){this.x=i,this.y=l}return C=1,w=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,l){return this.clone()._rotateAround(i,l)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var l=i.x-this.x,p=i.y-this.y;return l*l+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,l){return Math.atan2(this.x*l-this.y*i,this.x*i+this.y*l)},_matMult:function(i){var l=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=l,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var l=Math.cos(i),p=Math.sin(i),g=p*this.x+l*this.y;return this.x=l*this.x-p*this.y,this.y=g,this},_rotateAround:function(i,l){var p=Math.cos(i),g=Math.sin(i),_=l.y+g*(this.x-l.x)+p*(this.y-l.y);return this.x=l.x+p*(this.x-l.x)-g*(this.y-l.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(i){return i instanceof c?i:Array.isArray(i)?new c(i[0],i[1]):i},w}typeof SuppressedError=="function"&&SuppressedError;var I,A,B=b(k()),F=function(){if(A)return I;function c(i,l,p,g){this.cx=3*i,this.bx=3*(p-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(g-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=p,this.p2y=g}return A=1,I=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,l){if(l===void 0&&(l=1e-6),i<0)return 0;if(i>1)return 1;for(var p=i,g=0;g<8;g++){var _=this.sampleCurveX(p)-i;if(Math.abs(_)<l)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=_/x}var T=0,E=1;for(p=i,g=0;g<20&&(_=this.sampleCurveX(p),!(Math.abs(_-i)<l));g++)i>_?T=p:E=p,p=.5*(E-T)+T;return p},solve:function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))}},I}(),X=b(F);let q,V;function U(){return q==null&&(q=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),q}function ne(){if(V==null&&(V=!1,U())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let p=0;p<5*5;p++){const g=4*p;i.fillStyle=`rgb(${g},${g+1},${g+2})`,i.fillRect(p%5,Math.floor(p/5),1,1)}const l=i.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&l[p]!==p){V=!0;break}}}return V||!1}var de=1e-6,xe=typeof Float32Array<"u"?Float32Array:Array;function ke(){var c=new xe(9);return xe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function ze(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function We(){var c=new xe(3);return xe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function rt(c){return Math.hypot(c[0],c[1],c[2])}function Ze(c,i,l){var p=new xe(3);return p[0]=c,p[1]=i,p[2]=l,p}function He(c,i,l){return c[0]=i[0]+l[0],c[1]=i[1]+l[1],c[2]=i[2]+l[2],c}function Ct(c,i,l){return c[0]=i[0]*l,c[1]=i[1]*l,c[2]=i[2]*l,c}function st(c,i,l){var p=i[0],g=i[1],_=i[2],x=l[0],T=l[1],E=l[2];return c[0]=g*E-_*T,c[1]=_*x-p*E,c[2]=p*T-g*x,c}Math.hypot||(Math.hypot=function(){for(var c=0,i=arguments.length;i--;)c+=arguments[i]*arguments[i];return Math.sqrt(c)});var Ge,tt=rt;function ut(c,i,l){var p=i[0],g=i[1],_=i[2],x=i[3];return c[0]=l[0]*p+l[4]*g+l[8]*_+l[12]*x,c[1]=l[1]*p+l[5]*g+l[9]*_+l[13]*x,c[2]=l[2]*p+l[6]*g+l[10]*_+l[14]*x,c[3]=l[3]*p+l[7]*g+l[11]*_+l[15]*x,c}function Ve(){var c=new xe(4);return xe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function De(c,i,l,p){var g=.5*Math.PI/180;i*=g,l*=g,p*=g;var _=Math.sin(i),x=Math.cos(i),T=Math.sin(l),E=Math.cos(l),R=Math.sin(p),D=Math.cos(p);return c[0]=_*E*D-x*T*R,c[1]=x*T*D+_*E*R,c[2]=x*E*R-_*T*D,c[3]=x*E*D+_*T*R,c}function Ke(){var c=new xe(2);return xe!=Float32Array&&(c[0]=0,c[1]=0),c}function nt(c,i){var l=new xe(2);return l[0]=c,l[1]=i,l}We(),Ge=new xe(4),xe!=Float32Array&&(Ge[0]=0,Ge[1]=0,Ge[2]=0,Ge[3]=0),We(),Ze(1,0,0),Ze(0,1,0),Ve(),Ve(),ke(),Ke();const ot=8192;function Et(c,i,l){return i*(ot/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}function Rt(c,i){return(c%i+i)%i}function lr(c,i,l){return c*(1-l)+i*l}function gr(c){if(c<=0)return 0;if(c>=1)return 1;const i=c*c,l=i*c;return 4*(c<.5?l:3*(c-i)+l-.75)}function Xt(c,i,l,p){const g=new X(c,i,l,p);return _=>g.solve(_)}const Ii=Xt(.25,.1,.25,1);function yr(c,i,l){return Math.min(l,Math.max(i,c))}function Cn(c,i,l){const p=l-i,g=((c-i)%p+p)%p+i;return g===i?l:g}function br(c,...i){for(const l of i)for(const p in l)c[p]=l[p];return c}let Ri=1;function vr(c,i,l){const p={};for(const g in c)p[g]=i.call(this,c[g],g,c);return p}function ii(c,i,l){const p={};for(const g in c)i.call(this,c[g],g,c)&&(p[g]=c[g]);return p}function Xn(c){return Array.isArray(c)?c.map(Xn):typeof c=="object"&&c?vr(c,Xn):c}const ao={};function en(c){ao[c]||(typeof console<"u"&&console.warn(c),ao[c]=!0)}function yn(c,i,l){return(l.y-c.y)*(i.x-c.x)>(i.y-c.y)*(l.x-c.x)}function tn(c){return typeof WorkerGlobalScope<"u"&&c!==void 0&&c instanceof WorkerGlobalScope}let Lo=null;function yi(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const Os="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function oi(c,i,l,p,g){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(c,{timestamp:0});try{const x=_==null?void 0:_.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const T=x.startsWith("BGR"),E=new Uint8ClampedArray(p*g*4);if(yield _.copyTo(E,function(R,D,N,G,H){const Y=4*Math.max(-D,0),J=(Math.max(0,N)-N)*G*4+Y,ie=4*G,ce=Math.max(0,D),Se=Math.max(0,N);return{rect:{x:ce,y:Se,width:Math.min(R.width,D+G)-ce,height:Math.min(R.height,N+H)-Se},layout:[{offset:J,stride:ie}]}}(c,i,l,p,g)),T)for(let R=0;R<E.length;R+=4){const D=E[R];E[R]=E[R+2],E[R+2]=D}return E}finally{_.close()}})}let lo,ns;function Hr(c,i,l,p){return c.addEventListener(i,l,p),{unsubscribe:()=>{c.removeEventListener(i,l,p)}}}function un(c){return c*Math.PI/180}function Ki(c){return c/Math.PI*180}const xa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},is={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},co="AbortError";function Ee(){return new Error(co)}const ee={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function te(c){return ee.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const oe="global-dispatcher";class fe extends Error{constructor(i,l,p,g){super(`AJAXError: ${l} (${i}): ${p}`),this.status=i,this.statusText=l,this.url=p,this.body=g}}const we=()=>tn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pe=function(c,i){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const p=te(c.url);if(p)return p(c,i);if(tn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:oe},i)}if(!(/^file:/.test(l=c.url)||/^file:/.test(we())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,g){return s(this,void 0,void 0,function*(){const _=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:we(),signal:g.signal});let x,T;p.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{x=yield fetch(_)}catch(R){throw new fe(0,R.message,p.url,new Blob)}if(!x.ok){const R=yield x.blob();throw new fe(x.status,x.statusText,p.url,R)}T=p.type==="arrayBuffer"||p.type==="image"?x.arrayBuffer():p.type==="json"?x.json():x.text();const E=yield T;if(g.signal.aborted)throw Ee();return{data:E,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(c,i);if(tn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:oe},i)}var l;return function(p,g){return new Promise((_,x)=>{var T;const E=new XMLHttpRequest;E.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(E.responseType="arraybuffer");for(const R in p.headers)E.setRequestHeader(R,p.headers[R]);p.type==="json"&&(E.responseType="text",!((T=p.headers)===null||T===void 0)&&T.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=p.credentials==="include",E.onerror=()=>{x(new Error(E.statusText))},E.onload=()=>{if(!g.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let R=E.response;if(p.type==="json")try{R=JSON.parse(E.response)}catch(D){return void x(D)}_({data:R,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const R=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});x(new fe(E.status,E.statusText,p.url,R))}},g.signal.addEventListener("abort",()=>{E.abort(),x(Ee())}),E.send(p.body)})}(c,i)};function Re(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const i=new URL(c),l=window.location;return i.protocol===l.protocol&&i.host===l.host}function Te(c,i,l){l[c]&&l[c].indexOf(i)!==-1||(l[c]=l[c]||[],l[c].push(i))}function $e(c,i,l){if(l&&l[c]){const p=l[c].indexOf(i);p!==-1&&l[c].splice(p,1)}}class Fe{constructor(i,l={}){br(this,l),this.type=i}}class Me extends Fe{constructor(i,l={}){super("error",br({error:i},l))}}class qe{on(i,l){return this._listeners=this._listeners||{},Te(i,l,this._listeners),{unsubscribe:()=>{this.off(i,l)}}}off(i,l){return $e(i,l,this._listeners),$e(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Te(i,l,this._oneTimeListeners),this):new Promise(p=>this.once(i,p))}fire(i,l){typeof i=="string"&&(i=new Fe(i,l||{}));const p=i.type;if(this.listens(p)){i.target=this;const g=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const T of g)T.call(this,i);const _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const T of _)$e(p,T,this._oneTimeListeners),T.call(this,i);const x=this._eventedParent;x&&(br(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof Me&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Je=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function vt(c,i){const l={};for(const p in c)p!=="ref"&&(l[p]=c[p]);return Je.forEach(p=>{p in i&&(l[p]=i[p])}),l}function mt(c,i){if(Array.isArray(c)){if(!Array.isArray(i)||c.length!==i.length)return!1;for(let l=0;l<c.length;l++)if(!mt(c[l],i[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&i!==null){if(typeof i!="object"||Object.keys(c).length!==Object.keys(i).length)return!1;for(const l in c)if(!mt(c[l],i[l]))return!1;return!0}return c===i}function xt(c,i){c.push(i)}function At(c,i,l){xt(l,{command:"addSource",args:[c,i[c]]})}function ur(c,i,l){xt(i,{command:"removeSource",args:[c]}),l[c]=!0}function Ut(c,i,l,p){ur(c,l,p),At(c,i,l)}function Gt(c,i,l){let p;for(p in c[l])if(Object.prototype.hasOwnProperty.call(c[l],p)&&p!=="data"&&!mt(c[l][p],i[l][p]))return!1;for(p in i[l])if(Object.prototype.hasOwnProperty.call(i[l],p)&&p!=="data"&&!mt(c[l][p],i[l][p]))return!1;return!0}function Nt(c,i,l,p,g,_){c=c||{},i=i||{};for(const x in c)Object.prototype.hasOwnProperty.call(c,x)&&(mt(c[x],i[x])||l.push({command:_,args:[p,x,i[x],g]}));for(const x in i)Object.prototype.hasOwnProperty.call(i,x)&&!Object.prototype.hasOwnProperty.call(c,x)&&(mt(c[x],i[x])||l.push({command:_,args:[p,x,i[x],g]}))}function ir(c){return c.id}function Pn(c,i){return c[i.id]=i,c}class lt{constructor(i,l,p,g){this.message=(i?`${i}: `:"")+p,g&&(this.identifier=g),l!=null&&l.__line__&&(this.line=l.__line__)}}function Bn(c,...i){for(const l of i)for(const p in l)c[p]=l[p];return c}class Lr extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Fs{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[p,g]of l)this.bindings[p]=g}concat(i){return new Fs(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ba={kind:"null"},dt={kind:"number"},qt={kind:"string"},Zt={kind:"boolean"},Li={kind:"color"},dh={kind:"projectionDefinition"},Do={kind:"object"},Wt={kind:"value"},os={kind:"collator"},wa={kind:"formatted"},rn={kind:"padding"},Mc={kind:"colorArray"},kc={kind:"numberArray"},ss={kind:"resolvedImage"},Ac={kind:"variableAnchorOffsetCollection"};function Di(c,i){return{kind:"array",itemType:c,N:i}}function Dr(c){if(c.kind==="array"){const i=Dr(c.itemType);return typeof c.N=="number"?`array<${i}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${i}>`}return c.kind}const Pg=[ba,dt,qt,Zt,Li,dh,wa,Do,Di(Wt),rn,kc,Mc,ss,Ac];function Ic(c,i){if(i.kind==="error")return null;if(c.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Ic(c.itemType,i.itemType))&&(typeof c.N!="number"||c.N===i.N))return null}else{if(c.kind===i.kind)return null;if(c.kind==="value"){for(const l of Pg)if(!Ic(l,i))return null}}return`Expected ${Dr(c)} but found ${Dr(i)} instead.`}function ph(c,i){return i.some(l=>l.kind===c.kind)}function Sa(c,i){return i.some(l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c)}function Bs(c,i){return c.kind==="array"&&i.kind==="array"?c.itemType.kind===i.itemType.kind&&typeof c.N=="number":c.kind===i.kind}const Eg=.96422,Mg=.82521,kg=4/29,sl=6/29,Ag=3*sl*sl,Ig=sl*sl*sl,Rc=Math.PI/180,q_=180/Math.PI;function Rg(c){return(c%=360)<0&&(c+=360),c}function al([c,i,l,p]){let g,_;const x=Pp((.2225045*(c=Cp(c))+.7168786*(i=Cp(i))+.0606169*(l=Cp(l)))/1);c===i&&i===l?g=_=x:(g=Pp((.4360747*c+.3850649*i+.1430804*l)/Eg),_=Pp((.0139322*c+.0971045*i+.7141733*l)/Mg));const T=116*x-16;return[T<0?0:T,500*(g-x),200*(x-_),p]}function Cp(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Pp(c){return c>Ig?Math.pow(c,1/3):c/Ag+kg}function Lg([c,i,l,p]){let g=(c+16)/116,_=isNaN(i)?g:g+i/500,x=isNaN(l)?g:g-l/200;return g=1*mh(g),_=Eg*mh(_),x=Mg*mh(x),[fh(3.1338561*_-1.6168667*g-.4906146*x),fh(-.9787684*_+1.9161415*g+.033454*x),fh(.0719453*_-.2289914*g+1.4052427*x),p]}function fh(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function mh(c){return c>sl?c*c*c:Ag*(c-kg)}const zo=Object.hasOwn||function(c,i){return Object.prototype.hasOwnProperty.call(c,i)};function Yt(c,i){return zo(c,i)?c[i]:void 0}function as(c){return parseInt(c.padEnd(2,c),16)/255}function ls(c,i){return Ta(i?c/100:c,0,1)}function Ta(c,i,l){return Math.min(Math.max(i,c),l)}function Ep(c){return!c.some(Number.isNaN)}const Mp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Xi(c,i,l){return c+l*(i-c)}function cs(c,i,l){return c.map((p,g)=>Xi(p,i[g],l))}class Qt{constructor(i,l,p,g=1,_=!0){this.r=i,this.g=l,this.b=p,this.a=g,_||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[i,l,p,g]))}static parse(i){if(i instanceof Qt)return i;if(typeof i!="string")return;const l=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=Yt(Mp,p);if(g){const[x,T,E]=g;return[x/255,T/255,E/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const x=p.length<6?1:2;let T=1;return[as(p.slice(T,T+=x)),as(p.slice(T,T+=x)),as(p.slice(T,T+=x)),as(p.slice(T,T+x)||"ff")]}if(p.startsWith("rgb")){const x=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[T,E,R,D,N,G,H,Y,J,ie,ce,Se]=x,ye=[D||" ",H||" ",ie].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){const W=[R,G,J].join(""),re=W==="%%%"?100:W===""?255:0;if(re){const ve=[Ta(+E/re,0,1),Ta(+N/re,0,1),Ta(+Y/re,0,1),ce?ls(+ce,Se):1];if(Ep(ve))return ve}}return}}const _=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,T,E,R,D,N,G,H,Y]=_,J=[E||" ",D||" ",G].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const ie=[+T,Ta(+R,0,100),Ta(+N,0,100),H?ls(+H,Y):1];if(Ep(ie))return function([ce,Se,ye,W]){function re(ve){const Le=(ve+ce/30)%12,Xe=Se*Math.min(ye,1-ye);return ye-Xe*Math.max(-1,Math.min(Le-3,9-Le,1))}return ce=Rg(ce),Se/=100,ye/=100,[re(0),re(8),re(4),W]}(ie)}}}(i);return l?new Qt(...l,!1):void 0}get rgb(){const{r:i,g:l,b:p,a:g}=this,_=g||1/0;return this.overwriteGetter("rgb",[i/_,l/_,p/_,g])}get hcl(){return this.overwriteGetter("hcl",function(i){const[l,p,g,_]=al(i),x=Math.sqrt(p*p+g*g);return[Math.round(1e4*x)?Rg(Math.atan2(g,p)*q_):NaN,x,l,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",al(this.rgb))}overwriteGetter(i,l){return Object.defineProperty(this,i,{value:l}),l}toString(){const[i,l,p,g]=this.rgb;return`rgba(${[i,l,p].map(_=>Math.round(255*_)).join(",")},${g})`}static interpolate(i,l,p,g="rgb"){switch(g){case"rgb":{const[_,x,T,E]=cs(i.rgb,l.rgb,p);return new Qt(_,x,T,E,!1)}case"hcl":{const[_,x,T,E]=i.hcl,[R,D,N,G]=l.hcl;let H,Y;if(isNaN(_)||isNaN(R))isNaN(_)?isNaN(R)?H=NaN:(H=R,T!==1&&T!==0||(Y=D)):(H=_,N!==1&&N!==0||(Y=x));else{let ye=R-_;R>_&&ye>180?ye-=360:R<_&&_-R>180&&(ye+=360),H=_+p*ye}const[J,ie,ce,Se]=function([ye,W,re,ve]){return ye=isNaN(ye)?0:ye*Rc,Lg([re,Math.cos(ye)*W,Math.sin(ye)*W,ve])}([H,Y??Xi(x,D,p),Xi(T,N,p),Xi(E,G,p)]);return new Qt(J,ie,ce,Se,!1)}case"lab":{const[_,x,T,E]=Lg(cs(i.lab,l.lab,p));return new Qt(_,x,T,E,!1)}}}}Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);class Lc{constructor(i,l,p){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const gh=["bottom","center","top"];class kp{constructor(i,l,p,g,_,x){this.text=i,this.image=l,this.scale=p,this.fontStack=g,this.textColor=_,this.verticalAlign=x}}class Yn{constructor(i){this.sections=i}static fromString(i){return new Yn([new kp(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Yn?i:Yn.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class hn{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof hn)return i;if(typeof i=="number")return new hn([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const l of i)if(typeof l!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new hn(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,l,p){return new hn(cs(i.values,l.values,p))}}class Qn{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Qn)return i;if(typeof i=="number")return new Qn([i]);if(Array.isArray(i)){for(const l of i)if(typeof l!="number")return;return new Qn(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,l,p){return new Qn(cs(i.values,l.values,p))}}class En{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof En)return i;if(typeof i=="string"){const p=Qt.parse(i);return p?new En([p]):void 0}if(!Array.isArray(i))return;const l=[];for(const p of i){if(typeof p!="string")return;const g=Qt.parse(p);if(!g)return;l.push(g)}return new En(l)}toString(){return JSON.stringify(this.values)}static interpolate(i,l,p,g="rgb"){const _=[];if(i.values.length!=l.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${l.values.length}), cannot interpolate.`);for(let x=0;x<i.values.length;x++)_.push(Qt.interpolate(i.values[x],l.values[x],p,g));return new En(_)}}class zr extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const yh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class or{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof or)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let l=0;l<i.length;l+=2){const p=i[l],g=i[l+1];if(typeof p!="string"||!yh.has(p)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new or(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,l,p){const g=i.values,_=l.values;if(g.length!==_.length)throw new zr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${l.toString()}`);const x=[];for(let T=0;T<g.length;T+=2){if(g[T]!==_[T])throw new zr(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${g[T]}, to[${T}]: ${_[T]}`);x.push(g[T]);const[E,R]=g[T+1],[D,N]=_[T+1];x.push([Xi(E,D,p),Xi(R,N,p)])}return new or(x)}}class vi{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new vi({name:i,available:!1}):null}}class Ot{constructor(i,l,p){this.from=i,this.to=l,this.transition=p}static interpolate(i,l,p){return new Ot(i,l,p)}static parse(i){return i instanceof Ot?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new Ot(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new Ot(i.from,i.to,i.transition):typeof i=="string"?new Ot(i,i,1):void 0}}function Bt(c,i,l,p){return typeof c=="number"&&c>=0&&c<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[c,i,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[c,i,l,p]:[c,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ca(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Ot||c instanceof Qt||c instanceof Lc||c instanceof Yn||c instanceof hn||c instanceof Qn||c instanceof En||c instanceof or||c instanceof vi)return!0;if(Array.isArray(c)){for(const i of c)if(!Ca(i))return!1;return!0}if(typeof c=="object"){for(const i in c)if(!Ca(c[i]))return!1;return!0}return!1}function zt(c){if(c===null)return ba;if(typeof c=="string")return qt;if(typeof c=="boolean")return Zt;if(typeof c=="number")return dt;if(c instanceof Qt)return Li;if(c instanceof Ot)return dh;if(c instanceof Lc)return os;if(c instanceof Yn)return wa;if(c instanceof hn)return rn;if(c instanceof Qn)return kc;if(c instanceof En)return Mc;if(c instanceof or)return Ac;if(c instanceof vi)return ss;if(Array.isArray(c)){const i=c.length;let l;for(const p of c){const g=zt(p);if(l){if(l===g)continue;l=Wt;break}l=g}return Di(l||Wt,i)}return Do}function Pa(c){const i=typeof c;return c===null?"":i==="string"||i==="number"||i==="boolean"?String(c):c instanceof Qt||c instanceof Ot||c instanceof Yn||c instanceof hn||c instanceof Qn||c instanceof En||c instanceof or||c instanceof vi?c.toString():JSON.stringify(c)}class si{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Ca(i[1]))return l.error("invalid value");const p=i[1];let g=zt(p);const _=l.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new si(g,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ll={string:qt,number:dt,boolean:Zt,object:Do};class _i{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let p,g=1;const _=i[0];if(_==="array"){let T,E;if(i.length>2){const R=i[1];if(typeof R!="string"||!(R in ll)||R==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);T=ll[R],g++}else T=Wt;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=i[2],g++}p=Di(T,E)}else{if(!ll[_])throw new Error(`Types doesn't contain name = ${_}`);p=ll[_]}const x=[];for(;g<i.length;g++){const T=l.parse(i[g],g,Wt);if(!T)return null;x.push(T)}return new _i(p,x)}evaluate(i){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(i);if(!Ic(this.type,zt(p)))return p;if(l===this.args.length-1)throw new zr(`Expected value to be of type ${Dr(this.type)}, but found ${Dr(zt(p))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Ap={"to-boolean":Zt,"to-color":Li,"to-number":dt,"to-string":qt};class No{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[0];if(!Ap[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&i.length!==2)return l.error("Expected one argument.");const g=Ap[p],_=[];for(let x=1;x<i.length;x++){const T=l.parse(i[x],x,Wt);if(!T)return null;_.push(T)}return new No(g,_)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let l,p;for(const g of this.args){if(l=g.evaluate(i),p=null,l instanceof Qt)return l;if(typeof l=="string"){const _=i.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rgba value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Bt(l[0],l[1],l[2],l[3]),!p))return new Qt(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new zr(p||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const p of this.args){l=p.evaluate(i);const g=hn.parse(l);if(g)return g}throw new zr(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"numberArray":{let l;for(const p of this.args){l=p.evaluate(i);const g=Qn.parse(l);if(g)return g}throw new zr(`Could not parse numberArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"colorArray":{let l;for(const p of this.args){l=p.evaluate(i);const g=En.parse(l);if(g)return g}throw new zr(`Could not parse colorArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const p of this.args){l=p.evaluate(i);const g=or.parse(l);if(g)return g}throw new zr(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const p of this.args){if(l=p.evaluate(i),l===null)return 0;const g=Number(l);if(!isNaN(g))return g}throw new zr(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Yn.fromString(Pa(this.args[0].evaluate(i)));case"resolvedImage":return vi.fromString(Pa(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Pa(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Dg=["Unknown","Point","LineString","Polygon"];class zg{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Dg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let l=this._parseColorCache.get(i);return l||(l=Qt.parse(i),this._parseColorCache.set(i,l)),l}}class Dc{constructor(i,l,p=[],g,_=new Fs,x=[]){this.registry=i,this.path=p,this.key=p.map(T=>`[${T}]`).join(""),this.scope=_,this.errors=x,this.expectedType=g,this._isConstant=l}parse(i,l,p,g,_={}){return l?this.concat(l,p,g)._parse(i,_):this._parse(i,_)}_parse(i,l){function p(g,_,x){return x==="assert"?new _i(_,[g]):x==="coerce"?new No(_,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=i[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[g];if(_){let x=_.parse(i,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,E=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||E.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(E.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(E.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(E.kind)||T.kind==="colorArray"&&["value","string","array"].includes(E.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(E.kind))x=p(x,T,l.typeAnnotation||"coerce");else if(this.checkSubtype(T,E))return null}else x=p(x,T,l.typeAnnotation||"assert")}if(!(x instanceof si)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const T=new zg;try{x=new si(x.type,x.evaluate(T))}catch(E){return this.error(E.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,p){const g=typeof i=="number"?this.path.concat(i):this.path,_=p?this.scope.concat(p):this.scope;return new Dc(this.registry,this._isConstant,g,l||null,_,this.errors)}error(i,...l){const p=`${this.key}${l.map(g=>`[${g}]`).join("")}`;this.errors.push(new Lr(p,i))}checkSubtype(i,l){const p=Ic(i,l);return p&&this.error(p),p}}class zc{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const p=[];for(let _=1;_<i.length-1;_+=2){const x=i[_];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=l.parse(i[_+1],_+1);if(!T)return null;p.push([x,T])}const g=l.parse(i[i.length-1],i.length-1,l.expectedType,p);return g?new zc(p,g):null}outputDefined(){return this.result.outputDefined()}}class uo{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=i[1];return l.scope.has(p)?new uo(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Mn{constructor(i,l,p){this.type=i,this.index=l,this.input=p}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,dt),g=l.parse(i[2],2,Di(l.expectedType||Wt));return p&&g?new Mn(g.type.itemType,p,g):null}evaluate(i){const l=this.index.evaluate(i),p=this.input.evaluate(i);if(l<0)throw new zr(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new zr(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new zr(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class cl{constructor(i,l){this.type=Zt,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Wt),g=l.parse(i[2],2,Wt);return p&&g?ph(p.type,[Zt,qt,dt,ba,Wt])?new cl(p,g):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(p.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!p)return!1;if(!Sa(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(zt(l))} instead.`);if(!Sa(p,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${Dr(zt(p))} instead.`);return p.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class Nc{constructor(i,l,p){this.type=dt,this.needle=i,this.haystack=l,this.fromIndex=p}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Wt),g=l.parse(i[2],2,Wt);if(!p||!g)return null;if(!ph(p.type,[Zt,qt,dt,ba,Wt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(p.type)} instead`);if(i.length===4){const _=l.parse(i[3],3,dt);return _?new Nc(p,g,_):null}return new Nc(p,g)}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!Sa(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(zt(l))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(i)),Sa(p,["string"])){const _=p.indexOf(l,g);return _===-1?-1:[...p.slice(0,_)].length}if(Sa(p,["array"]))return p.indexOf(l,g);throw new zr(`Expected second argument to be of type array or string, but found ${Dr(zt(p))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class ul{constructor(i,l,p,g,_,x){this.inputType=i,this.type=l,this.input=p,this.cases=g,this.outputs=_,this.otherwise=x}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let p,g;l.expectedType&&l.expectedType.kind!=="value"&&(g=l.expectedType);const _={},x=[];for(let R=2;R<i.length-1;R+=2){let D=i[R];const N=i[R+1];Array.isArray(D)||(D=[D]);const G=l.concat(R);if(D.length===0)return G.error("Expected at least one branch label.");for(const Y of D){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(p){if(G.checkSubtype(p,zt(Y)))return null}else p=zt(Y);if(_[String(Y)]!==void 0)return G.error("Branch labels must be unique.");_[String(Y)]=x.length}const H=l.parse(N,R,g);if(!H)return null;g=g||H.type,x.push(H)}const T=l.parse(i[1],1,Wt);if(!T)return null;const E=l.parse(i[i.length-1],i.length-1,g);return E?T.type.kind!=="value"&&l.concat(1).checkSubtype(p,T.type)?null:new ul(p,g,T,_,x,E):null}evaluate(i){const l=this.input.evaluate(i);return(zt(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class dn{constructor(i,l,p){this.type=i,this.branches=l,this.otherwise=p}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const g=[];for(let x=1;x<i.length-1;x+=2){const T=l.parse(i[x],x,Zt);if(!T)return null;const E=l.parse(i[x+1],x+1,p);if(!E)return null;g.push([T,E]),p=p||E.type}const _=l.parse(i[i.length-1],i.length-1,p);if(!_)return null;if(!p)throw new Error("Can't infer output type");return new dn(p,g,_)}evaluate(i){for(const[l,p]of this.branches)if(l.evaluate(i))return p.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,p]of this.branches)i(l),i(p);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class jc{constructor(i,l,p,g){this.type=i,this.input=l,this.beginIndex=p,this.endIndex=g}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Wt),g=l.parse(i[2],2,dt);if(!p||!g)return null;if(!ph(p.type,[Di(Wt),qt,Wt]))return l.error(`Expected first argument to be of type array or string, but found ${Dr(p.type)} instead`);if(i.length===4){const _=l.parse(i[3],3,dt);return _?new jc(p.type,p,g,_):null}return new jc(p.type,p,g)}evaluate(i){const l=this.input.evaluate(i),p=this.beginIndex.evaluate(i);let g;if(this.endIndex&&(g=this.endIndex.evaluate(i)),Sa(l,["string"]))return[...l].slice(p,g).join("");if(Sa(l,["array"]))return l.slice(p,g);throw new zr(`Expected first argument to be of type array or string, but found ${Dr(zt(l))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function hl(c,i){const l=c.length-1;let p,g,_=0,x=l,T=0;for(;_<=x;)if(T=Math.floor((_+x)/2),p=c[T],g=c[T+1],p<=i){if(T===l||i<g)return T;_=T+1}else{if(!(p>i))throw new zr("Input is not a number.");x=T-1}return 0}class dl{constructor(i,l,p){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[g,_]of p)this.labels.push(g),this.outputs.push(_)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(i[1],1,dt);if(!p)return null;const g=[];let _=null;l.expectedType&&l.expectedType.kind!=="value"&&(_=l.expectedType);for(let x=1;x<i.length;x+=2){const T=x===1?-1/0:i[x],E=i[x+1],R=x,D=x+1;if(typeof T!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(g.length&&g[g.length-1][0]>=T)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const N=l.parse(E,D,_);if(!N)return null;_=_||N.type,g.push([T,N])}return new dl(_,p,g)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const _=l.length;return g>=l[_-1]?p[_-1].evaluate(i):p[hl(l,g)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Z_(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var $s,Oc,Ip=function(){if(Oc)return $s;function c(i,l,p,g){this.cx=3*i,this.bx=3*(p-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(g-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=p,this.p2y=g}return Oc=1,$s=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,l){if(l===void 0&&(l=1e-6),i<0)return 0;if(i>1)return 1;for(var p=i,g=0;g<8;g++){var _=this.sampleCurveX(p)-i;if(Math.abs(_)<l)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=_/x}var T=0,E=1;for(p=i,g=0;g<20&&(_=this.sampleCurveX(p),!(Math.abs(_-i)<l));g++)i>_?T=p:E=p,p=.5*(E-T)+T;return p},solve:function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))}},$s}(),W_=Z_(Ip);class ai{constructor(i,l,p,g,_){this.type=i,this.operator=l,this.interpolation=p,this.input=g,this.labels=[],this.outputs=[];for(const[x,T]of _)this.labels.push(x),this.outputs.push(T)}static interpolationFactor(i,l,p,g){let _=0;if(i.name==="exponential")_=pl(l,i.base,p,g);else if(i.name==="linear")_=pl(l,1,p,g);else if(i.name==="cubic-bezier"){const x=i.controlPoints;_=new W_(x[0],x[1],x[2],x[3]).solve(pl(l,1,p,g))}return _}static parse(i,l){let[p,g,_,...x]=i;if(!Array.isArray(g)||g.length===0)return l.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const R=g[1];if(typeof R!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:R}}else{if(g[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const R=g.slice(1);if(R.length!==4||R.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:R}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,dt),!_)return null;const T=[];let E=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||l.expectedType==Mc?l.expectedType&&l.expectedType.kind!=="value"&&(E=l.expectedType):E=Li;for(let R=0;R<x.length;R+=2){const D=x[R],N=x[R+1],G=R+3,H=R+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(T.length&&T[T.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=l.parse(N,H,E);if(!Y)return null;E=E||Y.type,T.push([D,Y])}return Bs(E,dt)||Bs(E,dh)||Bs(E,Li)||Bs(E,rn)||Bs(E,kc)||Bs(E,Mc)||Bs(E,Ac)||Bs(E,Di(dt))?new ai(E,p,g,_,T):l.error(`Type ${Dr(E)} is not interpolatable.`)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const _=l.length;if(g>=l[_-1])return p[_-1].evaluate(i);const x=hl(l,g),T=ai.interpolationFactor(this.interpolation,g,l[x],l[x+1]),E=p[x].evaluate(i),R=p[x+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Xi(E,R,T);case"color":return Qt.interpolate(E,R,T);case"padding":return hn.interpolate(E,R,T);case"colorArray":return En.interpolate(E,R,T);case"numberArray":return Qn.interpolate(E,R,T);case"variableAnchorOffsetCollection":return or.interpolate(E,R,T);case"array":return cs(E,R,T);case"projectionDefinition":return Ot.interpolate(E,R,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qt.interpolate(E,R,T,"hcl");case"colorArray":return En.interpolate(E,R,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qt.interpolate(E,R,T,"lab");case"colorArray":return En.interpolate(E,R,T,"lab")}}}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function pl(c,i,l,p){const g=p-l,_=c-l;return g===0?0:i===1?_/g:(Math.pow(i,_)-1)/(Math.pow(i,g)-1)}const zi={color:Qt.interpolate,number:Xi,padding:hn.interpolate,numberArray:Qn.interpolate,colorArray:En.interpolate,variableAnchorOffsetCollection:or.interpolate,array:cs};class xi{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let p=null;const g=l.expectedType;g&&g.kind!=="value"&&(p=g);const _=[];for(const T of i.slice(1)){const E=l.parse(T,1+_.length,p,void 0,{typeAnnotation:"omit"});if(!E)return null;p=p||E.type,_.push(E)}if(!p)throw new Error("No output type");const x=g&&_.some(T=>Ic(g,T.type));return new xi(x?Wt:p,_)}evaluate(i){let l,p=null,g=0;for(const _ of this.args)if(g++,p=_.evaluate(i),p&&p instanceof vi&&!p.available&&(l||(l=p.name),p=null,g===this.args.length&&(p=l)),p!==null)break;return p}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function Rp(c,i){return c==="=="||c==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Fc(c,i,l,p){return p.compare(i,l)===0}function fl(c,i,l){const p=c!=="=="&&c!=="!=";return class o3{constructor(_,x,T){this.type=Zt,this.lhs=_,this.rhs=x,this.collator=T,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const T=_[0];let E=x.parse(_[1],1,Wt);if(!E)return null;if(!Rp(T,E.type))return x.concat(1).error(`"${T}" comparisons are not supported for type '${Dr(E.type)}'.`);let R=x.parse(_[2],2,Wt);if(!R)return null;if(!Rp(T,R.type))return x.concat(2).error(`"${T}" comparisons are not supported for type '${Dr(R.type)}'.`);if(E.type.kind!==R.type.kind&&E.type.kind!=="value"&&R.type.kind!=="value")return x.error(`Cannot compare types '${Dr(E.type)}' and '${Dr(R.type)}'.`);p&&(E.type.kind==="value"&&R.type.kind!=="value"?E=new _i(R.type,[E]):E.type.kind!=="value"&&R.type.kind==="value"&&(R=new _i(E.type,[R])));let D=null;if(_.length===4){if(E.type.kind!=="string"&&R.type.kind!=="string"&&E.type.kind!=="value"&&R.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(_[3],3,os),!D)return null}return new o3(E,R,D)}evaluate(_){const x=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(p&&this.hasUntypedArgument){const E=zt(x),R=zt(T);if(E.kind!==R.kind||E.kind!=="string"&&E.kind!=="number")throw new zr(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${E.kind}, ${R.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const E=zt(x),R=zt(T);if(E.kind!=="string"||R.kind!=="string")return i(_,x,T)}return this.collator?l(_,x,T,this.collator.evaluate(_)):i(_,x,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Lp=fl("==",function(c,i,l){return i===l},Fc),H_=fl("!=",function(c,i,l){return i!==l},function(c,i,l,p){return!Fc(0,i,l,p)}),K_=fl("<",function(c,i,l){return i<l},function(c,i,l,p){return p.compare(i,l)<0}),X_=fl(">",function(c,i,l){return i>l},function(c,i,l,p){return p.compare(i,l)>0}),Y_=fl("<=",function(c,i,l){return i<=l},function(c,i,l,p){return p.compare(i,l)<=0}),vh=fl(">=",function(c,i,l){return i>=l},function(c,i,l,p){return p.compare(i,l)>=0});class _h{constructor(i,l,p){this.type=os,this.locale=p,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const p=i[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const g=l.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Zt);if(!g)return null;const _=l.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Zt);if(!_)return null;let x=null;return p.locale&&(x=l.parse(p.locale,1,qt),!x)?null:new _h(g,_,x)}evaluate(i){return new Lc(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class xh{constructor(i,l,p,g,_){this.type=qt,this.number=i,this.locale=l,this.currency=p,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const p=l.parse(i[1],1,dt);if(!p)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return l.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=l.parse(g.locale,1,qt),!_))return null;let x=null;if(g.currency&&(x=l.parse(g.currency,1,qt),!x))return null;let T=null;if(g["min-fraction-digits"]&&(T=l.parse(g["min-fraction-digits"],1,dt),!T))return null;let E=null;return g["max-fraction-digits"]&&(E=l.parse(g["max-fraction-digits"],1,dt),!E)?null:new xh(p,_,x,T,E)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class Bc{constructor(i){this.type=wa,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const g=[];let _=!1;for(let x=1;x<=i.length-1;++x){const T=i[x];if(_&&typeof T=="object"&&!Array.isArray(T)){_=!1;let E=null;if(T["font-scale"]&&(E=l.parse(T["font-scale"],1,dt),!E))return null;let R=null;if(T["text-font"]&&(R=l.parse(T["text-font"],1,Di(qt)),!R))return null;let D=null;if(T["text-color"]&&(D=l.parse(T["text-color"],1,Li),!D))return null;let N=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!gh.includes(T["vertical-align"]))return l.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(N=l.parse(T["vertical-align"],1,qt),!N)return null}const G=g[g.length-1];G.scale=E,G.font=R,G.textColor=D,G.verticalAlign=N}else{const E=l.parse(i[x],1,Wt);if(!E)return null;const R=E.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:E,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Bc(g)}evaluate(i){return new Yn(this.sections.map(l=>{const p=l.content.evaluate(i);return zt(p)===ss?new kp("",p,null,null,null,l.verticalAlign?l.verticalAlign.evaluate(i):null):new kp(Pa(p),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null,l.verticalAlign?l.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor),l.verticalAlign&&i(l.verticalAlign)}outputDefined(){return!1}}class Dp{constructor(i){this.type=ss,this.input=i}static parse(i,l){if(i.length!==2)return l.error("Expected two arguments.");const p=l.parse(i[1],1,qt);return p?new Dp(p):l.error("No image name provided.")}evaluate(i){const l=this.input.evaluate(i),p=vi.fromString(l);return p&&i.availableImages&&(p.available=i.availableImages.indexOf(l)>-1),p}eachChild(i){i(this.input)}outputDefined(){return!1}}class bh{constructor(i){this.type=dt,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const p=l.parse(i[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Dr(p.type)} instead.`):new bh(p):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string")return[...l].length;if(Array.isArray(l))return l.length;throw new zr(`Expected value to be of type string or array, but found ${Dr(zt(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const jo=8192;function Q_(c,i){const l=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(l*g*jo),Math.round(p*g*jo)]}function zp(c,i){const l=Math.pow(2,i.z);return[(g=(c[0]/jo+i.x)/l,360*g-180),(p=(c[1]/jo+i.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,g}function $c(c,i){c[0]=Math.min(c[0],i[0]),c[1]=Math.min(c[1],i[1]),c[2]=Math.max(c[2],i[0]),c[3]=Math.max(c[3],i[1])}function Vc(c,i){return!(c[0]<=i[0]||c[2]>=i[2]||c[1]<=i[1]||c[3]>=i[3])}function Ng(c,i,l){const p=c[0]-i[0],g=c[1]-i[1],_=c[0]-l[0],x=c[1]-l[1];return p*x-_*g==0&&p*_<=0&&g*x<=0}function Uc(c,i,l,p){return(g=[p[0]-l[0],p[1]-l[1]])[0]*(_=[i[0]-c[0],i[1]-c[1]])[1]-g[1]*_[0]!=0&&!(!wh(c,i,l,p)||!wh(l,p,c,i));var g,_}function jg(c,i,l){for(const p of l)for(let g=0;g<p.length-1;++g)if(Uc(c,i,p[g],p[g+1]))return!0;return!1}function ml(c,i,l=!1){let p=!1;for(const T of i)for(let E=0;E<T.length-1;E++){if(Ng(c,T[E],T[E+1]))return l;(_=T[E])[1]>(g=c)[1]!=(x=T[E+1])[1]>g[1]&&g[0]<(x[0]-_[0])*(g[1]-_[1])/(x[1]-_[1])+_[0]&&(p=!p)}var g,_,x;return p}function J_(c,i){for(const l of i)if(ml(c,l))return!0;return!1}function Og(c,i){for(const l of c)if(!ml(l,i))return!1;for(let l=0;l<c.length-1;++l)if(jg(c[l],c[l+1],i))return!1;return!0}function ex(c,i){for(const l of i)if(Og(c,l))return!0;return!1}function wh(c,i,l,p){const g=p[0]-l[0],_=p[1]-l[1],x=(c[0]-l[0])*_-g*(c[1]-l[1]),T=(i[0]-l[0])*_-g*(i[1]-l[1]);return x>0&&T<0||x<0&&T>0}function Np(c,i,l){const p=[];for(let g=0;g<c.length;g++){const _=[];for(let x=0;x<c[g].length;x++){const T=Q_(c[g][x],l);$c(i,T),_.push(T)}p.push(_)}return p}function Fg(c,i,l){const p=[];for(let g=0;g<c.length;g++){const _=Np(c[g],i,l);p.push(_)}return p}function Bg(c,i,l,p){if(c[0]<l[0]||c[0]>l[2]){const g=.5*p;let _=c[0]-l[0]>g?-p:l[0]-c[0]>g?p:0;_===0&&(_=c[0]-l[2]>g?-p:l[2]-c[0]>g?p:0),c[0]+=_}$c(i,c)}function jp(c,i,l,p){const g=Math.pow(2,p.z)*jo,_=[p.x*jo,p.y*jo],x=[];for(const T of c)for(const E of T){const R=[E.x+_[0],E.y+_[1]];Bg(R,i,l,g),x.push(R)}return x}function Op(c,i,l,p){const g=Math.pow(2,p.z)*jo,_=[p.x*jo,p.y*jo],x=[];for(const E of c){const R=[];for(const D of E){const N=[D.x+_[0],D.y+_[1]];$c(i,N),R.push(N)}x.push(R)}if(i[2]-i[0]<=g/2){(T=i)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const E of x)for(const R of E)Bg(R,i,l,g)}var T;return x}class Ea{constructor(i,l){this.type=Zt,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ca(i[1])){const p=i[1];if(p.type==="FeatureCollection"){const g=[];for(const _ of p.features){const{type:x,coordinates:T}=_.geometry;x==="Polygon"&&g.push(T),x==="MultiPolygon"&&g.push(...T)}if(g.length)return new Ea(p,{type:"MultiPolygon",coordinates:g})}else if(p.type==="Feature"){const g=p.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ea(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Ea(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(p.type==="Polygon"){const T=Np(p.coordinates,_,x),E=jp(l.geometry(),g,_,x);if(!Vc(g,_))return!1;for(const R of E)if(!ml(R,T))return!1}if(p.type==="MultiPolygon"){const T=Fg(p.coordinates,_,x),E=jp(l.geometry(),g,_,x);if(!Vc(g,_))return!1;for(const R of E)if(!J_(R,T))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(p.type==="Polygon"){const T=Np(p.coordinates,_,x),E=Op(l.geometry(),g,_,x);if(!Vc(g,_))return!1;for(const R of E)if(!Og(R,T))return!1}if(p.type==="MultiPolygon"){const T=Fg(p.coordinates,_,x),E=Op(l.geometry(),g,_,x);if(!Vc(g,_))return!1;for(const R of E)if(!ex(R,T))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let $g=class{constructor(c=[],i=(l,p)=>l<p?-1:l>p?1:0){if(this.data=c,this.length=this.data.length,this.compare=i,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:i,compare:l}=this,p=i[c];for(;c>0;){const g=c-1>>1,_=i[g];if(l(p,_)>=0)break;i[c]=_,c=g}i[c]=p}_down(c){const{data:i,compare:l}=this,p=this.length>>1,g=i[c];for(;c<p;){let _=1+(c<<1);const x=_+1;if(x<this.length&&l(i[x],i[_])<0&&(_=x),l(i[_],g)>=0)break;i[c]=i[_],c=_}i[c]=g}};function Fp(c,i,l=0,p=c.length-1,g=tx){for(;p>l;){if(p-l>600){const E=p-l+1,R=i-l+1,D=Math.log(E),N=.5*Math.exp(2*D/3),G=.5*Math.sqrt(D*N*(E-N)/E)*(R-E/2<0?-1:1);Fp(c,i,Math.max(l,Math.floor(i-R*N/E+G)),Math.min(p,Math.floor(i+(E-R)*N/E+G)),g)}const _=c[i];let x=l,T=p;for(gl(c,l,i),g(c[p],_)>0&&gl(c,l,p);x<T;){for(gl(c,x,T),x++,T--;g(c[x],_)<0;)x++;for(;g(c[T],_)>0;)T--}g(c[l],_)===0?gl(c,l,T):(T++,gl(c,T,p)),T<=i&&(l=T+1),i<=T&&(p=T-1)}}function gl(c,i,l){const p=c[i];c[i]=c[l],c[l]=p}function tx(c,i){return c<i?-1:c>i?1:0}function Sh(c,i){if(c.length<=1)return[c];const l=[];let p,g;for(const _ of c){const x=Vg(_);x!==0&&(_.area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(p&&l.push(p),p=[_]):p.push(_))}if(p&&l.push(p),i>1)for(let _=0;_<l.length;_++)l[_].length<=i||(Fp(l[_],i,1,l[_].length-1,rx),l[_]=l[_].slice(0,i));return l}function rx(c,i){return i.area-c.area}function Vg(c){let i=0;for(let l,p,g=0,_=c.length,x=_-1;g<_;x=g++)l=c[g],p=c[x],i+=(p.x-l.x)*(l.y+p.y);return i}const Ug=1/298.257223563,Gg=Ug*(2-Ug),qg=Math.PI/180;class Bp{constructor(i){const l=6378.137*qg*1e3,p=Math.cos(i*qg),g=1/(1-Gg*(1-p*p)),_=Math.sqrt(g);this.kx=l*_*p,this.ky=l*_*g*(1-Gg)}distance(i,l){const p=this.wrap(i[0]-l[0])*this.kx,g=(i[1]-l[1])*this.ky;return Math.sqrt(p*p+g*g)}pointOnLine(i,l){let p,g,_,x,T=1/0;for(let E=0;E<i.length-1;E++){let R=i[E][0],D=i[E][1],N=this.wrap(i[E+1][0]-R)*this.kx,G=(i[E+1][1]-D)*this.ky,H=0;N===0&&G===0||(H=(this.wrap(l[0]-R)*this.kx*N+(l[1]-D)*this.ky*G)/(N*N+G*G),H>1?(R=i[E+1][0],D=i[E+1][1]):H>0&&(R+=N/this.kx*H,D+=G/this.ky*H)),N=this.wrap(l[0]-R)*this.kx,G=(l[1]-D)*this.ky;const Y=N*N+G*G;Y<T&&(T=Y,p=R,g=D,_=E,x=H)}return{point:[p,g],index:_,t:Math.max(0,Math.min(1,x))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function pr(c,i){return i[0]-c[0]}function Th(c){return c[1]-c[0]+1}function us(c,i){return c[1]>=c[0]&&c[1]<i}function $p(c,i){if(c[0]>c[1])return[null,null];const l=Th(c);if(i){if(l===2)return[c,null];const g=Math.floor(l/2);return[[c[0],c[0]+g],[c[0]+g,c[1]]]}if(l===1)return[c,null];const p=Math.floor(l/2)-1;return[[c[0],c[0]+p],[c[0]+p+1,c[1]]]}function Vp(c,i){if(!us(i,c.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let p=i[0];p<=i[1];++p)$c(l,c[p]);return l}function Up(c){const i=[1/0,1/0,-1/0,-1/0];for(const l of c)for(const p of l)$c(i,p);return i}function Zg(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function Gp(c,i,l){if(!Zg(c)||!Zg(i))return NaN;let p=0,g=0;return c[2]<i[0]&&(p=i[0]-c[2]),c[0]>i[2]&&(p=c[0]-i[2]),c[1]>i[3]&&(g=c[1]-i[3]),c[3]<i[1]&&(g=i[1]-c[3]),l.distance([0,0],[p,g])}function Ma(c,i,l){const p=l.pointOnLine(i,c);return l.distance(c,p.point)}function qp(c,i,l,p,g){const _=Math.min(Ma(c,[l,p],g),Ma(i,[l,p],g)),x=Math.min(Ma(l,[c,i],g),Ma(p,[c,i],g));return Math.min(_,x)}function nx(c,i,l,p,g){if(!us(i,c.length)||!us(p,l.length))return 1/0;let _=1/0;for(let x=i[0];x<i[1];++x){const T=c[x],E=c[x+1];for(let R=p[0];R<p[1];++R){const D=l[R],N=l[R+1];if(Uc(T,E,D,N))return 0;_=Math.min(_,qp(T,E,D,N,g))}}return _}function ix(c,i,l,p,g){if(!us(i,c.length)||!us(p,l.length))return NaN;let _=1/0;for(let x=i[0];x<=i[1];++x)for(let T=p[0];T<=p[1];++T)if(_=Math.min(_,g.distance(c[x],l[T])),_===0)return _;return _}function ox(c,i,l){if(ml(c,i,!0))return 0;let p=1/0;for(const g of i){const _=g[0],x=g[g.length-1];if(_!==x&&(p=Math.min(p,Ma(c,[x,_],l)),p===0))return p;const T=l.pointOnLine(g,c);if(p=Math.min(p,l.distance(c,T.point)),p===0)return p}return p}function sx(c,i,l,p){if(!us(i,c.length))return NaN;for(let _=i[0];_<=i[1];++_)if(ml(c[_],l,!0))return 0;let g=1/0;for(let _=i[0];_<i[1];++_){const x=c[_],T=c[_+1];for(const E of l)for(let R=0,D=E.length,N=D-1;R<D;N=R++){const G=E[N],H=E[R];if(Uc(x,T,G,H))return 0;g=Math.min(g,qp(x,T,G,H,p))}}return g}function Wg(c,i){for(const l of c)for(const p of l)if(ml(p,i,!0))return!0;return!1}function ax(c,i,l,p=1/0){const g=Up(c),_=Up(i);if(p!==1/0&&Gp(g,_,l)>=p)return p;if(Vc(g,_)){if(Wg(c,i))return 0}else if(Wg(i,c))return 0;let x=1/0;for(const T of c)for(let E=0,R=T.length,D=R-1;E<R;D=E++){const N=T[D],G=T[E];for(const H of i)for(let Y=0,J=H.length,ie=J-1;Y<J;ie=Y++){const ce=H[ie],Se=H[Y];if(Uc(N,G,ce,Se))return 0;x=Math.min(x,qp(N,G,ce,Se,l))}}return x}function Hg(c,i,l,p,g,_){if(!_)return;const x=Gp(Vp(p,_),g,l);x<i&&c.push([x,_,[0,0]])}function Ch(c,i,l,p,g,_,x){if(!_||!x)return;const T=Gp(Vp(p,_),Vp(g,x),l);T<i&&c.push([T,_,x])}function Ph(c,i,l,p,g=1/0){let _=Math.min(p.distance(c[0],l[0][0]),g);if(_===0)return _;const x=new $g([[0,[0,c.length-1],[0,0]]],pr),T=Up(l);for(;x.length>0;){const E=x.pop();if(E[0]>=_)continue;const R=E[1],D=i?50:100;if(Th(R)<=D){if(!us(R,c.length))return NaN;if(i){const N=sx(c,R,l,p);if(isNaN(N)||N===0)return N;_=Math.min(_,N)}else for(let N=R[0];N<=R[1];++N){const G=ox(c[N],l,p);if(_=Math.min(_,G),_===0)return 0}}else{const N=$p(R,i);Hg(x,_,p,c,T,N[0]),Hg(x,_,p,c,T,N[1])}}return _}function Eh(c,i,l,p,g,_=1/0){let x=Math.min(_,g.distance(c[0],l[0]));if(x===0)return x;const T=new $g([[0,[0,c.length-1],[0,l.length-1]]],pr);for(;T.length>0;){const E=T.pop();if(E[0]>=x)continue;const R=E[1],D=E[2],N=i?50:100,G=p?50:100;if(Th(R)<=N&&Th(D)<=G){if(!us(R,c.length)&&us(D,l.length))return NaN;let H;if(i&&p)H=nx(c,R,l,D,g),x=Math.min(x,H);else if(i&&!p){const Y=c.slice(R[0],R[1]+1);for(let J=D[0];J<=D[1];++J)if(H=Ma(l[J],Y,g),x=Math.min(x,H),x===0)return x}else if(!i&&p){const Y=l.slice(D[0],D[1]+1);for(let J=R[0];J<=R[1];++J)if(H=Ma(c[J],Y,g),x=Math.min(x,H),x===0)return x}else H=ix(c,R,l,D,g),x=Math.min(x,H)}else{const H=$p(R,i),Y=$p(D,p);Ch(T,x,g,c,l,H[0],Y[0]),Ch(T,x,g,c,l,H[0],Y[1]),Ch(T,x,g,c,l,H[1],Y[0]),Ch(T,x,g,c,l,H[1],Y[1])}}return x}function Zp(c){return c.type==="MultiPolygon"?c.coordinates.map(i=>({type:"Polygon",coordinates:i})):c.type==="MultiLineString"?c.coordinates.map(i=>({type:"LineString",coordinates:i})):c.type==="MultiPoint"?c.coordinates.map(i=>({type:"Point",coordinates:i})):[c]}class ka{constructor(i,l){this.type=dt,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ca(i[1])){const p=i[1];if(p.type==="FeatureCollection")return new ka(p,p.features.map(g=>Zp(g.geometry)).flat());if(p.type==="Feature")return new ka(p,Zp(p.geometry));if("type"in p&&"coordinates"in p)return new ka(p,Zp(p))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,p){const g=l.geometry(),_=g.flat().map(E=>zp([E.x,E.y],l.canonical));if(g.length===0)return NaN;const x=new Bp(_[0][1]);let T=1/0;for(const E of p){switch(E.type){case"Point":T=Math.min(T,Eh(_,!1,[E.coordinates],!1,x,T));break;case"LineString":T=Math.min(T,Eh(_,!1,E.coordinates,!0,x,T));break;case"Polygon":T=Math.min(T,Ph(_,!1,E.coordinates,x,T))}if(T===0)return T}return T}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,p){const g=l.geometry(),_=g.flat().map(E=>zp([E.x,E.y],l.canonical));if(g.length===0)return NaN;const x=new Bp(_[0][1]);let T=1/0;for(const E of p){switch(E.type){case"Point":T=Math.min(T,Eh(_,!0,[E.coordinates],!1,x,T));break;case"LineString":T=Math.min(T,Eh(_,!0,E.coordinates,!0,x,T));break;case"Polygon":T=Math.min(T,Ph(_,!0,E.coordinates,x,T))}if(T===0)return T}return T}(i,this.geometries);if(i.geometryType()==="Polygon")return function(l,p){const g=l.geometry();if(g.length===0||g[0].length===0)return NaN;const _=Sh(g,0).map(E=>E.map(R=>R.map(D=>zp([D.x,D.y],l.canonical)))),x=new Bp(_[0][0][0][1]);let T=1/0;for(const E of p)for(const R of _){switch(E.type){case"Point":T=Math.min(T,Ph([E.coordinates],!1,R,x,T));break;case"LineString":T=Math.min(T,Ph(E.coordinates,!0,R,x,T));break;case"Polygon":T=Math.min(T,ax(R,E.coordinates,x,T))}if(T===0)return T}return T}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Gc{constructor(i){this.type=Wt,this.key=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const p=i[1];return p==null?l.error("Global state property must be defined."):typeof p!="string"?l.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Gc(p)}evaluate(i){var l;const p=(l=i.globals)===null||l===void 0?void 0:l.globalState;return p&&Object.keys(p).length!==0?Yt(p,this.key):null}eachChild(){}outputDefined(){return!1}}const yl={"==":Lp,"!=":H_,">":X_,"<":K_,">=":vh,"<=":Y_,array:_i,at:Mn,boolean:_i,case:dn,coalesce:xi,collator:_h,format:Bc,image:Dp,in:cl,"index-of":Nc,interpolate:ai,"interpolate-hcl":ai,"interpolate-lab":ai,length:bh,let:zc,literal:si,match:ul,number:_i,"number-format":xh,object:_i,slice:jc,step:dl,string:_i,"to-boolean":No,"to-color":No,"to-number":No,"to-string":No,var:uo,within:Ea,distance:ka,"global-state":Gc};class Yi{constructor(i,l,p,g){this.name=i,this.type=l,this._evaluate=p,this.args=g}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,l){const p=i[0],g=Yi.definitions[p];if(!g)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=x.filter(([R])=>!Array.isArray(R)||R.length===i.length-1);let E=null;for(const[R,D]of T){E=new Dc(l.registry,Mh,l.path,null,l.scope);const N=[];let G=!1;for(let H=1;H<i.length;H++){const Y=i[H],J=Array.isArray(R)?R[H-1]:R.type,ie=E.parse(Y,1+N.length,J);if(!ie){G=!0;break}N.push(ie)}if(!G)if(Array.isArray(R)&&R.length!==N.length)E.error(`Expected ${R.length} arguments, but found ${N.length} instead.`);else{for(let H=0;H<N.length;H++){const Y=Array.isArray(R)?R[H]:R.type,J=N[H];E.concat(H+1).checkSubtype(Y,J.type)}if(E.errors.length===0)return new Yi(p,_,D,N)}}if(T.length===1)l.errors.push(...E.errors);else{const R=(T.length?T:x).map(([N])=>{return G=N,Array.isArray(G)?`(${G.map(Dr).join(", ")})`:`(${Dr(G.type)}...)`;var G}).join(" | "),D=[];for(let N=1;N<i.length;N++){const G=l.parse(i[N],1+D.length);if(!G)return null;D.push(Dr(G.type))}l.error(`Expected arguments of type ${R}, but found (${D.join(", ")}) instead.`)}return null}static register(i,l){Yi.definitions=l;for(const p in l)i[p]=Yi}}function Kg(c,[i,l,p,g]){i=i.evaluate(c),l=l.evaluate(c),p=p.evaluate(c);const _=g?g.evaluate(c):1,x=Bt(i,l,p,_);if(x)throw new zr(x);return new Qt(i/255,l/255,p/255,_,!1)}function Xg(c,i){return c in i}function Wp(c,i){const l=i[c];return l===void 0?null:l}function Aa(c){return{type:c}}function Mh(c){if(c instanceof uo)return Mh(c.boundExpression);if(c instanceof Yi&&c.name==="error"||c instanceof _h||c instanceof Ea||c instanceof ka||c instanceof Gc)return!1;const i=c instanceof No||c instanceof _i;let l=!0;return c.eachChild(p=>{l=i?l&&Mh(p):l&&p instanceof si}),!!l&&kh(c)&&vl(c,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function kh(c){if(c instanceof Yi&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Ea||c instanceof ka)return!1;let i=!0;return c.eachChild(l=>{i&&!kh(l)&&(i=!1)}),i}function qc(c){if(c instanceof Yi&&c.name==="feature-state")return!1;let i=!0;return c.eachChild(l=>{i&&!qc(l)&&(i=!1)}),i}function vl(c,i){if(c instanceof Yi&&i.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild(p=>{l&&!vl(p,i)&&(l=!1)}),l}function Yg(c){return{result:"success",value:c}}function _l(c){return{result:"error",value:c}}function xl(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Hp(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Kp(c){return!!c.expression&&c.expression.interpolated}function Jt(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Ia(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)&&zt(c)===Do}function Qg(c){return c}function Jg(c,i){const l=c.stops&&typeof c.stops[0][0]=="object",p=l||!(l||c.property!==void 0),g=c.type||(Kp(i)?"exponential":"interval"),_=function(D){switch(D.type){case"color":return Qt.parse;case"padding":return hn.parse;case"numberArray":return Qn.parse;case"colorArray":return En.parse;default:return null}}(i);if(_&&((c=Bn({},c)).stops&&(c.stops=c.stops.map(D=>[D[0],_(D[1])])),c.default=_(c.default?c.default:i.default)),c.colorSpace&&(x=c.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var x;const T=function(D){switch(D){case"exponential":return ey;case"interval":return cx;case"categorical":return lx;case"identity":return ty;default:throw new Error(`Unknown function type "${D}"`)}}(g);let E,R;if(g==="categorical"){E=Object.create(null);for(const D of c.stops)E[D[0]]=D[1];R=typeof c.stops[0][0]}if(l){const D={},N=[];for(let Y=0;Y<c.stops.length;Y++){const J=c.stops[Y],ie=J[0].zoom;D[ie]===void 0&&(D[ie]={zoom:ie,type:c.type,property:c.property,default:c.default,stops:[]},N.push(ie)),D[ie].stops.push([J[0].value,J[1]])}const G=[];for(const Y of N)G.push([D[Y].zoom,Jg(D[Y],i)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:ai.interpolationFactor.bind(void 0,H),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>ey({stops:G,base:c.base},i,Y).evaluate(Y,J)}}if(p){const D=g==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ai.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map(N=>N[0]),evaluate:({zoom:N})=>T(c,i,N,E,R)}}return{kind:"source",evaluate(D,N){const G=N&&N.properties?N.properties[c.property]:void 0;return G===void 0?Zc(c.default,i.default):T(c,i,G,E,R)}}}function Zc(c,i,l){return c!==void 0?c:i!==void 0?i:l!==void 0?l:void 0}function lx(c,i,l,p,g){return Zc(typeof l===g?p[l]:void 0,c.default,i.default)}function cx(c,i,l){if(Jt(l)!=="number")return Zc(c.default,i.default);const p=c.stops.length;if(p===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[p-1][0])return c.stops[p-1][1];const g=hl(c.stops.map(_=>_[0]),l);return c.stops[g][1]}function ey(c,i,l){const p=c.base!==void 0?c.base:1;if(Jt(l)!=="number")return Zc(c.default,i.default);const g=c.stops.length;if(g===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[g-1][0])return c.stops[g-1][1];const _=hl(c.stops.map(D=>D[0]),l),x=function(D,N,G,H){const Y=H-G,J=D-G;return Y===0?0:N===1?J/Y:(Math.pow(N,J)-1)/(Math.pow(N,Y)-1)}(l,p,c.stops[_][0],c.stops[_+1][0]),T=c.stops[_][1],E=c.stops[_+1][1],R=zi[i.type]||Qg;return typeof T.evaluate=="function"?{evaluate(...D){const N=T.evaluate.apply(void 0,D),G=E.evaluate.apply(void 0,D);if(N!==void 0&&G!==void 0)return R(N,G,x,c.colorSpace)}}:R(T,E,x,c.colorSpace)}function ty(c,i,l){switch(i.type){case"color":l=Qt.parse(l);break;case"formatted":l=Yn.fromString(l.toString());break;case"resolvedImage":l=vi.fromString(l.toString());break;case"padding":l=hn.parse(l);break;case"colorArray":l=En.parse(l);break;case"numberArray":l=Qn.parse(l);break;default:Jt(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0)}return Zc(l,c.default,i.default)}Yi.register(yl,{error:[{kind:"error"},[qt],(c,[i])=>{throw new zr(i.evaluate(c))}],typeof:[qt,[Wt],(c,[i])=>Dr(zt(i.evaluate(c)))],"to-rgba":[Di(dt,4),[Li],(c,[i])=>{const[l,p,g,_]=i.evaluate(c).rgb;return[255*l,255*p,255*g,_]}],rgb:[Li,[dt,dt,dt],Kg],rgba:[Li,[dt,dt,dt,dt],Kg],has:{type:Zt,overloads:[[[qt],(c,[i])=>Xg(i.evaluate(c),c.properties())],[[qt,Do],(c,[i,l])=>Xg(i.evaluate(c),l.evaluate(c))]]},get:{type:Wt,overloads:[[[qt],(c,[i])=>Wp(i.evaluate(c),c.properties())],[[qt,Do],(c,[i,l])=>Wp(i.evaluate(c),l.evaluate(c))]]},"feature-state":[Wt,[qt],(c,[i])=>Wp(i.evaluate(c),c.featureState||{})],properties:[Do,[],c=>c.properties()],"geometry-type":[qt,[],c=>c.geometryType()],id:[Wt,[],c=>c.id()],zoom:[dt,[],c=>c.globals.zoom],"heatmap-density":[dt,[],c=>c.globals.heatmapDensity||0],elevation:[dt,[],c=>c.globals.elevation||0],"line-progress":[dt,[],c=>c.globals.lineProgress||0],accumulated:[Wt,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[dt,Aa(dt),(c,i)=>{let l=0;for(const p of i)l+=p.evaluate(c);return l}],"*":[dt,Aa(dt),(c,i)=>{let l=1;for(const p of i)l*=p.evaluate(c);return l}],"-":{type:dt,overloads:[[[dt,dt],(c,[i,l])=>i.evaluate(c)-l.evaluate(c)],[[dt],(c,[i])=>-i.evaluate(c)]]},"/":[dt,[dt,dt],(c,[i,l])=>i.evaluate(c)/l.evaluate(c)],"%":[dt,[dt,dt],(c,[i,l])=>i.evaluate(c)%l.evaluate(c)],ln2:[dt,[],()=>Math.LN2],pi:[dt,[],()=>Math.PI],e:[dt,[],()=>Math.E],"^":[dt,[dt,dt],(c,[i,l])=>Math.pow(i.evaluate(c),l.evaluate(c))],sqrt:[dt,[dt],(c,[i])=>Math.sqrt(i.evaluate(c))],log10:[dt,[dt],(c,[i])=>Math.log(i.evaluate(c))/Math.LN10],ln:[dt,[dt],(c,[i])=>Math.log(i.evaluate(c))],log2:[dt,[dt],(c,[i])=>Math.log(i.evaluate(c))/Math.LN2],sin:[dt,[dt],(c,[i])=>Math.sin(i.evaluate(c))],cos:[dt,[dt],(c,[i])=>Math.cos(i.evaluate(c))],tan:[dt,[dt],(c,[i])=>Math.tan(i.evaluate(c))],asin:[dt,[dt],(c,[i])=>Math.asin(i.evaluate(c))],acos:[dt,[dt],(c,[i])=>Math.acos(i.evaluate(c))],atan:[dt,[dt],(c,[i])=>Math.atan(i.evaluate(c))],min:[dt,Aa(dt),(c,i)=>Math.min(...i.map(l=>l.evaluate(c)))],max:[dt,Aa(dt),(c,i)=>Math.max(...i.map(l=>l.evaluate(c)))],abs:[dt,[dt],(c,[i])=>Math.abs(i.evaluate(c))],round:[dt,[dt],(c,[i])=>{const l=i.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[dt,[dt],(c,[i])=>Math.floor(i.evaluate(c))],ceil:[dt,[dt],(c,[i])=>Math.ceil(i.evaluate(c))],"filter-==":[Zt,[qt,Wt],(c,[i,l])=>c.properties()[i.value]===l.value],"filter-id-==":[Zt,[Wt],(c,[i])=>c.id()===i.value],"filter-type-==":[Zt,[qt],(c,[i])=>c.geometryType()===i.value],"filter-<":[Zt,[qt,Wt],(c,[i,l])=>{const p=c.properties()[i.value],g=l.value;return typeof p==typeof g&&p<g}],"filter-id-<":[Zt,[Wt],(c,[i])=>{const l=c.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Zt,[qt,Wt],(c,[i,l])=>{const p=c.properties()[i.value],g=l.value;return typeof p==typeof g&&p>g}],"filter-id->":[Zt,[Wt],(c,[i])=>{const l=c.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Zt,[qt,Wt],(c,[i,l])=>{const p=c.properties()[i.value],g=l.value;return typeof p==typeof g&&p<=g}],"filter-id-<=":[Zt,[Wt],(c,[i])=>{const l=c.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Zt,[qt,Wt],(c,[i,l])=>{const p=c.properties()[i.value],g=l.value;return typeof p==typeof g&&p>=g}],"filter-id->=":[Zt,[Wt],(c,[i])=>{const l=c.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Zt,[Wt],(c,[i])=>i.value in c.properties()],"filter-has-id":[Zt,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Zt,[Di(qt)],(c,[i])=>i.value.indexOf(c.geometryType())>=0],"filter-id-in":[Zt,[Di(Wt)],(c,[i])=>i.value.indexOf(c.id())>=0],"filter-in-small":[Zt,[qt,Di(Wt)],(c,[i,l])=>l.value.indexOf(c.properties()[i.value])>=0],"filter-in-large":[Zt,[qt,Di(Wt)],(c,[i,l])=>function(p,g,_,x){for(;_<=x;){const T=_+x>>1;if(g[T]===p)return!0;g[T]>p?x=T-1:_=T+1}return!1}(c.properties()[i.value],l.value,0,l.value.length-1)],all:{type:Zt,overloads:[[[Zt,Zt],(c,[i,l])=>i.evaluate(c)&&l.evaluate(c)],[Aa(Zt),(c,i)=>{for(const l of i)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Zt,overloads:[[[Zt,Zt],(c,[i,l])=>i.evaluate(c)||l.evaluate(c)],[Aa(Zt),(c,i)=>{for(const l of i)if(l.evaluate(c))return!0;return!1}]]},"!":[Zt,[Zt],(c,[i])=>!i.evaluate(c)],"is-supported-script":[Zt,[qt],(c,[i])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(i.evaluate(c))}],upcase:[qt,[qt],(c,[i])=>i.evaluate(c).toUpperCase()],downcase:[qt,[qt],(c,[i])=>i.evaluate(c).toLowerCase()],concat:[qt,Aa(Wt),(c,i)=>i.map(l=>Pa(l.evaluate(c))).join("")],"resolved-locale":[qt,[os],(c,[i])=>i.evaluate(c).resolvedLocale()]});class Ah{constructor(i,l){this.expression=i,this._warningHistory={},this._evaluator=new zg,this._defaultValue=l?function(p){if(p.type==="color"&&Ia(p.default))return new Qt(0,0,0,0);switch(p.type){case"color":return Qt.parse(p.default)||null;case"padding":return hn.parse(p.default)||null;case"numberArray":return Qn.parse(p.default)||null;case"colorArray":return En.parse(p.default)||null;case"variableAnchorOffsetCollection":return or.parse(p.default)||null;case"projectionDefinition":return Ot.parse(p.default)||null;default:return p.default===void 0?null:p.default}}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(i,l,p,g,_,x){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new zr(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Ih(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in yl}function Rh(c,i){const l=new Dc(yl,Mh,[],i?function(g){const _={color:Li,string:qt,number:dt,enum:qt,boolean:Zt,formatted:wa,padding:rn,numberArray:kc,colorArray:Mc,projectionDefinition:dh,resolvedImage:ss,variableAnchorOffsetCollection:Ac};return g.type==="array"?Di(_[g.value]||Wt,g.length):_[g.type]}(i):void 0),p=l.parse(c,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Yg(new Ah(p,i)):_l(l.errors)}class Wc{constructor(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent=i!=="constant"&&!qc(l.expression),this.globalStateRefs=wl(l.expression)}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,_,x)}evaluate(i,l,p,g,_,x){return this._styleExpression.evaluate(i,l,p,g,_,x)}}class Lh{constructor(i,l,p,g){this.kind=i,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!qc(l.expression),this.globalStateRefs=wl(l.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,_,x)}evaluate(i,l,p,g,_,x){return this._styleExpression.evaluate(i,l,p,g,_,x)}interpolationFactor(i,l,p){return this.interpolationType?ai.interpolationFactor(this.interpolationType,i,l,p):0}}function Xp(c,i){const l=Rh(c,i);if(l.result==="error")return l;const p=l.value.expression,g=kh(p);if(!g&&!xl(i))return _l([new Lr("","data expressions not supported")]);const _=vl(p,["zoom"]);if(!_&&!Hp(i))return _l([new Lr("","zoom expressions not supported")]);const x=bl(p);return x||_?x instanceof Lr?_l([x]):x instanceof ai&&!Kp(i)?_l([new Lr("",'"interpolate" expressions cannot be used with this property')]):Yg(x?new Lh(g?"camera":"composite",l.value,x.labels,x instanceof ai?x.interpolation:void 0):new Wc(g?"constant":"source",l.value)):_l([new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Hc{constructor(i,l){this._parameters=i,this._specification=l,Bn(this,Jg(this._parameters,this._specification))}static deserialize(i){return new Hc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function bl(c){let i=null;if(c instanceof zc)i=bl(c.result);else if(c instanceof xi){for(const l of c.args)if(i=bl(l),i)break}else(c instanceof dl||c instanceof ai)&&c.input instanceof Yi&&c.input.name==="zoom"&&(i=c);return i instanceof Lr||c.eachChild(l=>{const p=bl(l);p instanceof Lr?i=p:!i&&p?i=new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&p&&i!==p&&(i=new Lr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function wl(c,i=new Set){return c instanceof Gc&&i.add(c.key),c.eachChild(l=>{wl(l,i)}),i}function Kc(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const i of c.slice(1))if(!Kc(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Yp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Vs(c){if(c==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Kc(c)||(c=Dh(c));const i=Rh(c,Yp);if(i.result==="error")throw new Error(i.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,p,g)=>i.value.evaluate(l,p,{},g),needGeometry:ry(c),getGlobalStateRefs:()=>wl(i.value.expression)}}function ux(c,i){return c<i?-1:c>i?1:0}function ry(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let i=1;i<c.length;i++)if(ry(c[i]))return!0;return!1}function Dh(c){if(!c)return!0;const i=c[0];return c.length<=1?i!=="any":i==="=="?Qp(c[1],c[2],"=="):i==="!="?Xc(Qp(c[1],c[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Qp(c[1],c[2],i):i==="any"?(l=c.slice(1),["any"].concat(l.map(Dh))):i==="all"?["all"].concat(c.slice(1).map(Dh)):i==="none"?["all"].concat(c.slice(1).map(Dh).map(Xc)):i==="in"?ny(c[1],c.slice(2)):i==="!in"?Xc(ny(c[1],c.slice(2))):i==="has"?iy(c[1]):i!=="!has"||Xc(iy(c[1]));var l}function Qp(c,i,l){switch(c){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,c,i]}}function ny(c,i){if(i.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",c,["literal",i.sort(ux)]]:["filter-in-small",c,["literal",i]]}}function iy(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Xc(c){return["!",c]}function zh(c){const i=typeof c;if(i==="number"||i==="boolean"||i==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let g="[";for(const _ of c)g+=`${zh(_)},`;return`${g}]`}const l=Object.keys(c).sort();let p="{";for(let g=0;g<l.length;g++)p+=`${JSON.stringify(l[g])}:${zh(c[l[g]])},`;return`${p}}`}function Nh(c){let i="";for(const l of Je)i+=`/${zh(c[l])}`;return i}function oy(c){const i=c.value;return i?[new lt(c.key,i,"constants have been deprecated as of v8")]:[]}function Vr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Us(c){if(Array.isArray(c))return c.map(Us);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const i={};for(const l in c)i[l]=Us(c[l]);return i}return Vr(c)}function Qi(c){const i=c.key,l=c.value,p=c.valueSpec||{},g=c.objectElementValidators||{},_=c.style,x=c.styleSpec,T=c.validateSpec;let E=[];const R=Jt(l);if(R!=="object")return[new lt(i,l,`object expected, ${R} found`)];for(const D in l){const N=D.split(".")[0],G=Yt(p,N)||p["*"];let H;if(Yt(g,N))H=g[N];else if(Yt(p,N))H=T;else if(g["*"])H=g["*"];else{if(!p["*"]){E.push(new lt(i,l[D],`unknown property "${D}"`));continue}H=T}E=E.concat(H({key:(i&&`${i}.`)+D,value:l[D],valueSpec:G,style:_,styleSpec:x,object:l,objectKey:D,validateSpec:T},l))}for(const D in p)g[D]||p[D].required&&p[D].default===void 0&&l[D]===void 0&&E.push(new lt(i,l,`missing required property "${D}"`));return E}function jh(c){const i=c.value,l=c.valueSpec,p=c.style,g=c.styleSpec,_=c.key,x=c.arrayElementValidator||c.validateSpec;if(Jt(i)!=="array")return[new lt(_,i,`array expected, ${Jt(i)} found`)];if(l.length&&i.length!==l.length)return[new lt(_,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new lt(_,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let T={type:l.value,values:l.values};g.$version<7&&(T.function=l.function),Jt(l.value)==="object"&&(T=l.value);let E=[];for(let R=0;R<i.length;R++)E=E.concat(x({array:i,arrayIndex:R,value:i[R],valueSpec:T,validateSpec:c.validateSpec,style:p,styleSpec:g,key:`${_}[${R}]`}));return E}function Yc(c){const i=c.key,l=c.value,p=c.valueSpec;let g=Jt(l);return g==="number"&&l!=l&&(g="NaN"),g!=="number"?[new lt(i,l,`number expected, ${g} found`)]:"minimum"in p&&l<p.minimum?[new lt(i,l,`${l} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&l>p.maximum?[new lt(i,l,`${l} is greater than the maximum value ${p.maximum}`)]:[]}function Sl(c){const i=c.valueSpec,l=Vr(c.value.type);let p,g,_,x={};const T=l!=="categorical"&&c.value.property===void 0,E=!T,R=Jt(c.value.stops)==="array"&&Jt(c.value.stops[0])==="array"&&Jt(c.value.stops[0][0])==="object",D=Qi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(H){if(l==="identity")return[new lt(H.key,H.value,'identity function may not have a "stops" property')];let Y=[];const J=H.value;return Y=Y.concat(jh({key:H.key,value:J,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:N})),Jt(J)==="array"&&J.length===0&&Y.push(new lt(H.key,J,"array must have at least one stop")),Y},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return l==="identity"&&T&&D.push(new lt(c.key,c.value,'missing required property "property"')),l==="identity"||c.value.stops||D.push(new lt(c.key,c.value,'missing required property "stops"')),l==="exponential"&&c.valueSpec.expression&&!Kp(c.valueSpec)&&D.push(new lt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(E&&!xl(c.valueSpec)?D.push(new lt(c.key,c.value,"property functions not supported")):T&&!Hp(c.valueSpec)&&D.push(new lt(c.key,c.value,"zoom functions not supported"))),l!=="categorical"&&!R||c.value.property!==void 0||D.push(new lt(c.key,c.value,'"property" property is required')),D;function N(H){let Y=[];const J=H.value,ie=H.key;if(Jt(J)!=="array")return[new lt(ie,J,`array expected, ${Jt(J)} found`)];if(J.length!==2)return[new lt(ie,J,`array length 2 expected, length ${J.length} found`)];if(R){if(Jt(J[0])!=="object")return[new lt(ie,J,`object expected, ${Jt(J[0])} found`)];if(J[0].zoom===void 0)return[new lt(ie,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new lt(ie,J,"object stop key must have value")];if(_&&_>Vr(J[0].zoom))return[new lt(ie,J[0].zoom,"stop zoom values must appear in ascending order")];Vr(J[0].zoom)!==_&&(_=Vr(J[0].zoom),g=void 0,x={}),Y=Y.concat(Qi({key:`${ie}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Yc,value:G}}))}else Y=Y.concat(G({key:`${ie}[0]`,value:J[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},J));return Ih(Us(J[1]))?Y.concat([new lt(`${ie}[1]`,J[1],"expressions are not allowed in function stops.")]):Y.concat(H.validateSpec({key:`${ie}[1]`,value:J[1],valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function G(H,Y){const J=Jt(H.value),ie=Vr(H.value),ce=H.value!==null?H.value:Y;if(p){if(J!==p)return[new lt(H.key,ce,`${J} stop domain type must match previous stop domain type ${p}`)]}else p=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new lt(H.key,ce,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&l!=="categorical"){let Se=`number expected, ${J} found`;return xl(i)&&l===void 0&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new lt(H.key,ce,Se)]}return l!=="categorical"||J!=="number"||isFinite(ie)&&Math.floor(ie)===ie?l!=="categorical"&&J==="number"&&g!==void 0&&ie<g?[new lt(H.key,ce,"stop domain values must appear in ascending order")]:(g=ie,l==="categorical"&&ie in x?[new lt(H.key,ce,"stop domain values must be unique")]:(x[ie]=!0,[])):[new lt(H.key,ce,`integer expected, found ${ie}`)]}}function Tl(c){const i=(c.expressionContext==="property"?Xp:Rh)(Us(c.value),c.valueSpec);if(i.result==="error")return i.value.map(p=>new lt(`${c.key}${p.key}`,c.value,p.message));const l=i.value.expression||i.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!l.outputDefined())return[new lt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!qc(l))return[new lt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!qc(l))return[new lt(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!vl(l,["zoom","feature-state"]))return[new lt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!kh(l))return[new lt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Jp(c){const i=c.key,l=c.value,p=Jt(l);return p!=="string"?[new lt(i,l,`color expected, ${p} found`)]:Qt.parse(String(l))?[]:[new lt(i,l,`color expected, "${l}" found`)]}function Qc(c){const i=c.key,l=c.value,p=c.valueSpec,g=[];return Array.isArray(p.values)?p.values.indexOf(Vr(l))===-1&&g.push(new lt(i,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(Vr(l))===-1&&g.push(new lt(i,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),g}function ef(c){return Kc(Us(c.value))?Tl(Bn({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):sy(c)}function sy(c){const i=c.value,l=c.key;if(Jt(i)!=="array")return[new lt(l,i,`array expected, ${Jt(i)} found`)];const p=c.styleSpec;let g,_=[];if(i.length<1)return[new lt(l,i,"filter array must have at least 1 element")];switch(_=_.concat(Qc({key:`${l}[0]`,value:i[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Vr(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Vr(i[1])==="$type"&&_.push(new lt(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&_.push(new lt(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(g=Jt(i[1]),g!=="string"&&_.push(new lt(`${l}[1]`,i[1],`string expected, ${g} found`)));for(let x=2;x<i.length;x++)g=Jt(i[x]),Vr(i[1])==="$type"?_=_.concat(Qc({key:`${l}[${x}]`,value:i[x],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&_.push(new lt(`${l}[${x}]`,i[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<i.length;x++)_=_.concat(sy({key:`${l}[${x}]`,value:i[x],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=Jt(i[1]),i.length!==2?_.push(new lt(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="string"&&_.push(new lt(`${l}[1]`,i[1],`string expected, ${g} found`))}return _}function ay(c,i){const l=c.key,p=c.validateSpec,g=c.style,_=c.styleSpec,x=c.value,T=c.objectKey,E=_[`${i}_${c.layerType}`];if(!E)return[];const R=T.match(/^(.*)-transition$/);if(i==="paint"&&R&&E[R[1]]&&E[R[1]].transition)return p({key:l,value:x,valueSpec:_.transition,style:g,styleSpec:_});const D=c.valueSpec||E[T];if(!D)return[new lt(l,x,`unknown property "${T}"`)];let N;if(Jt(x)==="string"&&xl(D)&&!D.tokens&&(N=/^{([^}]+)}$/.exec(x)))return[new lt(l,x,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const G=[];return c.layerType==="symbol"&&(T==="text-field"&&g&&!g.glyphs&&G.push(new lt(l,x,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Ia(Us(x))&&Vr(x.type)==="identity"&&G.push(new lt(l,x,'"text-font" does not support identity functions'))),G.concat(p({key:c.key,value:x,valueSpec:D,style:g,styleSpec:_,expressionContext:"property",propertyType:i,propertyKey:T}))}function Cl(c){return ay(c,"paint")}function Pl(c){return ay(c,"layout")}function bi(c){let i=[];const l=c.value,p=c.key,g=c.style,_=c.styleSpec;if(Jt(l)!=="object")return[new lt(p,l,`object expected, ${Jt(l)} found`)];l.type||l.ref||i.push(new lt(p,l,'either "type" or "ref" is required'));let x=Vr(l.type);const T=Vr(l.ref);if(l.id){const E=Vr(l.id);for(let R=0;R<c.arrayIndex;R++){const D=g.layers[R];Vr(D.id)===E&&i.push(new lt(p,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let E;["type","source","source-layer","filter","layout"].forEach(R=>{R in l&&i.push(new lt(p,l[R],`"${R}" is prohibited for ref layers`))}),g.layers.forEach(R=>{Vr(R.id)===T&&(E=R)}),E?E.ref?i.push(new lt(p,l.ref,"ref cannot reference another ref layer")):x=Vr(E.type):i.push(new lt(p,l.ref,`ref layer "${T}" not found`))}else if(x!=="background")if(l.source){const E=g.sources&&g.sources[l.source],R=E&&Vr(E.type);E?R==="vector"&&x==="raster"?i.push(new lt(p,l.source,`layer "${l.id}" requires a raster source`)):R!=="raster-dem"&&x==="hillshade"||R!=="raster-dem"&&x==="color-relief"?i.push(new lt(p,l.source,`layer "${l.id}" requires a raster-dem source`)):R==="raster"&&x!=="raster"?i.push(new lt(p,l.source,`layer "${l.id}" requires a vector source`)):R!=="vector"||l["source-layer"]?R==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?i.push(new lt(p,l.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!l.paint||!l.paint["line-gradient"]||R==="geojson"&&E.lineMetrics||i.push(new lt(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new lt(p,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new lt(p,l.source,`source "${l.source}" not found`))}else i.push(new lt(p,l,'missing required property "source"'));return i=i.concat(Qi({key:p,value:l,valueSpec:_.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${p}.type`,value:l.type,valueSpec:_.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:l,objectKey:"type"}),filter:ef,layout:E=>Qi({layer:l,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":R=>Pl(Bn({layerType:x},R))}}),paint:E=>Qi({layer:l,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":R=>Cl(Bn({layerType:x},R))}})}})),i}function ho(c){const i=c.value,l=c.key,p=Jt(i);return p!=="string"?[new lt(l,i,`string expected, ${p} found`)]:[]}const tf={promoteId:function({key:c,value:i}){if(Jt(i)==="string")return ho({key:c,value:i});{const l=[];for(const p in i)l.push(...ho({key:`${c}.${p}`,value:i[p]}));return l}}};function ly(c){const i=c.value,l=c.key,p=c.styleSpec,g=c.style,_=c.validateSpec;if(!i.type)return[new lt(l,i,'"type" is required')];const x=Vr(i.type);let T;switch(x){case"vector":case"raster":return T=Qi({key:l,value:i,valueSpec:p[`source_${x.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:tf,validateSpec:_}),T;case"raster-dem":return T=function(E){var R;const D=(R=E.sourceName)!==null&&R!==void 0?R:"",N=E.value,G=E.styleSpec,H=G.source_raster_dem,Y=E.style;let J=[];const ie=Jt(N);if(N===void 0)return J;if(ie!=="object")return J.push(new lt("source_raster_dem",N,`object expected, ${ie} found`)),J;const ce=Vr(N.encoding)==="custom",Se=["redFactor","greenFactor","blueFactor","baseShift"],ye=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const W in N)!ce&&Se.includes(W)?J.push(new lt(W,N[W],`In "${D}": "${W}" is only valid when "encoding" is set to "custom". ${ye} encoding found`)):H[W]?J=J.concat(E.validateSpec({key:W,value:N[W],valueSpec:H[W],validateSpec:E.validateSpec,style:Y,styleSpec:G})):J.push(new lt(W,N[W],`unknown property "${W}"`));return J}({sourceName:l,value:i,style:c.style,styleSpec:p,validateSpec:_}),T;case"geojson":if(T=Qi({key:l,value:i,valueSpec:p.source_geojson,style:g,styleSpec:p,validateSpec:_,objectElementValidators:tf}),i.cluster)for(const E in i.clusterProperties){const[R,D]=i.clusterProperties[E],N=typeof R=="string"?[R,["accumulated"],["get",E]]:R;T.push(...Tl({key:`${l}.${E}.map`,value:D,expressionContext:"cluster-map"})),T.push(...Tl({key:`${l}.${E}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return T;case"video":return Qi({key:l,value:i,valueSpec:p.source_video,style:g,validateSpec:_,styleSpec:p});case"image":return Qi({key:l,value:i,valueSpec:p.source_image,style:g,validateSpec:_,styleSpec:p});case"canvas":return[new lt(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Qc({key:`${l}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function cy(c){const i=c.value,l=c.styleSpec,p=l.light,g=c.style;let _=[];const x=Jt(i);if(i===void 0)return _;if(x!=="object")return _=_.concat([new lt("light",i,`object expected, ${x} found`)]),_;for(const T in i){const E=T.match(/^(.*)-transition$/);_=_.concat(E&&p[E[1]]&&p[E[1]].transition?c.validateSpec({key:T,value:i[T],valueSpec:l.transition,validateSpec:c.validateSpec,style:g,styleSpec:l}):p[T]?c.validateSpec({key:T,value:i[T],valueSpec:p[T],validateSpec:c.validateSpec,style:g,styleSpec:l}):[new lt(T,i[T],`unknown property "${T}"`)])}return _}function El(c){const i=c.value,l=c.styleSpec,p=l.sky,g=c.style,_=Jt(i);if(i===void 0)return[];if(_!=="object")return[new lt("sky",i,`object expected, ${_} found`)];let x=[];for(const T in i)x=x.concat(p[T]?c.validateSpec({key:T,value:i[T],valueSpec:p[T],style:g,styleSpec:l}):[new lt(T,i[T],`unknown property "${T}"`)]);return x}function rf(c){const i=c.value,l=c.styleSpec,p=l.terrain,g=c.style;let _=[];const x=Jt(i);if(i===void 0)return _;if(x!=="object")return _=_.concat([new lt("terrain",i,`object expected, ${x} found`)]),_;for(const T in i)_=_.concat(p[T]?c.validateSpec({key:T,value:i[T],valueSpec:p[T],validateSpec:c.validateSpec,style:g,styleSpec:l}):[new lt(T,i[T],`unknown property "${T}"`)]);return _}function Oh(c){let i=[];const l=c.value,p=c.key;if(Array.isArray(l)){const g=[],_=[];for(const x in l)l[x].id&&g.includes(l[x].id)&&i.push(new lt(p,l,`all the sprites' ids must be unique, but ${l[x].id} is duplicated`)),g.push(l[x].id),l[x].url&&_.includes(l[x].url)&&i.push(new lt(p,l,`all the sprites' URLs must be unique, but ${l[x].url} is duplicated`)),_.push(l[x].url),i=i.concat(Qi({key:`${p}[${x}]`,value:l[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return i}return ho({key:p,value:l})}function uy(c){return i=c.value,i&&i.constructor===Object?[]:[new lt(c.key,c.value,`object expected, ${Jt(c.value)} found`)];var i}const Fh={"*":()=>[],array:jh,boolean:function(c){const i=c.value,l=c.key,p=Jt(i);return p!=="boolean"?[new lt(l,i,`boolean expected, ${p} found`)]:[]},number:Yc,color:Jp,constants:oy,enum:Qc,filter:ef,function:Sl,layer:bi,object:Qi,source:ly,light:cy,sky:El,terrain:rf,projection:function(c){const i=c.value,l=c.styleSpec,p=l.projection,g=c.style,_=Jt(i);if(i===void 0)return[];if(_!=="object")return[new lt("projection",i,`object expected, ${_} found`)];let x=[];for(const T in i)x=x.concat(p[T]?c.validateSpec({key:T,value:i[T],valueSpec:p[T],style:g,styleSpec:l}):[new lt(T,i[T],`unknown property "${T}"`)]);return x},projectionDefinition:function(c){const i=c.key;let l=c.value;l=l instanceof String?l.valueOf():l;const p=Jt(l);return p!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(l)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(l)?["array","string"].includes(p)?[]:[new lt(i,l,`projection expected, invalid type "${p}" found`)]:[new lt(i,l,`projection expected, invalid array ${JSON.stringify(l)} found`)]},string:ho,formatted:function(c){return ho(c).length===0?[]:Tl(c)},resolvedImage:function(c){return ho(c).length===0?[]:Tl(c)},padding:function(c){const i=c.key,l=c.value;if(Jt(l)==="array"){if(l.length<1||l.length>4)return[new lt(i,l,`padding requires 1 to 4 values; ${l.length} values found`)];const p={type:"number"};let g=[];for(let _=0;_<l.length;_++)g=g.concat(c.validateSpec({key:`${i}[${_}]`,value:l[_],validateSpec:c.validateSpec,valueSpec:p}));return g}return Yc({key:i,value:l,valueSpec:{}})},numberArray:function(c){const i=c.key,l=c.value;if(Jt(l)==="array"){const p={type:"number"};if(l.length<1)return[new lt(i,l,"array length at least 1 expected, length 0 found")];let g=[];for(let _=0;_<l.length;_++)g=g.concat(c.validateSpec({key:`${i}[${_}]`,value:l[_],validateSpec:c.validateSpec,valueSpec:p}));return g}return Yc({key:i,value:l,valueSpec:{}})},colorArray:function(c){const i=c.key,l=c.value;if(Jt(l)==="array"){if(l.length<1)return[new lt(i,l,"array length at least 1 expected, length 0 found")];let p=[];for(let g=0;g<l.length;g++)p=p.concat(Jp({key:`${i}[${g}]`,value:l[g]}));return p}return Jp({key:i,value:l})},variableAnchorOffsetCollection:function(c){const i=c.key,l=c.value,p=Jt(l),g=c.styleSpec;if(p!=="array"||l.length<1||l.length%2!=0)return[new lt(i,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<l.length;x+=2)_=_.concat(Qc({key:`${i}[${x}]`,value:l[x],valueSpec:g.layout_symbol["text-anchor"]})),_=_.concat(jh({key:`${i}[${x+1}]`,value:l[x+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:g}));return _},sprite:Oh,state:uy};function Bh(c){const i=c.value,l=c.valueSpec,p=c.styleSpec;return c.validateSpec=Bh,l.expression&&Ia(Vr(i))?Sl(c):l.expression&&Ih(Us(i))?Tl(c):l.type&&Fh[l.type]?Fh[l.type](c):Qi(Bn({},c,{valueSpec:l.type?p[l.type]:l}))}function Ml(c){const i=c.value,l=c.key,p=ho(c);return p.length||(i.indexOf("{fontstack}")===-1&&p.push(new lt(l,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&p.push(new lt(l,i,'"glyphs" url must include a "{range}" token'))),p}function Ji(c,i=pe){let l=[];return l=l.concat(Bh({key:"",value:c,valueSpec:i.$root,styleSpec:i,style:c,validateSpec:Bh,objectElementValidators:{glyphs:Ml,"*":()=>[]}})),c.constants&&(l=l.concat(oy({key:"constants",value:c.constants}))),hy(l)}function po(c){return function(i){return c({...i,validateSpec:Bh})}}function hy(c){return[].concat(c).sort((i,l)=>i.line-l.line)}function li(c){return function(...i){return hy(c.apply(this,i))}}Ji.source=li(po(ly)),Ji.sprite=li(po(Oh)),Ji.glyphs=li(po(Ml)),Ji.light=li(po(cy)),Ji.sky=li(po(El)),Ji.terrain=li(po(rf)),Ji.state=li(po(uy)),Ji.layer=li(po(bi)),Ji.filter=li(po(ef)),Ji.paintProperty=li(po(Cl)),Ji.layoutProperty=li(po(Pl));const kl=Ji,hx=kl.light,$h=kl.sky,dx=kl.paintProperty,nf=kl.layoutProperty;function Jc(c,i){let l=!1;if(i&&i.length)for(const p of i)c.fire(new Me(new Error(p.message))),l=!0;return l}class Al{constructor(i,l,p){const g=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const x=new Int32Array(this.arrayBuffer);i=x[0],this.d=(l=x[1])+2*(p=x[2]);for(let E=0;E<this.d*this.d;E++){const R=x[3+E],D=x[3+E+1];g.push(R===D?null:x.subarray(R,D))}const T=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],T),this.bboxes=x.subarray(T),this.insert=this._insertReadonly}else{this.d=l+2*p;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=i,this.padding=p,this.scale=l/i,this.uid=0;const _=p/l*i;this.min=-_,this.max=i+_}insert(i,l,p,g,_){this._forEachCell(l,p,g,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,l,p,g,_,x){this.cells[_].push(x)}query(i,l,p,g,_){const x=this.min,T=this.max;if(i<=x&&l<=x&&T<=p&&T<=g&&!_)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(i,l,p,g,this._queryCell,E,{},_),E}}_queryCell(i,l,p,g,_,x,T,E){const R=this.cells[_];if(R!==null){const D=this.keys,N=this.bboxes;for(let G=0;G<R.length;G++){const H=R[G];if(T[H]===void 0){const Y=4*H;(E?E(N[Y+0],N[Y+1],N[Y+2],N[Y+3]):i<=N[Y+2]&&l<=N[Y+3]&&p>=N[Y+0]&&g>=N[Y+1])?(T[H]=!0,x.push(D[H])):T[H]=!1}}}}_forEachCell(i,l,p,g,_,x,T,E){const R=this._convertToCellCoord(i),D=this._convertToCellCoord(l),N=this._convertToCellCoord(p),G=this._convertToCellCoord(g);for(let H=R;H<=N;H++)for(let Y=D;Y<=G;Y++){const J=this.d*Y+H;if((!E||E(this._convertFromCellCoord(H),this._convertFromCellCoord(Y),this._convertFromCellCoord(H+1),this._convertFromCellCoord(Y+1)))&&_.call(this,i,l,p,g,J,x,T,E))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,l=3+this.cells.length+1+1;let p=0;for(let x=0;x<this.cells.length;x++)p+=this.cells[x].length;const g=new Int32Array(l+p+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let _=l;for(let x=0;x<i.length;x++){const T=i[x];g[3+x]=_,g.set(T,_),_+=T.length}return g[3+i.length]=_,g.set(this.keys,_),_+=this.keys.length,g[3+i.length+1]=_,g.set(this.bboxes,_),_+=this.bboxes.length,g.buffer}static serialize(i,l){const p=i.toArrayBuffer();return l&&l.push(p),{buffer:p}}static deserialize(i){return new Al(i.buffer)}}const Oo={};function _t(c,i,l={}){if(Oo[c])throw new Error(`${c} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:c,writeable:!1}),Oo[c]={klass:i,omit:l.omit||[],shallow:l.shallow||[]}}_t("Object",Object),_t("Set",Set),_t("TransferableGridIndex",Al),_t("Color",Qt),_t("Error",Error),_t("AJAXError",fe),_t("ResolvedImage",vi),_t("StylePropertyFunction",Hc),_t("StyleExpression",Ah,{omit:["_evaluator"]}),_t("ZoomDependentExpression",Lh),_t("ZoomConstantExpression",Wc),_t("CompoundExpression",Yi,{omit:["_evaluate"]});for(const c in yl)yl[c]._classRegistryKey||_t(`Expression_${c}`,yl[c]);function of(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function eu(c){return c.$name||c.constructor._classRegistryKey}function sf(c){return!function(i){if(i===null||typeof i!="object")return!1;const l=eu(i);return!(!l||l==="Object")}(c)&&(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||of(c)||yi(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function tu(c,i){if(sf(c))return(of(c)||yi(c))&&i&&i.push(c),ArrayBuffer.isView(c)&&i&&i.push(c.buffer),c instanceof ImageData&&i&&i.push(c.data.buffer),c;if(Array.isArray(c)){const _=[];for(const x of c)_.push(tu(x,i));return _}if(typeof c!="object")throw new Error("can't serialize object of type "+typeof c);const l=eu(c);if(!l)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!Oo[l])throw new Error(`${l} is not registered.`);const{klass:p}=Oo[l],g=p.serialize?p.serialize(c,i):{};if(p.serialize){if(i&&g===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in c){if(!c.hasOwnProperty(_)||Oo[l].omit.indexOf(_)>=0)continue;const x=c[_];g[_]=Oo[l].shallow.indexOf(_)>=0?x:tu(x,i)}c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(g.$name=l),g}function Il(c){if(sf(c))return c;if(Array.isArray(c))return c.map(Il);if(typeof c!="object")throw new Error("can't deserialize object of type "+typeof c);const i=eu(c)||"Object";if(!Oo[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:l}=Oo[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(c);const p=Object.create(l.prototype);for(const g of Object.keys(c)){if(g==="$name")continue;const _=c[g];p[g]=Oo[i].shallow.indexOf(g)>=0?_:Il(_)}return p}class af{constructor(){this.first=!0}update(i,l){const p=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=p,!0))}}const er={"Latin-1 Supplement":c=>c>=128&&c<=255,"Hangul Jamo":c=>c>=4352&&c<=4607,Khmer:c=>c>=6016&&c<=6143,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Kanbun:c=>c>=12688&&c<=12703,"CJK Strokes":c=>c>=12736&&c<=12783,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Hangul Syllables":c=>c>=44032&&c<=55215,"Private Use Area":c=>c>=57344&&c<=63743,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function lf(c){for(const i of c)if(Uh(i.charCodeAt(0)))return!0;return!1}function dy(c){for(const i of c)if(!fx(i.charCodeAt(0)))return!1;return!0}function Vh(c){const i=c.map(l=>{try{return new RegExp(`\\p{sc=${l}}`,"u").source}catch{return null}}).filter(l=>l);return new RegExp(i.join("|"),"u")}const px=Vh(["Arab","Dupl","Mong","Ougr","Syrc"]);function fx(c){return!px.test(String.fromCodePoint(c))}const cf=Vh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Uh(c){return!(c!==746&&c!==747&&(c<4352||!(er["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||er["CJK Compatibility"](c)||er["CJK Strokes"](c)||!(!er["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||er["Enclosed CJK Letters and Months"](c)||er["Ideographic Description Characters"](c)||er.Kanbun(c)||er.Katakana(c)&&c!==12540||!(!er["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!er["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||er["Vertical Forms"](c)||er["Yijing Hexagram Symbols"](c)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(c))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(c))||cf.test(String.fromCodePoint(c)))))}function uf(c){return!(Uh(c)||function(i){return!!(er["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||er["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||er["Letterlike Symbols"](i)||er["Number Forms"](i)||er["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||er["Control Pictures"](i)&&i!==9251||er["Optical Character Recognition"](i)||er["Enclosed Alphanumerics"](i)||er["Geometric Shapes"](i)||er["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||er["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||er["CJK Symbols and Punctuation"](i)||er.Katakana(i)||er["Private Use Area"](i)||er["CJK Compatibility Forms"](i)||er["Small Form Variants"](i)||er["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(c))}const py=Vh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ru(c){return py.test(String.fromCodePoint(c))}function mx(c,i){return!(!i&&ru(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||er.Khmer(c))}function hf(c){for(const i of c)if(ru(i.charCodeAt(0)))return!0;return!1}const Gs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){if(Gs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(c,i){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(c.pluginStatus!=="loading")return this.setState(c),c;const l=c.pluginURL,p=new Promise(_=>{this.loadScriptResolve=_});i(l);const g=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([p,g]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:l};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${l}`)})}};class Rr{constructor(i,l){this.zoom=i,l?(this.now=l.now||0,this.fadeDuration=l.fadeDuration||0,this.zoomHistory=l.zoomHistory||new af,this.transition=l.transition||{},this.globalState=l.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new af,this.transition={},this.globalState={})}isSupportedScript(i){return function(l,p){for(const g of l)if(!mx(g.charCodeAt(0),p))return!1;return!0}(i,Gs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,l=i-Math.floor(i),p=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*l}}}class nu{constructor(i,l){this.property=i,this.value=l,this.expression=function(p,g){if(Ia(p))return new Hc(p,g);if(Ih(p)){const _=Xp(p,g);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=p;return g.type==="color"&&typeof p=="string"?_=Qt.parse(p):g.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?g.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?g.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?_=or.parse(p):g.type==="projectionDefinition"&&typeof p=="string"&&(_=Ot.parse(p)):_=En.parse(p):_=Qn.parse(p):_=hn.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>_}}}(l===void 0?i.specification.default:l,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,l,p){return this.property.possiblyEvaluate(this,i,l,p)}}class Gh{constructor(i){this.property=i,this.value=new nu(i,void 0)}transitioned(i,l){return new fy(this.property,this.value,l,br({},i.transition,this.transition),i.now)}untransitioned(){return new fy(this.property,this.value,null,{},0)}}class df{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Xn(this._values[i].value.value)}setValue(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Gh(this._values[i].property)),this._values[i].value=new nu(this._values[i].property,l===null?void 0:Xn(l))}getTransition(i){return Xn(this._values[i].transition)}setTransition(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Gh(this._values[i].property)),this._values[i].transition=Xn(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p);const g=this.getTransition(l);g!==void 0&&(i[`${l}-transition`]=g)}return i}transitioned(i,l){const p=new my(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].transitioned(i,l._values[g]);return p}untransitioned(){const i=new my(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class fy{constructor(i,l,p,g,_){this.property=i,this.value=l,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,i.specification.transition&&(g.delay||g.duration)&&(this.prior=p)}possiblyEvaluate(i,l,p){const g=i.now||0,_=this.value.possiblyEvaluate(i,l,p),x=this.prior;if(x){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return x.possiblyEvaluate(i,l,p);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,l,p),_,gr(T))}}return _}}class my{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,p){const g=new qh(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,l,p);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class gx{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return this._values[i].value!==void 0}getValue(i){return Xn(this._values[i].value)}setValue(i,l){this._values[i]=new nu(this._values[i].property,l===null?void 0:Xn(l))}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p)}return i}possiblyEvaluate(i,l,p){const g=new qh(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,l,p);return g}}class Fo{constructor(i,l,p){this.property=i,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,p,g){return this.property.evaluate(this.value,this.parameters,i,l,p,g)}}class qh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class St{constructor(i){this.specification=i}possiblyEvaluate(i,l){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(l)}interpolate(i,l,p){const g=zi[this.specification.type];return g?g(i,l,p):i}}class Dt{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,p,g){return new Fo(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},p,g)}:i.expression,l)}interpolate(i,l,p){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new Fo(this,{kind:"constant",value:void 0},i.parameters);const g=zi[this.specification.type];if(g){const _=g(i.value.value,l.value.value,p);return new Fo(this,{kind:"constant",value:_},i.parameters)}return i}evaluate(i,l,p,g,_,x){return i.kind==="constant"?i.value:i.evaluate(l,p,g,_,x)}}class Zh extends Dt{possiblyEvaluate(i,l,p,g){if(i.value===void 0)return new Fo(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){const _=i.expression.evaluate(l,null,{},p,g),x=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(x,x,x,l);return new Fo(this,{kind:"constant",value:T},l)}if(i.expression.kind==="camera"){const _=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new Fo(this,{kind:"constant",value:_},l)}return new Fo(this,i.expression,l)}evaluate(i,l,p,g,_,x){if(i.kind==="source"){const T=i.evaluate(l,p,g,_,x);return this._calculate(T,T,T,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,g),i.evaluate({zoom:Math.floor(l.zoom)},p,g),i.evaluate({zoom:Math.floor(l.zoom)+1},p,g),l):i.value}_calculate(i,l,p,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class pf{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,g){if(i.value!==void 0){if(i.expression.kind==="constant"){const _=i.expression.evaluate(l,null,{},p,g);return this._calculate(_,_,_,l)}return this._calculate(i.expression.evaluate(new Rr(Math.floor(l.zoom-1),l)),i.expression.evaluate(new Rr(Math.floor(l.zoom),l)),i.expression.evaluate(new Rr(Math.floor(l.zoom+1),l)),l)}}_calculate(i,l,p,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class iu{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,g){return!!i.expression.evaluate(l,null,{},p,g)}interpolate(){return!1}}class ci{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in i){const p=i[l];p.specification.overridable&&this.overridableProperties.push(l);const g=this.defaultPropertyValues[l]=new nu(p,void 0),_=this.defaultTransitionablePropertyValues[l]=new Gh(p);this.defaultTransitioningPropertyValues[l]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=g.possiblyEvaluate({})}}}_t("DataDrivenProperty",Dt),_t("DataConstantProperty",St),_t("CrossFadedDataDrivenProperty",Zh),_t("CrossFadedProperty",pf),_t("ColorRampProperty",iu);const gy="-transition";class $n extends qe{constructor(i,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=Vs(i.filter)),l.layout&&(this._unevaluatedLayout=new gx(l.layout)),l.paint)){this._transitionablePaint=new df(l.paint);for(const p in i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(const p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qh(l.paint)}}setFilter(i){this.filter=i,this._featureFilter=Vs(i)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const l in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[l];for(const g of p.getGlobalStateRefs())i.add(g)}for(const l of this._featureFilter.getGlobalStateRefs())i.add(l);return i}setLayoutProperty(i,l,p={}){l!=null&&this._validate(nf,`layers.${this.id}.layout.${i}`,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)}getPaintProperty(i){return i.endsWith(gy)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l,p={}){if(l!=null&&this._validate(dx,`layers.${this.id}.paint.${i}`,i,l,p))return!1;if(i.endsWith(gy))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;{const g=this._transitionablePaint._values[i],_=g.property.specification["property-type"]==="cross-faded-data-driven",x=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);const E=this._transitionablePaint._values[i].value;return E.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(i,T,E)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,l,p){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ii(i,(l,p)=>!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length))}_validate(i,l,p,g,_={}){return(!_||_.validate!==!1)&&Jc(this,i.call(kl,{key:l,layerType:this.type,objectKey:p,value:g,styleSpec:pe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof Fo&&xl(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const yy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ra{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Nr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ur(c,i=1){let l=0,p=0;return{members:c.map(g=>{const _=yy[g.type].BYTES_PER_ELEMENT,x=l=vy(l,Math.max(i,_)),T=g.components||1;return p=Math.max(p,_),l+=_*T,{name:g.name,type:g.type,components:T,offset:x}}),size:vy(l,Math.max(p,i)),alignment:i}}function vy(c,i){return Math.ceil(c/i)*i}class qs extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.int16[g+0]=l,this.int16[g+1]=p,i}}qs.prototype.bytesPerElement=4,_t("StructArrayLayout2i4",qs);class Zs extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=g,i}}Zs.prototype.bytesPerElement=6,_t("StructArrayLayout3i6",Zs);class ff extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,g)}emplace(i,l,p,g,_){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=g,this.int16[x+3]=_,i}}ff.prototype.bytesPerElement=8,_t("StructArrayLayout4i8",ff);class Wh extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,T){const E=6*i;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=g,this.int16[E+3]=_,this.int16[E+4]=x,this.int16[E+5]=T,i}}Wh.prototype.bytesPerElement=12,_t("StructArrayLayout2i4i12",Wh);class La extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,T){const E=4*i,R=8*i;return this.int16[E+0]=l,this.int16[E+1]=p,this.uint8[R+4]=g,this.uint8[R+5]=_,this.uint8[R+6]=x,this.uint8[R+7]=T,i}}La.prototype.bytesPerElement=8,_t("StructArrayLayout2i4ub8",La);class ou extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.float32[g+0]=l,this.float32[g+1]=p,i}}ou.prototype.bytesPerElement=8,_t("StructArrayLayout2f8",ou);class mf extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,T,E,R,D){const N=this.length;return this.resize(N+1),this.emplace(N,i,l,p,g,_,x,T,E,R,D)}emplace(i,l,p,g,_,x,T,E,R,D,N){const G=10*i;return this.uint16[G+0]=l,this.uint16[G+1]=p,this.uint16[G+2]=g,this.uint16[G+3]=_,this.uint16[G+4]=x,this.uint16[G+5]=T,this.uint16[G+6]=E,this.uint16[G+7]=R,this.uint16[G+8]=D,this.uint16[G+9]=N,i}}mf.prototype.bytesPerElement=20,_t("StructArrayLayout10ui20",mf);class Hh extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,T,E,R,D,N,G){const H=this.length;return this.resize(H+1),this.emplace(H,i,l,p,g,_,x,T,E,R,D,N,G)}emplace(i,l,p,g,_,x,T,E,R,D,N,G,H){const Y=12*i;return this.int16[Y+0]=l,this.int16[Y+1]=p,this.int16[Y+2]=g,this.int16[Y+3]=_,this.uint16[Y+4]=x,this.uint16[Y+5]=T,this.uint16[Y+6]=E,this.uint16[Y+7]=R,this.int16[Y+8]=D,this.int16[Y+9]=N,this.int16[Y+10]=G,this.int16[Y+11]=H,i}}Hh.prototype.bytesPerElement=24,_t("StructArrayLayout4i4ui4i24",Hh);class gf extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=g,i}}gf.prototype.bytesPerElement=12,_t("StructArrayLayout3f12",gf);class y extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}y.prototype.bytesPerElement=4,_t("StructArrayLayout1ul4",y);class n extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,T,E,R){const D=this.length;return this.resize(D+1),this.emplace(D,i,l,p,g,_,x,T,E,R)}emplace(i,l,p,g,_,x,T,E,R,D){const N=10*i,G=5*i;return this.int16[N+0]=l,this.int16[N+1]=p,this.int16[N+2]=g,this.int16[N+3]=_,this.int16[N+4]=x,this.int16[N+5]=T,this.uint32[G+3]=E,this.uint16[N+8]=R,this.uint16[N+9]=D,i}}n.prototype.bytesPerElement=20,_t("StructArrayLayout6i1ul2ui20",n);class a extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,T){const E=6*i;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=g,this.int16[E+3]=_,this.int16[E+4]=x,this.int16[E+5]=T,i}}a.prototype.bytesPerElement=12,_t("StructArrayLayout2i2i2i12",a);class f extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,_)}emplace(i,l,p,g,_,x){const T=4*i,E=8*i;return this.float32[T+0]=l,this.float32[T+1]=p,this.float32[T+2]=g,this.int16[E+6]=_,this.int16[E+7]=x,i}}f.prototype.bytesPerElement=16,_t("StructArrayLayout2f1f2i16",f);class m extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,T){const E=16*i,R=4*i,D=8*i;return this.uint8[E+0]=l,this.uint8[E+1]=p,this.float32[R+1]=g,this.float32[R+2]=_,this.int16[D+6]=x,this.int16[D+7]=T,i}}m.prototype.bytesPerElement=16,_t("StructArrayLayout2ub2f2i16",m);class v extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=g,i}}v.prototype.bytesPerElement=6,_t("StructArrayLayout3ui6",v);class S extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce){const Se=this.length;return this.resize(Se+1),this.emplace(Se,i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce)}emplace(i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce,Se){const ye=24*i,W=12*i,re=48*i;return this.int16[ye+0]=l,this.int16[ye+1]=p,this.uint16[ye+2]=g,this.uint16[ye+3]=_,this.uint32[W+2]=x,this.uint32[W+3]=T,this.uint32[W+4]=E,this.uint16[ye+10]=R,this.uint16[ye+11]=D,this.uint16[ye+12]=N,this.float32[W+7]=G,this.float32[W+8]=H,this.uint8[re+36]=Y,this.uint8[re+37]=J,this.uint8[re+38]=ie,this.uint32[W+10]=ce,this.int16[ye+22]=Se,i}}S.prototype.bytesPerElement=48,_t("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",S);class P extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce,Se,ye,W,re,ve,Le,Xe,Oe,Be,it,Qe){const at=this.length;return this.resize(at+1),this.emplace(at,i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce,Se,ye,W,re,ve,Le,Xe,Oe,Be,it,Qe)}emplace(i,l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce,Se,ye,W,re,ve,Le,Xe,Oe,Be,it,Qe,at){const Ue=32*i,wt=16*i;return this.int16[Ue+0]=l,this.int16[Ue+1]=p,this.int16[Ue+2]=g,this.int16[Ue+3]=_,this.int16[Ue+4]=x,this.int16[Ue+5]=T,this.int16[Ue+6]=E,this.int16[Ue+7]=R,this.uint16[Ue+8]=D,this.uint16[Ue+9]=N,this.uint16[Ue+10]=G,this.uint16[Ue+11]=H,this.uint16[Ue+12]=Y,this.uint16[Ue+13]=J,this.uint16[Ue+14]=ie,this.uint16[Ue+15]=ce,this.uint16[Ue+16]=Se,this.uint16[Ue+17]=ye,this.uint16[Ue+18]=W,this.uint16[Ue+19]=re,this.uint16[Ue+20]=ve,this.uint16[Ue+21]=Le,this.uint16[Ue+22]=Xe,this.uint32[wt+12]=Oe,this.float32[wt+13]=Be,this.float32[wt+14]=it,this.uint16[Ue+30]=Qe,this.uint16[Ue+31]=at,i}}P.prototype.bytesPerElement=64,_t("StructArrayLayout8i15ui1ul2f2ui64",P);class M extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}M.prototype.bytesPerElement=4,_t("StructArrayLayout1f4",M);class L extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.uint16[6*i+0]=l,this.float32[_+1]=p,this.float32[_+2]=g,i}}L.prototype.bytesPerElement=12,_t("StructArrayLayout1ui2f12",L);class z extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=g,i}}z.prototype.bytesPerElement=8,_t("StructArrayLayout1ul2ui8",z);class $ extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.uint16[g+0]=l,this.uint16[g+1]=p,i}}$.prototype.bytesPerElement=4,_t("StructArrayLayout2ui4",$);class O extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}O.prototype.bytesPerElement=2,_t("StructArrayLayout1ui2",O);class Z extends Nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,g)}emplace(i,l,p,g,_){const x=4*i;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=g,this.float32[x+3]=_,i}}Z.prototype.bytesPerElement=16,_t("StructArrayLayout4f16",Z);class Q extends Ra{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new B(this.anchorPointX,this.anchorPointY)}}Q.prototype.size=20;class ae extends n{get(i){return new Q(this,i)}}_t("CollisionBoxArray",ae);class se extends Ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}se.prototype.size=48;class le extends S{get(i){return new se(this,i)}}_t("PlacedSymbolArray",le);class ue extends Ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ue.prototype.size=64;class ge extends P{get(i){return new ue(this,i)}}_t("SymbolInstanceArray",ge);class he extends M{getoffsetX(i){return this.float32[1*i+0]}}_t("GlyphOffsetArray",he);class _e extends Zs{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}_t("SymbolLineVertexArray",_e);class be extends Ra{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}be.prototype.size=12;class me extends L{get(i){return new be(this,i)}}_t("TextAnchorOffsetArray",me);class Ce extends Ra{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ce.prototype.size=8;class Ne extends z{get(i){return new Ce(this,i)}}_t("FeatureIndexArray",Ne);class Ae extends qs{}class Ie extends qs{}class je extends qs{}class ht extends Wh{}class ct extends La{}class Ye extends ou{}class bt extends mf{}class $t extends Hh{}class fr extends gf{}class jr extends y{}class Sr extends a{}class Or extends m{}class Cr extends v{}class Tr extends ${}const Pr=Ur([{name:"a_pos",components:2,type:"Int16"}],4),{members:Vn}=Pr;class cr{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,l,p,g){const _=this.segments[this.segments.length-1];return i>cr.MAX_VERTEX_ARRAY_LENGTH&&en(`Max vertices per segment is ${cr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${cr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+i>cr.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g?this.createNewSegment(l,p,g):_}createNewSegment(i,l,p){const g={vertexOffset:i.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(g.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(i,l,p){return this.prepareSegment(0,i,l,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,p,g){return new cr([{vertexOffset:i,primitiveOffset:l,vertexLength:p,primitiveLength:g,vaos:{},sortKey:0}])}}function kn(c,i){return 256*(c=yr(Math.floor(c),0,255))+yr(Math.floor(i),0,255)}cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_t("SegmentVector",cr);const Un=Ur([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ws,Hs,Ks,Bo={exports:{}},su={exports:{}},au={exports:{}},Rl=function(){if(Ks)return Bo.exports;Ks=1;var c=(Ws||(Ws=1,su.exports=function(l,p){var g,_,x,T,E,R,D,N;for(_=l.length-(g=3&l.length),x=p,E=3432918353,R=461845907,N=0;N<_;)D=255&l.charCodeAt(N)|(255&l.charCodeAt(++N))<<8|(255&l.charCodeAt(++N))<<16|(255&l.charCodeAt(++N))<<24,++N,x=27492+(65535&(T=5*(65535&(x=(x^=D=(65535&(D=(D=(65535&D)*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*R+(((D>>>16)*R&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(D=0,g){case 3:D^=(255&l.charCodeAt(N+2))<<16;case 2:D^=(255&l.charCodeAt(N+1))<<8;case 1:x^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(N)))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*R+(((D>>>16)*R&65535)<<16)&4294967295}return x^=l.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),su.exports),i=(Hs||(Hs=1,au.exports=function(l,p){for(var g,_=l.length,x=p^_,T=0;_>=4;)g=1540483477*(65535&(g=255&l.charCodeAt(T)|(255&l.charCodeAt(++T))<<8|(255&l.charCodeAt(++T))<<16|(255&l.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++T;switch(_){case 3:x^=(255&l.charCodeAt(T+2))<<16;case 2:x^=(255&l.charCodeAt(T+1))<<8;case 1:x=1540483477*(65535&(x^=255&l.charCodeAt(T)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),au.exports);return Bo.exports=c,Bo.exports.murmur3=c,Bo.exports.murmur2=i,Bo.exports}(),wi=b(Rl);class fo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,l,p,g){this.ids.push(Xs(i)),this.positions.push(l,p,g)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=Xs(i);let p=0,g=this.ids.length-1;for(;p<g;){const x=p+g>>1;this.ids[x]>=l?g=x:p=x+1}const _=[];for(;this.ids[p]===l;)_.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return _}static serialize(i,l){const p=new Float64Array(i.ids),g=new Uint32Array(i.positions);return Da(p,g,0,p.length-1),l&&l.push(p.buffer,g.buffer),{ids:p,positions:g}}static deserialize(i){const l=new fo;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l}}function Xs(c){const i=+c;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:wi(String(c))}function Da(c,i,l,p){for(;l<p;){const g=c[l+p>>1];let _=l-1,x=p+1;for(;;){do _++;while(c[_]<g);do x--;while(c[x]>g);if(_>=x)break;Kr(c,_,x),Kr(i,3*_,3*x),Kr(i,3*_+1,3*x+1),Kr(i,3*_+2,3*x+2)}x-l<p-x?(Da(c,i,l,x),l=x+1):(Da(c,i,x+1,p),p=x)}}function Kr(c,i,l){const p=c[i];c[i]=c[l],c[l]=p}_t("FeaturePositionMap",fo);class kr{constructor(i,l){this.gl=i.gl,this.location=l}}class ui extends kr{constructor(i,l){super(i,l),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class vn extends kr{constructor(i,l){super(i,l),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class _y extends kr{constructor(i,l){super(i,l),this.current=Qt.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const yx=new Float32Array(16);function yf(c){return[kn(255*c.r,255*c.g),kn(255*c.b,255*c.a)]}class lu{constructor(i,l,p){this.value=i,this.uniformNames=l.map(g=>`u_${g}`),this.type=p}setUniform(i,l,p){i.set(p.constantOr(this.value))}getBinding(i,l,p){return this.type==="color"?new _y(i,l):new ui(i,l)}}class Ll{constructor(i,l){this.uniformNames=l.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=i.tlbr}setUniform(i,l,p,g){const _=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&i.set(_)}getBinding(i,l,p){return p.substr(0,9)==="u_pattern"?new vn(i,l):new ui(i,l)}}class hs{constructor(i,l,p,g){this.expression=i,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,l,p,g,_){const x=this.paintVertexArray.length,T=this.expression.evaluate(new Rr(0),l,{},g,[],_);this.paintVertexArray.resize(i),this._setPaintValue(x,i,T)}updatePaintArray(i,l,p,g){const _=this.expression.evaluate({zoom:0},p,g);this._setPaintValue(i,l,_)}_setPaintValue(i,l,p){if(this.type==="color"){const g=yf(p);for(let _=i;_<l;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=i;g<l;g++)this.paintVertexArray.emplace(g,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gn{constructor(i,l,p,g,_,x){this.expression=i,this.uniformNames=l.map(T=>`u_${T}_t`),this.type=p,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=l.map(T=>({name:`a_${T}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,l,p,g,_){const x=this.expression.evaluate(new Rr(this.zoom),l,{},g,[],_),T=this.expression.evaluate(new Rr(this.zoom+1),l,{},g,[],_),E=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(E,i,x,T)}updatePaintArray(i,l,p,g){const _=this.expression.evaluate({zoom:this.zoom},p,g),x=this.expression.evaluate({zoom:this.zoom+1},p,g);this._setPaintValue(i,l,_,x)}_setPaintValue(i,l,p,g){if(this.type==="color"){const _=yf(p),x=yf(g);for(let T=i;T<l;T++)this.paintVertexArray.emplace(T,_[0],_[1],x[0],x[1])}else{for(let _=i;_<l;_++)this.paintVertexArray.emplace(_,p,g);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,g=yr(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);i.set(g)}getBinding(i,l,p){return new ui(i,l)}}class ds{constructor(i,l,p,g,_,x){this.expression=i,this.type=l,this.useIntegerZoom=p,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(i,l,p){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(g,i,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(i,l,p,g,_){this._setPaintValues(i,l,p.patterns&&p.patterns[this.layerId],_)}_setPaintValues(i,l,p,g){if(!g||!p)return;const{min:_,mid:x,max:T}=p,E=g[_],R=g[x],D=g[T];if(E&&R&&D)for(let N=i;N<l;N++)this.zoomInPaintVertexArray.emplace(N,R.tl[0],R.tl[1],R.br[0],R.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],R.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(N,R.tl[0],R.tl[1],R.br[0],R.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],R.pixelRatio,D.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,Un.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,Un.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class vf{constructor(i,l,p){this.binders={},this._buffers=[];const g=[];for(const _ in i.paint._values){if(!p(_))continue;const x=i.paint.get(_);if(!(x instanceof Fo&&xl(x.property.specification)))continue;const T=_f(_,i.type),E=x.value,R=x.property.specification.type,D=x.property.useIntegerZoom,N=x.property.specification["property-type"],G=N==="cross-faded"||N==="cross-faded-data-driven";if(E.kind==="constant")this.binders[_]=G?new Ll(E.value,T):new lu(E.value,T,R),g.push(`/u_${_}`);else if(E.kind==="source"||G){const H=xf(_,R,"source");this.binders[_]=G?new ds(E,R,D,l,H,i.id):new hs(E,T,R,H),g.push(`/a_${_}`)}else{const H=xf(_,R,"composite");this.binders[_]=new Gn(E,T,R,D,l,H),g.push(`/z_${_}`)}}this.cacheKey=g.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof hs||l instanceof Gn?l.maxValue:0}populatePaintArrays(i,l,p,g,_){for(const x in this.binders){const T=this.binders[x];(T instanceof hs||T instanceof Gn||T instanceof ds)&&T.populatePaintArray(i,l,p,g,_)}}setConstantPatternPositions(i,l){for(const p in this.binders){const g=this.binders[p];g instanceof Ll&&g.setConstantPatternPositions(i,l)}}updatePaintArrays(i,l,p,g,_){let x=!1;for(const T in i){const E=l.getPositions(T);for(const R of E){const D=p.feature(R.index);for(const N in this.binders){const G=this.binders[N];if((G instanceof hs||G instanceof Gn||G instanceof ds)&&G.expression.isStateDependent===!0){const H=g.paint.get(N);G.expression=H.value,G.updatePaintArray(R.start,R.end,D,i[T],_),x=!0}}}}return x}defines(){const i=[];for(const l in this.binders){const p=this.binders[l];(p instanceof lu||p instanceof Ll)&&i.push(...p.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof hs||p instanceof Gn)for(let g=0;g<p.paintVertexAttributes.length;g++)i.push(p.paintVertexAttributes[g].name);else if(p instanceof ds)for(let g=0;g<Un.members.length;g++)i.push(Un.members[g].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof lu||p instanceof Ll||p instanceof Gn)for(const g of p.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,l){const p=[];for(const g in this.binders){const _=this.binders[g];if(_ instanceof lu||_ instanceof Ll||_ instanceof Gn){for(const x of _.uniformNames)if(l[x]){const T=_.getBinding(i,l[x],x);p.push({name:x,property:g,binding:T})}}}return p}setUniforms(i,l,p,g){for(const{name:_,property:x,binding:T}of l)this.binders[x].setUniform(T,g,p.get(x),_)}updatePaintBuffers(i){this._buffers=[];for(const l in this.binders){const p=this.binders[l];if(i&&p instanceof ds){const g=i.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(p instanceof hs||p instanceof Gn)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(i){for(const l in this.binders){const p=this.binders[l];(p instanceof hs||p instanceof Gn||p instanceof ds)&&p.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof hs||l instanceof Gn||l instanceof ds)&&l.destroy()}}}class Ys{constructor(i,l,p=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new vf(g,l,p);this.needsUpload=!1,this._featureMap=new fo,this._bufferOffset=0}populatePaintArrays(i,l,p,g,_,x){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(i,l,g,_,x);l.id!==void 0&&this._featureMap.add(l.id,p,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,p,g){for(const _ of p)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(i,this._featureMap,l,_,g)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function _f(c,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${i}-`,"").replace(/-/g,"_")]}function xf(c,i,l){const p={color:{source:ou,composite:Z},number:{source:M,composite:ou}},g=function(_){return{"line-pattern":{source:bt,composite:bt},"fill-pattern":{source:bt,composite:bt},"fill-extrusion-pattern":{source:bt,composite:bt}}[_]}(c);return g&&g[l]||p[i][l]}_t("ConstantBinder",lu),_t("CrossFadedConstantBinder",Ll),_t("SourceExpressionBinder",hs),_t("CrossFadedCompositeBinder",ds),_t("CompositeExpressionBinder",Gn),_t("ProgramConfiguration",vf,{omit:["_buffers"]}),_t("ProgramConfigurationSet",Ys);const cu=Math.pow(2,14)-1,RT=-cu-1;function uu(c){const i=ot/c.extent,l=c.loadGeometry();for(let p=0;p<l.length;p++){const g=l[p];for(let _=0;_<g.length;_++){const x=g[_],T=Math.round(x.x*i),E=Math.round(x.y*i);x.x=yr(T,RT,cu),x.y=yr(E,RT,cu),(T<x.x||T>x.x+1||E<x.y||E>x.y+1)&&en("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function hu(c,i){return{type:c.type,id:c.id,properties:c.properties,geometry:i?uu(c):[]}}const LT=-32768;function i4(c,i,l,p,g){c.emplaceBack(LT+8*i+p,LT+8*l+g)}class vx{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Ie,this.indexArray=new Cr,this.segments=new cr,this.programConfigurations=new Ys(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){const g=this.layers[0],_=[];let x=null,T=!1,E=g.type==="heatmap";if(g.type==="circle"){const D=g;x=D.layout.get("circle-sort-key"),T=!x.isConstant(),E=E||D.paint.get("circle-pitch-alignment")==="map"}const R=E?l.subdivisionGranularity.circle:1;for(const{feature:D,id:N,index:G,sourceLayerIndex:H}of i){const Y=this.layers[0]._featureFilter.needGeometry,J=hu(D,Y);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom,{globalState:this.globalState}),J,p))continue;const ie=T?x.evaluate(J,{},p):void 0,ce={id:N,properties:D.properties,type:D.type,sourceLayerIndex:H,index:G,geometry:Y?J.geometry:uu(D),patterns:{},sortKey:ie};_.push(ce)}T&&_.sort((D,N)=>D.sortKey-N.sortKey);for(const D of _){const{geometry:N,index:G,sourceLayerIndex:H}=D,Y=i[G].feature;this.addFeature(D,N,G,p,R),l.featureIndex.insert(Y,N,G,H,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Vn),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,p,g,_=1){let x;switch(_){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const T=x.length;for(const E of l)for(const R of E){const D=R.x,N=R.y;if(D<0||D>=ot||N<0||N>=ot)continue;const G=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,i.sortKey),H=G.vertexLength;for(let Y=0;Y<T;Y++)for(let J=0;J<T;J++)i4(this.layoutVertexArray,D,N,x[J],x[Y]);for(let Y=0;Y<T-1;Y++)for(let J=0;J<T-1;J++){const ie=H+Y*T+J,ce=H+(Y+1)*T+J;this.indexArray.emplaceBack(ie,ce+1,ie+1),this.indexArray.emplaceBack(ie,ce,ce+1)}G.vertexLength+=T*T,G.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,{},g)}}function DT(c,i){for(let l=0;l<c.length;l++)if(Kh(i,c[l]))return!0;for(let l=0;l<i.length;l++)if(Kh(c,i[l]))return!0;return!!_x(c,i)}function o4(c,i,l){return!!Kh(c,i)||!!xx(i,c,l)}function zT(c,i){if(c.length===1)return jT(i,c[0]);for(let l=0;l<i.length;l++){const p=i[l];for(let g=0;g<p.length;g++)if(Kh(c,p[g]))return!0}for(let l=0;l<c.length;l++)if(jT(i,c[l]))return!0;for(let l=0;l<i.length;l++)if(_x(c,i[l]))return!0;return!1}function s4(c,i,l){if(c.length>1){if(_x(c,i))return!0;for(let p=0;p<i.length;p++)if(xx(i[p],c,l))return!0}for(let p=0;p<c.length;p++)if(xx(c[p],i,l))return!0;return!1}function _x(c,i){if(c.length===0||i.length===0)return!1;for(let l=0;l<c.length-1;l++){const p=c[l],g=c[l+1];for(let _=0;_<i.length-1;_++)if(a4(p,g,i[_],i[_+1]))return!0}return!1}function a4(c,i,l,p){return yn(c,l,p)!==yn(i,l,p)&&yn(c,i,l)!==yn(c,i,p)}function xx(c,i,l){const p=l*l;if(i.length===1)return c.distSqr(i[0])<p;for(let g=1;g<i.length;g++)if(NT(c,i[g-1],i[g])<p)return!0;return!1}function NT(c,i,l){const p=i.distSqr(l);if(p===0)return c.distSqr(i);const g=((c.x-i.x)*(l.x-i.x)+(c.y-i.y)*(l.y-i.y))/p;return c.distSqr(g<0?i:g>1?l:l.sub(i)._mult(g)._add(i))}function jT(c,i){let l,p,g,_=!1;for(let x=0;x<c.length;x++){l=c[x];for(let T=0,E=l.length-1;T<l.length;E=T++)p=l[T],g=l[E],p.y>i.y!=g.y>i.y&&i.x<(g.x-p.x)*(i.y-p.y)/(g.y-p.y)+p.x&&(_=!_)}return _}function Kh(c,i){let l=!1;for(let p=0,g=c.length-1;p<c.length;g=p++){const _=c[p],x=c[g];_.y>i.y!=x.y>i.y&&i.x<(x.x-_.x)*(i.y-_.y)/(x.y-_.y)+_.x&&(l=!l)}return l}function l4(c,i,l){const p=l[0],g=l[2];if(c.x<p.x&&i.x<p.x||c.x>g.x&&i.x>g.x||c.y<p.y&&i.y<p.y||c.y>g.y&&i.y>g.y)return!1;const _=yn(c,i,l[0]);return _!==yn(c,i,l[1])||_!==yn(c,i,l[2])||_!==yn(c,i,l[3])}function bf(c,i,l){const p=i.paint.get(c).value;return p.kind==="constant"?p.value:l.programConfigurations.get(i.id).getMaxValue(c)}function xy(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function by(c,i,l,p,g){if(!i[0]&&!i[1])return c;const _=B.convert(i)._mult(g);l==="viewport"&&_._rotate(-p);const x=[];for(let T=0;T<c.length;T++)x.push(c[T].sub(_));return x}let OT,FT;_t("CircleBucket",vx,{omit:["layers"]});var c4={get paint(){return FT=FT||new ci({"circle-radius":new Dt(pe.paint_circle["circle-radius"]),"circle-color":new Dt(pe.paint_circle["circle-color"]),"circle-blur":new Dt(pe.paint_circle["circle-blur"]),"circle-opacity":new Dt(pe.paint_circle["circle-opacity"]),"circle-translate":new St(pe.paint_circle["circle-translate"]),"circle-translate-anchor":new St(pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Dt(pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Dt(pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Dt(pe.paint_circle["circle-stroke-opacity"])})},get layout(){return OT=OT||new ci({"circle-sort-key":new Dt(pe.layout_circle["circle-sort-key"])})}};class u4 extends $n{constructor(i){super(i,c4)}createBucket(i){return new vx(i)}queryRadius(i){const l=i;return bf("circle-radius",this,l)+bf("circle-stroke-width",this,l)+xy(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:l,featureState:p,geometry:g,transform:_,pixelsToTileUnits:x,unwrappedTileID:T,getElevation:E}){const R=by(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,x),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),N=this.paint.get("circle-pitch-alignment")==="map",G=N?R:function(Y,J,ie,ce){return Y.map(Se=>BT(Se,J,ie,ce))}(R,_,T,E),H=N?D*x:D;for(const Y of g)for(const J of Y){const ie=N?J:BT(J,_,T,E);let ce=H;const Se=_.projectTileCoordinates(J.x,J.y,T,E).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=Se/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=_.cameraToCenterDistance/Se),o4(G,ie,ce))return!0}return!1}}function BT(c,i,l,p){const g=i.projectTileCoordinates(c.x,c.y,l,p).point;return new B((.5*g.x+.5)*i.width,(.5*-g.y+.5)*i.height)}class $T extends vx{}let VT;_t("HeatmapBucket",$T,{omit:["layers"]});var h4={get paint(){return VT=VT||new ci({"heatmap-radius":new Dt(pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Dt(pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new iu(pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(pe.paint_heatmap["heatmap-opacity"])})}};function bx(c,{width:i,height:l},p,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*l*p)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${i*l*p}`)}else g=new Uint8Array(i*l*p);return c.width=i,c.height=l,c.data=g,c}function UT(c,{width:i,height:l},p){if(i===c.width&&l===c.height)return;const g=bx({},{width:i,height:l},p);wx(c,g,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,i),height:Math.min(c.height,l)},p),c.width=i,c.height=l,c.data=g.data}function wx(c,i,l,p,g,_){if(g.width===0||g.height===0)return i;if(g.width>c.width||g.height>c.height||l.x>c.width-g.width||l.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||p.x>i.width-g.width||p.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=c.data,T=i.data;if(x===T)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<g.height;E++){const R=((l.y+E)*c.width+l.x)*_,D=((p.y+E)*i.width+p.x)*_;for(let N=0;N<g.width*_;N++)T[D+N]=x[R+N]}return i}class wf{constructor(i,l){bx(this,i,1,l)}resize(i){UT(this,i,1)}clone(){return new wf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,_){wx(i,l,p,g,_,1)}}class Ni{constructor(i,l){bx(this,i,4,l)}resize(i){UT(this,i,4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ni({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,_){wx(i,l,p,g,_,4)}setPixel(i,l,p){const g=4*(i*this.width+l);this.data[g+0]=Math.round(255*p.r/p.a),this.data[g+1]=Math.round(255*p.g/p.a),this.data[g+2]=Math.round(255*p.b/p.a),this.data[g+3]=Math.round(255*p.a)}}function GT(c){const i={},l=c.resolution||256,p=c.clips?c.clips.length:1,g=c.image||new Ni({width:l,height:p});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const _=(x,T,E)=>{i[c.evaluationKey]=E;const R=c.expression.evaluate(i);g.setPixel(x/4/l,T/4,R)};if(c.clips)for(let x=0,T=0;x<p;++x,T+=4*l)for(let E=0,R=0;E<l;E++,R+=4){const D=E/(l-1),{start:N,end:G}=c.clips[x];_(T,R,N*(1-D)+G*D)}else for(let x=0,T=0;x<l;x++,T+=4)_(0,T,x/(l-1));return g}_t("AlphaImage",wf),_t("RGBAImage",Ni);const Sx="big-fb";class d4 extends $n{createBucket(i){return new $T(i)}constructor(i){super(i,h4),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=GT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Sx)&&this.heatmapFbos.delete(Sx)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let qT;var p4={get paint(){return qT=qT||new ci({"hillshade-illumination-direction":new St(pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new St(pe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new St(pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(pe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new St(pe.paint_hillshade["hillshade-method"])})}};class f4 extends $n{constructor(i){super(i,p4),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,l=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,g=this.paint.get("hillshade-shadow-color").values;const _=Math.max(i.length,l.length,p.length,g.length);i=i.concat(Array(_-i.length).fill(i.at(-1))),l=l.concat(Array(_-l.length).fill(l.at(-1))),p=p.concat(Array(_-p.length).fill(p.at(-1))),g=g.concat(Array(_-g.length).fill(g.at(-1)));const x=l.map(un);return{directionRadians:i.map(un),altitudeRadians:x,shadowColor:g,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let ZT;var m4={get paint(){return ZT=ZT||new ci({"color-relief-opacity":new St(pe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new iu(pe["paint_color-relief"]["color-relief-color"])})}};class Tx{constructor(i,l,p,g){this.context=i,this.format=p,this.texture=i.gl.createTexture(),this.update(l,g)}update(i,l,p){const{width:g,height:_}=i,x=!(this.size&&this.size[0]===g&&this.size[1]===_||p),{context:T}=this,{gl:E}=T;if(this.useMipmap=!!(l&&l.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!l||l.premultiply!==!1)),x)this.size=[g,_],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||yi(i)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,i):E.texImage2D(E.TEXTURE_2D,0,this.format,g,_,0,this.format,E.UNSIGNED_BYTE,i.data);else{const{x:R,y:D}=p||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||yi(i)?E.texSubImage2D(E.TEXTURE_2D,0,R,D,E.RGBA,E.UNSIGNED_BYTE,i):E.texSubImage2D(E.TEXTURE_2D,0,R,D,g,_,E.RGBA,E.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D),T.pixelStoreUnpackFlipY.setDefault(),T.pixelStoreUnpack.setDefault(),T.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,l,p){const{context:g}=this,{gl:_}=g;_.bindTexture(_.TEXTURE_2D,this.texture),p!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=_.LINEAR),i!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,p||i),this.filter=i),l!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,l),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class WT{constructor(i,l,p,g=1,_=1,x=1,T=0){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void en(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const E=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=_,this.blueFactor=x,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<E;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(E,R)]=this.data[this._idx(E-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,E)]=this.data[this._idx(R,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<E;R++)for(let D=0;D<E;D++){const N=this.get(R,D);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(i,l){const p=new Uint8Array(this.data.buffer),g=4*this._idx(i,l);return this.unpack(p[g],p[g+1],p[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}unpack(i,l,p){return i*this.redFactor+l*this.greenFactor+p*this.blueFactor-this.baseShift}pack(i){return HT(i,this.getUnpackVector())}getPixels(){return new Ni({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,l,p){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=l*this.dim,_=l*this.dim+this.dim,x=p*this.dim,T=p*this.dim+this.dim;switch(l){case-1:g=_-1;break;case 1:_=g+1}switch(p){case-1:x=T-1;break;case 1:T=x+1}const E=-l*this.dim,R=-p*this.dim;for(let D=x;D<T;D++)for(let N=g;N<_;N++)this.data[this._idx(N,D)]=i.data[this._idx(N+E,D+R)]}}function HT(c,i){const l=i[0],p=i[1],g=i[2],_=i[3],x=Math.min(l,p,g),T=Math.round((c+_)/x);return{r:Math.floor(T*x/l)%256,g:Math.floor(T*x/p)%256,b:Math.floor(T*x/g)%256}}_t("DEMData",WT);class g4 extends $n{constructor(i){super(i,m4)}_createColorRamp(i){const l={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof Wc&&p._styleExpression.expression instanceof ai){this.colorRampExpression=p;const x=p._styleExpression.expression;l.elevationStops=x.labels,l.colorStops=[];for(const T of l.elevationStops)l.colorStops.push(x.evaluate({globals:{elevation:T}}))}if(l.elevationStops.length<1&&(l.elevationStops=[0],l.colorStops=[Qt.transparent]),l.elevationStops.length<2&&(l.elevationStops.push(l.elevationStops[0]+1),l.colorStops.push(l.colorStops[0])),l.elevationStops.length<=i)return l;const g={elevationStops:[],colorStops:[]},_=(l.elevationStops.length-1)/(i-1);for(let x=0;x<l.elevationStops.length-.5;x+=_)g.elevationStops.push(l.elevationStops[Math.round(x)]),g.colorStops.push(l.colorStops[Math.round(x)]);return en(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),g}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,l,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const g=this._createColorRamp(l),_=new Ni({width:g.colorStops.length,height:1}),x=new Ni({width:g.colorStops.length,height:1});for(let T=0;T<g.elevationStops.length;T++){const E=HT(g.elevationStops[T],p);x.setPixel(0,T,new Qt(E.r/255,E.g/255,E.b/255,1)),_.setPixel(0,T,g.colorStops[T])}return this.colorRampTextures={elevationTexture:new Tx(i,x,i.gl.RGBA),colorTexture:new Tx(i,_,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const y4=Ur([{name:"a_pos",components:2,type:"Int16"}],4),{members:v4}=y4;function Cx(c,i,l){const p=l.patternDependencies;let g=!1;for(const _ of i){const x=_.paint.get(`${c}-pattern`);x.isConstant()||(g=!0);const T=x.constantOr(null);T&&(g=!0,p[T.to]=!0,p[T.from]=!0)}return g}function Px(c,i,l,p,g){const _=g.patternDependencies;for(const x of i){const T=x.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let E=T.evaluate({zoom:p-1},l,{},g.availableImages),R=T.evaluate({zoom:p},l,{},g.availableImages),D=T.evaluate({zoom:p+1},l,{},g.availableImages);E=E&&E.name?E.name:E,R=R&&R.name?R.name:R,D=D&&D.name?D.name:D,_[E]=!0,_[R]=!0,_[D]=!0,l.patterns[x.id]={min:E,mid:R,max:D}}}return l}function KT(c,i,l,p,g){let _;if(g===function(x,T,E,R){let D=0;for(let N=T,G=E-R;N<E;N+=R)D+=(x[G]-x[N])*(x[N+1]+x[G+1]),G=N;return D}(c,i,l,p)>0)for(let x=i;x<l;x+=p)_=JT(x/p|0,c[x],c[x+1],_);else for(let x=l-p;x>=i;x-=p)_=JT(x/p|0,c[x],c[x+1],_);return _&&Xh(_,_.next)&&(Pf(_),_=_.next),_}function du(c,i){if(!c)return c;i||(i=c);let l,p=c;do if(l=!1,p.steiner||!Xh(p,p.next)&&nn(p.prev,p,p.next)!==0)p=p.next;else{if(Pf(p),p=i=p.prev,p===p.next)break;l=!0}while(l||p!==i);return i}function Sf(c,i,l,p,g,_,x){if(!c)return;!x&&_&&function(E,R,D,N){let G=E;do G.z===0&&(G.z=Ex(G.x,G.y,R,D,N)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==E);G.prevZ.nextZ=null,G.prevZ=null,function(H){let Y,J=1;do{let ie,ce=H;H=null;let Se=null;for(Y=0;ce;){Y++;let ye=ce,W=0;for(let ve=0;ve<J&&(W++,ye=ye.nextZ,ye);ve++);let re=J;for(;W>0||re>0&&ye;)W!==0&&(re===0||!ye||ce.z<=ye.z)?(ie=ce,ce=ce.nextZ,W--):(ie=ye,ye=ye.nextZ,re--),Se?Se.nextZ=ie:H=ie,ie.prevZ=Se,Se=ie;ce=ye}Se.nextZ=null,J*=2}while(Y>1)}(G)}(c,p,g,_);let T=c;for(;c.prev!==c.next;){const E=c.prev,R=c.next;if(_?x4(c,p,g,_):_4(c))i.push(E.i,c.i,R.i),Pf(c),c=R.next,T=R.next;else if((c=R)===T){x?x===1?Sf(c=b4(du(c),i),i,l,p,g,_,2):x===2&&w4(c,i,l,p,g,_):Sf(du(c),i,l,p,g,_,1);break}}}function _4(c){const i=c.prev,l=c,p=c.next;if(nn(i,l,p)>=0)return!1;const g=i.x,_=l.x,x=p.x,T=i.y,E=l.y,R=p.y,D=Math.min(g,_,x),N=Math.min(T,E,R),G=Math.max(g,_,x),H=Math.max(T,E,R);let Y=p.next;for(;Y!==i;){if(Y.x>=D&&Y.x<=G&&Y.y>=N&&Y.y<=H&&Tf(g,T,_,E,x,R,Y.x,Y.y)&&nn(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function x4(c,i,l,p){const g=c.prev,_=c,x=c.next;if(nn(g,_,x)>=0)return!1;const T=g.x,E=_.x,R=x.x,D=g.y,N=_.y,G=x.y,H=Math.min(T,E,R),Y=Math.min(D,N,G),J=Math.max(T,E,R),ie=Math.max(D,N,G),ce=Ex(H,Y,i,l,p),Se=Ex(J,ie,i,l,p);let ye=c.prevZ,W=c.nextZ;for(;ye&&ye.z>=ce&&W&&W.z<=Se;){if(ye.x>=H&&ye.x<=J&&ye.y>=Y&&ye.y<=ie&&ye!==g&&ye!==x&&Tf(T,D,E,N,R,G,ye.x,ye.y)&&nn(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,W.x>=H&&W.x<=J&&W.y>=Y&&W.y<=ie&&W!==g&&W!==x&&Tf(T,D,E,N,R,G,W.x,W.y)&&nn(W.prev,W,W.next)>=0))return!1;W=W.nextZ}for(;ye&&ye.z>=ce;){if(ye.x>=H&&ye.x<=J&&ye.y>=Y&&ye.y<=ie&&ye!==g&&ye!==x&&Tf(T,D,E,N,R,G,ye.x,ye.y)&&nn(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;W&&W.z<=Se;){if(W.x>=H&&W.x<=J&&W.y>=Y&&W.y<=ie&&W!==g&&W!==x&&Tf(T,D,E,N,R,G,W.x,W.y)&&nn(W.prev,W,W.next)>=0)return!1;W=W.nextZ}return!0}function b4(c,i){let l=c;do{const p=l.prev,g=l.next.next;!Xh(p,g)&&YT(p,l,l.next,g)&&Cf(p,g)&&Cf(g,p)&&(i.push(p.i,l.i,g.i),Pf(l),Pf(l.next),l=c=g),l=l.next}while(l!==c);return du(l)}function w4(c,i,l,p,g,_){let x=c;do{let T=x.next.next;for(;T!==x.prev;){if(x.i!==T.i&&E4(x,T)){let E=QT(x,T);return x=du(x,x.next),E=du(E,E.next),Sf(x,i,l,p,g,_,0),void Sf(E,i,l,p,g,_,0)}T=T.next}x=x.next}while(x!==c)}function S4(c,i){let l=c.x-i.x;return l===0&&(l=c.y-i.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(i.next.y-i.y)/(i.next.x-i.x)),l}function T4(c,i){const l=function(g,_){let x=_;const T=g.x,E=g.y;let R,D=-1/0;if(Xh(g,x))return x;do{if(Xh(g,x.next))return x.next;if(E<=x.y&&E>=x.next.y&&x.next.y!==x.y){const J=x.x+(E-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(J<=T&&J>D&&(D=J,R=x.x<x.next.x?x:x.next,J===T))return R}x=x.next}while(x!==_);if(!R)return null;const N=R,G=R.x,H=R.y;let Y=1/0;x=R;do{if(T>=x.x&&x.x>=G&&T!==x.x&&XT(E<H?T:D,E,G,H,E<H?D:T,E,x.x,x.y)){const J=Math.abs(E-x.y)/(T-x.x);Cf(x,g)&&(J<Y||J===Y&&(x.x>R.x||x.x===R.x&&C4(R,x)))&&(R=x,Y=J)}x=x.next}while(x!==N);return R}(c,i);if(!l)return i;const p=QT(l,c);return du(p,p.next),du(l,l.next)}function C4(c,i){return nn(c.prev,c,i.prev)<0&&nn(i.next,c,c.next)<0}function Ex(c,i,l,p,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-p)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function P4(c){let i=c,l=c;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==c);return l}function XT(c,i,l,p,g,_,x,T){return(g-x)*(i-T)>=(c-x)*(_-T)&&(c-x)*(p-T)>=(l-x)*(i-T)&&(l-x)*(_-T)>=(g-x)*(p-T)}function Tf(c,i,l,p,g,_,x,T){return!(c===x&&i===T)&&XT(c,i,l,p,g,_,x,T)}function E4(c,i){return c.next.i!==i.i&&c.prev.i!==i.i&&!function(l,p){let g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==p.i&&g.next.i!==p.i&&YT(g,g.next,l,p))return!0;g=g.next}while(g!==l);return!1}(c,i)&&(Cf(c,i)&&Cf(i,c)&&function(l,p){let g=l,_=!1;const x=(l.x+p.x)/2,T=(l.y+p.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&x<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==l);return _}(c,i)&&(nn(c.prev,c,i.prev)||nn(c,i.prev,i))||Xh(c,i)&&nn(c.prev,c,c.next)>0&&nn(i.prev,i,i.next)>0)}function nn(c,i,l){return(i.y-c.y)*(l.x-i.x)-(i.x-c.x)*(l.y-i.y)}function Xh(c,i){return c.x===i.x&&c.y===i.y}function YT(c,i,l,p){const g=Sy(nn(c,i,l)),_=Sy(nn(c,i,p)),x=Sy(nn(l,p,c)),T=Sy(nn(l,p,i));return g!==_&&x!==T||!(g!==0||!wy(c,l,i))||!(_!==0||!wy(c,p,i))||!(x!==0||!wy(l,c,p))||!(T!==0||!wy(l,i,p))}function wy(c,i,l){return i.x<=Math.max(c.x,l.x)&&i.x>=Math.min(c.x,l.x)&&i.y<=Math.max(c.y,l.y)&&i.y>=Math.min(c.y,l.y)}function Sy(c){return c>0?1:c<0?-1:0}function Cf(c,i){return nn(c.prev,c,c.next)<0?nn(c,i,c.next)>=0&&nn(c,c.prev,i)>=0:nn(c,i,c.prev)<0||nn(c,c.next,i)<0}function QT(c,i){const l=Mx(c.i,c.x,c.y),p=Mx(i.i,i.x,i.y),g=c.next,_=i.prev;return c.next=i,i.prev=c,l.next=g,g.prev=l,p.next=l,l.prev=p,_.next=p,p.prev=_,p}function JT(c,i,l,p){const g=Mx(c,i,l);return p?(g.next=p.next,g.prev=p,p.next.prev=g,p.next=g):(g.prev=g,g.next=g),g}function Pf(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Mx(c,i,l){return{i:c,x:i,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Yh{constructor(i,l){if(l>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=l}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class Ty{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}Ty.noSubdivision=new Ty({fill:new Yh(0,0),line:new Yh(0,0),tile:new Yh(0,0),stencil:new Yh(0,0),circle:1}),_t("SubdivisionGranularityExpression",Yh),_t("SubdivisionGranularitySetting",Ty);const Qh=-32768,Ef=32767;class M4{constructor(i,l){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=ot/i,this._canonical=l}_getKey(i,l){return(i+=32768)<<16|l+32768}_vertexToIndex(i,l){if(i<-32768||l<-32768||i>32767||l>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(i),g=0|Math.round(l),_=this._getKey(p,g);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,x),this._vertexBuffer.push(p,g),x}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(g,_){const x=[];for(let T=0;T<_.length;T+=3){const E=_[T],R=_[T+1],D=_[T+2],N=g[2*E],G=g[2*E+1];(g[2*R]-N)*(g[2*D+1]-G)-(g[2*R+1]-G)*(g[2*D]-N)>0?(x.push(E),x.push(D),x.push(R)):(x.push(E),x.push(R),x.push(D))}return x}(this._vertexBuffer,i);const l=[],p=i.length;for(let g=0;g<p;g+=3){const _=[i[g+0],i[g+1],i[g+2]],x=[this._vertexBuffer[2*i[g+0]+0],this._vertexBuffer[2*i[g+0]+1],this._vertexBuffer[2*i[g+1]+0],this._vertexBuffer[2*i[g+1]+1],this._vertexBuffer[2*i[g+2]+0],this._vertexBuffer[2*i[g+2]+1]];let T=1/0,E=1/0,R=-1/0,D=-1/0;for(let J=0;J<3;J++){const ie=x[2*J],ce=x[2*J+1];T=Math.min(T,ie),R=Math.max(R,ie),E=Math.min(E,ce),D=Math.max(D,ce)}if(T===R||E===D)continue;const N=Math.floor(T/this._granularityCellSize),G=Math.ceil(R/this._granularityCellSize),H=Math.floor(E/this._granularityCellSize),Y=Math.ceil(D/this._granularityCellSize);if(N!==G||H!==Y)for(let J=H;J<Y;J++){const ie=this._scanlineGenerateVertexRingForCellRow(J,x,_);k4(this._vertexBuffer,ie,l)}else l.push(..._)}return l}_scanlineGenerateVertexRingForCellRow(i,l,p){const g=i*this._granularityCellSize,_=g+this._granularityCellSize,x=[];for(let T=0;T<3;T++){const E=l[2*T],R=l[2*T+1],D=l[2*(T+1)%6],N=l[(2*(T+1)+1)%6],G=l[2*(T+2)%6],H=l[(2*(T+2)+1)%6],Y=D-E,J=N-R,ie=Y===0,ce=J===0,Se=(g-R)/J,ye=(_-R)/J,W=Math.min(Se,ye),re=Math.max(Se,ye);if(!ce&&(W>=1||re<=0)||ce&&(R<g||R>_)){N>=g&&N<=_&&x.push(p[(T+1)%3]);continue}!ce&&W>0&&x.push(this._vertexToIndex(E+Y*W,R+J*W));const ve=E+Y*Math.max(W,0),Le=E+Y*Math.min(re,1);ie||this._generateIntraEdgeVertices(x,E,R,D,N,ve,Le),!ce&&re<1&&x.push(this._vertexToIndex(E+Y*re,R+J*re)),(ce||N>=g&&N<=_)&&x.push(p[(T+1)%3]),!ce&&(N<=g||N>=_)&&this._generateInterEdgeVertices(x,E,R,D,N,G,H,Le,g,_)}return x}_generateIntraEdgeVertices(i,l,p,g,_,x,T){const E=g-l,R=_-p,D=R===0,N=D?Math.min(l,g):Math.min(x,T),G=D?Math.max(l,g):Math.max(x,T),H=Math.floor(N/this._granularityCellSize)+1,Y=Math.ceil(G/this._granularityCellSize)-1;if(D?l<g:x<T)for(let J=H;J<=Y;J++){const ie=J*this._granularityCellSize;i.push(this._vertexToIndex(ie,p+R*(ie-l)/E))}else for(let J=Y;J>=H;J--){const ie=J*this._granularityCellSize;i.push(this._vertexToIndex(ie,p+R*(ie-l)/E))}}_generateInterEdgeVertices(i,l,p,g,_,x,T,E,R,D){const N=_-p,G=x-g,H=T-_,Y=(R-_)/H,J=(D-_)/H,ie=Math.min(Y,J),ce=Math.max(Y,J),Se=g+G*ie;let ye=Math.floor(Math.min(Se,E)/this._granularityCellSize)+1,W=Math.ceil(Math.max(Se,E)/this._granularityCellSize)-1,re=E<Se;const ve=H===0;if(ve&&(T===R||T===D))return;if(ve||ie>=1||ce<=0){const Xe=p-T,Oe=x+(l-x)*Math.min((R-T)/Xe,(D-T)/Xe);ye=Math.floor(Math.min(Oe,E)/this._granularityCellSize)+1,W=Math.ceil(Math.max(Oe,E)/this._granularityCellSize)-1,re=E<Oe}const Le=N>0?D:R;if(re)for(let Xe=ye;Xe<=W;Xe++)i.push(this._vertexToIndex(Xe*this._granularityCellSize,Le));else for(let Xe=W;Xe>=ye;Xe--)i.push(this._vertexToIndex(Xe*this._granularityCellSize,Le))}_generateOutline(i){const l=[];for(const p of i){const g=pu(p,this._granularity,!0),_=this._pointArrayToIndices(g),x=[];for(let T=1;T<_.length;T++)x.push(_[T-1]),x.push(_[T]);l.push(x)}return l}_handlePoles(i){let l=!1,p=!1;this._canonical&&(this._canonical.y===0&&(l=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(l||p)&&this._fillPoles(i,l,p)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let l=0;l<i.length;l+=2){const p=i[l+1];p===Qh&&(i[l+1]=-32767),p===Ef&&(i[l+1]=32766)}}_generatePoleQuad(i,l,p,g,_,x){g>_!=(x===Qh)?(i.push(l),i.push(p),i.push(this._vertexToIndex(g,x)),i.push(p),i.push(this._vertexToIndex(_,x)),i.push(this._vertexToIndex(g,x))):(i.push(p),i.push(l),i.push(this._vertexToIndex(g,x)),i.push(this._vertexToIndex(_,x)),i.push(p),i.push(this._vertexToIndex(g,x)))}_fillPoles(i,l,p){const g=this._vertexBuffer,_=ot,x=i.length;for(let T=2;T<x;T+=3){const E=i[T-2],R=i[T-1],D=i[T],N=g[2*E],G=g[2*E+1],H=g[2*R],Y=g[2*R+1],J=g[2*D],ie=g[2*D+1];l&&(G===0&&Y===0&&this._generatePoleQuad(i,E,R,N,H,Qh),Y===0&&ie===0&&this._generatePoleQuad(i,R,D,H,J,Qh),ie===0&&G===0&&this._generatePoleQuad(i,D,E,J,N,Qh)),p&&(G===_&&Y===_&&this._generatePoleQuad(i,E,R,N,H,Ef),Y===_&&ie===_&&this._generatePoleQuad(i,R,D,H,J,Ef),ie===_&&G===_&&this._generatePoleQuad(i,D,E,J,N,Ef))}}_initializeVertices(i){for(let l=0;l<i.length;l+=2)this._vertexToIndex(i[l],i[l+1])}subdividePolygonInternal(i,l){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:g}=function(T){const E=[],R=[];for(const D of T)if(D.length!==0){D!==T[0]&&E.push(R.length/2);for(let N=0;N<D.length;N++)R.push(D[N].x),R.push(D[N].y)}return{flattened:R,holeIndices:E}}(i);let _;this._initializeVertices(p);try{const T=function(R,D,N=2){const G=D&&D.length,H=G?D[0]*N:R.length;let Y=KT(R,0,H,N,!0);const J=[];if(!Y||Y.next===Y.prev)return J;let ie,ce,Se;if(G&&(Y=function(ye,W,re,ve){const Le=[];for(let Xe=0,Oe=W.length;Xe<Oe;Xe++){const Be=KT(ye,W[Xe]*ve,Xe<Oe-1?W[Xe+1]*ve:ye.length,ve,!1);Be===Be.next&&(Be.steiner=!0),Le.push(P4(Be))}Le.sort(S4);for(let Xe=0;Xe<Le.length;Xe++)re=T4(Le[Xe],re);return re}(R,D,Y,N)),R.length>80*N){ie=1/0,ce=1/0;let ye=-1/0,W=-1/0;for(let re=N;re<H;re+=N){const ve=R[re],Le=R[re+1];ve<ie&&(ie=ve),Le<ce&&(ce=Le),ve>ye&&(ye=ve),Le>W&&(W=Le)}Se=Math.max(ye-ie,W-ce),Se=Se!==0?32767/Se:0}return Sf(Y,J,N,ie,ce,Se,0),J}(p,g),E=this._convertIndices(p,T);_=this._subdivideTrianglesScanline(E)}catch(T){console.error(T)}let x=[];return l&&(x=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:x}}_convertIndices(i,l){const p=[];for(let g=0;g<l.length;g++)p.push(this._vertexToIndex(i[2*l[g]],i[2*l[g]+1]));return p}_pointArrayToIndices(i){const l=[];for(let p=0;p<i.length;p++){const g=i[p];l.push(this._vertexToIndex(g.x,g.y))}return l}}function eC(c,i,l,p=!0){return new M4(l,i).subdividePolygonInternal(c,p)}function pu(c,i,l=!1){if(!c||c.length<1)return[];if(c.length<2)return[];const p=c[0],g=c[c.length-1],_=l&&(p.x!==g.x||p.y!==g.y);if(i<2)return _?[...c,c[0]]:[...c];const x=Math.floor(ot/i),T=[];T.push(new B(c[0].x,c[0].y));const E=c.length,R=_?E:E-1;for(let D=0;D<R;D++){const N=c[D],G=D<E-1?c[D+1]:c[0],H=N.x,Y=N.y,J=G.x,ie=G.y,ce=H!==J,Se=Y!==ie;if(!ce&&!Se)continue;const ye=J-H,W=ie-Y,re=Math.abs(ye),ve=Math.abs(W);let Le=H,Xe=Y;for(;;){const Be=ye>0?(Math.floor(Le/x)+1)*x:(Math.ceil(Le/x)-1)*x,it=W>0?(Math.floor(Xe/x)+1)*x:(Math.ceil(Xe/x)-1)*x,Qe=Math.abs(Le-Be),at=Math.abs(Xe-it),Ue=Math.abs(Le-J),wt=Math.abs(Xe-ie),Lt=ce?Qe/re:Number.POSITIVE_INFINITY,kt=Se?at/ve:Number.POSITIVE_INFINITY;if((Ue<=Qe||!ce)&&(wt<=at||!Se))break;if(Lt<kt&&ce||!Se){Le=Be,Xe+=W*Lt;const Pt=new B(Le,Math.round(Xe));T[T.length-1].x===Pt.x&&T[T.length-1].y===Pt.y||T.push(Pt)}else{Le+=ye*kt,Xe=it;const Pt=new B(Math.round(Le),Xe);T[T.length-1].x===Pt.x&&T[T.length-1].y===Pt.y||T.push(Pt)}}const Oe=new B(J,ie);T[T.length-1].x===Oe.x&&T[T.length-1].y===Oe.y||T.push(Oe)}return T}function k4(c,i,l){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,g=c[2*i[0]];for(let E=1;E<i.length;E++){const R=c[2*i[E]];R<g&&(g=R,p=E)}const _=i.length;let x=p,T=(x+1)%_;for(;;){const E=x-1>=0?x-1:_-1,R=(T+1)%_,D=c[2*i[E]],N=c[2*i[R]],G=c[2*i[x]],H=c[2*i[x]+1],Y=c[2*i[T]+1];let J=!1;if(D<N)J=!0;else if(D>N)J=!1;else{const ie=Y-H,ce=-(c[2*i[T]]-G),Se=H<Y?1:-1;((D-G)*ie+(c[2*i[E]+1]-H)*ce)*Se>((N-G)*ie+(c[2*i[R]+1]-H)*ce)*Se&&(J=!0)}if(J){const ie=i[E],ce=i[x],Se=i[T];ie!==ce&&ie!==Se&&ce!==Se&&l.push(Se,ce,ie),x--,x<0&&(x=_-1)}else{const ie=i[R],ce=i[x],Se=i[T];ie!==ce&&ie!==Se&&ce!==Se&&l.push(Se,ce,ie),T++,T>=_&&(T=0)}if(E===R)break}}function tC(c,i,l,p,g,_,x,T,E){const R=g.length/2,D=x&&T&&E;if(R<cr.MAX_VERTEX_ARRAY_LENGTH){const N=i.prepareSegment(R,l,p),G=N.vertexLength;for(let J=0;J<_.length;J+=3)p.emplaceBack(G+_[J],G+_[J+1],G+_[J+2]);let H,Y;N.vertexLength+=R,N.primitiveLength+=_.length/3,D&&(Y=x.prepareSegment(R,l,T),H=Y.vertexLength,Y.vertexLength+=R);for(let J=0;J<g.length;J+=2)c(g[J],g[J+1]);if(D)for(let J=0;J<E.length;J++){const ie=E[J];for(let ce=1;ce<ie.length;ce+=2)T.emplaceBack(H+ie[ce-1],H+ie[ce]);Y.primitiveLength+=ie.length/2}}else(function(N,G,H,Y,J,ie){const ce=[];for(let ve=0;ve<Y.length/2;ve++)ce.push(-1);const Se={count:0};let ye=0,W=N.getOrCreateLatestSegment(G,H),re=W.vertexLength;for(let ve=2;ve<J.length;ve+=3){const Le=J[ve-2],Xe=J[ve-1],Oe=J[ve];let Be=ce[Le]<ye,it=ce[Xe]<ye,Qe=ce[Oe]<ye;W.vertexLength+((Be?1:0)+(it?1:0)+(Qe?1:0))>cr.MAX_VERTEX_ARRAY_LENGTH&&(W=N.createNewSegment(G,H),ye=Se.count,Be=!0,it=!0,Qe=!0,re=0);const at=Mf(ce,Y,ie,Se,Le,Be,W),Ue=Mf(ce,Y,ie,Se,Xe,it,W),wt=Mf(ce,Y,ie,Se,Oe,Qe,W);H.emplaceBack(re+at-ye,re+Ue-ye,re+wt-ye),W.primitiveLength++}})(i,l,p,g,_,c),D&&function(N,G,H,Y,J,ie){const ce=[];for(let ve=0;ve<Y.length/2;ve++)ce.push(-1);const Se={count:0};let ye=0,W=N.getOrCreateLatestSegment(G,H),re=W.vertexLength;for(let ve=0;ve<J.length;ve++){const Le=J[ve];for(let Xe=1;Xe<J[ve].length;Xe+=2){const Oe=Le[Xe-1],Be=Le[Xe];let it=ce[Oe]<ye,Qe=ce[Be]<ye;W.vertexLength+((it?1:0)+(Qe?1:0))>cr.MAX_VERTEX_ARRAY_LENGTH&&(W=N.createNewSegment(G,H),ye=Se.count,it=!0,Qe=!0,re=0);const at=Mf(ce,Y,ie,Se,Oe,it,W),Ue=Mf(ce,Y,ie,Se,Be,Qe,W);H.emplaceBack(re+at-ye,re+Ue-ye),W.primitiveLength++}}}(x,l,T,g,E,c),i.forceNewSegmentOnNextPrepare(),x==null||x.forceNewSegmentOnNextPrepare()}function Mf(c,i,l,p,g,_,x){if(_){const T=p.count;return l(i[2*g],i[2*g+1]),c[g]=p.count,p.count++,x.vertexLength++,T}return c[g]}class kx{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new je,this.indexArray=new Cr,this.indexArray2=new Tr,this.programConfigurations=new Ys(i.layers,i.zoom),this.segments=new cr,this.segments2=new cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Cx("fill",this.layers,l);const g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),x=[];for(const{feature:T,id:E,index:R,sourceLayerIndex:D}of i){const N=this.layers[0]._featureFilter.needGeometry,G=hu(T,N);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom,{globalState:this.globalState}),G,p))continue;const H=_?g.evaluate(G,{},p,l.availableImages):void 0,Y={id:E,properties:T.properties,type:T.type,sourceLayerIndex:D,index:R,geometry:N?G.geometry:uu(T),patterns:{},sortKey:H};x.push(Y)}_&&x.sort((T,E)=>T.sortKey-E.sortKey);for(const T of x){const{geometry:E,index:R,sourceLayerIndex:D}=T;if(this.hasPattern){const N=Px("fill",this.layers,T,this.zoom,l);this.patternFeatures.push(N)}else this.addFeature(T,E,R,p,{},l.subdivisionGranularity);l.featureIndex.insert(i[R].feature,E,R,D,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,p,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,v4),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,p,g,_,x){for(const T of Sh(l,500)){const E=eC(T,g,x.fill.getGranularityForZoomLevel(g.z)),R=this.layoutVertexArray;tC((D,N)=>{R.emplaceBack(D,N)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles,this.segments2,this.indexArray2,E.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}}let rC,nC;_t("FillBucket",kx,{omit:["layers","patternFeatures"]});var A4={get paint(){return nC=nC||new ci({"fill-antialias":new St(pe.paint_fill["fill-antialias"]),"fill-opacity":new Dt(pe.paint_fill["fill-opacity"]),"fill-color":new Dt(pe.paint_fill["fill-color"]),"fill-outline-color":new Dt(pe.paint_fill["fill-outline-color"]),"fill-translate":new St(pe.paint_fill["fill-translate"]),"fill-translate-anchor":new St(pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zh(pe.paint_fill["fill-pattern"])})},get layout(){return rC=rC||new ci({"fill-sort-key":new Dt(pe.layout_fill["fill-sort-key"])})}};class I4 extends $n{constructor(i){super(i,A4)}recalculate(i,l){super.recalculate(i,l);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new kx(i)}queryRadius(){return xy(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:l,transform:p,pixelsToTileUnits:g}){return zT(by(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,g),l)}isTileClipped(){return!0}}const R4=Ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),L4=Ur([{name:"a_centroid",components:2,type:"Int16"}],4),{members:D4}=R4;var Ax,iC,Ix,oC,Rx,sC,aC,Cy={};function lC(){if(iC)return Ax;iC=1;var c=k();function i(g,_,x,T,E){this.properties={},this.extent=x,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=E,g.readFields(l,this,_)}function l(g,_,x){g==1?_.id=x.readVarint():g==2?function(T,E){for(var R=T.readVarint()+T.pos;T.pos<R;){var D=E._keys[T.readVarint()],N=E._values[T.readVarint()];E.properties[D]=N}}(x,_):g==3?_.type=x.readVarint():g==4&&(_._geometry=x.pos)}function p(g){for(var _,x,T=0,E=0,R=g.length,D=R-1;E<R;D=E++)T+=((x=g[D]).x-(_=g[E]).x)*(_.y+x.y);return T}return Ax=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var _,x=g.readVarint()+g.pos,T=1,E=0,R=0,D=0,N=[];g.pos<x;){if(E<=0){var G=g.readVarint();T=7&G,E=G>>3}if(E--,T===1||T===2)R+=g.readSVarint(),D+=g.readSVarint(),T===1&&(_&&N.push(_),_=[]),_.push(new c(R,D));else{if(T!==7)throw new Error("unknown command "+T);_&&_.push(_[0].clone())}}return _&&N.push(_),N},i.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var _=g.readVarint()+g.pos,x=1,T=0,E=0,R=0,D=1/0,N=-1/0,G=1/0,H=-1/0;g.pos<_;){if(T<=0){var Y=g.readVarint();x=7&Y,T=Y>>3}if(T--,x===1||x===2)(E+=g.readSVarint())<D&&(D=E),E>N&&(N=E),(R+=g.readSVarint())<G&&(G=R),R>H&&(H=R);else if(x!==7)throw new Error("unknown command "+x)}return[D,G,N,H]},i.prototype.toGeoJSON=function(g,_,x){var T,E,R=this.extent*Math.pow(2,x),D=this.extent*g,N=this.extent*_,G=this.loadGeometry(),H=i.types[this.type];function Y(ce){for(var Se=0;Se<ce.length;Se++){var ye=ce[Se];ce[Se]=[360*(ye.x+D)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(ye.y+N)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(T=0;T<G.length;T++)J[T]=G[T][0];Y(G=J);break;case 2:for(T=0;T<G.length;T++)Y(G[T]);break;case 3:for(G=function(ce){var Se=ce.length;if(Se<=1)return[ce];for(var ye,W,re=[],ve=0;ve<Se;ve++){var Le=p(ce[ve]);Le!==0&&(W===void 0&&(W=Le<0),W===Le<0?(ye&&re.push(ye),ye=[ce[ve]]):ye.push(ce[ve]))}return ye&&re.push(ye),re}(G),T=0;T<G.length;T++)for(E=0;E<G[T].length;E++)Y(G[T][E])}G.length===1?G=G[0]:H="Multi"+H;var ie={type:"Feature",geometry:{type:H,coordinates:G},properties:this.properties};return"id"in this&&(ie.id=this.id),ie},Ax}function cC(){if(oC)return Ix;oC=1;var c=lC();function i(p,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(l,this,g),this.length=this._features.length}function l(p,g,_){p===15?g.version=_.readVarint():p===1?g.name=_.readString():p===5?g.extent=_.readVarint():p===2?g._features.push(_.pos):p===3?g._keys.push(_.readString()):p===4&&g._values.push(function(x){for(var T=null,E=x.readVarint()+x.pos;x.pos<E;){var R=x.readVarint()>>3;T=R===1?x.readString():R===2?x.readFloat():R===3?x.readDouble():R===4?x.readVarint64():R===5?x.readVarint():R===6?x.readSVarint():R===7?x.readBoolean():null}return T}(_))}return Ix=i,i.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var g=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,g,this.extent,this._keys,this._values)},Ix}function uC(){return aC||(aC=1,Cy.VectorTile=function(){if(sC)return Rx;sC=1;var c=cC();function i(l,p,g){if(l===3){var _=new c(g,g.readVarint()+g.pos);_.length&&(p[_.name]=_)}}return Rx=function(l,p){this.layers=l.readFields(i,{},p)},Rx}(),Cy.VectorTileFeature=lC(),Cy.VectorTileLayer=cC()),Cy}var kf=b(uC());const z4=kf.VectorTileFeature.types,Lx=Math.pow(2,13);function Af(c,i,l,p,g,_,x,T){c.emplaceBack(i,l,2*Math.floor(p*Lx)+x,g*Lx*2,_*Lx*2,Math.round(T))}class Dx{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ht,this.centroidVertexArray=new Ae,this.indexArray=new Cr,this.programConfigurations=new Ys(i.layers,i.zoom),this.segments=new cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.features=[],this.hasPattern=Cx("fill-extrusion",this.layers,l);for(const{feature:g,id:_,index:x,sourceLayerIndex:T}of i){const E=this.layers[0]._featureFilter.needGeometry,R=hu(g,E);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom,{globalState:this.globalState}),R,p))continue;const D={id:_,sourceLayerIndex:T,index:x,geometry:E?R.geometry:uu(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Px("fill-extrusion",this.layers,D,this.zoom,l)):this.addFeature(D,D.geometry,x,p,{},l.subdivisionGranularity),l.featureIndex.insert(g,D.geometry,x,T,this.index,!0)}}addFeatures(i,l,p){for(const g of this.features){const{geometry:_}=g;this.addFeature(g,_,g.index,l,p,i.subdivisionGranularity)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,D4),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,L4.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,l,p,g,_,x){for(const T of Sh(l,500)){const E={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(E,g,i,T,x);const D=this.layoutVertexArray.length-R,N=Math.floor(E.x/E.sampleCount),G=Math.floor(E.y/E.sampleCount);for(let H=0;H<D;H++)this.centroidVertexArray.emplaceBack(N,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}processPolygon(i,l,p,g,_){if(g.length<1||hC(g[0]))return;for(const N of g)N.length!==0&&N4(i,N);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=_.fill.getGranularityForZoomLevel(l.z),E=z4[p.type]==="Polygon";for(const N of g){if(N.length===0||hC(N))continue;const G=pu(N,T,E);this._generateSideFaces(G,x)}if(!E)return;const R=eC(g,l,T,!1),D=this.layoutVertexArray;tC((N,G)=>{Af(D,N,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(i,l){let p=0;for(let g=1;g<i.length;g++){const _=i[g],x=i[g-1];if(j4(_,x))continue;l.segment.vertexLength+4>cr.MAX_VERTEX_ARRAY_LENGTH&&(l.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=_.sub(x)._perp()._unit(),E=x.dist(_);p+E>32768&&(p=0),Af(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,0,p),Af(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,1,p),p+=E,Af(this.layoutVertexArray,x.x,x.y,T.x,T.y,0,0,p),Af(this.layoutVertexArray,x.x,x.y,T.x,T.y,0,1,p);const R=l.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),l.segment.vertexLength+=4,l.segment.primitiveLength+=2}}}function N4(c,i){for(let l=0;l<i.length;l++){const p=i[l];l===i.length-1&&i[0].x===p.x&&i[0].y===p.y||(c.x+=p.x,c.y+=p.y,c.sampleCount++)}}function j4(c,i){return c.x===i.x&&(c.x<0||c.x>ot)||c.y===i.y&&(c.y<0||c.y>ot)}function hC(c){return c.every(i=>i.x<0)||c.every(i=>i.x>ot)||c.every(i=>i.y<0)||c.every(i=>i.y>ot)}let dC;_t("FillExtrusionBucket",Dx,{omit:["layers","features"]});var O4={get paint(){return dC=dC||new ci({"fill-extrusion-opacity":new St(pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Dt(pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zh(pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Dt(pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Dt(pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class F4 extends $n{constructor(i){super(i,O4)}createBucket(i){return new Dx(i)}queryRadius(){return xy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:l,featureState:p,geometry:g,transform:_,pixelsToTileUnits:x,pixelPosMatrix:T}){const E=by(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,x),R=this.paint.get("fill-extrusion-height").evaluate(l,p),D=this.paint.get("fill-extrusion-base").evaluate(l,p),N=function(H,Y){const J=[];for(const ie of H){const ce=[ie.x,ie.y,0,1];ut(ce,ce,Y),J.push(new B(ce[0]/ce[3],ce[1]/ce[3]))}return J}(E,T),G=function(H,Y,J,ie){const ce=[],Se=[],ye=ie[8]*Y,W=ie[9]*Y,re=ie[10]*Y,ve=ie[11]*Y,Le=ie[8]*J,Xe=ie[9]*J,Oe=ie[10]*J,Be=ie[11]*J;for(const it of H){const Qe=[],at=[];for(const Ue of it){const wt=Ue.x,Lt=Ue.y,kt=ie[0]*wt+ie[4]*Lt+ie[12],Pt=ie[1]*wt+ie[5]*Lt+ie[13],rr=ie[2]*wt+ie[6]*Lt+ie[14],Gr=ie[3]*wt+ie[7]*Lt+ie[15],_n=rr+re,ei=Gr+ve,go=kt+Le,ji=Pt+Xe,qn=rr+Oe,Fr=Gr+Be,In=new B((kt+ye)/ei,(Pt+W)/ei);In.z=_n/ei,Qe.push(In);const Zn=new B(go/Fr,ji/Fr);Zn.z=qn/Fr,at.push(Zn)}ce.push(Qe),Se.push(at)}return[ce,Se]}(g,D,R,T);return function(H,Y,J){let ie=1/0;zT(J,Y)&&(ie=pC(J,Y[0]));for(let ce=0;ce<Y.length;ce++){const Se=Y[ce],ye=H[ce];for(let W=0;W<Se.length-1;W++){const re=Se[W],ve=[re,Se[W+1],ye[W+1],ye[W],re];DT(J,ve)&&(ie=Math.min(ie,pC(J,ve)))}}return ie!==1/0&&ie}(G[0],G[1],N)}}function If(c,i){return c.x*i.x+c.y*i.y}function pC(c,i){if(c.length===1){let l=0;const p=i[l++];let g;for(;!g||p.equals(g);)if(g=i[l++],!g)return 1/0;for(;l<i.length;l++){const _=i[l],x=c[0],T=g.sub(p),E=_.sub(p),R=x.sub(p),D=If(T,T),N=If(T,E),G=If(E,E),H=If(R,T),Y=If(R,E),J=D*G-N*N,ie=(G*H-N*Y)/J,ce=(D*Y-N*H)/J,Se=p.z*(1-ie-ce)+g.z*ie+_.z*ce;if(isFinite(Se))return Se}return 1/0}{let l=1/0;for(const p of i)l=Math.min(l,p.z);return l}}const B4=Ur([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:$4}=B4,V4=Ur([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:U4}=V4,G4=kf.VectorTileFeature.types,q4=Math.cos(Math.PI/180*37.5),fC=Math.pow(2,14)/.5;class zx{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new ct,this.layoutVertexArray2=new Ye,this.indexArray=new Cr,this.programConfigurations=new Ys(i.layers,i.zoom),this.segments=new cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Cx("line",this.layers,l);const g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),x=[];for(const{feature:T,id:E,index:R,sourceLayerIndex:D}of i){const N=this.layers[0]._featureFilter.needGeometry,G=hu(T,N);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom,{globalState:this.globalState}),G,p))continue;const H=_?g.evaluate(G,{},p):void 0,Y={id:E,properties:T.properties,type:T.type,sourceLayerIndex:D,index:R,geometry:N?G.geometry:uu(T),patterns:{},sortKey:H};x.push(Y)}_&&x.sort((T,E)=>T.sortKey-E.sortKey);for(const T of x){const{geometry:E,index:R,sourceLayerIndex:D}=T;if(this.hasPattern){const N=Px("line",this.layers,T,this.zoom,l);this.patternFeatures.push(N)}else this.addFeature(T,E,R,p,{},l.subdivisionGranularity);l.featureIndex.insert(i[R].feature,E,R,D,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,p,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,U4)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,$4),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,p,g,_,x){const T=this.layers[0].layout,E=T.get("line-join").evaluate(i,{}),R=T.get("line-cap"),D=T.get("line-miter-limit"),N=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const G of l)this.addLine(G,i,E,R,D,N,g,x);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}addLine(i,l,p,g,_,x,T,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=pu(i,T?E.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<i.length-1;ye++)this.totalDistance+=i[ye].dist(i[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=G4[l.type]==="Polygon";let D=i.length;for(;D>=2&&i[D-1].equals(i[D-2]);)D--;let N=0;for(;N<D-1&&i[N].equals(i[N+1]);)N++;if(D<(R?3:2))return;p==="bevel"&&(_=1.05);const G=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let Y,J,ie,ce,Se;this.e1=this.e2=-1,R&&(Y=i[D-2],Se=i[N].sub(Y)._unit()._perp());for(let ye=N;ye<D;ye++){if(ie=ye===D-1?R?i[N+1]:void 0:i[ye+1],ie&&i[ye].equals(ie))continue;Se&&(ce=Se),Y&&(J=Y),Y=i[ye],Se=ie?ie.sub(Y)._unit()._perp():ce,ce=ce||Se;let W=ce.add(Se);W.x===0&&W.y===0||W._unit();const re=ce.x*Se.x+ce.y*Se.y,ve=W.x*Se.x+W.y*Se.y,Le=ve!==0?1/ve:1/0,Xe=2*Math.sqrt(2-2*ve),Oe=ve<q4&&J&&ie,Be=ce.x*Se.y-ce.y*Se.x>0;if(Oe&&ye>N){const at=Y.dist(J);if(at>2*G){const Ue=Y.sub(Y.sub(J)._mult(G/at)._round());this.updateDistance(J,Ue),this.addCurrentVertex(Ue,ce,0,0,H),J=Ue}}const it=J&&ie;let Qe=it?p:R?"butt":g;if(it&&Qe==="round"&&(Le<x?Qe="miter":Le<=2&&(Qe="fakeround")),Qe==="miter"&&Le>_&&(Qe="bevel"),Qe==="bevel"&&(Le>2&&(Qe="flipbevel"),Le<_&&(Qe="miter")),J&&this.updateDistance(J,Y),Qe==="miter")W._mult(Le),this.addCurrentVertex(Y,W,0,0,H);else if(Qe==="flipbevel"){if(Le>100)W=Se.mult(-1);else{const at=Le*ce.add(Se).mag()/ce.sub(Se).mag();W._perp()._mult(at*(Be?-1:1))}this.addCurrentVertex(Y,W,0,0,H),this.addCurrentVertex(Y,W.mult(-1),0,0,H)}else if(Qe==="bevel"||Qe==="fakeround"){const at=-Math.sqrt(Le*Le-1),Ue=Be?at:0,wt=Be?0:at;if(J&&this.addCurrentVertex(Y,ce,Ue,wt,H),Qe==="fakeround"){const Lt=Math.round(180*Xe/Math.PI/20);for(let kt=1;kt<Lt;kt++){let Pt=kt/Lt;if(Pt!==.5){const Gr=Pt-.5;Pt+=Pt*Gr*(Pt-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*Gr*Gr+(.848013+re*(.215638*re-1.06021)))}const rr=Se.sub(ce)._mult(Pt)._add(ce)._unit()._mult(Be?-1:1);this.addHalfVertex(Y,rr.x,rr.y,!1,Be,0,H)}}ie&&this.addCurrentVertex(Y,Se,-Ue,-wt,H)}else if(Qe==="butt")this.addCurrentVertex(Y,W,0,0,H);else if(Qe==="square"){const at=J?1:-1;this.addCurrentVertex(Y,W,at,at,H)}else Qe==="round"&&(J&&(this.addCurrentVertex(Y,ce,0,0,H),this.addCurrentVertex(Y,ce,1,1,H,!0)),ie&&(this.addCurrentVertex(Y,Se,-1,-1,H,!0),this.addCurrentVertex(Y,Se,0,0,H)));if(Oe&&ye<D-1){const at=Y.dist(ie);if(at>2*G){const Ue=Y.add(ie.sub(Y)._mult(G/at)._round());this.updateDistance(Y,Ue),this.addCurrentVertex(Ue,Se,0,0,H),Y=Ue}}}}addCurrentVertex(i,l,p,g,_,x=!1){const T=l.y*g-l.x,E=-l.y-l.x*g;this.addHalfVertex(i,l.x+l.y*p,l.y-l.x*p,x,!1,p,_),this.addHalfVertex(i,T,E,x,!0,-g,_),this.distance>fC/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,l,p,g,_,x))}addHalfVertex({x:i,y:l},p,g,_,x,T,E){const R=.5*(this.lineClips?this.scaledDistance*(fC-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(l<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),E.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}let mC,gC;_t("LineBucket",zx,{omit:["layers","patternFeatures"]});var yC={get paint(){return gC=gC||new ci({"line-opacity":new Dt(pe.paint_line["line-opacity"]),"line-color":new Dt(pe.paint_line["line-color"]),"line-translate":new St(pe.paint_line["line-translate"]),"line-translate-anchor":new St(pe.paint_line["line-translate-anchor"]),"line-width":new Dt(pe.paint_line["line-width"]),"line-gap-width":new Dt(pe.paint_line["line-gap-width"]),"line-offset":new Dt(pe.paint_line["line-offset"]),"line-blur":new Dt(pe.paint_line["line-blur"]),"line-dasharray":new pf(pe.paint_line["line-dasharray"]),"line-pattern":new Zh(pe.paint_line["line-pattern"]),"line-gradient":new iu(pe.paint_line["line-gradient"])})},get layout(){return mC=mC||new ci({"line-cap":new St(pe.layout_line["line-cap"]),"line-join":new Dt(pe.layout_line["line-join"]),"line-miter-limit":new St(pe.layout_line["line-miter-limit"]),"line-round-limit":new St(pe.layout_line["line-round-limit"]),"line-sort-key":new Dt(pe.layout_line["line-sort-key"])})}};class Z4 extends Dt{possiblyEvaluate(i,l){return l=new Rr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(i,l)}evaluate(i,l,p,g){return l=br({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(i,l,p,g)}}let Py;class W4 extends $n{constructor(i){super(i,yC),this.gradientVersion=0,Py||(Py=new Z4(yC.paint.properties["line-width"].specification),Py.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof dl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,l){super.recalculate(i,l),this.paint._values["line-floorwidth"]=Py.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new zx(i)}queryRadius(i){const l=i,p=vC(bf("line-width",this,l),bf("line-gap-width",this,l)),g=bf("line-offset",this,l);return p/2+Math.abs(g)+xy(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:l,featureState:p,geometry:g,transform:_,pixelsToTileUnits:x}){const T=by(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,x),E=x/2*vC(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),R=this.paint.get("line-offset").evaluate(l,p);return R&&(g=function(D,N){const G=[];for(let H=0;H<D.length;H++){const Y=D[H],J=[];for(let ie=0;ie<Y.length;ie++){const ce=Y[ie-1],Se=Y[ie],ye=Y[ie+1],W=ie===0?new B(0,0):Se.sub(ce)._unit()._perp(),re=ie===Y.length-1?new B(0,0):ye.sub(Se)._unit()._perp(),ve=W._add(re)._unit(),Le=ve.x*re.x+ve.y*re.y;Le!==0&&ve._mult(1/Le),J.push(ve._mult(N)._add(Se))}G.push(J)}return G}(g,R*x)),function(D,N,G){for(let H=0;H<N.length;H++){const Y=N[H];if(D.length>=3){for(let J=0;J<Y.length;J++)if(Kh(D,Y[J]))return!0}if(s4(D,Y,G))return!0}return!1}(T,g,E)}isTileClipped(){return!0}}function vC(c,i){return i>0?i+2*c:c}const H4=Ur([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),K4=Ur([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ur([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const X4=Ur([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ur([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _C=Ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Y4=Ur([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Q4(c,i,l){return c.sections.forEach(p=>{p.text=function(g,_,x){const T=_.layout.get("text-transform").evaluate(x,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),Gs.applyArabicShaping&&(g=Gs.applyArabicShaping(g)),g}(p.text,i,l)}),c}Ur([{name:"triangle",components:3,type:"Uint16"}]),Ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ur([{type:"Float32",name:"offsetX"}]),Ur([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ur([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Rf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var xC,Nx,bC,An=24,jx={};function J4(){return xC||(xC=1,jx.read=function(c,i,l,p,g){var _,x,T=8*g-p-1,E=(1<<T)-1,R=E>>1,D=-7,N=l?g-1:0,G=l?-1:1,H=c[i+N];for(N+=G,_=H&(1<<-D)-1,H>>=-D,D+=T;D>0;_=256*_+c[i+N],N+=G,D-=8);for(x=_&(1<<-D)-1,_>>=-D,D+=p;D>0;x=256*x+c[i+N],N+=G,D-=8);if(_===0)_=1-R;else{if(_===E)return x?NaN:1/0*(H?-1:1);x+=Math.pow(2,p),_-=R}return(H?-1:1)*x*Math.pow(2,_-p)},jx.write=function(c,i,l,p,g,_){var x,T,E,R=8*_-g-1,D=(1<<R)-1,N=D>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=p?0:_-1,Y=p?1:-1,J=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(T=isNaN(i)?1:0,x=D):(x=Math.floor(Math.log(i)/Math.LN2),i*(E=Math.pow(2,-x))<1&&(x--,E*=2),(i+=x+N>=1?G/E:G*Math.pow(2,1-N))*E>=2&&(x++,E/=2),x+N>=D?(T=0,x=D):x+N>=1?(T=(i*E-1)*Math.pow(2,g),x+=N):(T=i*Math.pow(2,N-1)*Math.pow(2,g),x=0));g>=8;c[l+H]=255&T,H+=Y,T/=256,g-=8);for(x=x<<g|T,R+=g;R>0;c[l+H]=255&x,H+=Y,x/=256,R-=8);c[l+H-Y]|=128*J}),jx}function wC(){if(bC)return Nx;bC=1,Nx=i;var c=J4();function i(W){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(W)?W:new Uint8Array(W||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var l=4294967296,p=1/l,g=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function _(W){return W.type===i.Bytes?W.readVarint()+W.pos:W.pos+1}function x(W,re,ve){return ve?4294967296*re+(W>>>0):4294967296*(re>>>0)+(W>>>0)}function T(W,re,ve){var Le=re<=16383?1:re<=2097151?2:re<=268435455?3:Math.floor(Math.log(re)/(7*Math.LN2));ve.realloc(Le);for(var Xe=ve.pos-1;Xe>=W;Xe--)ve.buf[Xe+Le]=ve.buf[Xe]}function E(W,re){for(var ve=0;ve<W.length;ve++)re.writeVarint(W[ve])}function R(W,re){for(var ve=0;ve<W.length;ve++)re.writeSVarint(W[ve])}function D(W,re){for(var ve=0;ve<W.length;ve++)re.writeFloat(W[ve])}function N(W,re){for(var ve=0;ve<W.length;ve++)re.writeDouble(W[ve])}function G(W,re){for(var ve=0;ve<W.length;ve++)re.writeBoolean(W[ve])}function H(W,re){for(var ve=0;ve<W.length;ve++)re.writeFixed32(W[ve])}function Y(W,re){for(var ve=0;ve<W.length;ve++)re.writeSFixed32(W[ve])}function J(W,re){for(var ve=0;ve<W.length;ve++)re.writeFixed64(W[ve])}function ie(W,re){for(var ve=0;ve<W.length;ve++)re.writeSFixed64(W[ve])}function ce(W,re){return(W[re]|W[re+1]<<8|W[re+2]<<16)+16777216*W[re+3]}function Se(W,re,ve){W[ve]=re,W[ve+1]=re>>>8,W[ve+2]=re>>>16,W[ve+3]=re>>>24}function ye(W,re){return(W[re]|W[re+1]<<8|W[re+2]<<16)+(W[re+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(W,re,ve){for(ve=ve||this.length;this.pos<ve;){var Le=this.readVarint(),Xe=Le>>3,Oe=this.pos;this.type=7&Le,W(Xe,re,this),this.pos===Oe&&this.skip(Le)}return re},readMessage:function(W,re){return this.readFields(W,re,this.readVarint()+this.pos)},readFixed32:function(){var W=ce(this.buf,this.pos);return this.pos+=4,W},readSFixed32:function(){var W=ye(this.buf,this.pos);return this.pos+=4,W},readFixed64:function(){var W=ce(this.buf,this.pos)+ce(this.buf,this.pos+4)*l;return this.pos+=8,W},readSFixed64:function(){var W=ce(this.buf,this.pos)+ye(this.buf,this.pos+4)*l;return this.pos+=8,W},readFloat:function(){var W=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,W},readDouble:function(){var W=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,W},readVarint:function(W){var re,ve,Le=this.buf;return re=127&(ve=Le[this.pos++]),ve<128?re:(re|=(127&(ve=Le[this.pos++]))<<7,ve<128?re:(re|=(127&(ve=Le[this.pos++]))<<14,ve<128?re:(re|=(127&(ve=Le[this.pos++]))<<21,ve<128?re:function(Xe,Oe,Be){var it,Qe,at=Be.buf;if(it=(112&(Qe=at[Be.pos++]))>>4,Qe<128||(it|=(127&(Qe=at[Be.pos++]))<<3,Qe<128)||(it|=(127&(Qe=at[Be.pos++]))<<10,Qe<128)||(it|=(127&(Qe=at[Be.pos++]))<<17,Qe<128)||(it|=(127&(Qe=at[Be.pos++]))<<24,Qe<128)||(it|=(1&(Qe=at[Be.pos++]))<<31,Qe<128))return x(Xe,it,Oe);throw new Error("Expected varint not more than 10 bytes")}(re|=(15&(ve=Le[this.pos]))<<28,W,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var W=this.readVarint();return W%2==1?(W+1)/-2:W/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var W=this.readVarint()+this.pos,re=this.pos;return this.pos=W,W-re>=12&&g?function(ve,Le,Xe){return g.decode(ve.subarray(Le,Xe))}(this.buf,re,W):function(ve,Le,Xe){for(var Oe="",Be=Le;Be<Xe;){var it,Qe,at,Ue=ve[Be],wt=null,Lt=Ue>239?4:Ue>223?3:Ue>191?2:1;if(Be+Lt>Xe)break;Lt===1?Ue<128&&(wt=Ue):Lt===2?(192&(it=ve[Be+1]))==128&&(wt=(31&Ue)<<6|63&it)<=127&&(wt=null):Lt===3?(Qe=ve[Be+2],(192&(it=ve[Be+1]))==128&&(192&Qe)==128&&((wt=(15&Ue)<<12|(63&it)<<6|63&Qe)<=2047||wt>=55296&&wt<=57343)&&(wt=null)):Lt===4&&(Qe=ve[Be+2],at=ve[Be+3],(192&(it=ve[Be+1]))==128&&(192&Qe)==128&&(192&at)==128&&((wt=(15&Ue)<<18|(63&it)<<12|(63&Qe)<<6|63&at)<=65535||wt>=1114112)&&(wt=null)),wt===null?(wt=65533,Lt=1):wt>65535&&(wt-=65536,Oe+=String.fromCharCode(wt>>>10&1023|55296),wt=56320|1023&wt),Oe+=String.fromCharCode(wt),Be+=Lt}return Oe}(this.buf,re,W)},readBytes:function(){var W=this.readVarint()+this.pos,re=this.buf.subarray(this.pos,W);return this.pos=W,re},readPackedVarint:function(W,re){if(this.type!==i.Bytes)return W.push(this.readVarint(re));var ve=_(this);for(W=W||[];this.pos<ve;)W.push(this.readVarint(re));return W},readPackedSVarint:function(W){if(this.type!==i.Bytes)return W.push(this.readSVarint());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readSVarint());return W},readPackedBoolean:function(W){if(this.type!==i.Bytes)return W.push(this.readBoolean());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readBoolean());return W},readPackedFloat:function(W){if(this.type!==i.Bytes)return W.push(this.readFloat());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readFloat());return W},readPackedDouble:function(W){if(this.type!==i.Bytes)return W.push(this.readDouble());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readDouble());return W},readPackedFixed32:function(W){if(this.type!==i.Bytes)return W.push(this.readFixed32());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readFixed32());return W},readPackedSFixed32:function(W){if(this.type!==i.Bytes)return W.push(this.readSFixed32());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readSFixed32());return W},readPackedFixed64:function(W){if(this.type!==i.Bytes)return W.push(this.readFixed64());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readFixed64());return W},readPackedSFixed64:function(W){if(this.type!==i.Bytes)return W.push(this.readSFixed64());var re=_(this);for(W=W||[];this.pos<re;)W.push(this.readSFixed64());return W},skip:function(W){var re=7&W;if(re===i.Varint)for(;this.buf[this.pos++]>127;);else if(re===i.Bytes)this.pos=this.readVarint()+this.pos;else if(re===i.Fixed32)this.pos+=4;else{if(re!==i.Fixed64)throw new Error("Unimplemented type: "+re);this.pos+=8}},writeTag:function(W,re){this.writeVarint(W<<3|re)},realloc:function(W){for(var re=this.length||16;re<this.pos+W;)re*=2;if(re!==this.length){var ve=new Uint8Array(re);ve.set(this.buf),this.buf=ve,this.length=re}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(W){this.realloc(4),Se(this.buf,W,this.pos),this.pos+=4},writeSFixed32:function(W){this.realloc(4),Se(this.buf,W,this.pos),this.pos+=4},writeFixed64:function(W){this.realloc(8),Se(this.buf,-1&W,this.pos),Se(this.buf,Math.floor(W*p),this.pos+4),this.pos+=8},writeSFixed64:function(W){this.realloc(8),Se(this.buf,-1&W,this.pos),Se(this.buf,Math.floor(W*p),this.pos+4),this.pos+=8},writeVarint:function(W){(W=+W||0)>268435455||W<0?function(re,ve){var Le,Xe;if(re>=0?(Le=re%4294967296|0,Xe=re/4294967296|0):(Xe=~(-re/4294967296),4294967295^(Le=~(-re%4294967296))?Le=Le+1|0:(Le=0,Xe=Xe+1|0)),re>=18446744073709552e3||re<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Oe,Be,it){it.buf[it.pos++]=127&Oe|128,Oe>>>=7,it.buf[it.pos++]=127&Oe|128,Oe>>>=7,it.buf[it.pos++]=127&Oe|128,Oe>>>=7,it.buf[it.pos++]=127&Oe|128,it.buf[it.pos]=127&(Oe>>>=7)}(Le,0,ve),function(Oe,Be){var it=(7&Oe)<<4;Be.buf[Be.pos++]|=it|((Oe>>>=3)?128:0),Oe&&(Be.buf[Be.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Be.buf[Be.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Be.buf[Be.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Be.buf[Be.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Be.buf[Be.pos++]=127&Oe)))))}(Xe,ve)}(W,this):(this.realloc(4),this.buf[this.pos++]=127&W|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=W>>>7&127))))},writeSVarint:function(W){this.writeVarint(W<0?2*-W-1:2*W)},writeBoolean:function(W){this.writeVarint(!!W)},writeString:function(W){W=String(W),this.realloc(4*W.length),this.pos++;var re=this.pos;this.pos=function(Le,Xe,Oe){for(var Be,it,Qe=0;Qe<Xe.length;Qe++){if((Be=Xe.charCodeAt(Qe))>55295&&Be<57344){if(!it){Be>56319||Qe+1===Xe.length?(Le[Oe++]=239,Le[Oe++]=191,Le[Oe++]=189):it=Be;continue}if(Be<56320){Le[Oe++]=239,Le[Oe++]=191,Le[Oe++]=189,it=Be;continue}Be=it-55296<<10|Be-56320|65536,it=null}else it&&(Le[Oe++]=239,Le[Oe++]=191,Le[Oe++]=189,it=null);Be<128?Le[Oe++]=Be:(Be<2048?Le[Oe++]=Be>>6|192:(Be<65536?Le[Oe++]=Be>>12|224:(Le[Oe++]=Be>>18|240,Le[Oe++]=Be>>12&63|128),Le[Oe++]=Be>>6&63|128),Le[Oe++]=63&Be|128)}return Oe}(this.buf,W,this.pos);var ve=this.pos-re;ve>=128&&T(re,ve,this),this.pos=re-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(W){this.realloc(4),c.write(this.buf,W,this.pos,!0,23,4),this.pos+=4},writeDouble:function(W){this.realloc(8),c.write(this.buf,W,this.pos,!0,52,8),this.pos+=8},writeBytes:function(W){var re=W.length;this.writeVarint(re),this.realloc(re);for(var ve=0;ve<re;ve++)this.buf[this.pos++]=W[ve]},writeRawMessage:function(W,re){this.pos++;var ve=this.pos;W(re,this);var Le=this.pos-ve;Le>=128&&T(ve,Le,this),this.pos=ve-1,this.writeVarint(Le),this.pos+=Le},writeMessage:function(W,re,ve){this.writeTag(W,i.Bytes),this.writeRawMessage(re,ve)},writePackedVarint:function(W,re){re.length&&this.writeMessage(W,E,re)},writePackedSVarint:function(W,re){re.length&&this.writeMessage(W,R,re)},writePackedBoolean:function(W,re){re.length&&this.writeMessage(W,G,re)},writePackedFloat:function(W,re){re.length&&this.writeMessage(W,D,re)},writePackedDouble:function(W,re){re.length&&this.writeMessage(W,N,re)},writePackedFixed32:function(W,re){re.length&&this.writeMessage(W,H,re)},writePackedSFixed32:function(W,re){re.length&&this.writeMessage(W,Y,re)},writePackedFixed64:function(W,re){re.length&&this.writeMessage(W,J,re)},writePackedSFixed64:function(W,re){re.length&&this.writeMessage(W,ie,re)},writeBytesField:function(W,re){this.writeTag(W,i.Bytes),this.writeBytes(re)},writeFixed32Field:function(W,re){this.writeTag(W,i.Fixed32),this.writeFixed32(re)},writeSFixed32Field:function(W,re){this.writeTag(W,i.Fixed32),this.writeSFixed32(re)},writeFixed64Field:function(W,re){this.writeTag(W,i.Fixed64),this.writeFixed64(re)},writeSFixed64Field:function(W,re){this.writeTag(W,i.Fixed64),this.writeSFixed64(re)},writeVarintField:function(W,re){this.writeTag(W,i.Varint),this.writeVarint(re)},writeSVarintField:function(W,re){this.writeTag(W,i.Varint),this.writeSVarint(re)},writeStringField:function(W,re){this.writeTag(W,i.Bytes),this.writeString(re)},writeFloatField:function(W,re){this.writeTag(W,i.Fixed32),this.writeFloat(re)},writeDoubleField:function(W,re){this.writeTag(W,i.Fixed64),this.writeDouble(re)},writeBooleanField:function(W,re){this.writeVarintField(W,!!re)}},Nx}var Dl,Ox=b(wC());function eN(c,i,l){c===1&&l.readMessage(tN,i)}function tN(c,i,l){if(c===3){const{id:p,bitmap:g,width:_,height:x,left:T,top:E,advance:R}=l.readMessage(rN,{});i.push({id:p,bitmap:new wf({width:_+6,height:x+6},g),metrics:{width:_,height:x,left:T,top:E,advance:R}})}}function rN(c,i,l){c===1?i.id=l.readVarint():c===2?i.bitmap=l.readBytes():c===3?i.width=l.readVarint():c===4?i.height=l.readVarint():c===5?i.left=l.readSVarint():c===6?i.top=l.readSVarint():c===7&&(i.advance=l.readVarint())}function SC(c){let i=0,l=0;for(const x of c)i+=x.w*x.h,l=Math.max(l,x.w);c.sort((x,T)=>T.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let g=0,_=0;for(const x of c)for(let T=p.length-1;T>=0;T--){const E=p[T];if(!(x.w>E.w||x.h>E.h)){if(x.x=E.x,x.y=E.y,_=Math.max(_,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===E.w&&x.h===E.h){const R=p.pop();T<p.length&&(p[T]=R)}else x.h===E.h?(E.x+=x.w,E.w-=x.w):x.w===E.w?(E.y+=x.h,E.h-=x.h):(p.push({x:E.x+x.w,y:E.y,w:E.w-x.w,h:x.h}),E.y+=x.h,E.h-=x.h);break}}return{w:g,h:_,fill:i/(g*_)||0}}class Fx{constructor(i,{pixelRatio:l,version:p,stretchX:g,stretchY:_,content:x,textFitWidth:T,textFitHeight:E}){this.paddedRect=i,this.pixelRatio=l,this.stretchX=g,this.stretchY=_,this.content=x,this.version=p,this.textFitWidth=T,this.textFitHeight=E}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class TC{constructor(i,l){const p={},g={};this.haveRenderCallbacks=[];const _=[];this.addImages(i,p,_),this.addImages(l,g,_);const{w:x,h:T}=SC(_),E=new Ni({width:x||1,height:T||1});for(const R in i){const D=i[R],N=p[R].paddedRect;Ni.copy(D.data,E,{x:0,y:0},{x:N.x+1,y:N.y+1},D.data)}for(const R in l){const D=l[R],N=g[R].paddedRect,G=N.x+1,H=N.y+1,Y=D.data.width,J=D.data.height;Ni.copy(D.data,E,{x:0,y:0},{x:G,y:H},D.data),Ni.copy(D.data,E,{x:0,y:J-1},{x:G,y:H-1},{width:Y,height:1}),Ni.copy(D.data,E,{x:0,y:0},{x:G,y:H+J},{width:Y,height:1}),Ni.copy(D.data,E,{x:Y-1,y:0},{x:G-1,y:H},{width:1,height:J}),Ni.copy(D.data,E,{x:0,y:0},{x:G+Y,y:H},{width:1,height:J})}this.image=E,this.iconPositions=p,this.patternPositions=g}addImages(i,l,p){for(const g in i){const _=i[g],x={x:0,y:0,w:_.data.width+2,h:_.data.height+2};p.push(x),l[g]=new Fx(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(i,l){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in i.updatedImages)this.patchUpdatedImage(this.iconPositions[p],i.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],i.getImage(p),l)}patchUpdatedImage(i,l,p){if(!i||!l||i.version===l.version)return;i.version=l.version;const[g,_]=i.tl;p.update(l.data,void 0,{x:g,y:_})}}_t("ImagePosition",Fx),_t("ImageAtlas",TC),h.an=void 0,(Dl=h.an||(h.an={}))[Dl.none=0]="none",Dl[Dl.horizontal=1]="horizontal",Dl[Dl.vertical=2]="vertical",Dl[Dl.horizontalOnly=3]="horizontalOnly";class Lf{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,l,p){const g=new Lf;return g.scale=i||1,g.fontStack=l,g.verticalAlign=p||"bottom",g}static forImage(i,l){const p=new Lf;return p.imageName=i,p.verticalAlign=l||"bottom",p}}class Jh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const p=new Jh;for(let g=0;g<i.sections.length;g++){const _=i.sections[g];_.image?p.addImageSection(_):p.addTextSection(_,l)}return p}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let l="";for(let p=0;p<i.length;p++){const g=i.charCodeAt(p+1)||null,_=i.charCodeAt(p-1)||null;l+=g&&uf(g)&&!Rf[i[p+1]]||_&&uf(_)&&!Rf[i[p-1]]||!Rf[i[p]]?i[p]:Rf[i[p]]}return l}(this.text)}trim(){let i=0;for(let p=0;p<this.text.length&&My[this.text.charCodeAt(p)];p++)i++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=i&&My[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const p=new Jh;return p.text=this.text.substring(i,l),p.sectionIndex=this.sectionIndex.slice(i,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}getMaxImageSize(i){let l=0,p=0;for(let g=0;g<this.length();g++){const _=this.getSection(g);if(_.imageName){const x=i[_.imageName];if(!x)continue;const T=x.displaySize;l=Math.max(l,T[0]),p=Math.max(p,T[1])}}return{maxImageWidth:l,maxImageHeight:p}}addTextSection(i,l){this.text+=i.text,this.sections.push(Lf.forText(i.scale,i.fontStack||l,i.verticalAlign));const p=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(p)}addImageSection(i){const l=i.image?i.image.name:"";if(l.length===0)return void en("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Lf.forImage(l,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):en("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ey(c,i,l,p,g,_,x,T,E,R,D,N,G,H,Y){const J=Jh.fromFeature(c,g);let ie;N===h.an.vertical&&J.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:Se}=Gs;if(ce&&J.sections.length===1){ie=[];const re=ce(J.toString(),Bx(J,R,_,i,p,H));for(const ve of re){const Le=new Jh;Le.text=ve,Le.sections=J.sections;for(let Xe=0;Xe<ve.length;Xe++)Le.sectionIndex.push(0);ie.push(Le)}}else if(Se){ie=[];const re=Se(J.text,J.sectionIndex,Bx(J,R,_,i,p,H));for(const ve of re){const Le=new Jh;Le.text=ve[0],Le.sectionIndex=ve[1],Le.sections=J.sections,ie.push(Le)}}else ie=function(re,ve){const Le=[],Xe=re.text;let Oe=0;for(const Be of ve)Le.push(re.substring(Oe,Be)),Oe=Be;return Oe<Xe.length&&Le.push(re.substring(Oe,Xe.length)),Le}(J,Bx(J,R,_,i,p,H));const ye=[],W={positionedLines:ye,text:J.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:N,iconsInText:!1,verticalizable:!1};return function(re,ve,Le,Xe,Oe,Be,it,Qe,at,Ue,wt,Lt){let kt=0,Pt=0,rr=0,Gr=0;const _n=Qe==="right"?1:Qe==="left"?0:.5,ei=An/Lt;let go=0;for(const Fr of Oe){Fr.trim();const In=Fr.getMaxScale(),Zn={positionedGlyphs:[],lineOffset:0};re.positionedLines[go]=Zn;const Wn=Zn.positionedGlyphs;let Si=0;if(!Fr.length()){Pt+=Be,++go;continue}const yo=sN(Xe,Fr,ei);for(let Oi=0;Oi<Fr.length();Oi++){const xn=Fr.getSection(Oi),Ln=Fr.getSectionIndex(Oi),Dn=Fr.getCharCode(Oi),pn=aN(at,wt,Dn);let Ar;if(xn.imageName){if(re.iconsInText=!0,xn.scale=xn.scale*ei,Ar=cN(xn,pn,In,yo,Xe),!Ar)continue;Si=Math.max(Si,Ar.imageOffset)}else if(Ar=lN(xn,Dn,pn,yo,ve,Le),!Ar)continue;const{rect:ps,metrics:nd,baselineOffset:fs}=Ar;Wn.push({glyph:Dn,imageName:xn.imageName,x:kt,y:Pt+fs+-17,vertical:pn,scale:xn.scale,fontStack:xn.fontStack,sectionIndex:Ln,metrics:nd,rect:ps}),pn?(re.verticalizable=!0,kt+=(xn.imageName?nd.advance:An)*xn.scale+Ue):kt+=nd.advance*xn.scale+Ue}Wn.length!==0&&(rr=Math.max(kt-Ue,rr),uN(Wn,0,Wn.length-1,_n)),kt=0,Zn.lineOffset=Math.max(Si,(In-1)*An);const Rn=Be*In+Si;Pt+=Rn,Gr=Math.max(Rn,Gr),++go}const{horizontalAlign:ji,verticalAlign:qn}=$x(it);(function(Fr,In,Zn,Wn,Si,yo,Rn,Oi,xn){const Ln=(In-Zn)*Si;let Dn=0;Dn=yo!==Rn?-Oi*Wn- -17:-Wn*xn*Rn+.5*Rn;for(const pn of Fr)for(const Ar of pn.positionedGlyphs)Ar.x+=Ln,Ar.y+=Dn})(re.positionedLines,_n,ji,qn,rr,Gr,Be,Pt,Oe.length),re.top+=-qn*Pt,re.bottom=re.top+Pt,re.left+=-ji*rr,re.right=re.left+rr}(W,i,l,p,ie,x,T,E,N,R,G,Y),!function(re){for(const ve of re)if(ve.positionedGlyphs.length!==0)return!1;return!0}(ye)&&W}const My={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nN={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},iN={40:!0};function CC(c,i,l,p,g,_){if(i.imageName){const x=p[i.imageName];return x?x.displaySize[0]*i.scale*An/_+g:0}{const x=l[i.fontStack],T=x&&x[c];return T?T.metrics.advance*i.scale+g:0}}function PC(c,i,l,p){const g=Math.pow(c-i,2);return p?c<i?g/2:2*g:g+Math.abs(l)*l}function oN(c,i,l){let p=0;return c===10&&(p-=1e4),l&&(p+=150),c!==40&&c!==65288||(p+=50),i!==41&&i!==65289||(p+=50),p}function EC(c,i,l,p,g,_){let x=null,T=PC(i,l,g,_);for(const E of p){const R=PC(i-E.x,l,g,_)+E.badness;R<=T&&(x=E,T=R)}return{index:c,x:i,priorBreak:x,badness:T}}function MC(c){return c?MC(c.priorBreak).concat(c.index):[]}function Bx(c,i,l,p,g,_){if(!c)return[];const x=[],T=function(N,G,H,Y,J,ie){let ce=0;for(let Se=0;Se<N.length();Se++){const ye=N.getSection(Se);ce+=CC(N.getCharCode(Se),ye,Y,J,G,ie)}return ce/Math.max(1,Math.ceil(ce/H))}(c,i,l,p,g,_),E=c.text.indexOf("​")>=0;let R=0;for(let N=0;N<c.length();N++){const G=c.getSection(N),H=c.getCharCode(N);if(My[H]||(R+=CC(H,G,p,g,i,_)),N<c.length()-1){const Y=!((D=H)<11904)&&(!!er["CJK Compatibility Forms"](D)||!!er["CJK Compatibility"](D)||!!er["CJK Strokes"](D)||!!er["CJK Symbols and Punctuation"](D)||!!er["Enclosed CJK Letters and Months"](D)||!!er["Halfwidth and Fullwidth Forms"](D)||!!er["Ideographic Description Characters"](D)||!!er["Vertical Forms"](D)||cf.test(String.fromCodePoint(D)));(nN[H]||Y||G.imageName||N!==c.length()-2&&iN[c.getCharCode(N+1)])&&x.push(EC(N+1,R,T,x,oN(H,c.getCharCode(N+1),Y&&E),!1))}}var D;return MC(EC(c.length(),R,T,x,0,!0))}function $x(c){let i=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function sN(c,i,l){const p=i.getMaxScale()*An,{maxImageWidth:g,maxImageHeight:_}=i.getMaxImageSize(c),x=Math.max(p,_*l);return{verticalLineContentWidth:Math.max(p,g*l),horizontalLineContentHeight:x}}function kC(c){switch(c){case"top":return 0;case"center":return .5;default:return 1}}function aN(c,i,l){return!(c===h.an.horizontal||!i&&!Uh(l)||i&&(My[l]||(p=l,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function lN(c,i,l,p,g,_){const x=_[c.fontStack],T=function(R,D,N,G){if(R&&R.rect)return R;const H=D[N.fontStack],Y=H&&H[G];return Y?{rect:null,metrics:Y.metrics}:null}(x&&x[i],g,c,i);if(T===null)return null;let E;if(l)E=p.verticalLineContentWidth-c.scale*An;else{const R=kC(c.verticalAlign);E=(p.horizontalLineContentHeight-c.scale*An)*R}return{rect:T.rect,metrics:T.metrics,baselineOffset:E}}function cN(c,i,l,p,g){const _=g[c.imageName];if(!_)return null;const x=_.paddedRect,T=_.displaySize,E={width:T[0],height:T[1],left:1,top:-3,advance:i?T[1]:T[0]};let R;if(i)R=p.verticalLineContentWidth-T[1]*c.scale;else{const D=kC(c.verticalAlign);R=(p.horizontalLineContentHeight-T[1]*c.scale)*D}return{rect:x,metrics:E,baselineOffset:R,imageOffset:(i?T[0]:T[1])*c.scale-An*l}}function uN(c,i,l,p){if(p===0)return;const g=c[l],_=(c[l].x+g.metrics.advance*g.scale)*p;for(let x=i;x<=l;x++)c[x].x-=_}function hN(c,i,l){const{horizontalAlign:p,verticalAlign:g}=$x(l),_=i[0]-c.displaySize[0]*p,x=i[1]-c.displaySize[1]*g;return{image:c,top:x,bottom:x+c.displaySize[1],left:_,right:_+c.displaySize[0]}}function AC(c){var i,l;let p=c.left,g=c.top,_=c.right-p,x=c.bottom-g;const T=(i=c.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",E=(l=c.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",R=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if(E==="proportional"){if(T==="stretchOnly"&&_/x<R||T==="proportional"){const D=Math.ceil(x*R);p*=D/_,_=D}}else if(T==="proportional"&&E==="stretchOnly"&&R!==0&&_/x>R){const D=Math.ceil(_/R);g*=D/x,x=D}return{x1:p,y1:g,x2:p+_,y2:g+x}}function IC(c,i,l,p,g,_){const x=c.image;let T;if(x.content){const ie=x.content,ce=x.pixelRatio||1;T=[ie[0]/ce,ie[1]/ce,x.displaySize[0]-ie[2]/ce,x.displaySize[1]-ie[3]/ce]}const E=i.left*_,R=i.right*_;let D,N,G,H;l==="width"||l==="both"?(H=g[0]+E-p[3],N=g[0]+R+p[1]):(H=g[0]+(E+R-x.displaySize[0])/2,N=H+x.displaySize[0]);const Y=i.top*_,J=i.bottom*_;return l==="height"||l==="both"?(D=g[1]+Y-p[0],G=g[1]+J+p[2]):(D=g[1]+(Y+J-x.displaySize[1])/2,G=D+x.displaySize[1]),{image:x,top:D,right:N,bottom:G,left:H,collisionPadding:T}}const za=128,zl=32640;function RC(c,i){const{expression:l}=i;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Rr(c+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:g}=l;let _=0;for(;_<p.length&&p[_]<=c;)_++;_=Math.max(0,_-1);let x=_;for(;x<p.length&&p[x]<c+1;)x++;x=Math.min(p.length-1,x);const T=p[_],E=p[x];return l.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:E,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:E,minSize:l.evaluate(new Rr(T)),maxSize:l.evaluate(new Rr(E)),interpolationType:g}}}function Vx(c,i,l){let p="never";const g=c.get(i);return g?p=g:c.get(l)&&(p="always"),p}const dN=kf.VectorTileFeature.types,pN=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ky(c,i,l,p,g,_,x,T,E,R,D,N,G){const H=T?Math.min(zl,Math.round(T[0])):0,Y=T?Math.min(zl,Math.round(T[1])):0;c.emplaceBack(i,l,Math.round(32*p),Math.round(32*g),_,x,(H<<1)+(E?1:0),Y,16*R,16*D,256*N,256*G)}function Ux(c,i,l){c.emplaceBack(i.x,i.y,l),c.emplaceBack(i.x,i.y,l),c.emplaceBack(i.x,i.y,l),c.emplaceBack(i.x,i.y,l)}function fN(c){for(const i of c.sections)if(hf(i.text))return!0;return!1}class Gx{constructor(i){this.layoutVertexArray=new $t,this.indexArray=new Cr,this.programConfigurations=i,this.segments=new cr,this.dynamicLayoutVertexArray=new fr,this.opacityVertexArray=new jr,this.hasVisibleVertices=!1,this.placedSymbolArray=new le}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,l,p,g){this.isEmpty()||(p&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,H4.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,K4.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,pN,!0),this.opacityVertexBuffer.itemSize=1),(p||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}_t("SymbolBuffers",Gx);class qx{constructor(i,l,p){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new p,this.segments=new cr,this.collisionVertexArray=new Or}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,X4.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}_t("CollisionBuffers",qx);class ed{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=RC(this.zoom,l["text-size"]),this.iconSizeData=RC(this.zoom,l["icon-size"]);const p=this.layers[0].layout,g=p.get("symbol-sort-key"),_=p.get("symbol-z-order");this.canOverlap=Vx(p,"text-overlap","text-allow-overlap")!=="never"||Vx(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(x=>h.an[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID}createArrays(){this.text=new Gx(new Ys(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Gx(new Ys(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new he,this.lineVertexArray=new _e,this.symbolInstances=new ge,this.textAnchorOffsets=new me}calculateGlyphDependencies(i,l,p,g,_){for(let x=0;x<i.length;x++)if(l[i.charCodeAt(x)]=!0,(p||g)&&_){const T=Rf[i.charAt(x)];T&&(l[T.charCodeAt(0)]=!0)}}populate(i,l,p){const g=this.layers[0],_=g.layout,x=_.get("text-font"),T=_.get("text-field"),E=_.get("icon-image"),R=(T.value.kind!=="constant"||T.value.value instanceof Yn&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),D=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,N=_.get("symbol-sort-key");if(this.features=[],!R&&!D)return;const G=l.iconDependencies,H=l.glyphDependencies,Y=l.availableImages,J=new Rr(this.zoom,{globalState:this.globalState});for(const{feature:ie,id:ce,index:Se,sourceLayerIndex:ye}of i){const W=g._featureFilter.needGeometry,re=hu(ie,W);if(!g._featureFilter.filter(J,re,p))continue;let ve,Le;if(W||(re.geometry=uu(ie)),R){const Oe=g.getValueAndResolveTokens("text-field",re,p,Y),Be=Yn.factory(Oe),it=this.hasRTLText=this.hasRTLText||fN(Be);(!it||Gs.getRTLTextPluginStatus()==="unavailable"||it&&Gs.isParsed())&&(ve=Q4(Be,g,re))}if(D){const Oe=g.getValueAndResolveTokens("icon-image",re,p,Y);Le=Oe instanceof vi?Oe:vi.fromString(Oe)}if(!ve&&!Le)continue;const Xe=this.sortFeaturesByKey?N.evaluate(re,{},p):void 0;if(this.features.push({id:ce,text:ve,icon:Le,index:Se,sourceLayerIndex:ye,geometry:re.geometry,properties:ie.properties,type:dN[ie.type],sortKey:Xe}),Le&&(G[Le.name]=!0),ve){const Oe=x.evaluate(re,{},p).join(","),Be=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(h.an.vertical)>=0;for(const it of ve.sections)if(it.image)G[it.image.name]=!0;else{const Qe=lf(ve.toString()),at=it.fontStack||Oe,Ue=H[at]=H[at]||{};this.calculateGlyphDependencies(it.text,Ue,Be,this.allowVerticalPlacement,Qe)}}}_.get("symbol-placement")==="line"&&(this.features=function(ie){const ce={},Se={},ye=[];let W=0;function re(Oe){ye.push(ie[Oe]),W++}function ve(Oe,Be,it){const Qe=Se[Oe];return delete Se[Oe],Se[Be]=Qe,ye[Qe].geometry[0].pop(),ye[Qe].geometry[0]=ye[Qe].geometry[0].concat(it[0]),Qe}function Le(Oe,Be,it){const Qe=ce[Be];return delete ce[Be],ce[Oe]=Qe,ye[Qe].geometry[0].shift(),ye[Qe].geometry[0]=it[0].concat(ye[Qe].geometry[0]),Qe}function Xe(Oe,Be,it){const Qe=it?Be[0][Be[0].length-1]:Be[0][0];return`${Oe}:${Qe.x}:${Qe.y}`}for(let Oe=0;Oe<ie.length;Oe++){const Be=ie[Oe],it=Be.geometry,Qe=Be.text?Be.text.toString():null;if(!Qe){re(Oe);continue}const at=Xe(Qe,it),Ue=Xe(Qe,it,!0);if(at in Se&&Ue in ce&&Se[at]!==ce[Ue]){const wt=Le(at,Ue,it),Lt=ve(at,Ue,ye[wt].geometry);delete ce[at],delete Se[Ue],Se[Xe(Qe,ye[Lt].geometry,!0)]=Lt,ye[wt].geometry=null}else at in Se?ve(at,Ue,it):Ue in ce?Le(at,Ue,it):(re(Oe),ce[at]=W-1,Se[Ue]=W-1)}return ye.filter(Oe=>Oe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ie,ce)=>ie.sortKey-ce.sortKey)}update(i,l,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,p),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const p=this.lineVertexArray.length;if(i.segment!==void 0){let g=i.dist(l[i.segment+1]),_=i.dist(l[i.segment]);const x={};for(let T=i.segment+1;T<l.length;T++)x[T]={x:l[T].x,y:l[T].y,tileUnitDistanceFromAnchor:g},T<l.length-1&&(g+=l[T+1].dist(l[T]));for(let T=i.segment||0;T>=0;T--)x[T]={x:l[T].x,y:l[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=l[T-1].dist(l[T]));for(let T=0;T<l.length;T++){const E=x[T];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(i,l,p,g,_,x,T,E,R,D,N,G){const H=i.indexArray,Y=i.layoutVertexArray,J=i.segments.prepareSegment(4*l.length,Y,H,this.canOverlap?x.sortKey:void 0),ie=this.glyphOffsetArray.length,ce=J.vertexLength,Se=this.allowVerticalPlacement&&T===h.an.vertical?Math.PI/2:0,ye=x.text&&x.text.sections;for(let W=0;W<l.length;W++){const{tl:re,tr:ve,bl:Le,br:Xe,tex:Oe,pixelOffsetTL:Be,pixelOffsetBR:it,minFontScaleX:Qe,minFontScaleY:at,glyphOffset:Ue,isSDF:wt,sectionIndex:Lt}=l[W],kt=J.vertexLength,Pt=Ue[1];ky(Y,E.x,E.y,re.x,Pt+re.y,Oe.x,Oe.y,p,wt,Be.x,Be.y,Qe,at),ky(Y,E.x,E.y,ve.x,Pt+ve.y,Oe.x+Oe.w,Oe.y,p,wt,it.x,Be.y,Qe,at),ky(Y,E.x,E.y,Le.x,Pt+Le.y,Oe.x,Oe.y+Oe.h,p,wt,Be.x,it.y,Qe,at),ky(Y,E.x,E.y,Xe.x,Pt+Xe.y,Oe.x+Oe.w,Oe.y+Oe.h,p,wt,it.x,it.y,Qe,at),Ux(i.dynamicLayoutVertexArray,E,Se),H.emplaceBack(kt,kt+2,kt+1),H.emplaceBack(kt+1,kt+2,kt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ue[0]),W!==l.length-1&&Lt===l[W+1].sectionIndex||i.programConfigurations.populatePaintArrays(Y.length,x,x.index,{},G,ye&&ye[Lt])}i.placedSymbolArray.emplaceBack(E.x,E.y,ie,this.glyphOffsetArray.length-ie,ce,R,D,E.segment,p?p[0]:0,p?p[1]:0,g[0],g[1],T,0,!1,0,N)}_addCollisionDebugVertex(i,l,p,g,_,x){return l.emplaceBack(0,0),i.emplaceBack(p.x,p.y,g,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(i,l,p,g,_,x,T){const E=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),R=E.vertexLength,D=_.layoutVertexArray,N=_.collisionVertexArray,G=T.anchorX,H=T.anchorY;this._addCollisionDebugVertex(D,N,x,G,H,new B(i,l)),this._addCollisionDebugVertex(D,N,x,G,H,new B(p,l)),this._addCollisionDebugVertex(D,N,x,G,H,new B(p,g)),this._addCollisionDebugVertex(D,N,x,G,H,new B(i,g)),E.vertexLength+=4;const Y=_.indexArray;Y.emplaceBack(R,R+1),Y.emplaceBack(R+1,R+2),Y.emplaceBack(R+2,R+3),Y.emplaceBack(R+3,R),E.primitiveLength+=4}addDebugCollisionBoxes(i,l,p,g){for(let _=i;_<l;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new qx(Sr,_C.members,Tr),this.iconCollisionBox=new qx(Sr,_C.members,Tr);for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(i,l,p,g,_,x,T,E,R){const D={};for(let N=l;N<p;N++){const G=i.get(N);D.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},D.textFeatureIndex=G.featureIndex;break}for(let N=g;N<_;N++){const G=i.get(N);D.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},D.verticalTextFeatureIndex=G.featureIndex;break}for(let N=x;N<T;N++){const G=i.get(N);D.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},D.iconFeatureIndex=G.featureIndex;break}for(let N=E;N<R;N++){const G=i.get(N);D.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},D.verticalIconFeatureIndex=G.featureIndex;break}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,l){const p=i.placedSymbolArray.get(l),g=p.vertexStartIndex+4*p.numGlyphs;for(let _=p.vertexStartIndex;_<g;_+=4)i.indexArray.emplaceBack(_,_+2,_+1),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),p=Math.cos(i),g=[],_=[],x=[];for(let T=0;T<this.symbolInstances.length;++T){x.push(T);const E=this.symbolInstances.get(T);g.push(0|Math.round(l*E.anchorX+p*E.anchorY)),_.push(E.featureIndex)}return x.sort((T,E)=>g[T]-g[E]||_[E]-_[T]),x}addToSortKeyRanges(i,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((g,_,x)=>{g>=0&&x.indexOf(g)===_&&this.addIndicesForPlacedSymbol(this.text,g)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let LC,DC;_t("SymbolBucket",ed,{omit:["layers","collisionBoxArray","features","compareText"]}),ed.MAX_GLYPHS=65535,ed.addDynamicAttributes=Ux;var Zx={get paint(){return DC=DC||new ci({"icon-opacity":new Dt(pe.paint_symbol["icon-opacity"]),"icon-color":new Dt(pe.paint_symbol["icon-color"]),"icon-halo-color":new Dt(pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Dt(pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Dt(pe.paint_symbol["icon-halo-blur"]),"icon-translate":new St(pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Dt(pe.paint_symbol["text-opacity"]),"text-color":new Dt(pe.paint_symbol["text-color"],{runtimeType:Li,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Dt(pe.paint_symbol["text-halo-color"]),"text-halo-width":new Dt(pe.paint_symbol["text-halo-width"]),"text-halo-blur":new Dt(pe.paint_symbol["text-halo-blur"]),"text-translate":new St(pe.paint_symbol["text-translate"]),"text-translate-anchor":new St(pe.paint_symbol["text-translate-anchor"])})},get layout(){return LC=LC||new ci({"symbol-placement":new St(pe.layout_symbol["symbol-placement"]),"symbol-spacing":new St(pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Dt(pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(pe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new St(pe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new St(pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Dt(pe.layout_symbol["icon-size"]),"icon-text-fit":new St(pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Dt(pe.layout_symbol["icon-image"]),"icon-rotate":new Dt(pe.layout_symbol["icon-rotate"]),"icon-padding":new Dt(pe.layout_symbol["icon-padding"]),"icon-keep-upright":new St(pe.layout_symbol["icon-keep-upright"]),"icon-offset":new Dt(pe.layout_symbol["icon-offset"]),"icon-anchor":new Dt(pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(pe.layout_symbol["text-rotation-alignment"]),"text-field":new Dt(pe.layout_symbol["text-field"]),"text-font":new Dt(pe.layout_symbol["text-font"]),"text-size":new Dt(pe.layout_symbol["text-size"]),"text-max-width":new Dt(pe.layout_symbol["text-max-width"]),"text-line-height":new St(pe.layout_symbol["text-line-height"]),"text-letter-spacing":new Dt(pe.layout_symbol["text-letter-spacing"]),"text-justify":new Dt(pe.layout_symbol["text-justify"]),"text-radial-offset":new Dt(pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(pe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Dt(pe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Dt(pe.layout_symbol["text-anchor"]),"text-max-angle":new St(pe.layout_symbol["text-max-angle"]),"text-writing-mode":new St(pe.layout_symbol["text-writing-mode"]),"text-rotate":new Dt(pe.layout_symbol["text-rotate"]),"text-padding":new St(pe.layout_symbol["text-padding"]),"text-keep-upright":new St(pe.layout_symbol["text-keep-upright"]),"text-transform":new Dt(pe.layout_symbol["text-transform"]),"text-offset":new Dt(pe.layout_symbol["text-offset"]),"text-allow-overlap":new St(pe.layout_symbol["text-allow-overlap"]),"text-overlap":new St(pe.layout_symbol["text-overlap"]),"text-ignore-placement":new St(pe.layout_symbol["text-ignore-placement"]),"text-optional":new St(pe.layout_symbol["text-optional"])})}};class zC{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ba,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_t("FormatSectionOverride",zC,{omit:["defaultValue"]});class Ay extends $n{constructor(i){super(i,Zx)}recalculate(i,l){if(super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const g=[];for(const _ of p)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,l,p,g){const _=this.layout.get(i).evaluate(l,{},p,g),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Ih(x.value)||!_?_:function(T,E){return E.replace(/{([^{}]+)}/g,(R,D)=>T&&D in T?String(T[D]):"")}(l.properties,_)}createBucket(i){return new ed(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of Zx.paint.overridableProperties){if(!Ay.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),p=new zC(l),g=new Ah(p,l.property.specification);let _=null;_=l.value.kind==="constant"||l.value.kind==="source"?new Wc("source",g):new Lh("composite",g,l.value.zoomStops),this.paint._values[i]=new Fo(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&Ay.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const p=i.get("text-field"),g=Zx.paint.properties[l];let _=!1;const x=T=>{for(const E of T)if(g.overrides&&g.overrides.hasOverride(E))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Yn)x(p.value.value.sections);else if(p.value.kind==="source"){const T=R=>{_||(R instanceof si&&zt(R.value)===wa?x(R.value.sections):R instanceof Bc?x(R.sections):R.eachChild(T))},E=p.value;E._styleExpression&&T(E._styleExpression.expression)}return _}}let NC;var mN={get paint(){return NC=NC||new ci({"background-color":new St(pe.paint_background["background-color"]),"background-pattern":new pf(pe.paint_background["background-pattern"]),"background-opacity":new St(pe.paint_background["background-opacity"])})}};class gN extends $n{constructor(i){super(i,mN)}}let jC;var yN={get paint(){return jC=jC||new ci({"raster-opacity":new St(pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(pe.paint_raster["raster-brightness-max"]),"raster-saturation":new St(pe.paint_raster["raster-saturation"]),"raster-contrast":new St(pe.paint_raster["raster-contrast"]),"raster-resampling":new St(pe.paint_raster["raster-resampling"]),"raster-fade-duration":new St(pe.paint_raster["raster-fade-duration"])})}};class vN extends $n{constructor(i){super(i,yN)}}class _N extends $n{constructor(i){super(i,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class xN{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const bN={once:!0},Wx=63710088e-1;class Nl{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Nl(Cn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,p=this.lat*l,g=i.lat*l,_=Math.sin(p)*Math.sin(g)+Math.cos(p)*Math.cos(g)*Math.cos((i.lng-this.lng)*l);return Wx*Math.acos(Math.min(_,1))}static convert(i){if(i instanceof Nl)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Nl(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Nl(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const OC=2*Math.PI*Wx;function FC(c){return OC*Math.cos(c*Math.PI/180)}function BC(c){return(180+c)/360}function $C(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function VC(c,i){return c/FC(i)}function Hx(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function UC(c,i){return c*FC(Hx(i))}class Df{constructor(i,l,p=0){this.x=+i,this.y=+l,this.z=+p}static fromLngLat(i,l=0){const p=Nl.convert(i);return new Df(BC(p.lng),$C(p.lat),VC(l,p.lat))}toLngLat(){return new Nl(360*this.x-180,Hx(this.y))}toAltitude(){return UC(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/OC*(i=Hx(this.y),1/Math.cos(i*Math.PI/180));var i}}function GC(c,i,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[c*p-2*Math.PI*6378137/2,i*p-2*Math.PI*6378137/2]}class Kx{constructor(i,l,p){if(!function(g,_,x){return!(g<0||g>25||x<0||x>=Math.pow(2,g)||_<0||_>=Math.pow(2,g))}(i,l,p))throw new Error(`x=${l}, y=${p}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=l,this.y=p,this.key=td(0,i,i,l,p)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l,p){const g=(x=this.y,T=this.z,E=GC(256*(_=this.x),256*(x=Math.pow(2,T)-x-1),T),R=GC(256*(_+1),256*(x+1),T),E[0]+","+E[1]+","+R[0]+","+R[1]);var _,x,T,E,R;const D=function(N,G,H){let Y,J="";for(let ie=N;ie>0;ie--)Y=1<<ie-1,J+=(G&Y?1:0)+(H&Y?2:0);return J}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,g)}isChildOf(i){const l=this.z-i.z;return l>0&&i.x===this.x>>l&&i.y===this.y>>l}getTilePoint(i){const l=Math.pow(2,this.z);return new B((i.x*l-this.x)*ot,(i.y*l-this.y)*ot)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qC{constructor(i,l){this.wrap=i,this.canonical=l,this.key=td(i,l.z,l.z,l.x,l.y)}}class mo{constructor(i,l,p,g,_){if(this.terrainRttPosMatrix32f=null,i<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${p}`);this.overscaledZ=i,this.wrap=l,this.canonical=new Kx(p,+g,+_),this.key=td(l,i,p,g,_)}clone(){return new mo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-i;return i>this.canonical.z?new mo(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mo(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-i;return i>this.canonical.z?td(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y):td(this.wrap*+l,i,i,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new mo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,g=2*this.canonical.y;return[new mo(l,this.wrap,l,p,g),new mo(l,this.wrap,l,p+1,g),new mo(l,this.wrap,l,p,g+1),new mo(l,this.wrap,l,p+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new mo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new mo(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Df(i.x-this.wrap,i.y))}}function td(c,i,l,p,g){(c*=2)<0&&(c=-1*c-1);const _=1<<l;return(_*_*c+_*g+p).toString(36)+l.toString(36)+i.toString(36)}_t("CanonicalTileID",Kx),_t("OverscaledTileID",mo,{omit:["terrainRttPosMatrix32f"]});class fu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const l=new fu;return l.extend(i(new B(this.minX,this.minY))),l.extend(i(new B(this.maxX,this.minY))),l.extend(i(new B(this.minX,this.maxY))),l.extend(i(new B(this.maxX,this.maxY))),l}static fromPoints(i){const l=new fu;for(const p of i)l.extend(p);return l}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class ZC{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const p=i[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class WC{constructor(i,l,p,g,_){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=p,i._y=g,this.properties=i.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(i[l]=this[l]);return i}}class HC{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Al(ot,16,0),this.grid3D=new Al(ot,16,0),this.featureIndexArray=new Ne,this.promoteId=l}insert(i,l,p,g,_,x){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,g,_);const E=x?this.grid3D:this.grid;for(let R=0;R<l.length;R++){const D=l[R],N=[1/0,1/0,-1/0,-1/0];for(let G=0;G<D.length;G++){const H=D[G];N[0]=Math.min(N[0],H.x),N[1]=Math.min(N[1],H.y),N[2]=Math.max(N[2],H.x),N[3]=Math.max(N[3],H.y)}N[0]<ot&&N[1]<ot&&N[2]>=0&&N[3]>=0&&E.insert(T,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new kf.VectorTile(new Ox(this.rawTileData)).layers,this.sourceLayerCoder=new ZC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,l,p,g){this.loadVTLayers();const _=i.params,x=ot/i.tileSize/i.scale,T=Vs(_.filter),E=i.queryGeometry,R=i.queryPadding*x,D=fu.fromPoints(E),N=this.grid.query(D.minX-R,D.minY-R,D.maxX+R,D.maxY+R),G=fu.fromPoints(i.cameraQueryGeometry).expandBy(R),H=this.grid3D.query(G.minX,G.minY,G.maxX,G.maxY,(ie,ce,Se,ye)=>function(W,re,ve,Le,Xe){for(const Be of W)if(re<=Be.x&&ve<=Be.y&&Le>=Be.x&&Xe>=Be.y)return!0;const Oe=[new B(re,ve),new B(re,Xe),new B(Le,Xe),new B(Le,ve)];if(W.length>2){for(const Be of Oe)if(Kh(W,Be))return!0}for(let Be=0;Be<W.length-1;Be++)if(l4(W[Be],W[Be+1],Oe))return!0;return!1}(i.cameraQueryGeometry,ie-R,ce-R,Se+R,ye+R));for(const ie of H)N.push(ie);N.sort(wN);const Y={};let J;for(let ie=0;ie<N.length;ie++){const ce=N[ie];if(ce===J)continue;J=ce;const Se=this.featureIndexArray.get(ce);let ye=null;this.loadMatchingFeature(Y,Se.bucketIndex,Se.sourceLayerIndex,Se.featureIndex,T,_.layers,_.availableImages,l,p,g,(W,re,ve)=>(ye||(ye=uu(W)),re.queryIntersectsFeature({queryGeometry:E,feature:W,featureState:ve,geometry:ye,zoom:this.z,transform:i.transform,pixelsToTileUnits:x,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return Y}loadMatchingFeature(i,l,p,g,_,x,T,E,R,D,N){const G=this.bucketLayerIDs[l];if(x&&!G.some(ie=>x.has(ie)))return;const H=this.sourceLayerCoder.decode(p),Y=this.vtLayers[H].feature(g);if(_.needGeometry){const ie=hu(Y,!0);if(!_.filter(new Rr(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!_.filter(new Rr(this.tileID.overscaledZ),Y))return;const J=this.getId(Y,H);for(let ie=0;ie<G.length;ie++){const ce=G[ie];if(x&&!x.has(ce))continue;const Se=E[ce];if(!Se)continue;let ye={};J&&D&&(ye=D.getState(Se.sourceLayer||"_geojsonTileLayer",J));const W=br({},R[ce]);W.paint=KC(W.paint,Se.paint,Y,ye,T),W.layout=KC(W.layout,Se.layout,Y,ye,T);const re=!N||N(Y,Se,ye);if(!re)continue;const ve=new WC(Y,this.z,this.x,this.y,J);ve.layer=W;let Le=i[ce];Le===void 0&&(Le=i[ce]=[]),Le.push({featureIndex:g,feature:ve,intersectionZ:re})}}lookupSymbolFeatures(i,l,p,g,_,x,T,E){const R={};this.loadVTLayers();const D=Vs(_);for(const N of i)this.loadMatchingFeature(R,p,g,N,D,x,T,E,l);return R}hasLayer(i){for(const l of this.bucketLayerIDs)for(const p of l)if(i===p)return!0;return!1}getId(i,l){var p;let g=i.id;return this.promoteId&&(g=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((p=i.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(g=Number(i.properties.cluster_id))),g}}function KC(c,i,l,p,g){return vr(c,(_,x)=>{const T=i instanceof qh?i.get(x):null;return T&&T.evaluate?T.evaluate(l,p,g):T})}function wN(c,i){return i-c}function XC(c,i,l,p,g){const _=[];for(let x=0;x<c.length;x++){const T=c[x];let E;for(let R=0;R<T.length-1;R++){let D=T[R],N=T[R+1];D.x<i&&N.x<i||(D.x<i?D=new B(i,D.y+(i-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x<i&&(N=new B(i,D.y+(i-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y<l&&N.y<l||(D.y<l?D=new B(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round():N.y<l&&(N=new B(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round()),D.x>=p&&N.x>=p||(D.x>=p?D=new B(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x>=p&&(N=new B(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y>=g&&N.y>=g||(D.y>=g?D=new B(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round():N.y>=g&&(N=new B(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round()),E&&D.equals(E[E.length-1])||(E=[D],_.push(E)),E.push(N)))))}}return _}_t("FeatureIndex",HC,{omit:["rawTileData","sourceLayerCoder"]});class jl extends B{constructor(i,l,p,g){super(i,l),this.angle=p,g!==void 0&&(this.segment=g)}clone(){return new jl(this.x,this.y,this.angle,this.segment)}}function YC(c,i,l,p,g){if(i.segment===void 0||l===0)return!0;let _=i,x=i.segment+1,T=0;for(;T>-l/2;){if(x--,x<0)return!1;T-=c[x].dist(_),_=c[x]}T+=c[x].dist(c[x+1]),x++;const E=[];let R=0;for(;T<l/2;){const D=c[x],N=c[x+1];if(!N)return!1;let G=c[x-1].angleTo(D)-D.angleTo(N);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:T,angleDelta:G}),R+=G;T-E[0].distance>p;)R-=E.shift().angleDelta;if(R>g)return!1;x++,T+=D.dist(N)}return!0}function QC(c){let i=0;for(let l=0;l<c.length-1;l++)i+=c[l].dist(c[l+1]);return i}function JC(c,i,l){return c?.6*i*l:0}function eP(c,i){return Math.max(c?c.right-c.left:0,i?i.right-i.left:0)}function SN(c,i,l,p,g,_){const x=JC(l,g,_),T=eP(l,p)*_;let E=0;const R=QC(c)/2;for(let D=0;D<c.length-1;D++){const N=c[D],G=c[D+1],H=N.dist(G);if(E+H>R){const Y=(R-E)/H,J=zi.number(N.x,G.x,Y),ie=zi.number(N.y,G.y,Y),ce=new jl(J,ie,G.angleTo(N),D);return ce._round(),!x||YC(c,ce,T,x,i)?ce:void 0}E+=H}}function TN(c,i,l,p,g,_,x,T,E){const R=JC(p,_,x),D=eP(p,g),N=D*x,G=c[0].x===0||c[0].x===E||c[0].y===0||c[0].y===E;return i-N<i/4&&(i=N+i/4),tP(c,G?i/2*T%i:(D/2+2*_)*x*T%i,i,R,l,N,G,!1,E)}function tP(c,i,l,p,g,_,x,T,E){const R=_/2,D=QC(c);let N=0,G=i-l,H=[];for(let Y=0;Y<c.length-1;Y++){const J=c[Y],ie=c[Y+1],ce=J.dist(ie),Se=ie.angleTo(J);for(;G+l<N+ce;){G+=l;const ye=(G-N)/ce,W=zi.number(J.x,ie.x,ye),re=zi.number(J.y,ie.y,ye);if(W>=0&&W<E&&re>=0&&re<E&&G-R>=0&&G+R<=D){const ve=new jl(W,re,Se,Y);ve._round(),p&&!YC(c,ve,_,p,g)||H.push(ve)}}N+=ce}return T||H.length||x||(H=tP(c,N/2,l,p,g,_,x,!0,E)),H}function rP(c,i,l,p){const g=[],_=c.image,x=_.pixelRatio,T=_.paddedRect.w-2,E=_.paddedRect.h-2;let R={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const D=_.stretchX||[[0,T]],N=_.stretchY||[[0,E]],G=(Ue,wt)=>Ue+wt[1]-wt[0],H=D.reduce(G,0),Y=N.reduce(G,0),J=T-H,ie=E-Y;let ce=0,Se=H,ye=0,W=Y,re=0,ve=J,Le=0,Xe=ie;if(_.content&&p){const Ue=_.content,wt=Ue[2]-Ue[0],Lt=Ue[3]-Ue[1];(_.textFitWidth||_.textFitHeight)&&(R=AC(c)),ce=Iy(D,0,Ue[0]),ye=Iy(N,0,Ue[1]),Se=Iy(D,Ue[0],Ue[2]),W=Iy(N,Ue[1],Ue[3]),re=Ue[0]-ce,Le=Ue[1]-ye,ve=wt-Se,Xe=Lt-W}const Oe=R.x1,Be=R.y1,it=R.x2-Oe,Qe=R.y2-Be,at=(Ue,wt,Lt,kt)=>{const Pt=Ry(Ue.stretch-ce,Se,it,Oe),rr=Ly(Ue.fixed-re,ve,Ue.stretch,H),Gr=Ry(wt.stretch-ye,W,Qe,Be),_n=Ly(wt.fixed-Le,Xe,wt.stretch,Y),ei=Ry(Lt.stretch-ce,Se,it,Oe),go=Ly(Lt.fixed-re,ve,Lt.stretch,H),ji=Ry(kt.stretch-ye,W,Qe,Be),qn=Ly(kt.fixed-Le,Xe,kt.stretch,Y),Fr=new B(Pt,Gr),In=new B(ei,Gr),Zn=new B(ei,ji),Wn=new B(Pt,ji),Si=new B(rr/x,_n/x),yo=new B(go/x,qn/x),Rn=i*Math.PI/180;if(Rn){const Ln=Math.sin(Rn),Dn=Math.cos(Rn),pn=[Dn,-Ln,Ln,Dn];Fr._matMult(pn),In._matMult(pn),Wn._matMult(pn),Zn._matMult(pn)}const Oi=Ue.stretch+Ue.fixed,xn=wt.stretch+wt.fixed;return{tl:Fr,tr:In,bl:Wn,br:Zn,tex:{x:_.paddedRect.x+1+Oi,y:_.paddedRect.y+1+xn,w:Lt.stretch+Lt.fixed-Oi,h:kt.stretch+kt.fixed-xn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Si,pixelOffsetBR:yo,minFontScaleX:ve/x/it,minFontScaleY:Xe/x/Qe,isSDF:l}};if(p&&(_.stretchX||_.stretchY)){const Ue=nP(D,J,H),wt=nP(N,ie,Y);for(let Lt=0;Lt<Ue.length-1;Lt++){const kt=Ue[Lt],Pt=Ue[Lt+1];for(let rr=0;rr<wt.length-1;rr++)g.push(at(kt,wt[rr],Pt,wt[rr+1]))}}else g.push(at({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:E+1}));return g}function Iy(c,i,l){let p=0;for(const g of c)p+=Math.max(i,Math.min(l,g[1]))-Math.max(i,Math.min(l,g[0]));return p}function nP(c,i,l){const p=[{fixed:-1,stretch:0}];for(const[g,_]of c){const x=p[p.length-1];p.push({fixed:g-x.stretch,stretch:x.stretch}),p.push({fixed:g-x.stretch,stretch:x.stretch+(_-g)})}return p.push({fixed:i+1,stretch:l}),p}function Ry(c,i,l,p){return c/i*l+p}function Ly(c,i,l,p){return c-i*l/p}_t("Anchor",jl);class Dy{constructor(i,l,p,g,_,x,T,E,R,D){var N;if(this.boxStartIndex=i.length,R){let G=x.top,H=x.bottom;const Y=x.collisionPadding;Y&&(G-=Y[1],H+=Y[3]);let J=H-G;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const G=!((N=x.image)===null||N===void 0)&&N.content&&(x.image.textFitWidth||x.image.textFitHeight)?AC(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};G.y1=G.y1*T-E[0],G.y2=G.y2*T+E[2],G.x1=G.x1*T-E[3],G.x2=G.x2*T+E[1];const H=x.collisionPadding;if(H&&(G.x1-=H[0]*T,G.y1-=H[1]*T,G.x2+=H[2]*T,G.y2+=H[3]*T),D){const Y=new B(G.x1,G.y1),J=new B(G.x2,G.y1),ie=new B(G.x1,G.y2),ce=new B(G.x2,G.y2),Se=D*Math.PI/180;Y._rotate(Se),J._rotate(Se),ie._rotate(Se),ce._rotate(Se),G.x1=Math.min(Y.x,J.x,ie.x,ce.x),G.x2=Math.max(Y.x,J.x,ie.x,ce.x),G.y1=Math.min(Y.y,J.y,ie.y,ce.y),G.y2=Math.max(Y.y,J.y,ie.y,ce.y)}i.emplaceBack(l.x,l.y,G.x1,G.y1,G.x2,G.y2,p,g,_)}this.boxEndIndex=i.length}}class CN{constructor(i=[],l=(p,g)=>p<g?-1:p>g?1:0){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:p}=this,g=l[i];for(;i>0;){const _=i-1>>1,x=l[_];if(p(g,x)>=0)break;l[i]=x,i=_}l[i]=g}_down(i){const{data:l,compare:p}=this,g=this.length>>1,_=l[i];for(;i<g;){let x=1+(i<<1);const T=x+1;if(T<this.length&&p(l[T],l[x])<0&&(x=T),p(l[x],_)>=0)break;l[i]=l[x],i=x}l[i]=_}}function PN(c,i=1,l=!1){const p=fu.fromPoints(c[0]),g=Math.min(p.width(),p.height());let _=g/2;const x=new CN([],EN),{minX:T,minY:E,maxX:R,maxY:D}=p;if(g===0)return new B(T,E);for(let H=T;H<R;H+=g)for(let Y=E;Y<D;Y+=g)x.push(new rd(H+_,Y+_,_,c));let N=function(H){let Y=0,J=0,ie=0;const ce=H[0];for(let Se=0,ye=ce.length,W=ye-1;Se<ye;W=Se++){const re=ce[Se],ve=ce[W],Le=re.x*ve.y-ve.x*re.y;J+=(re.x+ve.x)*Le,ie+=(re.y+ve.y)*Le,Y+=3*Le}return new rd(J/Y,ie/Y,0,H)}(c),G=x.length;for(;x.length;){const H=x.pop();(H.d>N.d||!N.d)&&(N=H,l&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,G)),H.max-N.d<=i||(_=H.h/2,x.push(new rd(H.p.x-_,H.p.y-_,_,c)),x.push(new rd(H.p.x+_,H.p.y-_,_,c)),x.push(new rd(H.p.x-_,H.p.y+_,_,c)),x.push(new rd(H.p.x+_,H.p.y+_,_,c)),G+=4)}return l&&(console.log(`num probes: ${G}`),console.log(`best distance: ${N.d}`)),N.p}function EN(c,i){return i.max-c.max}function rd(c,i,l,p){this.p=new B(c,i),this.h=l,this.d=function(g,_){let x=!1,T=1/0;for(let E=0;E<_.length;E++){const R=_[E];for(let D=0,N=R.length,G=N-1;D<N;G=D++){const H=R[D],Y=R[G];H.y>g.y!=Y.y>g.y&&g.x<(Y.x-H.x)*(g.y-H.y)/(Y.y-H.y)+H.x&&(x=!x),T=Math.min(T,NT(g,H,Y))}}return(x?1:-1)*Math.sqrt(T)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Jn;h.aD=void 0,(Jn=h.aD||(h.aD={}))[Jn.center=1]="center",Jn[Jn.left=2]="left",Jn[Jn.right=3]="right",Jn[Jn.top=4]="top",Jn[Jn.bottom=5]="bottom",Jn[Jn["top-left"]=6]="top-left",Jn[Jn["top-right"]=7]="top-right",Jn[Jn["bottom-left"]=8]="bottom-left",Jn[Jn["bottom-right"]=9]="bottom-right";const Xx=Number.POSITIVE_INFINITY;function iP(c,i){return i[1]!==Xx?function(l,p,g){let _=0,x=0;switch(p=Math.abs(p),g=Math.abs(g),l){case"top-right":case"top-left":case"top":x=g-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-g}switch(l){case"top-right":case"bottom-right":case"right":_=-p;break;case"top-left":case"bottom-left":case"left":_=p}return[_,x]}(c,i[0],i[1]):function(l,p){let g=0,_=0;p<0&&(p=0);const x=p/Math.SQRT2;switch(l){case"top-right":case"top-left":_=x-7;break;case"bottom-right":case"bottom-left":_=7-x;break;case"bottom":_=7-p;break;case"top":_=p-7}switch(l){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=p;break;case"right":g=-p}return[g,_]}(c,i[0])}function oP(c,i,l){var p;const g=c.layout,_=(p=g.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(i,{},l);if(_){const T=_.values,E=[];for(let R=0;R<T.length;R+=2){const D=E[R]=T[R],N=T[R+1].map(G=>G*An);D.startsWith("top")?N[1]-=7:D.startsWith("bottom")&&(N[1]+=7),E[R+1]=N}return new or(E)}const x=g.get("text-variable-anchor");if(x){let T;T=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(i,{},l)*An,Xx]:g.get("text-offset").evaluate(i,{},l).map(R=>R*An);const E=[];for(const R of x)E.push(R,iP(R,T));return new or(E)}return null}function Yx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function MN(c,i,l,p,g,_,x,T,E,R,D,N){let G=_.textMaxSize.evaluate(i,{});G===void 0&&(G=x);const H=c.layers[0].layout,Y=H.get("icon-offset").evaluate(i,{},D),J=aP(l.horizontal),ie=x/24,ce=c.tilePixelRatio*ie,Se=c.tilePixelRatio*G/24,ye=c.tilePixelRatio*T,W=c.tilePixelRatio*H.get("symbol-spacing"),re=H.get("text-padding")*c.tilePixelRatio,ve=function(Lt,kt,Pt,rr=1){const Gr=Lt.get("icon-padding").evaluate(kt,{},Pt),_n=Gr&&Gr.values;return[_n[0]*rr,_n[1]*rr,_n[2]*rr,_n[3]*rr]}(H,i,D,c.tilePixelRatio),Le=H.get("text-max-angle")/180*Math.PI,Xe=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Oe=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",Be=H.get("symbol-placement"),it=W/2,Qe=H.get("icon-text-fit");let at;p&&Qe!=="none"&&(c.allowVerticalPlacement&&l.vertical&&(at=IC(p,l.vertical,Qe,H.get("icon-text-fit-padding"),Y,ie)),J&&(p=IC(p,J,Qe,H.get("icon-text-fit-padding"),Y,ie)));const Ue=D?N.line.getGranularityForZoomLevel(D.z):1,wt=(Lt,kt)=>{kt.x<0||kt.x>=ot||kt.y<0||kt.y>=ot||function(Pt,rr,Gr,_n,ei,go,ji,qn,Fr,In,Zn,Wn,Si,yo,Rn,Oi,xn,Ln,Dn,pn,Ar,ps,nd,fs,IN){const id=Pt.addToLineVertexArray(rr,Gr);let mu,od,sd,ad,hP=0,dP=0,pP=0,fP=0,o1=-1,s1=-1;const Na={};let mP=wi("");if(Pt.allowVerticalPlacement&&_n.vertical){const hi=qn.layout.get("text-rotate").evaluate(Ar,{},fs)+90;sd=new Dy(Fr,rr,In,Zn,Wn,_n.vertical,Si,yo,Rn,hi),ji&&(ad=new Dy(Fr,rr,In,Zn,Wn,ji,xn,Ln,Rn,hi))}if(ei){const hi=qn.layout.get("icon-rotate").evaluate(Ar,{}),vo=qn.layout.get("icon-text-fit")!=="none",gu=rP(ei,hi,nd,vo),gs=ji?rP(ji,hi,nd,vo):void 0;od=new Dy(Fr,rr,In,Zn,Wn,ei,xn,Ln,!1,hi),hP=4*gu.length;const yu=Pt.iconSizeData;let Qs=null;yu.kind==="source"?(Qs=[za*qn.layout.get("icon-size").evaluate(Ar,{})],Qs[0]>zl&&en(`${Pt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):yu.kind==="composite"&&(Qs=[za*ps.compositeIconSizes[0].evaluate(Ar,{},fs),za*ps.compositeIconSizes[1].evaluate(Ar,{},fs)],(Qs[0]>zl||Qs[1]>zl)&&en(`${Pt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Pt.addSymbols(Pt.icon,gu,Qs,pn,Dn,Ar,h.an.none,rr,id.lineStartIndex,id.lineLength,-1,fs),o1=Pt.icon.placedSymbolArray.length-1,gs&&(dP=4*gs.length,Pt.addSymbols(Pt.icon,gs,Qs,pn,Dn,Ar,h.an.vertical,rr,id.lineStartIndex,id.lineLength,-1,fs),s1=Pt.icon.placedSymbolArray.length-1)}const gP=Object.keys(_n.horizontal);for(const hi of gP){const vo=_n.horizontal[hi];if(!mu){mP=wi(vo.text);const gs=qn.layout.get("text-rotate").evaluate(Ar,{},fs);mu=new Dy(Fr,rr,In,Zn,Wn,vo,Si,yo,Rn,gs)}const gu=vo.positionedLines.length===1;if(pP+=sP(Pt,rr,vo,go,qn,Rn,Ar,Oi,id,_n.vertical?h.an.horizontal:h.an.horizontalOnly,gu?gP:[hi],Na,o1,ps,fs),gu)break}_n.vertical&&(fP+=sP(Pt,rr,_n.vertical,go,qn,Rn,Ar,Oi,id,h.an.vertical,["vertical"],Na,s1,ps,fs));const RN=mu?mu.boxStartIndex:Pt.collisionBoxArray.length,LN=mu?mu.boxEndIndex:Pt.collisionBoxArray.length,DN=sd?sd.boxStartIndex:Pt.collisionBoxArray.length,zN=sd?sd.boxEndIndex:Pt.collisionBoxArray.length,NN=od?od.boxStartIndex:Pt.collisionBoxArray.length,jN=od?od.boxEndIndex:Pt.collisionBoxArray.length,ON=ad?ad.boxStartIndex:Pt.collisionBoxArray.length,FN=ad?ad.boxEndIndex:Pt.collisionBoxArray.length;let ms=-1;const Ny=(hi,vo)=>hi&&hi.circleDiameter?Math.max(hi.circleDiameter,vo):vo;ms=Ny(mu,ms),ms=Ny(sd,ms),ms=Ny(od,ms),ms=Ny(ad,ms);const yP=ms>-1?1:0;yP&&(ms*=IN/An),Pt.glyphOffsetArray.length>=ed.MAX_GLYPHS&&en("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ar.sortKey!==void 0&&Pt.addToSortKeyRanges(Pt.symbolInstances.length,Ar.sortKey);const BN=oP(qn,Ar,fs),[$N,VN]=function(hi,vo){const gu=hi.length,gs=vo==null?void 0:vo.values;if((gs==null?void 0:gs.length)>0)for(let yu=0;yu<gs.length;yu+=2){const Qs=gs[yu+1];hi.emplaceBack(h.aD[gs[yu]],Qs[0],Qs[1])}return[gu,hi.length]}(Pt.textAnchorOffsets,BN);Pt.symbolInstances.emplaceBack(rr.x,rr.y,Na.right>=0?Na.right:-1,Na.center>=0?Na.center:-1,Na.left>=0?Na.left:-1,Na.vertical||-1,o1,s1,mP,RN,LN,DN,zN,NN,jN,ON,FN,In,pP,fP,hP,dP,yP,0,Si,ms,$N,VN)}(c,kt,Lt,l,p,g,at,c.layers[0],c.collisionBoxArray,i.index,i.sourceLayerIndex,c.index,ce,[re,re,re,re],Xe,E,ye,ve,Oe,Y,i,_,R,D,x)};if(Be==="line")for(const Lt of XC(i.geometry,0,0,ot,ot)){const kt=pu(Lt,Ue),Pt=TN(kt,W,Le,l.vertical||J,p,24,Se,c.overscaling,ot);for(const rr of Pt)J&&kN(c,J.text,it,rr)||wt(kt,rr)}else if(Be==="line-center"){for(const Lt of i.geometry)if(Lt.length>1){const kt=pu(Lt,Ue),Pt=SN(kt,Le,l.vertical||J,p,24,Se);Pt&&wt(kt,Pt)}}else if(i.type==="Polygon")for(const Lt of Sh(i.geometry,0)){const kt=PN(Lt,16);wt(pu(Lt[0],Ue,!0),new jl(kt.x,kt.y,0))}else if(i.type==="LineString")for(const Lt of i.geometry){const kt=pu(Lt,Ue);wt(kt,new jl(kt[0].x,kt[0].y,0))}else if(i.type==="Point")for(const Lt of i.geometry)for(const kt of Lt)wt([kt],new jl(kt.x,kt.y,0))}function sP(c,i,l,p,g,_,x,T,E,R,D,N,G,H,Y){const J=function(Se,ye,W,re,ve,Le,Xe,Oe){const Be=re.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,it=[];for(const Qe of ye.positionedLines)for(const at of Qe.positionedGlyphs){if(!at.rect)continue;const Ue=at.rect||{};let wt=4,Lt=!0,kt=1,Pt=0;const rr=(ve||Oe)&&at.vertical,Gr=at.metrics.advance*at.scale/2;if(Oe&&ye.verticalizable&&(Pt=Qe.lineOffset/2-(at.imageName?-(An-at.metrics.width*at.scale)/2:(at.scale-1)*An)),at.imageName){const Ln=Xe[at.imageName];Lt=Ln.sdf,kt=Ln.pixelRatio,wt=1/kt}const _n=ve?[at.x+Gr,at.y]:[0,0];let ei=ve?[0,0]:[at.x+Gr+W[0],at.y+W[1]-Pt],go=[0,0];rr&&(go=ei,ei=[0,0]);const ji=at.metrics.isDoubleResolution?2:1,qn=(at.metrics.left-wt)*at.scale-Gr+ei[0],Fr=(-at.metrics.top-wt)*at.scale+ei[1],In=qn+Ue.w/ji*at.scale/kt,Zn=Fr+Ue.h/ji*at.scale/kt,Wn=new B(qn,Fr),Si=new B(In,Fr),yo=new B(qn,Zn),Rn=new B(In,Zn);if(rr){const Ln=new B(-Gr,Gr- -17),Dn=-Math.PI/2,pn=12-Gr,Ar=new B(22-pn,-(at.imageName?pn:0)),ps=new B(...go);Wn._rotateAround(Dn,Ln)._add(Ar)._add(ps),Si._rotateAround(Dn,Ln)._add(Ar)._add(ps),yo._rotateAround(Dn,Ln)._add(Ar)._add(ps),Rn._rotateAround(Dn,Ln)._add(Ar)._add(ps)}if(Be){const Ln=Math.sin(Be),Dn=Math.cos(Be),pn=[Dn,-Ln,Ln,Dn];Wn._matMult(pn),Si._matMult(pn),yo._matMult(pn),Rn._matMult(pn)}const Oi=new B(0,0),xn=new B(0,0);it.push({tl:Wn,tr:Si,bl:yo,br:Rn,tex:Ue,writingMode:ye.writingMode,glyphOffset:_n,sectionIndex:at.sectionIndex,isSDF:Lt,pixelOffsetTL:Oi,pixelOffsetBR:xn,minFontScaleX:0,minFontScaleY:0})}return it}(0,l,T,g,_,x,p,c.allowVerticalPlacement),ie=c.textSizeData;let ce=null;ie.kind==="source"?(ce=[za*g.layout.get("text-size").evaluate(x,{})],ce[0]>zl&&en(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ie.kind==="composite"&&(ce=[za*H.compositeTextSizes[0].evaluate(x,{},Y),za*H.compositeTextSizes[1].evaluate(x,{},Y)],(ce[0]>zl||ce[1]>zl)&&en(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,J,ce,T,_,x,R,i,E.lineStartIndex,E.lineLength,G,Y);for(const Se of D)N[Se]=c.text.placedSymbolArray.length-1;return 4*J.length}function aP(c){for(const i in c)return c[i];return null}function kN(c,i,l,p){const g=c.compareText;if(i in g){const _=g[i];for(let x=_.length-1;x>=0;x--)if(p.dist(_[x])<l)return!0}else g[i]=[];return g[i].push(p),!1}const lP=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qx{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,p]=new Uint8Array(i,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=p>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const _=lP[15&p];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(i,2,1),[T]=new Uint32Array(i,4,1);return new Qx(T,x,_,i)}constructor(i,l=64,p=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=p,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const _=lP.indexOf(this.ArrayType),x=2*i*this.ArrayType.BYTES_PER_ELEMENT,T=i*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-T%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${p}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+T+E,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+x+T+E),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+T+E,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=i)}add(i,l){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=i,this.coords[this._pos++]=l,p}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Jx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,l,p,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:T}=this,E=[0,_.length-1,0],R=[];for(;E.length;){const D=E.pop()||0,N=E.pop()||0,G=E.pop()||0;if(N-G<=T){for(let ie=G;ie<=N;ie++){const ce=x[2*ie],Se=x[2*ie+1];ce>=i&&ce<=p&&Se>=l&&Se<=g&&R.push(_[ie])}continue}const H=G+N>>1,Y=x[2*H],J=x[2*H+1];Y>=i&&Y<=p&&J>=l&&J<=g&&R.push(_[H]),(D===0?i<=Y:l<=J)&&(E.push(G),E.push(H-1),E.push(1-D)),(D===0?p>=Y:g>=J)&&(E.push(H+1),E.push(N),E.push(1-D))}return R}within(i,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,T=[0,g.length-1,0],E=[],R=p*p;for(;T.length;){const D=T.pop()||0,N=T.pop()||0,G=T.pop()||0;if(N-G<=x){for(let ie=G;ie<=N;ie++)uP(_[2*ie],_[2*ie+1],i,l)<=R&&E.push(g[ie]);continue}const H=G+N>>1,Y=_[2*H],J=_[2*H+1];uP(Y,J,i,l)<=R&&E.push(g[H]),(D===0?i-p<=Y:l-p<=J)&&(T.push(G),T.push(H-1),T.push(1-D)),(D===0?i+p>=Y:l+p>=J)&&(T.push(H+1),T.push(N),T.push(1-D))}return E}}function Jx(c,i,l,p,g,_){if(g-p<=l)return;const x=p+g>>1;cP(c,i,x,p,g,_),Jx(c,i,l,p,x-1,1-_),Jx(c,i,l,x+1,g,1-_)}function cP(c,i,l,p,g,_){for(;g>p;){if(g-p>600){const R=g-p+1,D=l-p+1,N=Math.log(R),G=.5*Math.exp(2*N/3),H=.5*Math.sqrt(N*G*(R-G)/R)*(D-R/2<0?-1:1);cP(c,i,l,Math.max(p,Math.floor(l-D*G/R+H)),Math.min(g,Math.floor(l+(R-D)*G/R+H)),_)}const x=i[2*l+_];let T=p,E=g;for(zf(c,i,p,l),i[2*g+_]>x&&zf(c,i,p,g);T<E;){for(zf(c,i,T,E),T++,E--;i[2*T+_]<x;)T++;for(;i[2*E+_]>x;)E--}i[2*p+_]===x?zf(c,i,p,E):(E++,zf(c,i,E,g)),E<=l&&(p=E+1),l<=E&&(g=E-1)}}function zf(c,i,l,p){e1(c,l,p),e1(i,2*l,2*p),e1(i,2*l+1,2*p+1)}function e1(c,i,l){const p=c[i];c[i]=c[l],c[l]=p}function uP(c,i,l,p){const g=c-l,_=i-p;return g*g+_*_}var t1;h.cw=void 0,(t1=h.cw||(h.cw={})).create="create",t1.load="load",t1.fullLoad="fullLoad";let zy=null,Nf=[];const r1=1e3/60,n1="loadTime",i1="fullLoadTime",AN={mark(c){performance.mark(c)},frame(c){const i=c;zy!=null&&Nf.push(i-zy),zy=i},clearMetrics(){zy=null,Nf=[],performance.clearMeasures(n1),performance.clearMeasures(i1);for(const c in h.cw)performance.clearMarks(h.cw[c])},getPerformanceMetrics(){performance.measure(n1,h.cw.create,h.cw.load),performance.measure(i1,h.cw.create,h.cw.fullLoad);const c=performance.getEntriesByName(n1)[0].duration,i=performance.getEntriesByName(i1)[0].duration,l=Nf.length,p=1/(Nf.reduce((_,x)=>_+x,0)/l/1e3),g=Nf.filter(_=>_>r1).reduce((_,x)=>_+(x-r1)/r1,0);return{loadTime:c,fullLoadTime:i,fps:p,percentDroppedFrames:g/(l+g)*100,totalFrames:l}}};h.$=ot,h.A=xe,h.B=function([c,i,l]){return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:c*Math.cos(i)*Math.sin(l),y:c*Math.sin(i)*Math.sin(l),z:c*Math.cos(l)}},h.C=zi,h.D=St,h.E=qe,h.F=Rr,h.G=$h,h.H=function(c){if(Lo==null){const i=c.navigator?c.navigator.userAgent:null;Lo=!!c.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Lo},h.I=Fx,h.J=class{constructor(c,i){this.target=c,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new xN(()=>this.process()),this.subscription=Hr(this.target,"message",l=>this.receive(l),!1),this.globalScope=tn(self)?c:window}registerMessageHandler(c,i){this.messageHandlers[c]=i}sendAsync(c,i){return new Promise((l,p)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=i?Hr(i.signal,"abort",()=>{_==null||_.unsubscribe(),delete this.resolveRejects[g];const E={id:g,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(E)},bN):null;this.resolveRejects[g]={resolve:E=>{_==null||_.unsubscribe(),l(E)},reject:E=>{_==null||_.unsubscribe(),p(E)}};const x=[],T=Object.assign(Object.assign({},c),{id:g,sourceMapId:this.mapId,origin:location.origin,data:tu(c.data,x)});this.target.postMessage(T,{transfer:x})})}receive(c){const i=c.data,l=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[l];const p=this.abortControllers[l];return delete this.abortControllers[l],void(p&&p.abort())}if(tn(self)||i.mustQueue)return this.tasks[l]=i,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,i)}}process(){if(this.taskQueue.length===0)return;const c=this.taskQueue.shift(),i=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(c,i)}processTask(c,i){return s(this,void 0,void 0,function*(){if(i.type==="<response>"){const g=this.resolveRejects[c];return delete this.resolveRejects[c],g?void(i.error?g.reject(Il(i.error)):g.resolve(Il(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=Il(i.data),p=new AbortController;this.abortControllers[c]=p;try{const g=yield this.messageHandlers[i.type](i.sourceMapId,l,p);this.completeTask(c,null,g)}catch(g){this.completeTask(c,g)}})}completeTask(c,i,l){const p=[];delete this.abortControllers[c];const g={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?tu(i):null,data:tu(l,p)};this.target.postMessage(g,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},h.K=oe,h.L=function(){var c=new xe(16);return xe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},h.M=function(c,i,l){var p,g,_,x,T,E,R,D,N,G,H,Y,J=l[0],ie=l[1],ce=l[2];return i===c?(c[12]=i[0]*J+i[4]*ie+i[8]*ce+i[12],c[13]=i[1]*J+i[5]*ie+i[9]*ce+i[13],c[14]=i[2]*J+i[6]*ie+i[10]*ce+i[14],c[15]=i[3]*J+i[7]*ie+i[11]*ce+i[15]):(g=i[1],_=i[2],x=i[3],T=i[4],E=i[5],R=i[6],D=i[7],N=i[8],G=i[9],H=i[10],Y=i[11],c[0]=p=i[0],c[1]=g,c[2]=_,c[3]=x,c[4]=T,c[5]=E,c[6]=R,c[7]=D,c[8]=N,c[9]=G,c[10]=H,c[11]=Y,c[12]=p*J+T*ie+N*ce+i[12],c[13]=g*J+E*ie+G*ce+i[13],c[14]=_*J+R*ie+H*ce+i[14],c[15]=x*J+D*ie+Y*ce+i[15]),c},h.N=function(c,i,l){var p=l[0],g=l[1],_=l[2];return c[0]=i[0]*p,c[1]=i[1]*p,c[2]=i[2]*p,c[3]=i[3]*p,c[4]=i[4]*g,c[5]=i[5]*g,c[6]=i[6]*g,c[7]=i[7]*g,c[8]=i[8]*_,c[9]=i[9]*_,c[10]=i[10]*_,c[11]=i[11]*_,c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c},h.O=function(c,i,l){var p=i[0],g=i[1],_=i[2],x=i[3],T=i[4],E=i[5],R=i[6],D=i[7],N=i[8],G=i[9],H=i[10],Y=i[11],J=i[12],ie=i[13],ce=i[14],Se=i[15],ye=l[0],W=l[1],re=l[2],ve=l[3];return c[0]=ye*p+W*T+re*N+ve*J,c[1]=ye*g+W*E+re*G+ve*ie,c[2]=ye*_+W*R+re*H+ve*ce,c[3]=ye*x+W*D+re*Y+ve*Se,c[4]=(ye=l[4])*p+(W=l[5])*T+(re=l[6])*N+(ve=l[7])*J,c[5]=ye*g+W*E+re*G+ve*ie,c[6]=ye*_+W*R+re*H+ve*ce,c[7]=ye*x+W*D+re*Y+ve*Se,c[8]=(ye=l[8])*p+(W=l[9])*T+(re=l[10])*N+(ve=l[11])*J,c[9]=ye*g+W*E+re*G+ve*ie,c[10]=ye*_+W*R+re*H+ve*ce,c[11]=ye*x+W*D+re*Y+ve*Se,c[12]=(ye=l[12])*p+(W=l[13])*T+(re=l[14])*N+(ve=l[15])*J,c[13]=ye*g+W*E+re*G+ve*ie,c[14]=ye*_+W*R+re*H+ve*ce,c[15]=ye*x+W*D+re*Y+ve*Se,c},h.P=B,h.Q=function(c,i){const l={};for(let p=0;p<i.length;p++){const g=i[p];g in c&&(l[g]=c[g])}return l},h.R=Ni,h.S=Nl,h.T=Tx,h.U=$C,h.V=BC,h.W=U,h.X=ne,h.Y=oi,h.Z=mo,h._=s,h.a=ee,h.a$=function(c,i,l){return c[0]=i[0]*l,c[1]=i[1]*l,c[2]=i[2]*l,c[3]=i[3]*l,c},h.a0=Df,h.a1=fu,h.a2=25,h.a3=Kx,h.a4=c=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(l=>{i.onloadstart=()=>{l(i)};for(const p of c){const g=window.document.createElement("source");Re(p)||(i.crossOrigin="Anonymous"),g.src=p,i.appendChild(g)}})},h.a5=lt,h.a6=function(){return Ri++},h.a7=ae,h.a8=ed,h.a9=Vs,h.aA=An,h.aB=Et,h.aC=function(c,i,l,p,g=!1){if(!l[0]&&!l[1])return[0,0];const _=g?p==="map"?-c.bearingInRadians:0:p==="viewport"?c.bearingInRadians:0;if(_){const x=Math.sin(_),T=Math.cos(_);l=[l[0]*T-l[1]*x,l[0]*x+l[1]*T]}return[g?l[0]:Et(i,l[0],c.zoom),g?l[1]:Et(i,l[1],c.zoom)]},h.aE=Vx,h.aF=Yx,h.aG=$x,h.aH=Qx,h.aI=Ur,h.aJ=Ty,h.aK=Ae,h.aL=cr,h.aM=Cr,h.aN=Cn,h.aO=Ki,h.aP=UC,h.aQ=Ct,h.aR=He,h.aS=function(c){var i=new xe(3);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i},h.aT=function(c,i,l){return c[0]=i[0]-l[0],c[1]=i[1]-l[1],c[2]=i[2]-l[2],c},h.aU=function(c,i){var l=i[0],p=i[1],g=i[2],_=l*l+p*p+g*g;return _>0&&(_=1/Math.sqrt(_)),c[0]=i[0]*_,c[1]=i[1]*_,c[2]=i[2]*_,c},h.aV=st,h.aW=function(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]},h.aX=function(c,i,l){return c[0]=i[0]*l[0],c[1]=i[1]*l[1],c[2]=i[2]*l[2],c[3]=i[3]*l[3],c},h.aY=rt,h.aZ=function(c,i,l){const p=i[0]*l[0]+i[1]*l[1]+i[2]*l[2];return p===0?null:(-(c[0]*l[0]+c[1]*l[1]+c[2]*l[2])-l[3])/p},h.a_=tt,h.aa=hu,h.ab=WC,h.ac=function(c){const i={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,g,_)=>{const x=g||_;return i[p]=!x||x.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i},h.ad=un,h.ae=function(c){return Math.pow(2,c)},h.af=ze,h.ag=yr,h.ah=85.051129,h.ai=VC,h.aj=function(c){return Math.log(c)/Math.LN2},h.ak=function(c){var i=c[0],l=c[1];return i*i+l*l},h.al=function(c,i){const l=[];for(const p in c)p in i||l.push(p);return l},h.am=function(c,i){let l=0,p=0;if(c.kind==="constant")p=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:x}=c,T=g?yr(ai.interpolationFactor(g,i,_,x),0,1):0;c.kind==="camera"?p=zi.number(c.minSize,c.maxSize,T):l=T}return{uSizeT:l,uSize:p}},h.ao=function(c,{uSize:i,uSizeT:l},{lowerSize:p,upperSize:g}){return c.kind==="source"?p/za:c.kind==="composite"?zi.number(p/za,g/za,l):i},h.ap=function(c,i){var l=i[0],p=i[1],g=i[2],_=i[3],x=i[4],T=i[5],E=i[6],R=i[7],D=i[8],N=i[9],G=i[10],H=i[11],Y=i[12],J=i[13],ie=i[14],ce=i[15],Se=l*T-p*x,ye=l*E-g*x,W=l*R-_*x,re=p*E-g*T,ve=p*R-_*T,Le=g*R-_*E,Xe=D*J-N*Y,Oe=D*ie-G*Y,Be=D*ce-H*Y,it=N*ie-G*J,Qe=N*ce-H*J,at=G*ce-H*ie,Ue=Se*at-ye*Qe+W*it+re*Be-ve*Oe+Le*Xe;return Ue?(c[0]=(T*at-E*Qe+R*it)*(Ue=1/Ue),c[1]=(g*Qe-p*at-_*it)*Ue,c[2]=(J*Le-ie*ve+ce*re)*Ue,c[3]=(G*ve-N*Le-H*re)*Ue,c[4]=(E*Be-x*at-R*Oe)*Ue,c[5]=(l*at-g*Be+_*Oe)*Ue,c[6]=(ie*W-Y*Le-ce*ye)*Ue,c[7]=(D*Le-G*W+H*ye)*Ue,c[8]=(x*Qe-T*Be+R*Xe)*Ue,c[9]=(p*Be-l*Qe-_*Xe)*Ue,c[10]=(Y*ve-J*W+ce*Se)*Ue,c[11]=(N*W-D*ve-H*Se)*Ue,c[12]=(T*Oe-x*it-E*Xe)*Ue,c[13]=(l*it-p*Oe+g*Xe)*Ue,c[14]=(J*ye-Y*re-ie*Se)*Ue,c[15]=(D*re-N*ye+G*Se)*Ue,c):null},h.aq=Ke,h.ar=function(c){return Math.hypot(c[0],c[1])},h.as=function(c){return c[0]=0,c[1]=0,c},h.at=function(c,i,l){return c[0]=i[0]*l,c[1]=i[1]*l,c},h.au=Ux,h.av=ut,h.aw=function(c,i,l,p){const g=i.y-c.y,_=i.x-c.x,x=p.y-l.y,T=p.x-l.x,E=x*_-T*g;if(E===0)return null;const R=(T*(c.y-l.y)-x*(c.x-l.x))/E;return new B(c.x+R*_,c.y+R*g)},h.ax=XC,h.ay=DT,h.az=function(c){let i=1/0,l=1/0,p=-1/0,g=-1/0;for(const _ of c)i=Math.min(i,_.x),l=Math.min(l,_.y),p=Math.max(p,_.x),g=Math.max(g,_.y);return[i,l,p,g]},h.b=yi,h.b$=Y4,h.b0=function(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]+c[3]},h.b1=qC,h.b2=td,h.b3=function(c,i,l,p,g){var _,x=1/Math.tan(i/2);return c[0]=x/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=x,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+p)*(_=1/(p-g)),c[14]=2*g*p*_):(c[10]=-1,c[14]=-2*p),c},h.b4=function(c){var i=new xe(16);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i[3]=c[3],i[4]=c[4],i[5]=c[5],i[6]=c[6],i[7]=c[7],i[8]=c[8],i[9]=c[9],i[10]=c[10],i[11]=c[11],i[12]=c[12],i[13]=c[13],i[14]=c[14],i[15]=c[15],i},h.b5=function(c,i,l){var p=Math.sin(l),g=Math.cos(l),_=i[0],x=i[1],T=i[2],E=i[3],R=i[4],D=i[5],N=i[6],G=i[7];return i!==c&&(c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=_*g+R*p,c[1]=x*g+D*p,c[2]=T*g+N*p,c[3]=E*g+G*p,c[4]=R*g-_*p,c[5]=D*g-x*p,c[6]=N*g-T*p,c[7]=G*g-E*p,c},h.b6=function(c,i,l){var p=Math.sin(l),g=Math.cos(l),_=i[4],x=i[5],T=i[6],E=i[7],R=i[8],D=i[9],N=i[10],G=i[11];return i!==c&&(c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[4]=_*g+R*p,c[5]=x*g+D*p,c[6]=T*g+N*p,c[7]=E*g+G*p,c[8]=R*g-_*p,c[9]=D*g-x*p,c[10]=N*g-T*p,c[11]=G*g-E*p,c},h.b7=function(){const c=new Float32Array(16);return ze(c),c},h.b8=function(){const c=new Float64Array(16);return ze(c),c},h.b9=function(){return new Float64Array(16)},h.bA=function(c){return c[0]=0,c[1]=0,c[2]=0,c},h.bB=function(c,i,l,p){const g=Math.sqrt(c*c+i*i),_=Math.sqrt(l*l+p*p);c/=g,i/=g,l/=_,p/=_;const x=Math.acos(c*l+i*p);return-i*l+c*p>0?x:-x},h.bC=function(c,i){const l=Rt(c,2*Math.PI),p=Rt(i,2*Math.PI);return Math.min(Math.abs(l-p),Math.abs(l-p+2*Math.PI),Math.abs(l-p-2*Math.PI))},h.bD=function(){const c={},i=pe.$version;for(const l in pe.$root){const p=pe.$root[l];if(p.required){let g=null;g=l==="version"?i:p.type==="array"?[]:{},g!=null&&(c[l]=g)}}return c},h.bE=af,h.bF=we,h.bG=function c(i,l){if(Array.isArray(i)){if(!Array.isArray(l)||i.length!==l.length)return!1;for(let p=0;p<i.length;p++)if(!c(i[p],l[p]))return!1;return!0}if(typeof i=="object"&&i!==null&&l!==null){if(typeof l!="object"||Object.keys(i).length!==Object.keys(l).length)return!1;for(const p in i)if(!c(i[p],l[p]))return!1;return!0}return i===l},h.bH=function(c){c=c.slice();const i=Object.create(null);for(let l=0;l<c.length;l++)i[c[l].id]=c[l];for(let l=0;l<c.length;l++)"ref"in c[l]&&(c[l]=vt(c[l],i[c[l].ref]));return c},h.bI=function(c){if(c.type==="custom")return new _N(c);switch(c.type){case"background":return new gN(c);case"circle":return new u4(c);case"color-relief":return new g4(c);case"fill":return new I4(c);case"fill-extrusion":return new F4(c);case"heatmap":return new d4(c);case"hillshade":return new f4(c);case"line":return new W4(c);case"raster":return new vN(c);case"symbol":return new Ay(c)}},h.bJ=Xn,h.bK=function(c,i){if(!c)return[{command:"setStyle",args:[i]}];let l=[];try{if(!mt(c.version,i.version))return[{command:"setStyle",args:[i]}];mt(c.center,i.center)||l.push({command:"setCenter",args:[i.center]}),mt(c.state,i.state)||l.push({command:"setGlobalState",args:[i.state]}),mt(c.centerAltitude,i.centerAltitude)||l.push({command:"setCenterAltitude",args:[i.centerAltitude]}),mt(c.zoom,i.zoom)||l.push({command:"setZoom",args:[i.zoom]}),mt(c.bearing,i.bearing)||l.push({command:"setBearing",args:[i.bearing]}),mt(c.pitch,i.pitch)||l.push({command:"setPitch",args:[i.pitch]}),mt(c.roll,i.roll)||l.push({command:"setRoll",args:[i.roll]}),mt(c.sprite,i.sprite)||l.push({command:"setSprite",args:[i.sprite]}),mt(c.glyphs,i.glyphs)||l.push({command:"setGlyphs",args:[i.glyphs]}),mt(c.transition,i.transition)||l.push({command:"setTransition",args:[i.transition]}),mt(c.light,i.light)||l.push({command:"setLight",args:[i.light]}),mt(c.terrain,i.terrain)||l.push({command:"setTerrain",args:[i.terrain]}),mt(c.sky,i.sky)||l.push({command:"setSky",args:[i.sky]}),mt(c.projection,i.projection)||l.push({command:"setProjection",args:[i.projection]});const p={},g=[];(function(x,T,E,R){let D;for(D in T=T||{},x=x||{})Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(T,D)||ur(D,E,R));for(D in T)Object.prototype.hasOwnProperty.call(T,D)&&(Object.prototype.hasOwnProperty.call(x,D)?mt(x[D],T[D])||(x[D].type==="geojson"&&T[D].type==="geojson"&&Gt(x,T,D)?xt(E,{command:"setGeoJSONSourceData",args:[D,T[D].data]}):Ut(D,T,E,R)):At(D,T,E))})(c.sources,i.sources,g,p);const _=[];c.layers&&c.layers.forEach(x=>{"source"in x&&p[x.source]?l.push({command:"removeLayer",args:[x.id]}):_.push(x)}),l=l.concat(g),function(x,T,E){T=T||[];const R=(x=x||[]).map(ir),D=T.map(ir),N=x.reduce(Pn,{}),G=T.reduce(Pn,{}),H=R.slice(),Y=Object.create(null);let J,ie,ce,Se,ye;for(let W=0,re=0;W<R.length;W++)J=R[W],Object.prototype.hasOwnProperty.call(G,J)?re++:(xt(E,{command:"removeLayer",args:[J]}),H.splice(H.indexOf(J,re),1));for(let W=0,re=0;W<D.length;W++)J=D[D.length-1-W],H[H.length-1-W]!==J&&(Object.prototype.hasOwnProperty.call(N,J)?(xt(E,{command:"removeLayer",args:[J]}),H.splice(H.lastIndexOf(J,H.length-re),1)):re++,Se=H[H.length-W],xt(E,{command:"addLayer",args:[G[J],Se]}),H.splice(H.length-W,0,J),Y[J]=!0);for(let W=0;W<D.length;W++)if(J=D[W],ie=N[J],ce=G[J],!Y[J]&&!mt(ie,ce))if(mt(ie.source,ce.source)&&mt(ie["source-layer"],ce["source-layer"])&&mt(ie.type,ce.type)){for(ye in Nt(ie.layout,ce.layout,E,J,null,"setLayoutProperty"),Nt(ie.paint,ce.paint,E,J,null,"setPaintProperty"),mt(ie.filter,ce.filter)||xt(E,{command:"setFilter",args:[J,ce.filter]}),mt(ie.minzoom,ce.minzoom)&&mt(ie.maxzoom,ce.maxzoom)||xt(E,{command:"setLayerZoomRange",args:[J,ce.minzoom,ce.maxzoom]}),ie)Object.prototype.hasOwnProperty.call(ie,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?Nt(ie[ye],ce[ye],E,J,ye.slice(6),"setPaintProperty"):mt(ie[ye],ce[ye])||xt(E,{command:"setLayerProperty",args:[J,ye,ce[ye]]}));for(ye in ce)Object.prototype.hasOwnProperty.call(ce,ye)&&!Object.prototype.hasOwnProperty.call(ie,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?Nt(ie[ye],ce[ye],E,J,ye.slice(6),"setPaintProperty"):mt(ie[ye],ce[ye])||xt(E,{command:"setLayerProperty",args:[J,ye,ce[ye]]}))}else xt(E,{command:"removeLayer",args:[J]}),Se=H[H.lastIndexOf(J)+1],xt(E,{command:"addLayer",args:[ce,Se]})}(_,i.layers,l)}catch(p){console.warn("Unable to compute style diff:",p),l=[{command:"setStyle",args:[i]}]}return l},h.bL=function(c){const i=[],l=c.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},h.bM=vr,h.bN=ii,h.bO=class extends kr{constructor(c,i){super(c,i),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},h.bP=_y,h.bQ=class extends kr{constructor(c,i){super(c,i),this.current=yx}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let i=1;i<16;i++)if(c[i]!==this.current[i]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},h.bR=vn,h.bS=class extends kr{constructor(c,i){super(c,i),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},h.bT=class extends kr{constructor(c,i){super(c,i),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},h.bU=ke,h.bV=function(c,i){var l=Math.sin(i),p=Math.cos(i);return c[0]=p,c[1]=l,c[2]=0,c[3]=-l,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},h.bW=function(c,i,l){var p=i[0],g=i[1],_=i[2];return c[0]=p*l[0]+g*l[3]+_*l[6],c[1]=p*l[1]+g*l[4]+_*l[7],c[2]=p*l[2]+g*l[5]+_*l[8],c},h.bX=function(c,i,l,p,g,_,x){var T=1/(i-l),E=1/(p-g),R=1/(_-x);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*E,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*R,c[11]=0,c[12]=(i+l)*T,c[13]=(g+p)*E,c[14]=(x+_)*R,c[15]=1,c},h.bY=class extends kr{constructor(c,i){super(c,i),this.current=new Array}set(c){if(c!=this.current){this.current=c;const i=new Float32Array(4*c.length);for(let l=0;l<c.length;l++)i[4*l]=c[l].r,i[4*l+1]=c[l].g,i[4*l+2]=c[l].b,i[4*l+3]=c[l].a;this.gl.uniform4fv(this.location,i)}}},h.bZ=class extends kr{constructor(c,i){super(c,i),this.current=new Array}set(c){if(c!=this.current){this.current=c;const i=new Float32Array(c);this.gl.uniform1fv(this.location,i)}}},h.b_=class extends f{},h.ba=function(c,i,l){const p=new Float64Array(4);return De(p,c,i-90,l),p},h.bb=function(c,i,l,p){var g,_,x,T,E,R=i[0],D=i[1],N=i[2],G=i[3],H=l[0],Y=l[1],J=l[2],ie=l[3];return(_=R*H+D*Y+N*J+G*ie)<0&&(_=-_,H=-H,Y=-Y,J=-J,ie=-ie),1-_>de?(g=Math.acos(_),x=Math.sin(g),T=Math.sin((1-p)*g)/x,E=Math.sin(p*g)/x):(T=1-p,E=p),c[0]=T*R+E*H,c[1]=T*D+E*Y,c[2]=T*N+E*J,c[3]=T*G+E*ie,c},h.bc=function(c){const i=new Float64Array(9);var l,p,g,_,x,T,E,R,D,N,G,H,Y,J,ie,ce,Se,ye;N=(g=(p=c)[0])*(E=g+g),G=(_=p[1])*E,Y=(x=p[2])*E,J=x*(R=_+_),ce=(T=p[3])*E,Se=T*R,ye=T*(D=x+x),(l=i)[0]=1-(H=_*R)-(ie=x*D),l[3]=G-ye,l[6]=Y+Se,l[1]=G+ye,l[4]=1-N-ie,l[7]=J-ce,l[2]=Y-Se,l[5]=J+ce,l[8]=1-N-H;const W=Ki(-Math.asin(yr(i[2],-1,1)));let re,ve;return Math.hypot(i[5],i[8])<.001?(re=0,ve=-Ki(Math.atan2(i[3],i[4]))):(re=Ki(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),ve=Ki(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:re,pitch:W+90,bearing:ve}},h.bd=function(c,i){return c.roll==i.roll&&c.pitch==i.pitch&&c.bearing==i.bearing},h.be=Qt,h.bf=ui,h.bg=Qh,h.bh=Ef,h.bi=Yh,h.bj=lr,h.bk=gr,h.bl=Ot,h.bm=function(c,i,l,p,g){return lr(p,g,yr((c-i)/(l-i),0,1))},h.bn=Rt,h.bo=function(){return new Float64Array(3)},h.bp=function(c,i,l,p){return c[0]=i[0]+l[0]*p,c[1]=i[1]+l[1]*p,c[2]=i[2]+l[2]*p,c},h.bq=De,h.br=function(c,i,l){var p=l[0],g=l[1],_=l[2],x=i[0],T=i[1],E=i[2],R=g*E-_*T,D=_*x-p*E,N=p*T-g*x,G=g*N-_*D,H=_*R-p*N,Y=p*D-g*R,J=2*l[3];return D*=J,N*=J,H*=2,Y*=2,c[0]=x+(R*=J)+(G*=2),c[1]=T+D+H,c[2]=E+N+Y,c},h.bs=function(c,i,l){const p=(g=[c[0],c[1],c[2],i[0],i[1],i[2],l[0],l[1],l[2]])[0]*((D=g[8])*(x=g[4])-(T=g[5])*(R=g[7]))+g[1]*(-D*(_=g[3])+T*(E=g[6]))+g[2]*(R*_-x*E);var g,_,x,T,E,R,D;if(p===0)return null;const N=st([],[i[0],i[1],i[2]],[l[0],l[1],l[2]]),G=st([],[l[0],l[1],l[2]],[c[0],c[1],c[2]]),H=st([],[c[0],c[1],c[2]],[i[0],i[1],i[2]]),Y=Ct([],N,-c[3]);return He(Y,Y,Ct([],G,-i[3])),He(Y,Y,Ct([],H,-l[3])),Ct(Y,Y,1/p),Y},h.bt=Wx,h.bu=function(){return new Float64Array(4)},h.bv=function(c,i,l,p){var g=[],_=[];return g[0]=i[0]-l[0],g[1]=i[1]-l[1],g[2]=i[2]-l[2],_[0]=g[0]*Math.cos(p)-g[1]*Math.sin(p),_[1]=g[0]*Math.sin(p)+g[1]*Math.cos(p),_[2]=g[2],c[0]=_[0]+l[0],c[1]=_[1]+l[1],c[2]=_[2]+l[2],c},h.bw=function(c,i,l,p){var g=[],_=[];return g[0]=i[0]-l[0],g[1]=i[1]-l[1],g[2]=i[2]-l[2],_[0]=g[0],_[1]=g[1]*Math.cos(p)-g[2]*Math.sin(p),_[2]=g[1]*Math.sin(p)+g[2]*Math.cos(p),c[0]=_[0]+l[0],c[1]=_[1]+l[1],c[2]=_[2]+l[2],c},h.bx=function(c,i,l,p){var g=[],_=[];return g[0]=i[0]-l[0],g[1]=i[1]-l[1],g[2]=i[2]-l[2],_[0]=g[2]*Math.sin(p)+g[0]*Math.cos(p),_[1]=g[1],_[2]=g[2]*Math.cos(p)-g[0]*Math.sin(p),c[0]=_[0]+l[0],c[1]=_[1]+l[1],c[2]=_[2]+l[2],c},h.by=function(c,i,l){var p=Math.sin(l),g=Math.cos(l),_=i[0],x=i[1],T=i[2],E=i[3],R=i[8],D=i[9],N=i[10],G=i[11];return i!==c&&(c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=_*g-R*p,c[1]=x*g-D*p,c[2]=T*g-N*p,c[3]=E*g-G*p,c[8]=_*p+R*g,c[9]=x*p+D*g,c[10]=T*p+N*g,c[11]=E*p+G*g,c},h.bz=function(c,i){const l=Rt(c,360),p=Rt(i,360),g=p-l,_=p>l?g-360:g+360;return Math.abs(g)<Math.abs(_)?g:_},h.c=Ee,h.c0=class extends v{},h.c1=Sx,h.c2=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},h.c3=GT,h.c4=function(c,i,l){var p=i[0],g=i[1],_=i[2],x=l[3]*p+l[7]*g+l[11]*_+l[15];return c[0]=(l[0]*p+l[4]*g+l[8]*_+l[12])/(x=x||1),c[1]=(l[1]*p+l[5]*g+l[9]*_+l[13])/x,c[2]=(l[2]*p+l[6]*g+l[10]*_+l[14])/x,c},h.c5=class extends ff{},h.c6=class extends O{},h.c7=function(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]&&c[3]===i[3]&&c[4]===i[4]&&c[5]===i[5]&&c[6]===i[6]&&c[7]===i[7]&&c[8]===i[8]&&c[9]===i[9]&&c[10]===i[10]&&c[11]===i[11]&&c[12]===i[12]&&c[13]===i[13]&&c[14]===i[14]&&c[15]===i[15]},h.c8=function(c,i){var l=c[0],p=c[1],g=c[2],_=c[3],x=c[4],T=c[5],E=c[6],R=c[7],D=c[8],N=c[9],G=c[10],H=c[11],Y=c[12],J=c[13],ie=c[14],ce=c[15],Se=i[0],ye=i[1],W=i[2],re=i[3],ve=i[4],Le=i[5],Xe=i[6],Oe=i[7],Be=i[8],it=i[9],Qe=i[10],at=i[11],Ue=i[12],wt=i[13],Lt=i[14],kt=i[15];return Math.abs(l-Se)<=de*Math.max(1,Math.abs(l),Math.abs(Se))&&Math.abs(p-ye)<=de*Math.max(1,Math.abs(p),Math.abs(ye))&&Math.abs(g-W)<=de*Math.max(1,Math.abs(g),Math.abs(W))&&Math.abs(_-re)<=de*Math.max(1,Math.abs(_),Math.abs(re))&&Math.abs(x-ve)<=de*Math.max(1,Math.abs(x),Math.abs(ve))&&Math.abs(T-Le)<=de*Math.max(1,Math.abs(T),Math.abs(Le))&&Math.abs(E-Xe)<=de*Math.max(1,Math.abs(E),Math.abs(Xe))&&Math.abs(R-Oe)<=de*Math.max(1,Math.abs(R),Math.abs(Oe))&&Math.abs(D-Be)<=de*Math.max(1,Math.abs(D),Math.abs(Be))&&Math.abs(N-it)<=de*Math.max(1,Math.abs(N),Math.abs(it))&&Math.abs(G-Qe)<=de*Math.max(1,Math.abs(G),Math.abs(Qe))&&Math.abs(H-at)<=de*Math.max(1,Math.abs(H),Math.abs(at))&&Math.abs(Y-Ue)<=de*Math.max(1,Math.abs(Y),Math.abs(Ue))&&Math.abs(J-wt)<=de*Math.max(1,Math.abs(J),Math.abs(wt))&&Math.abs(ie-Lt)<=de*Math.max(1,Math.abs(ie),Math.abs(Lt))&&Math.abs(ce-kt)<=de*Math.max(1,Math.abs(ce),Math.abs(kt))},h.c9=function(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c},h.cA=function(c){delete ee.REGISTERED_PROTOCOLS[c]},h.cB=function(c,i){const l={};for(let g=0;g<c.length;g++){const _=i&&i[c[g].id]||Nh(c[g]);i&&(i[c[g].id]=_);let x=l[_];x||(x=l[_]=[]),x.push(c[g])}const p=[];for(const g in l)p.push(l[g]);return p},h.cC=_t,h.cD=ZC,h.cE=HC,h.cF=TC,h.cG=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=ot/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const i=c.bucket.layers[0],l=i.layout,p=i._unevaluatedLayout._values,g={layoutIconSize:p["icon-size"].possiblyEvaluate(new Rr(c.bucket.zoom+1),c.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Rr(c.bucket.zoom+1),c.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Rr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:R,maxZoom:D}=c.bucket.textSizeData;g.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Rr(R),c.canonical),p["text-size"].possiblyEvaluate(new Rr(D),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:R,maxZoom:D}=c.bucket.iconSizeData;g.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Rr(R),c.canonical),p["icon-size"].possiblyEvaluate(new Rr(D),c.canonical)]}const _=l.get("text-line-height")*An,x=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",T=l.get("text-keep-upright"),E=l.get("text-size");for(const R of c.bucket.features){const D=l.get("text-font").evaluate(R,{},c.canonical).join(","),N=E.evaluate(R,{},c.canonical),G=g.layoutTextSize.evaluate(R,{},c.canonical),H=g.layoutIconSize.evaluate(R,{},c.canonical),Y={horizontal:{},vertical:void 0},J=R.text;let ie,ce=[0,0];if(J){const W=J.toString(),re=l.get("text-letter-spacing").evaluate(R,{},c.canonical)*An,ve=dy(W)?re:0,Le=l.get("text-anchor").evaluate(R,{},c.canonical),Xe=oP(i,R,c.canonical);if(!Xe){const Qe=l.get("text-radial-offset").evaluate(R,{},c.canonical);ce=Qe?iP(Le,[Qe*An,Xx]):l.get("text-offset").evaluate(R,{},c.canonical).map(at=>at*An)}let Oe=x?"center":l.get("text-justify").evaluate(R,{},c.canonical);const Be=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(R,{},c.canonical)*An:1/0,it=()=>{c.bucket.allowVerticalPlacement&&lf(W)&&(Y.vertical=Ey(J,c.glyphMap,c.glyphPositions,c.imagePositions,D,Be,_,Le,"left",ve,ce,h.an.vertical,!0,G,N))};if(!x&&Xe){const Qe=new Set;if(Oe==="auto")for(let Ue=0;Ue<Xe.values.length;Ue+=2)Qe.add(Yx(Xe.values[Ue]));else Qe.add(Oe);let at=!1;for(const Ue of Qe)if(!Y.horizontal[Ue])if(at)Y.horizontal[Ue]=Y.horizontal[0];else{const wt=Ey(J,c.glyphMap,c.glyphPositions,c.imagePositions,D,Be,_,"center",Ue,ve,ce,h.an.horizontal,!1,G,N);wt&&(Y.horizontal[Ue]=wt,at=wt.positionedLines.length===1)}it()}else{Oe==="auto"&&(Oe=Yx(Le));const Qe=Ey(J,c.glyphMap,c.glyphPositions,c.imagePositions,D,Be,_,Le,Oe,ve,ce,h.an.horizontal,!1,G,N);Qe&&(Y.horizontal[Oe]=Qe),it(),lf(W)&&x&&T&&(Y.vertical=Ey(J,c.glyphMap,c.glyphPositions,c.imagePositions,D,Be,_,Le,Oe,ve,ce,h.an.vertical,!1,G,N))}}let Se=!1;if(R.icon&&R.icon.name){const W=c.imageMap[R.icon.name];W&&(ie=hN(c.imagePositions[R.icon.name],l.get("icon-offset").evaluate(R,{},c.canonical),l.get("icon-anchor").evaluate(R,{},c.canonical)),Se=!!W.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Se:c.bucket.sdfIcons!==Se&&en("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(W.pixelRatio!==c.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const ye=aP(Y.horizontal)||Y.vertical;c.bucket.iconsInText=!!ye&&ye.iconsInText,(ye||ie)&&MN(c.bucket,R,Y,ie,c.imageMap,g,G,H,ce,Se,c.canonical,c.subdivisionGranularity)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},h.cH=zx,h.cI=kx,h.cJ=Dx,h.cK=kf,h.cL=Ox,h.cM=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},h.cN=function(c,i,l,p,g){return s(this,void 0,void 0,function*(){if(ne())try{return yield oi(c,i,l,p,g)}catch{}return function(_,x,T,E,R){const D=_.width,N=_.height;lo&&ns||(lo=new OffscreenCanvas(D,N),ns=lo.getContext("2d",{willReadFrequently:!0})),lo.width=D,lo.height=N,ns.drawImage(_,0,0,D,N);const G=ns.getImageData(x,T,E,R);return ns.clearRect(0,0,D,N),G.data}(c,i,l,p,g)})},h.cO=WT,h.cP=b,h.cQ=k,h.cR=uC,h.cS=wC,h.cT=Rh,h.cU=Gs,h.ca=c=>c.type==="symbol",h.cb=c=>c.type==="circle",h.cc=c=>c.type==="heatmap",h.cd=c=>c.type==="line",h.ce=c=>c.type==="fill",h.cf=c=>c.type==="fill-extrusion",h.cg=c=>c.type==="hillshade",h.ch=c=>c.type==="color-relief",h.ci=c=>c.type==="raster",h.cj=c=>c.type==="background",h.ck=c=>c.type==="custom",h.cl=Xt,h.cm=function(c,i,l){const p=nt(i.x-l.x,i.y-l.y),g=nt(c.x-l.x,c.y-l.y);var _,x;return Ki(Math.atan2(p[0]*g[1]-p[1]*g[0],(_=p)[0]*(x=g)[0]+_[1]*x[1]))},h.cn=Ii,h.co=function(c,i){return is[i]&&(c instanceof MouseEvent||c instanceof WheelEvent)},h.cp=function(c,i){return xa[i]&&"touches"in c},h.cq=function(c){return xa[c]||is[c]},h.cr=function(c,i,l){var p=i[0],g=i[1];return c[0]=l[0]*p+l[4]*g+l[12],c[1]=l[1]*p+l[5]*g+l[13],c},h.cs=function(c,i){const{x:l,y:p}=Df.fromLngLat(i);return!(c<0||c>25||p<0||p>=1||l<0||l>=1)},h.ct=function(c,i){return c[0]=i[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=i[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=i[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},h.cu=class extends Zs{},h.cv=AN,h.cx=function(c){return c.message===co},h.cy=fe,h.cz=function(c,i){ee.REGISTERED_PROTOCOLS[c]=i},h.d=Re,h.e=br,h.f=c=>s(void 0,void 0,void 0,function*(){if(c.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(i)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),h.g=te,h.h=c=>new Promise((i,l)=>{const p=new Image;p.onload=()=>{i(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=Os})},p.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(c)],{type:"image/png"});p.src=c.byteLength?URL.createObjectURL(g):Os}),h.i=tn,h.j=(c,i)=>Pe(br(c,{type:"json"}),i),h.k=Me,h.l=Fe,h.m=Pe,h.n=(c,i)=>Pe(br(c,{type:"arrayBuffer"}),i),h.o=function(c){return new Ox(c).readFields(eN,[])},h.p=SC,h.q=wf,h.r=ci,h.s=Hr,h.t=df,h.u=er,h.v=pe,h.w=en,h.x=hx,h.y=Jc,h.z=kl}),u("worker",["./shared"],function(h){class s{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,te){for(const fe of ee){this._layerConfigs[fe.id]=fe;const we=this._layers[fe.id]=h.bI(fe);we._featureFilter=h.a9(we.filter),this.keyCache[fe.id]&&delete this.keyCache[fe.id]}for(const fe of te)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const oe=h.cB(Object.values(this._layerConfigs),this.keyCache);for(const fe of oe){const we=fe.map(Me=>this._layers[Me.id]),Pe=we[0];if(Pe.visibility==="none")continue;const Re=Pe.source||"";let Te=this.familiesBySource[Re];Te||(Te=this.familiesBySource[Re]={});const $e=Pe.sourceLayer||"_geojsonTileLayer";let Fe=Te[$e];Fe||(Fe=Te[$e]=[]),Fe.push(we)}}}class b{constructor(ee){const te={},oe=[];for(const Re in ee){const Te=ee[Re],$e=te[Re]={};for(const Fe in Te){const Me=Te[+Fe];if(!Me||Me.bitmap.width===0||Me.bitmap.height===0)continue;const qe={x:0,y:0,w:Me.bitmap.width+2,h:Me.bitmap.height+2};oe.push(qe),$e[Fe]={rect:qe,metrics:Me.metrics}}}const{w:fe,h:we}=h.p(oe),Pe=new h.q({width:fe||1,height:we||1});for(const Re in ee){const Te=ee[Re];for(const $e in Te){const Fe=Te[+$e];if(!Fe||Fe.bitmap.width===0||Fe.bitmap.height===0)continue;const Me=te[Re][$e].rect;h.q.copy(Fe.bitmap,Pe,{x:0,y:0},{x:Me.x+1,y:Me.y+1},Fe.bitmap)}}this.image=Pe,this.positions=te}}h.cC("GlyphAtlas",b);class w{constructor(ee){this.tileID=new h.Z(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[],this.globalState=ee.globalState}parse(ee,te,oe,fe,we){return h._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new h.a7;const Pe=new h.cD(Object.keys(ee.layers).sort()),Re=new h.cE(this.tileID,this.promoteId);Re.bucketLayerIDs=[];const Te={},$e={featureIndex:Re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe,subdivisionGranularity:we},Fe=te.familiesBySource[this.source];for(const Nt in Fe){const ir=ee.layers[Nt];if(!ir)continue;ir.version===1&&h.w(`Vector tile source "${this.source}" layer "${Nt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pn=Pe.encode(Nt),lt=[];for(let Bn=0;Bn<ir.length;Bn++){const Lr=ir.feature(Bn),Fs=Re.getId(Lr,Nt);lt.push({feature:Lr,id:Fs,index:Bn,sourceLayerIndex:Pn})}for(const Bn of Fe[Nt]){const Lr=Bn[0];Lr.source!==this.source&&h.w(`layer.source = ${Lr.source} does not equal this.source = ${this.source}`),Lr.minzoom&&this.zoom<Math.floor(Lr.minzoom)||Lr.maxzoom&&this.zoom>=Lr.maxzoom||Lr.visibility!=="none"&&(C(Bn,this.zoom,oe),(Te[Lr.id]=Lr.createBucket({index:Re.bucketLayerIDs.length,layers:Bn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pn,sourceID:this.source,globalState:this.globalState})).populate(lt,$e,this.tileID.canonical),Re.bucketLayerIDs.push(Bn.map(Fs=>Fs.id)))}}const Me=h.bM($e.glyphDependencies,Nt=>Object.keys(Nt).map(Number));this.inFlightDependencies.forEach(Nt=>Nt==null?void 0:Nt.abort()),this.inFlightDependencies=[];let qe=Promise.resolve({});if(Object.keys(Me).length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),qe=fe.sendAsync({type:"GG",data:{stacks:Me,source:this.source,tileID:this.tileID,type:"glyphs"}},Nt)}const pe=Object.keys($e.iconDependencies);let Je=Promise.resolve({});if(pe.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),Je=fe.sendAsync({type:"GI",data:{icons:pe,source:this.source,tileID:this.tileID,type:"icons"}},Nt)}const vt=Object.keys($e.patternDependencies);let mt=Promise.resolve({});if(vt.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),mt=fe.sendAsync({type:"GI",data:{icons:vt,source:this.source,tileID:this.tileID,type:"patterns"}},Nt)}const[xt,At,ur]=yield Promise.all([qe,Je,mt]),Ut=new b(xt),Gt=new h.cF(At,ur);for(const Nt in Te){const ir=Te[Nt];ir instanceof h.a8?(C(ir.layers,this.zoom,oe),h.cG({bucket:ir,glyphMap:xt,glyphPositions:Ut.positions,imageMap:At,imagePositions:Gt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:$e.subdivisionGranularity})):ir.hasPattern&&(ir instanceof h.cH||ir instanceof h.cI||ir instanceof h.cJ)&&(C(ir.layers,this.zoom,oe),ir.addFeatures($e,this.tileID.canonical,Gt.patternPositions))}return this.status="done",{buckets:Object.values(Te).filter(Nt=>!Nt.isEmpty()),featureIndex:Re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ut.image,imageAtlas:Gt,glyphMap:this.returnDependencies?xt:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?Ut.positions:null}})}}function C(Ee,ee,te){const oe=new h.F(ee);for(const fe of Ee)fe.recalculate(oe,te)}class k{constructor(ee,te,oe){this.actor=ee,this.layerIndex=te,this.availableImages=oe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,te){return h._(this,void 0,void 0,function*(){const oe=yield h.n(ee.request,te);try{return{vectorTile:new h.cK.VectorTile(new h.cL(oe.data)),rawData:oe.data,cacheControl:oe.cacheControl,expires:oe.expires}}catch(fe){const we=new Uint8Array(oe.data);let Pe=`Unable to parse the tile at ${ee.request.url}, `;throw Pe+=we[0]===31&&we[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(Pe)}})}loadTile(ee){return h._(this,void 0,void 0,function*(){const te=ee.uid,oe=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new h.cM(ee.request),fe=new w(ee);this.loading[te]=fe;const we=new AbortController;fe.abort=we;try{const Pe=yield this.loadVectorTile(ee,we);if(delete this.loading[te],!Pe)return null;const Re=Pe.rawData,Te={};Pe.expires&&(Te.expires=Pe.expires),Pe.cacheControl&&(Te.cacheControl=Pe.cacheControl);const $e={};if(oe){const Me=oe.finish();Me&&($e.resourceTiming=JSON.parse(JSON.stringify(Me)))}fe.vectorTile=Pe.vectorTile;const Fe=fe.parse(Pe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[te]=fe,this.fetching[te]={rawTileData:Re,cacheControl:Te,resourceTiming:$e};try{const Me=yield Fe;return h.e({rawTileData:Re.slice(0)},Me,Te,$e)}finally{delete this.fetching[te]}}catch(Pe){throw delete this.loading[te],fe.status="done",this.loaded[te]=fe,Pe}})}reloadTile(ee){return h._(this,void 0,void 0,function*(){const te=ee.uid;if(!this.loaded||!this.loaded[te])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const oe=this.loaded[te];if(oe.showCollisionBoxes=ee.showCollisionBoxes,oe.globalState=ee.globalState,oe.status==="parsing"){const fe=yield oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let we;if(this.fetching[te]){const{rawTileData:Pe,cacheControl:Re,resourceTiming:Te}=this.fetching[te];delete this.fetching[te],we=h.e({rawTileData:Pe.slice(0)},fe,Re,Te)}else we=fe;return we}if(oe.status==="done"&&oe.vectorTile)return oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return h._(this,void 0,void 0,function*(){const te=this.loading,oe=ee.uid;te&&te[oe]&&te[oe].abort&&(te[oe].abort.abort(),delete te[oe])})}removeTile(ee){return h._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class I{constructor(){this.loaded={}}loadTile(ee){return h._(this,void 0,void 0,function*(){const{uid:te,encoding:oe,rawImageData:fe,redFactor:we,greenFactor:Pe,blueFactor:Re,baseShift:Te}=ee,$e=fe.width+2,Fe=fe.height+2,Me=h.b(fe)?new h.R({width:$e,height:Fe},yield h.cN(fe,-1,-1,$e,Fe)):fe,qe=new h.cO(te,Me,oe,we,Pe,Re,Te);return this.loaded=this.loaded||{},this.loaded[te]=qe,qe})}removeTile(ee){const te=this.loaded,oe=ee.uid;te&&te[oe]&&delete te[oe]}}var A,B,F=function(){if(B)return A;function Ee(te,oe){if(te.length!==0){ee(te[0],oe);for(var fe=1;fe<te.length;fe++)ee(te[fe],!oe)}}function ee(te,oe){for(var fe=0,we=0,Pe=0,Re=te.length,Te=Re-1;Pe<Re;Te=Pe++){var $e=(te[Pe][0]-te[Te][0])*(te[Te][1]+te[Pe][1]),Fe=fe+$e;we+=Math.abs(fe)>=Math.abs($e)?fe-Fe+$e:$e-Fe+fe,fe=Fe}fe+we>=0!=!!oe&&te.reverse()}return B=1,A=function te(oe,fe){var we,Pe=oe&&oe.type;if(Pe==="FeatureCollection")for(we=0;we<oe.features.length;we++)te(oe.features[we],fe);else if(Pe==="GeometryCollection")for(we=0;we<oe.geometries.length;we++)te(oe.geometries[we],fe);else if(Pe==="Feature")te(oe.geometry,fe);else if(Pe==="Polygon")Ee(oe.coordinates,fe);else if(Pe==="MultiPolygon")for(we=0;we<oe.coordinates.length;we++)Ee(oe.coordinates[we],fe);return oe}}(),X=h.cP(F);const q=h.cK.VectorTileFeature.prototype.toGeoJSON;class V{constructor(ee){this._feature=ee,this.extent=h.$,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const te of this._feature.geometry)ee.push([new h.P(te[0],te[1])]);return ee}{const ee=[];for(const te of this._feature.geometry){const oe=[];for(const fe of te)oe.push(new h.P(fe[0],fe[1]));ee.push(oe)}return ee}}toGeoJSON(ee,te,oe){return q.call(this,ee,te,oe)}}class U{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.$,this.length=ee.length,this._features=ee}feature(ee){return new V(this._features[ee])}}var ne,de,xe,ke={exports:{}},ze=function(){if(xe)return ke.exports;xe=1;var Ee=h.cS(),ee=function(){if(de)return ne;de=1;var Fe=h.cQ(),Me=h.cR().VectorTileFeature;function qe(Je,vt){this.options=vt||{},this.features=Je,this.length=Je.length}function pe(Je,vt){this.id=typeof Je.id=="number"?Je.id:void 0,this.type=Je.type,this.rawGeometry=Je.type===1?[Je.geometry]:Je.geometry,this.properties=Je.tags,this.extent=vt||4096}return ne=qe,qe.prototype.feature=function(Je){return new pe(this.features[Je],this.options.extent)},pe.prototype.loadGeometry=function(){var Je=this.rawGeometry;this.geometry=[];for(var vt=0;vt<Je.length;vt++){for(var mt=Je[vt],xt=[],At=0;At<mt.length;At++)xt.push(new Fe(mt[At][0],mt[At][1]));this.geometry.push(xt)}return this.geometry},pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Je=this.geometry,vt=1/0,mt=-1/0,xt=1/0,At=-1/0,ur=0;ur<Je.length;ur++)for(var Ut=Je[ur],Gt=0;Gt<Ut.length;Gt++){var Nt=Ut[Gt];vt=Math.min(vt,Nt.x),mt=Math.max(mt,Nt.x),xt=Math.min(xt,Nt.y),At=Math.max(At,Nt.y)}return[vt,xt,mt,At]},pe.prototype.toGeoJSON=Me.prototype.toGeoJSON,ne}();function te(Fe){var Me=new Ee;return function(qe,pe){for(var Je in qe.layers)pe.writeMessage(3,oe,qe.layers[Je])}(Fe,Me),Me.finish()}function oe(Fe,Me){var qe;Me.writeVarintField(15,Fe.version||1),Me.writeStringField(1,Fe.name||""),Me.writeVarintField(5,Fe.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(qe=0;qe<Fe.length;qe++)pe.feature=Fe.feature(qe),Me.writeMessage(2,fe,pe);var Je=pe.keys;for(qe=0;qe<Je.length;qe++)Me.writeStringField(3,Je[qe]);var vt=pe.values;for(qe=0;qe<vt.length;qe++)Me.writeMessage(4,$e,vt[qe])}function fe(Fe,Me){var qe=Fe.feature;qe.id!==void 0&&Me.writeVarintField(1,qe.id),Me.writeMessage(2,we,Fe),Me.writeVarintField(3,qe.type),Me.writeMessage(4,Te,qe)}function we(Fe,Me){var qe=Fe.feature,pe=Fe.keys,Je=Fe.values,vt=Fe.keycache,mt=Fe.valuecache;for(var xt in qe.properties){var At=qe.properties[xt],ur=vt[xt];if(At!==null){ur===void 0&&(pe.push(xt),vt[xt]=ur=pe.length-1),Me.writeVarint(ur);var Ut=typeof At;Ut!=="string"&&Ut!=="boolean"&&Ut!=="number"&&(At=JSON.stringify(At));var Gt=Ut+":"+At,Nt=mt[Gt];Nt===void 0&&(Je.push(At),mt[Gt]=Nt=Je.length-1),Me.writeVarint(Nt)}}}function Pe(Fe,Me){return(Me<<3)+(7&Fe)}function Re(Fe){return Fe<<1^Fe>>31}function Te(Fe,Me){for(var qe=Fe.loadGeometry(),pe=Fe.type,Je=0,vt=0,mt=qe.length,xt=0;xt<mt;xt++){var At=qe[xt],ur=1;pe===1&&(ur=At.length),Me.writeVarint(Pe(1,ur));for(var Ut=pe===3?At.length-1:At.length,Gt=0;Gt<Ut;Gt++){Gt===1&&pe!==1&&Me.writeVarint(Pe(2,Ut-1));var Nt=At[Gt].x-Je,ir=At[Gt].y-vt;Me.writeVarint(Re(Nt)),Me.writeVarint(Re(ir)),Je+=Nt,vt+=ir}pe===3&&Me.writeVarint(Pe(7,1))}}function $e(Fe,Me){var qe=typeof Fe;qe==="string"?Me.writeStringField(1,Fe):qe==="boolean"?Me.writeBooleanField(7,Fe):qe==="number"&&(Fe%1!=0?Me.writeDoubleField(3,Fe):Fe<0?Me.writeSVarintField(6,Fe):Me.writeVarintField(5,Fe))}return ke.exports=te,ke.exports.fromVectorTileJs=te,ke.exports.fromGeojsonVt=function(Fe,Me){Me=Me||{};var qe={};for(var pe in Fe)qe[pe]=new ee(Fe[pe].features,Me),qe[pe].name=pe,qe[pe].version=Me.version,qe[pe].extent=Me.extent;return te({layers:qe})},ke.exports.GeoJSONWrapper=ee,ke.exports}(),We=h.cP(ze);const rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ee=>Ee},Ze=Math.fround||(He=new Float32Array(1),Ee=>(He[0]=+Ee,He[0]));var He;class Ct{constructor(ee){this.options=Object.assign(Object.create(rt),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:te,minZoom:oe,maxZoom:fe}=this.options;te&&console.time("total time");const we=`prepare ${ee.length} points`;te&&console.time(we),this.points=ee;const Pe=[];for(let Te=0;Te<ee.length;Te++){const $e=ee[Te];if(!$e.geometry)continue;const[Fe,Me]=$e.geometry.coordinates,qe=Ze(tt(Fe)),pe=Ze(ut(Me));Pe.push(qe,pe,1/0,Te,-1,1),this.options.reduce&&Pe.push(0)}let Re=this.trees[fe+1]=this._createTree(Pe);te&&console.timeEnd(we);for(let Te=fe;Te>=oe;Te--){const $e=+Date.now();Re=this.trees[Te]=this._createTree(this._cluster(Re,Te)),te&&console.log("z%d: %d clusters in %dms",Te,Re.numItems,+Date.now()-$e)}return te&&console.timeEnd("total time"),this}getClusters(ee,te){let oe=((ee[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,ee[1]));let we=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)oe=-180,we=180;else if(oe>we){const Me=this.getClusters([oe,fe,180,Pe],te),qe=this.getClusters([-180,fe,we,Pe],te);return Me.concat(qe)}const Re=this.trees[this._limitZoom(te)],Te=Re.range(tt(oe),ut(Pe),tt(we),ut(fe)),$e=Re.data,Fe=[];for(const Me of Te){const qe=this.stride*Me;Fe.push($e[qe+5]>1?st($e,qe,this.clusterProps):this.points[$e[qe+3]])}return Fe}getChildren(ee){const te=this._getOriginId(ee),oe=this._getOriginZoom(ee),fe="No cluster with the specified id.",we=this.trees[oe];if(!we)throw new Error(fe);const Pe=we.data;if(te*this.stride>=Pe.length)throw new Error(fe);const Re=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),Te=we.within(Pe[te*this.stride],Pe[te*this.stride+1],Re),$e=[];for(const Fe of Te){const Me=Fe*this.stride;Pe[Me+4]===ee&&$e.push(Pe[Me+5]>1?st(Pe,Me,this.clusterProps):this.points[Pe[Me+3]])}if($e.length===0)throw new Error(fe);return $e}getLeaves(ee,te,oe){const fe=[];return this._appendLeaves(fe,ee,te=te||10,oe=oe||0,0),fe}getTile(ee,te,oe){const fe=this.trees[this._limitZoom(ee)],we=Math.pow(2,ee),{extent:Pe,radius:Re}=this.options,Te=Re/Pe,$e=(oe-Te)/we,Fe=(oe+1+Te)/we,Me={features:[]};return this._addTileFeatures(fe.range((te-Te)/we,$e,(te+1+Te)/we,Fe),fe.data,te,oe,we,Me),te===0&&this._addTileFeatures(fe.range(1-Te/we,$e,1,Fe),fe.data,we,oe,we,Me),te===we-1&&this._addTileFeatures(fe.range(0,$e,Te/we,Fe),fe.data,-1,oe,we,Me),Me.features.length?Me:null}getClusterExpansionZoom(ee){let te=this._getOriginZoom(ee)-1;for(;te<=this.options.maxZoom;){const oe=this.getChildren(ee);if(te++,oe.length!==1)break;ee=oe[0].properties.cluster_id}return te}_appendLeaves(ee,te,oe,fe,we){const Pe=this.getChildren(te);for(const Re of Pe){const Te=Re.properties;if(Te&&Te.cluster?we+Te.point_count<=fe?we+=Te.point_count:we=this._appendLeaves(ee,Te.cluster_id,oe,fe,we):we<fe?we++:ee.push(Re),ee.length===oe)break}return we}_createTree(ee){const te=new h.aH(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let oe=0;oe<ee.length;oe+=this.stride)te.add(ee[oe],ee[oe+1]);return te.finish(),te.data=ee,te}_addTileFeatures(ee,te,oe,fe,we,Pe){for(const Re of ee){const Te=Re*this.stride,$e=te[Te+5]>1;let Fe,Me,qe;if($e)Fe=Ge(te,Te,this.clusterProps),Me=te[Te],qe=te[Te+1];else{const vt=this.points[te[Te+3]];Fe=vt.properties;const[mt,xt]=vt.geometry.coordinates;Me=tt(mt),qe=ut(xt)}const pe={type:1,geometry:[[Math.round(this.options.extent*(Me*we-oe)),Math.round(this.options.extent*(qe*we-fe))]],tags:Fe};let Je;Je=$e||this.options.generateId?te[Te+3]:this.points[te[Te+3]].id,Je!==void 0&&(pe.id=Je),Pe.features.push(pe)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,te){const{radius:oe,extent:fe,reduce:we,minPoints:Pe}=this.options,Re=oe/(fe*Math.pow(2,te)),Te=ee.data,$e=[],Fe=this.stride;for(let Me=0;Me<Te.length;Me+=Fe){if(Te[Me+2]<=te)continue;Te[Me+2]=te;const qe=Te[Me],pe=Te[Me+1],Je=ee.within(Te[Me],Te[Me+1],Re),vt=Te[Me+5];let mt=vt;for(const xt of Je){const At=xt*Fe;Te[At+2]>te&&(mt+=Te[At+5])}if(mt>vt&&mt>=Pe){let xt,At=qe*vt,ur=pe*vt,Ut=-1;const Gt=(Me/Fe<<5)+(te+1)+this.points.length;for(const Nt of Je){const ir=Nt*Fe;if(Te[ir+2]<=te)continue;Te[ir+2]=te;const Pn=Te[ir+5];At+=Te[ir]*Pn,ur+=Te[ir+1]*Pn,Te[ir+4]=Gt,we&&(xt||(xt=this._map(Te,Me,!0),Ut=this.clusterProps.length,this.clusterProps.push(xt)),we(xt,this._map(Te,ir)))}Te[Me+4]=Gt,$e.push(At/mt,ur/mt,1/0,Gt,-1,mt),we&&$e.push(Ut)}else{for(let xt=0;xt<Fe;xt++)$e.push(Te[Me+xt]);if(mt>1)for(const xt of Je){const At=xt*Fe;if(!(Te[At+2]<=te)){Te[At+2]=te;for(let ur=0;ur<Fe;ur++)$e.push(Te[At+ur])}}}}return $e}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,te,oe){if(ee[te+5]>1){const Pe=this.clusterProps[ee[te+6]];return oe?Object.assign({},Pe):Pe}const fe=this.points[ee[te+3]].properties,we=this.options.map(fe);return oe&&we===fe?Object.assign({},we):we}}function st(Ee,ee,te){return{type:"Feature",id:Ee[ee+3],properties:Ge(Ee,ee,te),geometry:{type:"Point",coordinates:[(oe=Ee[ee],360*(oe-.5)),Ve(Ee[ee+1])]}};var oe}function Ge(Ee,ee,te){const oe=Ee[ee+5],fe=oe>=1e4?`${Math.round(oe/1e3)}k`:oe>=1e3?Math.round(oe/100)/10+"k":oe,we=Ee[ee+6],Pe=we===-1?{}:Object.assign({},te[we]);return Object.assign(Pe,{cluster:!0,cluster_id:Ee[ee+3],point_count:oe,point_count_abbreviated:fe})}function tt(Ee){return Ee/360+.5}function ut(Ee){const ee=Math.sin(Ee*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function Ve(Ee){const ee=(180-360*Ee)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function De(Ee,ee,te,oe){let fe=oe;const we=ee+(te-ee>>1);let Pe,Re=te-ee;const Te=Ee[ee],$e=Ee[ee+1],Fe=Ee[te],Me=Ee[te+1];for(let qe=ee+3;qe<te;qe+=3){const pe=Ke(Ee[qe],Ee[qe+1],Te,$e,Fe,Me);if(pe>fe)Pe=qe,fe=pe;else if(pe===fe){const Je=Math.abs(qe-we);Je<Re&&(Pe=qe,Re=Je)}}fe>oe&&(Pe-ee>3&&De(Ee,ee,Pe,oe),Ee[Pe+2]=fe,te-Pe>3&&De(Ee,Pe,te,oe))}function Ke(Ee,ee,te,oe,fe,we){let Pe=fe-te,Re=we-oe;if(Pe!==0||Re!==0){const Te=((Ee-te)*Pe+(ee-oe)*Re)/(Pe*Pe+Re*Re);Te>1?(te=fe,oe=we):Te>0&&(te+=Pe*Te,oe+=Re*Te)}return Pe=Ee-te,Re=ee-oe,Pe*Pe+Re*Re}function nt(Ee,ee,te,oe){const fe={id:Ee??null,type:ee,geometry:te,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")ot(fe,te);else if(ee==="Polygon")ot(fe,te[0]);else if(ee==="MultiLineString")for(const we of te)ot(fe,we);else if(ee==="MultiPolygon")for(const we of te)ot(fe,we[0]);return fe}function ot(Ee,ee){for(let te=0;te<ee.length;te+=3)Ee.minX=Math.min(Ee.minX,ee[te]),Ee.minY=Math.min(Ee.minY,ee[te+1]),Ee.maxX=Math.max(Ee.maxX,ee[te]),Ee.maxY=Math.max(Ee.maxY,ee[te+1])}function Et(Ee,ee,te,oe){if(!ee.geometry)return;const fe=ee.geometry.coordinates;if(fe&&fe.length===0)return;const we=ee.geometry.type,Pe=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2);let Re=[],Te=ee.id;if(te.promoteId?Te=ee.properties[te.promoteId]:te.generateId&&(Te=oe||0),we==="Point")Rt(fe,Re);else if(we==="MultiPoint")for(const $e of fe)Rt($e,Re);else if(we==="LineString")lr(fe,Re,Pe,!1);else if(we==="MultiLineString"){if(te.lineMetrics){for(const $e of fe)Re=[],lr($e,Re,Pe,!1),Ee.push(nt(Te,"LineString",Re,ee.properties));return}gr(fe,Re,Pe,!1)}else if(we==="Polygon")gr(fe,Re,Pe,!0);else{if(we!=="MultiPolygon"){if(we==="GeometryCollection"){for(const $e of ee.geometry.geometries)Et(Ee,{id:Te,geometry:$e,properties:ee.properties},te,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const $e of fe){const Fe=[];gr($e,Fe,Pe,!0),Re.push(Fe)}}Ee.push(nt(Te,we,Re,ee.properties))}function Rt(Ee,ee){ee.push(Xt(Ee[0]),Ii(Ee[1]),0)}function lr(Ee,ee,te,oe){let fe,we,Pe=0;for(let Te=0;Te<Ee.length;Te++){const $e=Xt(Ee[Te][0]),Fe=Ii(Ee[Te][1]);ee.push($e,Fe,0),Te>0&&(Pe+=oe?(fe*Fe-$e*we)/2:Math.sqrt(Math.pow($e-fe,2)+Math.pow(Fe-we,2))),fe=$e,we=Fe}const Re=ee.length-3;ee[2]=1,De(ee,0,Re,te),ee[Re+2]=1,ee.size=Math.abs(Pe),ee.start=0,ee.end=ee.size}function gr(Ee,ee,te,oe){for(let fe=0;fe<Ee.length;fe++){const we=[];lr(Ee[fe],we,te,oe),ee.push(we)}}function Xt(Ee){return Ee/360+.5}function Ii(Ee){const ee=Math.sin(Ee*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function yr(Ee,ee,te,oe,fe,we,Pe,Re){if(oe/=ee,we>=(te/=ee)&&Pe<oe)return Ee;if(Pe<te||we>=oe)return null;const Te=[];for(const $e of Ee){const Fe=$e.geometry;let Me=$e.type;const qe=fe===0?$e.minX:$e.minY,pe=fe===0?$e.maxX:$e.maxY;if(qe>=te&&pe<oe){Te.push($e);continue}if(pe<te||qe>=oe)continue;let Je=[];if(Me==="Point"||Me==="MultiPoint")Cn(Fe,Je,te,oe,fe);else if(Me==="LineString")br(Fe,Je,te,oe,fe,!1,Re.lineMetrics);else if(Me==="MultiLineString")vr(Fe,Je,te,oe,fe,!1);else if(Me==="Polygon")vr(Fe,Je,te,oe,fe,!0);else if(Me==="MultiPolygon")for(const vt of Fe){const mt=[];vr(vt,mt,te,oe,fe,!0),mt.length&&Je.push(mt)}if(Je.length){if(Re.lineMetrics&&Me==="LineString"){for(const vt of Je)Te.push(nt($e.id,Me,vt,$e.tags));continue}Me!=="LineString"&&Me!=="MultiLineString"||(Je.length===1?(Me="LineString",Je=Je[0]):Me="MultiLineString"),Me!=="Point"&&Me!=="MultiPoint"||(Me=Je.length===3?"Point":"MultiPoint"),Te.push(nt($e.id,Me,Je,$e.tags))}}return Te.length?Te:null}function Cn(Ee,ee,te,oe,fe){for(let we=0;we<Ee.length;we+=3){const Pe=Ee[we+fe];Pe>=te&&Pe<=oe&&ii(ee,Ee[we],Ee[we+1],Ee[we+2])}}function br(Ee,ee,te,oe,fe,we,Pe){let Re=Ri(Ee);const Te=fe===0?Xn:ao;let $e,Fe,Me=Ee.start;for(let mt=0;mt<Ee.length-3;mt+=3){const xt=Ee[mt],At=Ee[mt+1],ur=Ee[mt+2],Ut=Ee[mt+3],Gt=Ee[mt+4],Nt=fe===0?xt:At,ir=fe===0?Ut:Gt;let Pn=!1;Pe&&($e=Math.sqrt(Math.pow(xt-Ut,2)+Math.pow(At-Gt,2))),Nt<te?ir>te&&(Fe=Te(Re,xt,At,Ut,Gt,te),Pe&&(Re.start=Me+$e*Fe)):Nt>oe?ir<oe&&(Fe=Te(Re,xt,At,Ut,Gt,oe),Pe&&(Re.start=Me+$e*Fe)):ii(Re,xt,At,ur),ir<te&&Nt>=te&&(Fe=Te(Re,xt,At,Ut,Gt,te),Pn=!0),ir>oe&&Nt<=oe&&(Fe=Te(Re,xt,At,Ut,Gt,oe),Pn=!0),!we&&Pn&&(Pe&&(Re.end=Me+$e*Fe),ee.push(Re),Re=Ri(Ee)),Pe&&(Me+=$e)}let qe=Ee.length-3;const pe=Ee[qe],Je=Ee[qe+1],vt=fe===0?pe:Je;vt>=te&&vt<=oe&&ii(Re,pe,Je,Ee[qe+2]),qe=Re.length-3,we&&qe>=3&&(Re[qe]!==Re[0]||Re[qe+1]!==Re[1])&&ii(Re,Re[0],Re[1],Re[2]),Re.length&&ee.push(Re)}function Ri(Ee){const ee=[];return ee.size=Ee.size,ee.start=Ee.start,ee.end=Ee.end,ee}function vr(Ee,ee,te,oe,fe,we){for(const Pe of Ee)br(Pe,ee,te,oe,fe,we,!1)}function ii(Ee,ee,te,oe){Ee.push(ee,te,oe)}function Xn(Ee,ee,te,oe,fe,we){const Pe=(we-ee)/(oe-ee);return ii(Ee,we,te+(fe-te)*Pe,1),Pe}function ao(Ee,ee,te,oe,fe,we){const Pe=(we-te)/(fe-te);return ii(Ee,ee+(oe-ee)*Pe,we,1),Pe}function en(Ee,ee){const te=[];for(let oe=0;oe<Ee.length;oe++){const fe=Ee[oe],we=fe.type;let Pe;if(we==="Point"||we==="MultiPoint"||we==="LineString")Pe=yn(fe.geometry,ee);else if(we==="MultiLineString"||we==="Polygon"){Pe=[];for(const Re of fe.geometry)Pe.push(yn(Re,ee))}else if(we==="MultiPolygon"){Pe=[];for(const Re of fe.geometry){const Te=[];for(const $e of Re)Te.push(yn($e,ee));Pe.push(Te)}}te.push(nt(fe.id,we,Pe,fe.tags))}return te}function yn(Ee,ee){const te=[];te.size=Ee.size,Ee.start!==void 0&&(te.start=Ee.start,te.end=Ee.end);for(let oe=0;oe<Ee.length;oe+=3)te.push(Ee[oe]+ee,Ee[oe+1],Ee[oe+2]);return te}function tn(Ee,ee){if(Ee.transformed)return Ee;const te=1<<Ee.z,oe=Ee.x,fe=Ee.y;for(const we of Ee.features){const Pe=we.geometry,Re=we.type;if(we.geometry=[],Re===1)for(let Te=0;Te<Pe.length;Te+=2)we.geometry.push(Lo(Pe[Te],Pe[Te+1],ee,te,oe,fe));else for(let Te=0;Te<Pe.length;Te++){const $e=[];for(let Fe=0;Fe<Pe[Te].length;Fe+=2)$e.push(Lo(Pe[Te][Fe],Pe[Te][Fe+1],ee,te,oe,fe));we.geometry.push($e)}}return Ee.transformed=!0,Ee}function Lo(Ee,ee,te,oe,fe,we){return[Math.round(te*(Ee*oe-fe)),Math.round(te*(ee*oe-we))]}function yi(Ee,ee,te,oe,fe){const we=ee===fe.maxZoom?0:fe.tolerance/((1<<ee)*fe.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:Ee.length,source:null,x:te,y:oe,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Re of Ee)Os(Pe,Re,we,fe);return Pe}function Os(Ee,ee,te,oe){const fe=ee.geometry,we=ee.type,Pe=[];if(Ee.minX=Math.min(Ee.minX,ee.minX),Ee.minY=Math.min(Ee.minY,ee.minY),Ee.maxX=Math.max(Ee.maxX,ee.maxX),Ee.maxY=Math.max(Ee.maxY,ee.maxY),we==="Point"||we==="MultiPoint")for(let Re=0;Re<fe.length;Re+=3)Pe.push(fe[Re],fe[Re+1]),Ee.numPoints++,Ee.numSimplified++;else if(we==="LineString")oi(Pe,fe,Ee,te,!1,!1);else if(we==="MultiLineString"||we==="Polygon")for(let Re=0;Re<fe.length;Re++)oi(Pe,fe[Re],Ee,te,we==="Polygon",Re===0);else if(we==="MultiPolygon")for(let Re=0;Re<fe.length;Re++){const Te=fe[Re];for(let $e=0;$e<Te.length;$e++)oi(Pe,Te[$e],Ee,te,!0,$e===0)}if(Pe.length){let Re=ee.tags||null;if(we==="LineString"&&oe.lineMetrics){Re={};for(const $e in ee.tags)Re[$e]=ee.tags[$e];Re.mapbox_clip_start=fe.start/fe.size,Re.mapbox_clip_end=fe.end/fe.size}const Te={geometry:Pe,type:we==="Polygon"||we==="MultiPolygon"?3:we==="LineString"||we==="MultiLineString"?2:1,tags:Re};ee.id!==null&&(Te.id=ee.id),Ee.features.push(Te)}}function oi(Ee,ee,te,oe,fe,we){const Pe=oe*oe;if(oe>0&&ee.size<(fe?Pe:oe))return void(te.numPoints+=ee.length/3);const Re=[];for(let Te=0;Te<ee.length;Te+=3)(oe===0||ee[Te+2]>Pe)&&(te.numSimplified++,Re.push(ee[Te],ee[Te+1])),te.numPoints++;fe&&function(Te,$e){let Fe=0;for(let Me=0,qe=Te.length,pe=qe-2;Me<qe;pe=Me,Me+=2)Fe+=(Te[Me]-Te[pe])*(Te[Me+1]+Te[pe+1]);if(Fe>0===$e)for(let Me=0,qe=Te.length;Me<qe/2;Me+=2){const pe=Te[Me],Je=Te[Me+1];Te[Me]=Te[qe-2-Me],Te[Me+1]=Te[qe-1-Me],Te[qe-2-Me]=pe,Te[qe-1-Me]=Je}}(Re,we),Ee.push(Re)}const lo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ns{constructor(ee,te){const oe=(te=this.options=function(we,Pe){for(const Re in Pe)we[Re]=Pe[Re];return we}(Object.create(lo),te)).debug;if(oe&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=function(we,Pe){const Re=[];if(we.type==="FeatureCollection")for(let Te=0;Te<we.features.length;Te++)Et(Re,we.features[Te],Pe,Te);else Et(Re,we.type==="Feature"?we:{geometry:we},Pe);return Re}(ee,te);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(we,Pe){const Re=Pe.buffer/Pe.extent;let Te=we;const $e=yr(we,1,-1-Re,Re,0,-1,2,Pe),Fe=yr(we,1,1-Re,2+Re,0,-1,2,Pe);return($e||Fe)&&(Te=yr(we,1,-Re,1+Re,0,-1,2,Pe)||[],$e&&(Te=en($e,1).concat(Te)),Fe&&(Te=Te.concat(en(Fe,-1)))),Te}(fe,te),fe.length&&this.splitTile(fe,0,0,0),oe&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,te,oe,fe,we,Pe,Re){const Te=[ee,te,oe,fe],$e=this.options,Fe=$e.debug;for(;Te.length;){fe=Te.pop(),oe=Te.pop(),te=Te.pop(),ee=Te.pop();const Me=1<<te,qe=Hr(te,oe,fe);let pe=this.tiles[qe];if(!pe&&(Fe>1&&console.time("creation"),pe=this.tiles[qe]=yi(ee,te,oe,fe,$e),this.tileCoords.push({z:te,x:oe,y:fe}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,oe,fe,pe.numFeatures,pe.numPoints,pe.numSimplified),console.timeEnd("creation"));const Pn=`z${te}`;this.stats[Pn]=(this.stats[Pn]||0)+1,this.total++}if(pe.source=ee,we==null){if(te===$e.indexMaxZoom||pe.numPoints<=$e.indexMaxPoints)continue}else{if(te===$e.maxZoom||te===we)continue;if(we!=null){const Pn=we-te;if(oe!==Pe>>Pn||fe!==Re>>Pn)continue}}if(pe.source=null,ee.length===0)continue;Fe>1&&console.time("clipping");const Je=.5*$e.buffer/$e.extent,vt=.5-Je,mt=.5+Je,xt=1+Je;let At=null,ur=null,Ut=null,Gt=null,Nt=yr(ee,Me,oe-Je,oe+mt,0,pe.minX,pe.maxX,$e),ir=yr(ee,Me,oe+vt,oe+xt,0,pe.minX,pe.maxX,$e);ee=null,Nt&&(At=yr(Nt,Me,fe-Je,fe+mt,1,pe.minY,pe.maxY,$e),ur=yr(Nt,Me,fe+vt,fe+xt,1,pe.minY,pe.maxY,$e),Nt=null),ir&&(Ut=yr(ir,Me,fe-Je,fe+mt,1,pe.minY,pe.maxY,$e),Gt=yr(ir,Me,fe+vt,fe+xt,1,pe.minY,pe.maxY,$e),ir=null),Fe>1&&console.timeEnd("clipping"),Te.push(At||[],te+1,2*oe,2*fe),Te.push(ur||[],te+1,2*oe,2*fe+1),Te.push(Ut||[],te+1,2*oe+1,2*fe),Te.push(Gt||[],te+1,2*oe+1,2*fe+1)}}getTile(ee,te,oe){ee=+ee,te=+te,oe=+oe;const fe=this.options,{extent:we,debug:Pe}=fe;if(ee<0||ee>24)return null;const Re=1<<ee,Te=Hr(ee,te=te+Re&Re-1,oe);if(this.tiles[Te])return tn(this.tiles[Te],we);Pe>1&&console.log("drilling down to z%d-%d-%d",ee,te,oe);let $e,Fe=ee,Me=te,qe=oe;for(;!$e&&Fe>0;)Fe--,Me>>=1,qe>>=1,$e=this.tiles[Hr(Fe,Me,qe)];return $e&&$e.source?(Pe>1&&(console.log("found parent tile z%d-%d-%d",Fe,Me,qe),console.time("drilling down")),this.splitTile($e.source,Fe,Me,qe,ee,te,oe),Pe>1&&console.timeEnd("drilling down"),this.tiles[Te]?tn(this.tiles[Te],we):null):null}}function Hr(Ee,ee,te){return 32*((1<<Ee)*te+ee)+Ee}function un(Ee,ee){return ee?Ee.properties[ee]:Ee.id}function Ki(Ee,ee){if(Ee==null)return!0;if(Ee.type==="Feature")return un(Ee,ee)!=null;if(Ee.type==="FeatureCollection"){const te=new Set;for(const oe of Ee.features){const fe=un(oe,ee);if(fe==null||te.has(fe))return!1;te.add(fe)}return!0}return!1}function xa(Ee,ee){const te=new Map;if(Ee!=null)if(Ee.type==="Feature")te.set(un(Ee,ee),Ee);else for(const oe of Ee.features)te.set(un(oe,ee),oe);return te}class is extends k{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,te){return h._(this,void 0,void 0,function*(){const oe=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!fe)return null;const we=new U(fe.features);let Pe=We(we);return Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),{vectorTile:we,rawData:Pe.buffer}})}loadData(ee){return h._(this,void 0,void 0,function*(){var te;(te=this._pendingRequest)===null||te===void 0||te.abort();const oe=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new h.cM(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new Ct(function({superclusterOptions:Pe,clusterProperties:Re}){if(!Re||!Pe)return Pe;const Te={},$e={},Fe={accumulated:null,zoom:0},Me={properties:null},qe=Object.keys(Re);for(const pe of qe){const[Je,vt]=Re[pe],mt=h.cT(vt),xt=h.cT(typeof Je=="string"?[Je,["accumulated"],["get",pe]]:Je);Te[pe]=mt.value,$e[pe]=xt.value}return Pe.map=pe=>{Me.properties=pe;const Je={};for(const vt of qe)Je[vt]=Te[vt].evaluate(Fe,Me);return Je},Pe.reduce=(pe,Je)=>{Me.properties=Je;for(const vt of qe)Fe.accumulated=pe[vt],pe[vt]=$e[vt].evaluate(Fe,Me)},Pe}(ee)).load((yield this._pendingData).features):(fe=yield this._pendingData,new ns(fe,ee.geojsonVtOptions)),this.loaded={};const we={};if(oe){const Pe=oe.finish();Pe&&(we.resourceTiming={},we.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Pe)))}return we}catch(we){if(delete this._pendingRequest,h.cx(we))return{abandoned:!0};throw we}var fe})}getData(){return h._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const te=this.loaded;return te&&te[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,te){return h._(this,void 0,void 0,function*(){let oe=yield this.loadGeoJSON(ee,te);if(delete this._pendingRequest,typeof oe!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(X(oe,!0),ee.filter){const fe=h.cT(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));oe={type:"FeatureCollection",features:oe.features.filter(Pe=>fe.value.evaluate({zoom:0},Pe))}}return oe})}loadGeoJSON(ee,te){return h._(this,void 0,void 0,function*(){const{promoteId:oe}=ee;if(ee.request){const fe=yield h.j(ee.request,te);return this._dataUpdateable=Ki(fe.data,oe)?xa(fe.data,oe):void 0,fe.data}if(typeof ee.data=="string")try{const fe=JSON.parse(ee.data);return this._dataUpdateable=Ki(fe,oe)?xa(fe,oe):void 0,fe}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(fe,we,Pe){var Re,Te,$e,Fe;if(we.removeAll&&fe.clear(),we.remove)for(const Me of we.remove)fe.delete(Me);if(we.add)for(const Me of we.add){const qe=un(Me,Pe);qe!=null&&fe.set(qe,Me)}if(we.update)for(const Me of we.update){let qe=fe.get(Me.id);if(qe==null)continue;const pe=!Me.removeAllProperties&&(((Re=Me.removeProperties)===null||Re===void 0?void 0:Re.length)>0||((Te=Me.addOrUpdateProperties)===null||Te===void 0?void 0:Te.length)>0);if((Me.newGeometry||Me.removeAllProperties||pe)&&(qe=Object.assign({},qe),fe.set(Me.id,qe),pe&&(qe.properties=Object.assign({},qe.properties))),Me.newGeometry&&(qe.geometry=Me.newGeometry),Me.removeAllProperties)qe.properties={};else if((($e=Me.removeProperties)===null||$e===void 0?void 0:$e.length)>0)for(const Je of Me.removeProperties)Object.prototype.hasOwnProperty.call(qe.properties,Je)&&delete qe.properties[Je];if(((Fe=Me.addOrUpdateProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const{key:Je,value:vt}of Me.addOrUpdateProperties)qe.properties[Je]=vt}}(this._dataUpdateable,ee.dataDiff,oe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return h._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class co{constructor(ee){this.self=ee,this.actor=new h.J(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(te,oe)=>{if(this.externalWorkerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.externalWorkerSourceTypes[te]=oe},this.self.addProtocol=h.cz,this.self.removeProtocol=h.cA,this.self.registerRTLTextPlugin=te=>{h.cU.setMethods(te)},this.actor.registerMessageHandler("LDT",(te,oe)=>this._getDEMWorkerSource(te,oe.source).loadTile(oe)),this.actor.registerMessageHandler("RDT",(te,oe)=>h._(this,void 0,void 0,function*(){this._getDEMWorkerSource(te,oe.source).removeTile(oe)})),this.actor.registerMessageHandler("GCEZ",(te,oe)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterExpansionZoom(oe)})),this.actor.registerMessageHandler("GCC",(te,oe)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterChildren(oe)})),this.actor.registerMessageHandler("GCL",(te,oe)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterLeaves(oe)})),this.actor.registerMessageHandler("LD",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).loadData(oe)),this.actor.registerMessageHandler("GD",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).getData()),this.actor.registerMessageHandler("LT",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).loadTile(oe)),this.actor.registerMessageHandler("RT",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).reloadTile(oe)),this.actor.registerMessageHandler("AT",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).abortTile(oe)),this.actor.registerMessageHandler("RMT",(te,oe)=>this._getWorkerSource(te,oe.type,oe.source).removeTile(oe)),this.actor.registerMessageHandler("RS",(te,oe)=>h._(this,void 0,void 0,function*(){if(!this.workerSources[te]||!this.workerSources[te][oe.type]||!this.workerSources[te][oe.type][oe.source])return;const fe=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],fe.removeSource!==void 0&&fe.removeSource(oe)})),this.actor.registerMessageHandler("RM",te=>h._(this,void 0,void 0,function*(){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te]})),this.actor.registerMessageHandler("SR",(te,oe)=>h._(this,void 0,void 0,function*(){this.referrer=oe})),this.actor.registerMessageHandler("SRPS",(te,oe)=>this._syncRTLPluginState(te,oe)),this.actor.registerMessageHandler("IS",(te,oe)=>h._(this,void 0,void 0,function*(){this.self.importScripts(oe)})),this.actor.registerMessageHandler("SI",(te,oe)=>this._setImages(te,oe)),this.actor.registerMessageHandler("UL",(te,oe)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(te).update(oe.layers,oe.removedIds)})),this.actor.registerMessageHandler("SL",(te,oe)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(te).replace(oe)}))}_setImages(ee,te){return h._(this,void 0,void 0,function*(){this.availableImages[ee]=te;for(const oe in this.workerSources[ee]){const fe=this.workerSources[ee][oe];for(const we in fe)fe[we].availableImages=te}})}_syncRTLPluginState(ee,te){return h._(this,void 0,void 0,function*(){return yield h.cU.syncState(te,this.self.importScripts)})}_getAvailableImages(ee){let te=this.availableImages[ee];return te||(te=[]),te}_getLayerIndex(ee){let te=this.layerIndexes[ee];return te||(te=this.layerIndexes[ee]=new s),te}_getWorkerSource(ee,te,oe){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][te]||(this.workerSources[ee][te]={}),!this.workerSources[ee][te][oe]){const fe={sendAsync:(we,Pe)=>(we.targetMapId=ee,this.actor.sendAsync(we,Pe))};switch(te){case"vector":this.workerSources[ee][te][oe]=new k(fe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][te][oe]=new is(fe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][te][oe]=new this.externalWorkerSourceTypes[te](fe,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][te][oe]}_getDEMWorkerSource(ee,te){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][te]||(this.demWorkerSources[ee][te]=new I),this.demWorkerSources[ee][te]}}return h.i(self)&&(self.worker=new co(self)),co}),u("index",["exports","./shared"],function(h,s){var b="5.6.1";function w(){var y=new s.A(4);return s.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let C,k;const I={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(y,n,a){const f=requestAnimationFrame(v=>{m(),n(v)}),{unsubscribe:m}=s.s(y.signal,"abort",()=>{m(),cancelAnimationFrame(f),a(s.c())},!1)},frameAsync(y){return new Promise((n,a)=>{this.frame(y,n,a)})},getImageData(y,n=0){return this.getImageCanvasContext(y).getImageData(-n,-n,y.width+2*n,y.height+2*n)},getImageCanvasContext(y){const n=window.document.createElement("canvas"),a=n.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return n.width=y.width,n.height=y.height,a.drawImage(y,0,0,y.width,y.height),a},resolveURL:y=>(C||(C=document.createElement("a")),C.href=y,C.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}};class A{static testProp(n){if(!A.docStyle)return n[0];for(let a=0;a<n.length;a++)if(n[a]in A.docStyle)return n[a];return n[0]}static create(n,a,f){const m=window.document.createElement(n);return a!==void 0&&(m.className=a),f&&f.appendChild(m),m}static createNS(n,a){return window.document.createElementNS(n,a)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(n,a){n.style[A.transformProp]=a}static addEventListener(n,a,f,m={}){n.addEventListener(a,f,"passive"in m?m:m.capture)}static removeEventListener(n,a,f,m={}){n.removeEventListener(a,f,"passive"in m?m:m.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(n){const a=n.getBoundingClientRect();return{x:a.width/n.offsetWidth||1,y:a.height/n.offsetHeight||1,boundingClientRect:a}}static getPoint(n,a,f){const m=a.boundingClientRect;return new s.P((f.clientX-m.left)/a.x-n.clientLeft,(f.clientY-m.top)/a.y-n.clientTop)}static mousePos(n,a){const f=A.getScale(n);return A.getPoint(n,f,a)}static touchPos(n,a){const f=[],m=A.getScale(n);for(let v=0;v<a.length;v++)f.push(A.getPoint(n,m,a[v]));return f}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const a=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),f=a.querySelectorAll("script");for(const m of f)m.remove();return A.clean(a),a.innerHTML}static isPossiblyDangerous(n,a){const f=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!f.includes("javascript:")&&!f.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const a=n.children;for(const f of a)A.removeAttributes(f),A.clean(f)}static removeAttributes(n){for(const{name:a,value:f}of n.attributes)A.isPossiblyDangerous(a,f)&&n.removeAttribute(a)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const B={supported:!1,testSupport:function(y){!q&&X&&(V?U(y):F=y)}};let F,X,q=!1,V=!1;function U(y){const n=y.createTexture();y.bindTexture(y.TEXTURE_2D,n);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,X),y.isContextLost())return;B.supported=!0}catch{}y.deleteTexture(n),q=!0}var ne;typeof document<"u"&&(X=document.createElement("img"),X.onload=()=>{F&&U(F),F=null,V=!0},X.onerror=()=>{q=!0,F=null},X.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let n,a,f,m;y.resetRequestQueue=()=>{n=[],a=0,f=0,m={}},y.addThrottleControl=M=>{const L=f++;return m[L]=M,L},y.removeThrottleControl=M=>{delete m[M],S()},y.getImage=(M,L,z=!0)=>new Promise(($,O)=>{B.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),s.e(M,{type:"image"}),n.push({abortController:L,requestParameters:M,supportImageRefresh:z,state:"queued",onError:Z=>{O(Z)},onSuccess:Z=>{$(Z)}}),S()});const v=M=>s._(this,void 0,void 0,function*(){M.state="running";const{requestParameters:L,supportImageRefresh:z,onError:$,onSuccess:O,abortController:Z}=M,Q=z===!1&&!s.i(self)&&!s.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce((le,ue)=>le&&ue==="accept",!0));a++;const ae=Q?P(L,Z):s.m(L,Z);try{const le=yield ae;delete M.abortController,M.state="completed",le.data instanceof HTMLImageElement||s.b(le.data)?O(le):le.data&&O({data:yield(se=le.data,typeof createImageBitmap=="function"?s.f(se):s.h(se)),cacheControl:le.cacheControl,expires:le.expires})}catch(le){delete M.abortController,$(le)}finally{a--,S()}var se}),S=()=>{const M=(()=>{for(const L of Object.keys(m))if(m[L]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=a;L<M&&n.length>0;L++){const z=n.shift();z.abortController.signal.aborted?L--:v(z)}},P=(M,L)=>new Promise((z,$)=>{const O=new Image,Z=M.url,Q=M.credentials;Q&&Q==="include"?O.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!s.d(Z))&&(O.crossOrigin="anonymous"),L.signal.addEventListener("abort",()=>{O.src="",$(s.c())}),O.fetchPriority="high",O.onload=()=>{O.onerror=O.onload=null,z({data:O})},O.onerror=()=>{O.onerror=O.onload=null,L.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},O.src=Z})}(ne||(ne={})),ne.resetRequestQueue();class de{constructor(n){this._transformRequestFn=n}transformRequest(n,a){return this._transformRequestFn&&this._transformRequestFn(n,a)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function xe(y){const n=[];if(typeof y=="string")n.push({id:"default",url:y});else if(y&&y.length>0){const a=[];for(const{id:f,url:m}of y){const v=`${f}${m}`;a.indexOf(v)===-1&&(a.push(v),n.push({id:f,url:m}))}}return n}function ke(y,n,a){try{const f=new URL(y);return f.pathname+=`${n}${a}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ze(y){const{userImage:n}=y;return!!(n&&n.render&&n.render())&&(y.data.replace(new Uint8Array(n.data.buffer)),!0)}class We extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:a,promiseResolve:f}of this.requestors)f(this._getImagesForIds(a));this.requestors=[]}}getImage(n){const a=this.images[n];if(a&&!a.data&&a.spriteData){const f=a.spriteData;a.data=new s.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),a.spriteData=null}return a}addImage(n,a){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,a)&&(this.images[n]=a)}_validate(n,a){let f=!0;const m=a.data||a.spriteData;return this._validateStretch(a.stretchX,m&&m.width)||(this.fire(new s.k(new Error(`Image "${n}" has invalid "stretchX" value`))),f=!1),this._validateStretch(a.stretchY,m&&m.height)||(this.fire(new s.k(new Error(`Image "${n}" has invalid "stretchY" value`))),f=!1),this._validateContent(a.content,a)||(this.fire(new s.k(new Error(`Image "${n}" has invalid "content" value`))),f=!1),f}_validateStretch(n,a){if(!n)return!0;let f=0;for(const m of n){if(m[0]<f||m[1]<m[0]||a<m[1])return!1;f=m[1]}return!0}_validateContent(n,a){if(!n)return!0;if(n.length!==4)return!1;const f=a.spriteData,m=f&&f.width||a.data.width,v=f&&f.height||a.data.height;return!(n[0]<0||m<n[0]||n[1]<0||v<n[1]||n[2]<0||m<n[2]||n[3]<0||v<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,a,f=!0){const m=this.getImage(n);if(f&&(m.data.width!==a.data.width||m.data.height!==a.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=m.version+1,this.images[n]=a,this.updatedImages[n]=!0}removeImage(n){const a=this.images[n];delete this.images[n],delete this.patterns[n],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((a,f)=>{let m=!0;if(!this.isLoaded())for(const v of n)this.images[v]||(m=!1);this.isLoaded()||m?a(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:a})})}_getImagesForIds(n){const a={};for(const f of n){let m=this.getImage(f);m||(this.fire(new s.l("styleimagemissing",{id:f})),m=this.getImage(f)),m?a[f]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:s.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:n,height:a}=this.atlasImage;return{width:n,height:a}}getPattern(n){const a=this.patterns[n],f=this.getImage(n);if(!f)return null;if(a&&a.position.version===f.version)return a.position;if(a)a.position.version=f.version;else{const m={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new s.I(m,f);this.patterns[n]={bin:m,position:v}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const a=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(n,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const v in this.patterns)n.push(this.patterns[v].bin);const{w:a,h:f}=s.p(n),m=this.atlasImage;m.resize({width:a||1,height:f||1});for(const v in this.patterns){const{bin:S}=this.patterns[v],P=S.x+1,M=S.y+1,L=this.getImage(v).data,z=L.width,$=L.height;s.R.copy(L,m,{x:0,y:0},{x:P,y:M},{width:z,height:$}),s.R.copy(L,m,{x:0,y:$-1},{x:P,y:M-1},{width:z,height:1}),s.R.copy(L,m,{x:0,y:0},{x:P,y:M+$},{width:z,height:1}),s.R.copy(L,m,{x:z-1,y:0},{x:P-1,y:M},{width:1,height:$}),s.R.copy(L,m,{x:0,y:0},{x:P+z,y:M},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const a of n){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const f=this.getImage(a);f||s.w(`Image with ID: "${a}" was not found`),ze(f)&&this.updateImage(a,f)}}}const rt=1e20;function Ze(y,n,a,f,m,v,S,P,M){for(let L=n;L<n+f;L++)He(y,a*v+L,v,m,S,P,M);for(let L=a;L<a+m;L++)He(y,L*v+n,1,f,S,P,M)}function He(y,n,a,f,m,v,S){v[0]=0,S[0]=-rt,S[1]=rt,m[0]=y[n];for(let P=1,M=0,L=0;P<f;P++){m[P]=y[n+P*a];const z=P*P;do{const $=v[M];L=(m[P]-m[$]+z-$*$)/(P-$)/2}while(L<=S[M]&&--M>-1);M++,v[M]=P,S[M]=L,S[M+1]=rt}for(let P=0,M=0;P<f;P++){for(;S[M+1]<P;)M++;const L=v[M],z=P-L;y[n+P*a]=m[L]+z*z}}class Ct{constructor(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return s._(this,void 0,void 0,function*(){const a=[];for(const v in n)for(const S of n[v])a.push(this._getAndCacheGlyphsPromise(v,S));const f=yield Promise.all(a),m={};for(const{stack:v,id:S,glyph:P}of f)m[v]||(m[v]={}),m[v][S]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};return m})}_getAndCacheGlyphsPromise(n,a){return s._(this,void 0,void 0,function*(){let f=this.entries[n];f||(f=this.entries[n]={glyphs:{},requests:{},ranges:{}});let m=f.glyphs[a];if(m!==void 0)return{stack:n,id:a,glyph:m};if(m=this._tinySDF(f,n,a),m)return f.glyphs[a]=m,{stack:n,id:a,glyph:m};const v=Math.floor(a/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[v])return{stack:n,id:a,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[v]){const P=Ct.loadGlyphRange(n,v,this.url,this.requestManager);f.requests[v]=P}const S=yield f.requests[v];for(const P in S)this._doesCharSupportLocalGlyph(+P)||(f.glyphs[+P]=S[+P]);return f.ranges[v]=!0,{stack:n,id:a,glyph:S[a]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||s.u["CJK Unified Ideographs"](n)||s.u["Hangul Syllables"](n)||s.u.Hiragana(n)||s.u.Katakana(n)||s.u["CJK Symbols and Punctuation"](n)||s.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,a,f){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(f))return;let v=n.tinySDF;if(!v){let P="400";/bold/i.test(a)?P="900":/medium/i.test(a)?P="500":/light/i.test(a)&&(P="200"),v=n.tinySDF=new Ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:P})}const S=v.draw(String.fromCharCode(f));return{id:f,bitmap:new s.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ct.loadGlyphRange=function(y,n,a,f){return s._(this,void 0,void 0,function*(){const m=256*n,v=m+255,S=f.transformRequest(a.replace("{fontstack}",y).replace("{range}",`${m}-${v}`),"Glyphs"),P=yield s.n(S,new AbortController);if(!P||!P.data)throw new Error(`Could not load glyph range. range: ${n}, ${m}-${v}`);const M={};for(const L of s.o(P.data))M[L.id]=L;return M})},Ct.TinySDF=class{constructor({fontSize:y=24,buffer:n=3,radius:a=8,cutoff:f=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:S="normal"}={}){this.buffer=n,this.cutoff=f,this.radius=a;const P=this.size=y+4*n,M=this._createCanvas(P),L=this.ctx=M.getContext("2d",{willReadFrequently:!0});L.font=`${S} ${v} ${y}px ${m}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(y){const n=document.createElement("canvas");return n.width=n.height=y,n}draw(y){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:f,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(y),S=Math.ceil(a),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),M=Math.min(this.size-this.buffer,S+Math.ceil(f)),L=P+2*this.buffer,z=M+2*this.buffer,$=Math.max(L*z,0),O=new Uint8ClampedArray($),Z={data:O,width:L,height:z,glyphWidth:P,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:n};if(P===0||M===0)return Z;const{ctx:Q,buffer:ae,gridInner:se,gridOuter:le}=this;Q.clearRect(ae,ae,P,M),Q.fillText(y,ae,ae+S);const ue=Q.getImageData(ae,ae,P,M);le.fill(rt,0,$),se.fill(0,0,$);for(let ge=0;ge<M;ge++)for(let he=0;he<P;he++){const _e=ue.data[4*(ge*P+he)+3]/255;if(_e===0)continue;const be=(ge+ae)*L+he+ae;if(_e===1)le[be]=0,se[be]=rt;else{const me=.5-_e;le[be]=me>0?me*me:0,se[be]=me<0?me*me:0}}Ze(le,0,0,L,z,L,this.f,this.v,this.z),Ze(se,ae,ae,P,M,L,this.f,this.v,this.z);for(let ge=0;ge<$;ge++){const he=Math.sqrt(le[ge])-Math.sqrt(se[ge]);O[ge]=Math.round(255-255*(he/this.radius+this.cutoff))}return Z}};class st{constructor(){this.specification=s.v.light.position}possiblyEvaluate(n,a){return s.B(n.expression.evaluate(a))}interpolate(n,a,f){return{x:s.C.number(n.x,a.x,f),y:s.C.number(n.y,a.y,f),z:s.C.number(n.z,a.z,f)}}}let Ge;class tt extends s.E{constructor(n){super(),Ge=Ge||new s.r({anchor:new s.D(s.v.light.anchor),position:new st,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(Ge),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,a={}){if(!this._validate(s.x,n,a))for(const f in n){const m=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),m):this._transitionable.setValue(f,m)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,f){return(!f||f.validate!==!1)&&s.y(this,n.call(s.z,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const ut=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Ve extends s.E{constructor(n){super(),this._transitionable=new s.t(ut),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(n,a={}){if(!this._validate(s.G,n,a)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in n){const m=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),m):this._transitionable.setValue(f,m)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,f={}){return(f==null?void 0:f.validate)!==!1&&s.y(this,n.call(s.z,s.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class De{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,a){const f=n.join(",")+String(a);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(n,a)),this.dashEntry[f]}getDashRanges(n,a,f){const m=[];let v=n.length%2==1?-n[n.length-1]*f:0,S=n[0]*f,P=!0;m.push({left:v,right:S,isDash:P,zeroLength:n[0]===0});let M=n[0];for(let L=1;L<n.length;L++){P=!P;const z=n[L];v=M*f,M+=z,S=M*f,m.push({left:v,right:S,isDash:P,zeroLength:z===0})}return m}addRoundDash(n,a,f){const m=a/2;for(let v=-f;v<=f;v++){const S=this.width*(this.nextRow+f+v);let P=0,M=n[P];for(let L=0;L<this.width;L++){L/M.right>1&&(M=n[++P]);const z=Math.abs(L-M.left),$=Math.abs(L-M.right),O=Math.min(z,$);let Z;const Q=v/f*(m+1);if(M.isDash){const ae=m-Math.abs(Q);Z=Math.sqrt(O*O+ae*ae)}else Z=m-Math.sqrt(O*O+Q*Q);this.data[S+L]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(n){for(let P=n.length-1;P>=0;--P){const M=n[P],L=n[P+1];M.zeroLength?n.splice(P,1):L&&L.isDash===M.isDash&&(L.left=M.left,n.splice(P,1))}const a=n[0],f=n[n.length-1];a.isDash===f.isDash&&(a.left=f.left-this.width,f.right=a.right+this.width);const m=this.width*this.nextRow;let v=0,S=n[v];for(let P=0;P<this.width;P++){P/S.right>1&&(S=n[++v]);const M=Math.abs(P-S.left),L=Math.abs(P-S.right),z=Math.min(M,L);this.data[m+P]=Math.max(0,Math.min(255,(S.isDash?z:-z)+128))}}addDash(n,a){const f=a?7:0,m=2*f+1;if(this.nextRow+m>this.height)return s.w("LineAtlas out of space"),null;let v=0;for(let P=0;P<n.length;P++)v+=n[P];if(v!==0){const P=this.width/v,M=this.getDashRanges(n,this.width,P);a?this.addRoundDash(M,P,f):this.addRegularDash(M)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:v};return this.nextRow+=m,this.dirty=!0,S}bind(n){const a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Ke="maplibre_preloaded_worker_pool";class nt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<nt.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ke]}numActive(){return Object.keys(this.active).length}}const ot=Math.floor(I.hardwareConcurrency/2);let Et,Rt;function lr(){return Et||(Et=new nt),Et}nt.workerCount=s.H(globalThis)?Math.max(Math.min(ot,3),1):1;class gr{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=a;const f=this.workerPool.acquire(a);for(let m=0;m<f.length;m++){const v=new s.J(f[m],a);v.name=`Worker ${m}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,a){const f=[];for(const m of this.actors)f.push(m.sendAsync({type:n,data:a}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,a){for(const f of this.actors)f.registerMessageHandler(n,a)}}function Xt(){return Rt||(Rt=new gr(lr(),s.K),Rt.registerMessageHandler("GR",(y,n,a)=>s.m(n,a))),Rt}function Ii(y,n){const a=s.L();return s.M(a,a,[1,1,0]),s.N(a,a,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?s.O(a,a,y.calculatePosMatrix(n.toUnwrapped())):a}function yr(y,n,a,f,m,v,S){var P;const M=function(O,Z,Q){if(O)for(const ae of O){const se=Z[ae];if(se&&se.source===Q&&se.type==="fill-extrusion")return!0}else for(const ae in Z){const se=Z[ae];if(se.source===Q&&se.type==="fill-extrusion")return!0}return!1}((P=m==null?void 0:m.layers)!==null&&P!==void 0?P:null,n,y.id),L=v.maxPitchScaleFactor(),z=y.tilesIn(f,L,M);z.sort(Cn);const $=[];for(const O of z)$.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(n,a,y._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,m,v,L,Ii(y.transform,O.tileID),S?(Z,Q)=>S(O.tileID,Z,Q):void 0)});return function(O,Z){for(const Q in O)for(const ae of O[Q])br(ae,Z);return O}(function(O){const Z={},Q={};for(const ae of O){const se=ae.queryResults,le=ae.wrappedTileID,ue=Q[le]=Q[le]||{};for(const ge in se){const he=se[ge],_e=ue[ge]=ue[ge]||{},be=Z[ge]=Z[ge]||[];for(const me of he)_e[me.featureIndex]||(_e[me.featureIndex]=!0,be.push(me))}}return Z}($),y)}function Cn(y,n){const a=y.tileID,f=n.tileID;return a.overscaledZ-f.overscaledZ||a.canonical.y-f.canonical.y||a.wrap-f.wrap||a.canonical.x-f.canonical.x}function br(y,n){const a=y.feature,f=n.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=f}function Ri(y,n,a){return s._(this,void 0,void 0,function*(){let f=y;if(y.url?f=(yield s.j(n.transformRequest(y.url,"Source"),a)).data:yield I.frameAsync(a),!f)return null;const m=s.Q(s.e(f,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(m.vectorLayerIds=f.vector_layers.map(v=>v.id)),m})}class vr{constructor(n,a){n&&(a?this.setSouthWest(n).setNorthEast(a):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof s.S?new s.S(n.lng,n.lat):s.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof s.S?new s.S(n.lng,n.lat):s.S.convert(n),this}extend(n){const a=this._sw,f=this._ne;let m,v;if(n instanceof s.S)m=n,v=n;else{if(!(n instanceof vr))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(vr.convert(n)):this.extend(s.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(s.S.convert(n)):this;if(m=n._sw,v=n._ne,!m||!v)return this}return a||f?(a.lng=Math.min(m.lng,a.lng),a.lat=Math.min(m.lat,a.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new s.S(m.lng,m.lat),this._ne=new s.S(v.lng,v.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:f}=s.S.convert(n);let m=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&m}static convert(n){return n instanceof vr?n:n&&new vr(n)}static fromLngLat(n,a=0){const f=360*a/40075017,m=f/Math.cos(Math.PI/180*n.lat);return new vr(new s.S(n.lng-m,n.lat-f),new s.S(n.lng+m,n.lat+f))}adjustAntiMeridian(){const n=new s.S(this._sw.lng,this._sw.lat),a=new s.S(this._ne.lng,this._ne.lat);return new vr(n,n.lng>a.lng?new s.S(a.lng+360,a.lat):a)}}class ii{constructor(n,a,f){this.bounds=vr.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const a=Math.pow(2,n.z),f=Math.floor(s.V(this.bounds.getWest())*a),m=Math.floor(s.U(this.bounds.getNorth())*a),v=Math.ceil(s.V(this.bounds.getEast())*a),S=Math.ceil(s.U(this.bounds.getSouth())*a);return n.x>=f&&n.x<v&&n.y>=m&&n.y<S}}class Xn extends s.E{constructor(n,a,f,m){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(a,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Ri(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(s.e(this,n),n.bounds&&(this.tileBounds=new ii(n.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new s.k(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(n){return s._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(a,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((v,S)=>{n.reloadPromise={resolve:v,reject:S}})}else n.actor=this.dispatcher.getActor(),m="LT";n.abortController=new AbortController;try{const v=yield n.actor.sendAsync({type:m,data:f},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,v)}catch(v){if(delete n.abortController,n.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,a){if(a&&a.resourceTiming&&(n.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&n.setExpiryData(a),n.loadVectorData(a,this.map.painter),n.reloadPromise){const f=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(f.resolve).catch(f.reject)}}abortTile(n){return s._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return s._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ao extends s.E{constructor(n,a,f,m){super(),this.id=n,this.dispatcher=f,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},a),s.e(this,s.Q(a,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(n=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Ri(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(s.e(this,a),a.bounds&&(this.tileBounds=new ii(a.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(a){this._tileJSONRequest=null,this.fire(new s.k(a))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return s.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return s._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const f=yield ne.getImage(this.map._requestManager.transformRequest(a,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const m=this.map.painter.context,v=m.gl,S=f.data;n.texture=this.map.painter.getTileTexture(S.width),n.texture?n.texture.update(S,{useMipmap:!0}):(n.texture=new s.T(m,S,v.RGBA,{useMipmap:!0}),n.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}})}abortTile(n){return s._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return s._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class en extends ao{constructor(n,a,f,m){super(n,a,f,m),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(n){return s._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(a,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const m=yield ne.getImage(f,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(m&&m.data){const v=m.data;this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&n.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const S=s.b(v)&&s.W()?v:yield this.readImageNow(v),P={type:this.type,uid:n.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const M=yield n.actor.sendAsync({type:"LDT",data:P});n.dem=M,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(m){if(delete n.abortController,n.aborted)n.state="unloaded";else if(m)throw n.state="errored",m}})}readImageNow(n){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const a=n.width+2,f=n.height+2;try{return new s.R({width:a,height:f},yield s.Y(n,-1,-1,a,f))}catch{}}return I.getImageData(n,1)})}_getNeighboringTiles(n){const a=n.canonical,f=Math.pow(2,a.z),m=(a.x-1+f)%f,v=a.x===0?n.wrap-1:n.wrap,S=(a.x+1+f)%f,P=a.x+1===f?n.wrap+1:n.wrap,M={};return M[new s.Z(n.overscaledZ,v,a.z,m,a.y).key]={backfilled:!1},M[new s.Z(n.overscaledZ,P,a.z,S,a.y).key]={backfilled:!1},a.y>0&&(M[new s.Z(n.overscaledZ,v,a.z,m,a.y-1).key]={backfilled:!1},M[new s.Z(n.overscaledZ,n.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},M[new s.Z(n.overscaledZ,P,a.z,S,a.y-1).key]={backfilled:!1}),a.y+1<f&&(M[new s.Z(n.overscaledZ,v,a.z,m,a.y+1).key]={backfilled:!1},M[new s.Z(n.overscaledZ,n.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},M[new s.Z(n.overscaledZ,P,a.z,S,a.y+1).key]={backfilled:!1}),M}unloadTile(n){return s._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class yn extends s.E{constructor(n,a,f,m){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(m),this._data=a.data,this._options=s.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(s.$/this.tileSize)}_getClusterMaxZoom(n){const a=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${a}"`),a}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return s._(this,void 0,void 0,function*(){const n=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map(a=>a.coordinates).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const n=new vr,a=yield this.getData();let f;switch(a.type){case"FeatureCollection":f=a.features.map(m=>this.getCoordinatesFromGeometry(m.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(a.geometry);break;default:f=this.getCoordinatesFromGeometry(a)}if(f.length==0)return n;for(let m=0;m<f.length-1;m+=2)n.extend([f[m],f[m+1]]);return n})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,a,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:a,offset:f}})}_updateWorkerData(n){return s._(this,void 0,void 0,function*(){const a=s.e({type:this.type},this.workerOptions);n?a.dataDiff=n:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(I.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let m=null;f.resourceTiming&&f.resourceTiming[this.id]&&(m=f.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&s.e(v,{resourceTiming:m}),this.fire(new s.l("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(f))}})}loaded(){return this._pendingLoads===0}loadTile(n){return s._(this,void 0,void 0,function*(){const a=n.actor?"RT":"LT";n.actor=this.actor;const f={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const m=yield this.actor.sendAsync({type:a,data:f},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(m,this.map.painter,a==="RT")})}abortTile(n){return s._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return s._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class tn extends s.E{constructor(n,a,f,m){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=f,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=a}load(n){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield ne.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,n&&(this.coordinates=n),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new s.k(a))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const a=n.map(s.a0.fromLngLat);var f;return this.tileID=function(m){const v=s.a1.fromPoints(m),S=v.width(),P=v.height(),M=Math.max(S,P),L=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),z=Math.pow(2,L);return new s.a3(L,Math.floor((v.minX+v.maxX)/2*z),Math.floor((v.minY+v.maxY)/2*z))}(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map(m=>this.tileID.getTilePoint(m)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,a=n.gl;this.texture||(this.texture=new s.T(n,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let f=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:a,minY:f,maxX:m,maxY:v}=s.a1.fromPoints(n),S={};for(let P=0;P<=s.a2;P++){const M=Math.pow(2,P),L=Math.floor(a*M),z=Math.floor(f*M),$=Math.floor(m*M),O=Math.floor(v*M);S[P]={minTileX:L,minTileY:z,maxTileX:$,maxTileY:O}}return S}}class Lo extends tn{constructor(n,a,f,m){super(n,a,f,m),this.roundZoom=!0,this.type="video",this.options=a}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const a of n.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield s.a4(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new s.k(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const a=this.video.seekable;n<a.start(0)||n>a.end(0)?this.fire(new s.k(new s.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,a=n.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(n,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let f=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class yi extends tn{constructor(n,a,f,m){super(n,a,f,m),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(S=>typeof S!="number"))||this.fire(new s.k(new s.a5(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a5(`sources.${n}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new s.k(new s.a5(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a5(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a5(`sources.${n}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,f=a.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(a,this.canvas,f.RGBA,{premultiply:!0});let m=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,m=!0)}m&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Os={},oi=y=>{switch(y){case"geojson":return yn;case"image":return tn;case"raster":return ao;case"raster-dem":return en;case"vector":return Xn;case"video":return Lo;case"canvas":return yi}return Os[y]},lo="RTLPluginLoaded";class ns extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Xt()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return s._(this,arguments,void 0,function*(a,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=I.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(lo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Hr=null;function un(){return Hr||(Hr=new ns),Hr}class Ki{constructor(n,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=s.a6(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const a=n+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,a,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(m,v){const S={};if(!v)return S;for(const P of m){const M=P.layerIds.map(L=>v.getLayer(L)).filter(Boolean);if(M.length!==0){P.layers=M,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(L=>M.filter(z=>z.id===L)[0]));for(const L of M)S[L.id]=P}}return S}(n.buckets,a==null?void 0:a.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof s.a8){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof s.a8&&v.hasRTLText){this.hasRTLText=!0,un().lazyLoad();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(m).queryRadius(v))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new s.a7}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const f in this.buckets){const m=this.buckets[f];m.uploadPending()&&m.upload(n)}const a=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(n,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(n,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,a,f,m,v,S,P,M,L,z,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:v,scale:S,tileSize:this.tileSize,pixelPosMatrix:z,transform:M,params:P,queryPadding:this.queryPadding*L,getElevation:$},n,a,f):{}}querySourceFeatures(n,a){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const m=f.loadVTLayers(),v=a&&a.sourceLayer?a.sourceLayer:"",S=m._geojsonTileLayer||m[v];if(!S)return;const P=s.a9(a&&a.filter),{z:M,x:L,y:z}=this.tileID.canonical,$={z:M,x:L,y:z};for(let O=0;O<S.length;O++){const Z=S.feature(O);if(P.needGeometry){const se=s.aa(Z,!0);if(!P.filter(new s.F(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!P.filter(new s.F(this.tileID.overscaledZ),Z))continue;const Q=f.getId(Z,v),ae=new s.ab(Z,M,L,z,Q);ae.tile=$,n.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const a=this.expirationTime;if(n.cacheControl){const f=s.ac(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let m=!1;if(this.expirationTime>f)m=!1;else if(a)if(this.expirationTime<a)m=!0;else{const v=this.expirationTime-a;v?this.expirationTime=f+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!a.style.hasLayer(m))continue;const v=this.buckets[m],S=v.layers[0].sourceLayer||"_geojsonTileLayer",P=f[S],M=n[S];if(!P||!M||Object.keys(M).length===0)continue;v.update(M,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=a&&a.style&&a.style.getLayer(m);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<I.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=I.now()+n}setDependencies(n,a){const f={};for(const m of a)f[m]=!0;this.dependencies[n]=f}hasDependency(n,a){for(const f of n){const m=this.dependencies[f];if(m){for(const v of a)if(m[v])return!0}}return!1}}class xa{constructor(n,a){this.max=n,this.onRemove=a,this.reset()}reset(){for(const n in this.data)for(const a of this.data[n])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(n,a,f){const m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:a,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},f)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value}getByKey(n){const a=this.data[n];return a?a[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,a){if(!this.has(n))return this;const f=n.wrapped().key,m=a===void 0?0:this.data[f].indexOf(a),v=this.data[f][m];return this.data[f].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(n){const a=[];for(const f in this.data)for(const m of this.data[f])n(m.value)||a.push(m);for(const f of a)this.remove(f.value.tileID,f)}}class is{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,a,f){const m=String(a);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][m]=this.stateChanges[n][m]||{},s.e(this.stateChanges[n][m],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==m&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][m]===null){this.deletedStates[n][m]={};for(const v in this.state[n][m])f[v]||(this.deletedStates[n][m][v]=null)}else for(const v in f)this.deletedStates[n]&&this.deletedStates[n][m]&&this.deletedStates[n][m][v]===null&&delete this.deletedStates[n][m][v]}removeFeatureState(n,a,f){if(this.deletedStates[n]===null)return;const m=String(a);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&a!==void 0)this.deletedStates[n][m]!==null&&(this.deletedStates[n][m]=this.deletedStates[n][m]||{},this.deletedStates[n][m][f]=null);else if(a!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][m])for(f in this.deletedStates[n][m]={},this.stateChanges[n][m])this.deletedStates[n][m][f]=null;else this.deletedStates[n][m]=null;else this.deletedStates[n]=null}getState(n,a){const f=String(a),m=s.e({},(this.state[n]||{})[f],(this.stateChanges[n]||{})[f]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const v=this.deletedStates[n][a];if(v===null)return{};for(const S in v)delete m[S]}return m}initializeTileState(n,a){n.setFeatureState(this.state,a)}coalesceChanges(n,a){const f={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const S in this.stateChanges[m])this.state[m][S]||(this.state[m][S]={}),s.e(this.state[m][S],this.stateChanges[m][S]),v[S]=this.state[m][S];f[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const S in this.state[m])v[S]={},this.state[m][S]={};else for(const S in this.deletedStates[m]){if(this.deletedStates[m][S]===null)this.state[m][S]={};else for(const P of Object.keys(this.deletedStates[m][S]))delete this.state[m][S][P];v[S]=this.state[m][S]}f[m]=f[m]||{},s.e(f[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const m in n)n[m].setFeatureState(f,a)}}const co=89.25;function Ee(y,n){const a=s.ag(n.lat,-s.ah,s.ah);return new s.P(s.V(n.lng)*y,s.U(a)*y)}function ee(y,n){return new s.a0(n.x/y,n.y/y).toLngLat()}function te(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(s.ad(90-y.pitch)),Math.tan(s.ad(co-y.pitch)))}function oe(y,n){const a=y.canonical,f=n/s.ae(a.z),m=a.x+Math.pow(2,a.z)*y.wrap,v=s.af(new Float64Array(16));return s.M(v,v,[m*f,a.y*f,0]),s.N(v,v,[f/s.$,f/s.$,1]),v}function fe(y,n,a,f,m){const v=s.a0.fromLngLat(y,n),S=m*s.ai(1,y.lat),P=S*Math.cos(s.ad(a)),M=Math.sqrt(S*S-P*P),L=M*Math.sin(s.ad(-f)),z=M*Math.cos(s.ad(-f));return new s.a0(v.x+L,v.y+z,v.z+P)}function we(y,n,a){const f=n.intersectsFrustum(y);if(!a||f===0)return f;const m=n.intersectsPlane(a);return m===0?0:f===2&&m===2?2:1}function Pe(y,n,a){let f=0;const m=(a-n)/10;for(let v=0;v<10;v++)f+=m*Math.pow(Math.cos(n+(v+.5)/10*(a-n)),y);return f}function Re(y,n){return function(a,f,m,v,S){const P=2*((y-1)/s.aj(Math.cos(s.ad(co-S))/Math.cos(s.ad(co)))-1),M=Math.acos(m/v),L=2*Pe(P-1,0,s.ad(S/2)),z=Math.min(s.ad(co),M+s.ad(S/2)),$=Pe(P-1,Math.min(z,M-s.ad(S/2)),z),O=Math.atan(f/m),Z=Math.hypot(f,m);let Q=a;return Q+=s.aj(v/Z/Math.max(.5,Math.cos(s.ad(S/2)))),Q+=P*s.aj(Math.cos(O))/2,Q-=s.aj(Math.max(1,$/L/n))/2,Q}}const Te=Re(9.314,3);function $e(y,n){const a=(n.roundZoom?Math.round:Math.floor)(y.zoom+s.aj(y.tileSize/n.tileSize));return Math.max(0,a)}function Fe(y,n){const a=y.getCameraFrustum(),f=y.getClippingPlane(),m=y.screenPointToMercatorCoordinate(y.getCameraPoint()),v=s.a0.fromLngLat(y.center,y.elevation);m.z=v.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const S=y.getCoveringTilesDetailsProvider(),P=S.allowVariableZoom(y,n),M=$e(y,n),L=n.minzoom||0,z=n.maxzoom!==void 0?n.maxzoom:y.maxZoom,$=Math.min(Math.max(0,M),z),O=Math.pow(2,$),Z=[O*m.x,O*m.y,0],Q=[O*v.x,O*v.y,0],ae=Math.hypot(v.x-m.x,v.y-m.y),se=Math.abs(v.z-m.z),le=Math.hypot(ae,se),ue=_e=>({zoom:0,x:0,y:0,wrap:_e,fullyVisible:!1}),ge=[],he=[];if(y.renderWorldCopies&&S.allowWorldCopies())for(let _e=1;_e<=3;_e++)ge.push(ue(-_e)),ge.push(ue(_e));for(ge.push(ue(0));ge.length>0;){const _e=ge.pop(),be=_e.x,me=_e.y;let Ce=_e.fullyVisible;const Ne={x:be,y:me,z:_e.zoom},Ae=S.getTileBoundingVolume(Ne,_e.wrap,y.elevation,n);if(!Ce){const ct=we(a,Ae,f);if(ct===0)continue;Ce=ct===2}const Ie=S.distanceToTile2d(m.x,m.y,Ne,Ae);let je=M;P&&(je=(n.calculateTileZoom||Te)(y.zoom+s.aj(y.tileSize/n.tileSize),Ie,se,le,y.fov)),je=(n.roundZoom?Math.round:Math.floor)(je),je=Math.max(0,je);const ht=Math.min(je,z);if(_e.wrap=S.getWrap(v,Ne,_e.wrap),_e.zoom>=ht){if(_e.zoom<L)continue;const ct=$-_e.zoom,Ye=Z[0]-.5-(be<<ct),bt=Z[1]-.5-(me<<ct),$t=n.reparseOverscaled?Math.max(_e.zoom,je):_e.zoom;he.push({tileID:new s.Z(_e.zoom===z?$t:_e.zoom,_e.wrap,_e.zoom,be,me),distanceSq:s.ak([Q[0]-.5-be,Q[1]-.5-me]),tileDistanceToCamera:Math.sqrt(Ye*Ye+bt*bt)})}else for(let ct=0;ct<4;ct++)ge.push({zoom:_e.zoom+1,x:(be<<1)+ct%2,y:(me<<1)+(ct>>1),wrap:_e.wrap,fullyVisible:Ce})}return he.sort((_e,be)=>_e.distanceSq-be.distanceSq).map(_e=>_e.tileID)}const Me=s.a1.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class qe extends s.E{constructor(n,a,f){super(),this.id=n,this.dispatcher=f,this.on("data",m=>this._dataHandler(m)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,v,S,P)=>{const M=new(oi(v.type))(m,v,S,P);if(M.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${M.id}`);return M})(n,a,f,this),this._tiles={},this._cache=new xa(0,m=>this._unloadTile(m)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new is,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const a=this._tiles[n];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,a,f){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,a,f)}catch(m){n.state="errored",m.status!==404?this._source.fire(new s.k(m,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new s.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const f=this._tiles[a];f.upload(n),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(pe).map(n=>n.key)}getRenderableIds(n){const a=[];for(const f in this._tiles)this._isIdRenderable(f,n)&&a.push(this._tiles[f]);return n?a.sort((f,m)=>{const v=f.tileID,S=m.tileID,P=new s.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians),M=new s.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return v.overscaledZ-S.overscaledZ||M.y-P.y||M.x-P.x}).map(f=>f.tileID.key):a.map(f=>f.tileID).sort(pe).map(f=>f.key)}hasRenderableParent(n){const a=this.findLoadedParent(n,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(n,a){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(a||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)n?this._reloadTile(a,"expired"):this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(n,a){return s._(this,void 0,void 0,function*(){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=a),yield this._loadTile(f,n,a))})}_tileLoaded(n,a,f){n.timeAdded=I.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(a,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const a=this.getRenderableIds();for(let m=0;m<a.length;m++){const v=a[m];if(n.neighboringTiles&&n.neighboringTiles[v]){const S=this.getTileByID(v);f(n,S),f(S,n)}}function f(m,v){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let S=v.tileID.canonical.x-m.tileID.canonical.x;const P=v.tileID.canonical.y-m.tileID.canonical.y,M=Math.pow(2,m.tileID.canonical.z),L=v.tileID.key;S===0&&P===0||Math.abs(P)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,S,P),m.neighboringTiles&&m.neighboringTiles[L]&&(m.neighboringTiles[L].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,a,f,m){for(const v in this._tiles){let S=this._tiles[v];if(m[v]||!S.hasData()||S.tileID.overscaledZ<=a||S.tileID.overscaledZ>f)continue;let P=S.tileID;for(;S&&S.tileID.overscaledZ>a+1;){const L=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[L.key],S&&S.hasData()&&(P=L)}let M=P;for(;M.overscaledZ>a;)if(M=M.scaledTo(M.overscaledZ-1),n[M.key]||n[M.canonical.key]){m[P.key]=P;break}}}findLoadedParent(n,a){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=a?f:null}for(let f=n.overscaledZ-1;f>=a;f--){const m=n.scaledTo(f),v=this._getLoadedTile(m);if(v)return v}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const a=this._tiles[n.key];return a&&a.hasData()?a:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const a=Math.ceil(n.width/this._source.tileSize)+1,f=Math.ceil(n.height/this._source.tileSize)+1,m=Math.floor(a*f*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(n){const a=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,a){const f={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),f[v.tileID.key]=v}this._tiles=f;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}_updateCoveredAndRetainedTiles(n,a,f,m,v,S){const P={},M={},L=Object.keys(n),z=I.now();for(const $ of L){const O=n[$],Z=this._tiles[$];if(!Z||Z.fadeEndTime!==0&&Z.fadeEndTime<=z)continue;const Q=this.findLoadedParent(O,a),ae=this.findLoadedSibling(O),se=Q||ae||null;se&&(this._addTile(se.tileID),P[se.tileID.key]=se.tileID),M[$]=O}this._retainLoadedChildren(M,m,f,n);for(const $ in P)n[$]||(this._coveredTiles[$]=!0,n[$]=P[$]);if(S){const $={},O={};for(const Z of v)this._tiles[Z.key].hasData()?$[Z.key]=Z:O[Z.key]=Z;for(const Z in O){const Q=O[Z].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&($[Q[0].key]=n[Q[0].key]=Q[0],$[Q[1].key]=n[Q[1].key]=Q[1],$[Q[2].key]=n[Q[2].key]=Q[2],$[Q[3].key]=n[Q[3].key]=Q[3],delete O[Z])}for(const Z in O){const Q=O[Z],ae=this.findLoadedParent(Q,this._source.minzoom),se=this.findLoadedSibling(Q),le=ae||se||null;if(le){$[le.tileID.key]=n[le.tileID.key]=le.tileID;for(const ue in $)$[ue].isChildOf(le.tileID)&&delete $[ue]}}for(const Z in this._tiles)$[Z]||(this._coveredTiles[Z]=!0)}}update(n,a){if(!this._sourceLoaded||this._paused)return;let f;this.transform=n,this.terrain=a,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new s.Z(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(f=Fe(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(z=>this._source.hasTile(z)))):f=[];const m=$e(n,this._source),v=Math.max(m-qe.maxOverzooming,this._source.minzoom),S=Math.max(m+qe.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const $ of f)if($.canonical.z>this._source.minzoom){const O=$.scaledTo($.canonical.z-1);z[O.key]=O;const Z=$.scaledTo(Math.max(this._source.minzoom,Math.min($.canonical.z,5)));z[Z.key]=Z}f=f.concat(Object.values(z))}const P=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,P&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(f,m);Je(this._source.type)&&this._updateCoveredAndRetainedTiles(M,v,S,m,f,a);for(const z in M)this._tiles[z].clearFadeHold();const L=s.al(this._tiles,M);for(const z of L){const $=this._tiles[z];$.hasSymbolBuckets&&!$.holdingForFade()?$.setHoldDuration(this.map._fadeDuration):$.hasSymbolBuckets&&!$.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,a){var f;const m={},v={},S=Math.max(a-qe.maxOverzooming,this._source.minzoom),P=Math.max(a+qe.maxUnderzooming,this._source.minzoom),M={};for(const L of n){const z=this._addTile(L);m[L.key]=L,z.hasData()||a<this._source.maxzoom&&(M[L.key]=L)}this._retainLoadedChildren(M,a,P,m);for(const L of n){let z=this._tiles[L.key];if(z.hasData())continue;if(a+1>this._source.maxzoom){const O=L.children(this._source.maxzoom)[0],Z=this.getTile(O);if(Z&&Z.hasData()){m[O.key]=O;continue}}else{const O=L.children(this._source.maxzoom);if(m[O[0].key]&&m[O[1].key]&&m[O[2].key]&&m[O[3].key])continue}let $=z.wasRequested();for(let O=L.overscaledZ-1;O>=S;--O){const Z=L.scaledTo(O);if(v[Z.key])break;if(v[Z.key]=!0,z=this.getTile(Z),!z&&$&&(z=this._addTile(Z)),z){const Q=z.hasData();if((Q||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||$)&&(m[Z.key]=Z),$=z.wasRequested(),Q)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const a=[];let f,m=this._tiles[n].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){f=this._loadedParentTiles[m.key];break}a.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;m=v}for(const v of a)this._loadedParentTiles[v]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const a=this._tiles[n].tileID,f=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=f}}_addTile(n){let a=this._tiles[n.key];if(a)return a;a=this._cache.getAndRemove(n),a&&(this._setTileReloadTimer(n.key,a),a.tileID=n,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,a)));const f=a;return a||(a=new Ki(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(a,n.key,a.state)),a.uses++,this._tiles[n.key]=a,f||this._source.fire(new s.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(n,a){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=a.getExpiryTimeout();f&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},f))}refreshTiles(n){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&n.some(f=>f.equals(this._tiles[a].tileID.canonical))&&this._reloadTile(a,"expired")}_removeTile(n){const a=this._tiles[n];a&&(a.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(n){const a=n.sourceDataType;n.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&a==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,a,f){const m=[],v=this.transform;if(!v)return m;const S=v.getCoveringTilesDetailsProvider().allowWorldCopies(),P=f?v.getCameraQueryGeometry(n):n,M=Z=>v.screenPointToMercatorCoordinate(Z,this.terrain),L=this.transformBbox(n,M,!S),z=this.transformBbox(P,M,!S),$=this.getIds(),O=s.a1.fromPoints(z);for(let Z=0;Z<$.length;Z++){const Q=this._tiles[$[Z]];if(Q.holdingForFade())continue;const ae=S?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],se=Math.pow(2,v.zoom-Q.tileID.overscaledZ),le=a*Q.queryPadding*s.$/Q.tileSize/se;for(const ue of ae){const ge=O.map(he=>ue.getTilePoint(new s.a0(he.x,he.y)));if(ge.expandBy(le),ge.intersects(Me)){const he=L.map(be=>ue.getTilePoint(be)),_e=z.map(be=>ue.getTilePoint(be));m.push({tile:Q,tileID:S?ue:ue.unwrapTo(0),queryGeometry:he,cameraQueryGeometry:_e,scale:se})}}}return m}transformBbox(n,a,f){let m=n.map(a);if(f){const v=s.a1.fromPoints(n);v.shrinkBy(.001*Math.min(v.width(),v.height()));const S=v.map(a);s.a1.fromPoints(m).covers(S)||(m=m.map(P=>P.x>.5?new s.a0(P.x-1,P.y,P.z):P))}return m}getVisibleCoordinates(n){const a=this.getRenderableIds(n).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(Je(this._source.type)){const n=I.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=n)return!0}return!1}setFeatureState(n,a,f){this._state.updateState(n=n||"_geojsonTileLayer",a,f)}removeFeatureState(n,a,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",a,f)}getFeatureState(n,a){return this._state.getState(n=n||"_geojsonTileLayer",a)}setDependencies(n,a,f){const m=this._tiles[n];m&&m.setDependencies(a,f)}reloadTilesForDependencies(n,a){for(const f in this._tiles)this._tiles[f].hasDependency(n,a)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(n,a))}}function pe(y,n){const a=Math.abs(2*y.wrap)-+(y.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return y.overscaledZ-n.overscaledZ||f-a||n.canonical.y-y.canonical.y||n.canonical.x-y.canonical.x}function Je(y){return y==="raster"||y==="image"||y==="video"}qe.maxOverzooming=10,qe.maxUnderzooming=3;class vt{constructor(n,a){this.reset(n,a)}reset(n,a){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=s.ag(n,0,1);let a=1,f=this._distances[a];const m=n*this.paddedLength+this.padding;for(;f<m&&a<this._distances.length;)f=this._distances[++a];const v=a-1,S=this._distances[v],P=f-S,M=P>0?(m-S)/P:0;return this.points[v].mult(1-M).add(this.points[a].mult(M))}}function mt(y,n){let a=!0;return y==="always"||y!=="never"&&n!=="never"||(a=!1),a}class xt{constructor(n,a,f){const m=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(a/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)m.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,a,f,m,v){this._forEachCell(a,f,m,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(v)}insertCircle(n,a,f,m){this._forEachCell(a-m,f-m,a+m,f+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(f),this.circles.push(m)}_insertBoxCell(n,a,f,m,v,S){this.boxCells[v].push(S)}_insertCircleCell(n,a,f,m,v,S){this.circleCells[v].push(S)}_query(n,a,f,m,v,S,P){if(f<0||n>this.width||m<0||a>this.height)return[];const M=[];if(n<=0&&a<=0&&this.width<=f&&this.height<=m){if(v)return[{key:null,x1:n,y1:a,x2:f,y2:m}];for(let L=0;L<this.boxKeys.length;L++)M.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const z=this.circles[3*L],$=this.circles[3*L+1],O=this.circles[3*L+2];M.push({key:this.circleKeys[L],x1:z-O,y1:$-O,x2:z+O,y2:$+O})}}else this._forEachCell(n,a,f,m,this._queryCell,M,{hitTest:v,overlapMode:S,seenUids:{box:{},circle:{}}},P);return M}query(n,a,f,m){return this._query(n,a,f,m,!1,null)}hitTest(n,a,f,m,v,S){return this._query(n,a,f,m,!0,v,S).length>0}hitTestCircle(n,a,f,m,v){const S=n-f,P=n+f,M=a-f,L=a+f;if(P<0||S>this.width||L<0||M>this.height)return!1;const z=[];return this._forEachCell(S,M,P,L,this._queryCellCircle,z,{hitTest:!0,overlapMode:m,circle:{x:n,y:a,radius:f},seenUids:{box:{},circle:{}}},v),z.length>0}_queryCell(n,a,f,m,v,S,P,M){const{seenUids:L,hitTest:z,overlapMode:$}=P,O=this.boxCells[v];if(O!==null){const Q=this.bboxes;for(const ae of O)if(!L.box[ae]){L.box[ae]=!0;const se=4*ae,le=this.boxKeys[ae];if(n<=Q[se+2]&&a<=Q[se+3]&&f>=Q[se+0]&&m>=Q[se+1]&&(!M||M(le))&&(!z||!mt($,le.overlapMode))&&(S.push({key:le,x1:Q[se],y1:Q[se+1],x2:Q[se+2],y2:Q[se+3]}),z))return!0}}const Z=this.circleCells[v];if(Z!==null){const Q=this.circles;for(const ae of Z)if(!L.circle[ae]){L.circle[ae]=!0;const se=3*ae,le=this.circleKeys[ae];if(this._circleAndRectCollide(Q[se],Q[se+1],Q[se+2],n,a,f,m)&&(!M||M(le))&&(!z||!mt($,le.overlapMode))){const ue=Q[se],ge=Q[se+1],he=Q[se+2];if(S.push({key:le,x1:ue-he,y1:ge-he,x2:ue+he,y2:ge+he}),z)return!0}}}return!1}_queryCellCircle(n,a,f,m,v,S,P,M){const{circle:L,seenUids:z,overlapMode:$}=P,O=this.boxCells[v];if(O!==null){const Q=this.bboxes;for(const ae of O)if(!z.box[ae]){z.box[ae]=!0;const se=4*ae,le=this.boxKeys[ae];if(this._circleAndRectCollide(L.x,L.y,L.radius,Q[se+0],Q[se+1],Q[se+2],Q[se+3])&&(!M||M(le))&&!mt($,le.overlapMode))return S.push(!0),!0}}const Z=this.circleCells[v];if(Z!==null){const Q=this.circles;for(const ae of Z)if(!z.circle[ae]){z.circle[ae]=!0;const se=3*ae,le=this.circleKeys[ae];if(this._circlesCollide(Q[se],Q[se+1],Q[se+2],L.x,L.y,L.radius)&&(!M||M(le))&&!mt($,le.overlapMode))return S.push(!0),!0}}}_forEachCell(n,a,f,m,v,S,P,M){const L=this._convertToXCellCoord(n),z=this._convertToYCellCoord(a),$=this._convertToXCellCoord(f),O=this._convertToYCellCoord(m);for(let Z=L;Z<=$;Z++)for(let Q=z;Q<=O;Q++)if(v.call(this,n,a,f,m,this.xCellCount*Q+Z,S,P,M))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,a,f,m,v,S){const P=m-n,M=v-a,L=f+S;return L*L>P*P+M*M}_circleAndRectCollide(n,a,f,m,v,S,P){const M=(S-m)/2,L=Math.abs(n-(m+M));if(L>M+f)return!1;const z=(P-v)/2,$=Math.abs(a-(v+z));if($>z+f)return!1;if(L<=M||$<=z)return!0;const O=L-M,Z=$-z;return O*O+Z*Z<=f*f}}function At(y,n,a){const f=s.L();if(!y){const{vecSouth:$,vecEast:O}=Ut(n),Z=w();Z[0]=O[0],Z[1]=O[1],Z[2]=$[0],Z[3]=$[1],m=Z,(z=(S=(v=Z)[0])*(L=v[3])-(M=v[2])*(P=v[1]))&&(m[0]=L*(z=1/z),m[1]=-P*z,m[2]=-M*z,m[3]=S*z),f[0]=Z[0],f[1]=Z[1],f[4]=Z[2],f[5]=Z[3]}var m,v,S,P,M,L,z;return s.N(f,f,[1/a,1/a,1]),f}function ur(y,n,a,f){if(y){const m=s.L();if(!n){const{vecSouth:v,vecEast:S}=Ut(a);m[0]=S[0],m[1]=S[1],m[4]=v[0],m[5]=v[1]}return s.N(m,m,[f,f,1]),m}return a.pixelsToClipSpaceMatrix}function Ut(y){const n=Math.cos(y.rollInRadians),a=Math.sin(y.rollInRadians),f=Math.cos(y.pitchInRadians),m=Math.cos(y.bearingInRadians),v=Math.sin(y.bearingInRadians),S=s.aq();S[0]=-m*f*a-v*n,S[1]=-v*f*a+m*n;const P=s.ar(S);P<1e-9?s.as(S):s.at(S,S,1/P);const M=s.aq();M[0]=m*f*n-v*a,M[1]=v*f*n+m*a;const L=s.ar(M);return L<1e-9?s.as(M):s.at(M,M,1/L),{vecEast:M,vecSouth:S}}function Gt(y,n,a,f){let m;f?(m=[y,n,f(y,n),1],s.av(m,m,a)):(m=[y,n,0,1],wa(m,m,a));const v=m[3];return{point:new s.P(m[0]/v,m[1]/v),signedDistanceFromCamera:v,isOccluded:!1}}function Nt(y,n){return .5+y/n*.5}function ir(y,n){return y.x>=-n[0]&&y.x<=n[0]&&y.y>=-n[1]&&y.y<=n[1]}function Pn(y,n,a,f,m,v,S,P,M,L,z,$,O){const Z=a?y.textSizeData:y.iconSizeData,Q=s.am(Z,n.transform.zoom),ae=[256/n.width*2+1,256/n.height*2+1],se=a?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;se.clear();const le=y.lineVertexArray,ue=a?y.text.placedSymbolArray:y.icon.placedSymbolArray,ge=n.transform.width/n.transform.height;let he=!1;for(let _e=0;_e<ue.length;_e++){const be=ue.get(_e);if(be.hidden||be.writingMode===s.an.vertical&&!he){os(be.numGlyphs,se);continue}he=!1;const me=new s.P(be.anchorX,be.anchorY),Ce={getElevation:O,pitchedLabelPlaneMatrix:f,lineVertexArray:le,pitchWithMap:v,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:me,unwrappedTileID:M,width:L,height:z,translation:$},Ne=Zt(be.anchorX,be.anchorY,Ce);if(!ir(Ne.point,ae)){os(be.numGlyphs,se);continue}const Ae=Nt(n.transform.cameraToCenterDistance,Ne.signedDistanceFromCamera),Ie=s.ao(Z,Q,be),je=v?Ie*n.transform.getPitchedTextCorrection(be.anchorX,be.anchorY,M)/Ae:Ie*Ae,ht=Lr({projectionContext:Ce,pitchedLabelPlaneMatrixInverse:m,symbol:be,fontSize:je,flip:!1,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ge,rotateToLine:P});he=ht.useVertical,(ht.notEnoughRoom||he||ht.needsFlipping&&Lr({projectionContext:Ce,pitchedLabelPlaneMatrixInverse:m,symbol:be,fontSize:je,flip:!0,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ge,rotateToLine:P}).notEnoughRoom)&&os(be.numGlyphs,se)}a?y.text.dynamicLayoutVertexBuffer.updateData(se):y.icon.dynamicLayoutVertexBuffer.updateData(se)}function lt(y,n,a,f,m,v,S,P){const M=v.glyphStartIndex+v.numGlyphs,L=v.lineStartIndex,z=v.lineStartIndex+v.lineLength,$=n.getoffsetX(v.glyphStartIndex),O=n.getoffsetX(M-1),Z=Do(y*$,a,f,m,v.segment,L,z,P,S);if(!Z)return null;const Q=Do(y*O,a,f,m,v.segment,L,z,P,S);return Q?P.projectionCache.anyProjectionOccluded?null:{first:Z,last:Q}:null}function Bn(y,n,a,f){return y===s.an.horizontal&&Math.abs(a.y-n.y)>Math.abs(a.x-n.x)*f?{useVertical:!0}:(y===s.an.vertical?n.y<a.y:n.x>a.x)?{needsFlipping:!0}:null}function Lr(y){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:a,symbol:f,fontSize:m,flip:v,keepUpright:S,glyphOffsetArray:P,dynamicLayoutVertexArray:M,aspectRatio:L,rotateToLine:z}=y,$=m/24,O=f.lineOffsetX*$,Z=f.lineOffsetY*$;let Q;if(f.numGlyphs>1){const ae=f.glyphStartIndex+f.numGlyphs,se=f.lineStartIndex,le=f.lineStartIndex+f.lineLength,ue=lt($,P,O,Z,v,f,z,n);if(!ue)return{notEnoughRoom:!0};const ge=qt(ue.first.point.x,ue.first.point.y,n,a),he=qt(ue.last.point.x,ue.last.point.y,n,a);if(S&&!v){const _e=Bn(f.writingMode,ge,he,L);if(_e)return _e}Q=[ue.first];for(let _e=f.glyphStartIndex+1;_e<ae-1;_e++){const be=Do($*P.getoffsetX(_e),O,Z,v,f.segment,se,le,n,z);if(!be)return{notEnoughRoom:!0};Q.push(be)}Q.push(ue.last)}else{if(S&&!v){const se=dt(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,le=f.lineStartIndex+f.segment+1,ue=new s.P(n.lineVertexArray.getx(le),n.lineVertexArray.gety(le)),ge=dt(ue.x,ue.y,n),he=ge.signedDistanceFromCamera>0?ge.point:Fs(n.tileAnchorPoint,ue,se,1,n),_e=qt(se.x,se.y,n,a),be=qt(he.x,he.y,n,a),me=Bn(f.writingMode,_e,be,L);if(me)return me}const ae=Do($*P.getoffsetX(f.glyphStartIndex),O,Z,v,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,n,z);if(!ae||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[ae]}for(const ae of Q)s.au(M,ae.point,ae.angle);return{}}function Fs(y,n,a,f,m){const v=y.add(y.sub(n)._unit()),S=dt(v.x,v.y,m).point,P=a.sub(S);return a.add(P._mult(f/P.mag()))}function ba(y,n,a){const f=n.projectionCache;if(f.projections[y])return f.projections[y];const m=new s.P(n.lineVertexArray.getx(y),n.lineVertexArray.gety(y)),v=dt(m.x,m.y,n);if(v.signedDistanceFromCamera>0)return f.projections[y]=v.point,f.anyProjectionOccluded=f.anyProjectionOccluded||v.isOccluded,v.point;const S=y-a.direction;return Fs(a.distanceFromAnchor===0?n.tileAnchorPoint:new s.P(n.lineVertexArray.getx(S),n.lineVertexArray.gety(S)),m,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,n)}function dt(y,n,a){const f=y+a.translation[0],m=n+a.translation[1];let v;return a.pitchWithMap?(v=Gt(f,m,a.pitchedLabelPlaneMatrix,a.getElevation),v.isOccluded=!1):(v=a.transform.projectTileCoordinates(f,m,a.unwrappedTileID,a.getElevation),v.point.x=(.5*v.point.x+.5)*a.width,v.point.y=(.5*-v.point.y+.5)*a.height),v}function qt(y,n,a,f){if(a.pitchWithMap){const m=[y,n,0,1];return s.av(m,m,f),a.transform.projectTileCoordinates(m[0]/m[3],m[1]/m[3],a.unwrappedTileID,a.getElevation).point}return{x:y/a.width*2-1,y:1-n/a.height*2}}function Zt(y,n,a){return a.transform.projectTileCoordinates(y,n,a.unwrappedTileID,a.getElevation)}function Li(y,n,a){return y._unit()._perp()._mult(n*a)}function dh(y,n,a,f,m,v,S,P,M){if(P.projectionCache.offsets[y])return P.projectionCache.offsets[y];const L=a.add(n);if(y+M.direction<f||y+M.direction>=m)return P.projectionCache.offsets[y]=L,L;const z=ba(y+M.direction,P,M),$=Li(z.sub(a),S,M.direction),O=a.add($),Z=z.add($);return P.projectionCache.offsets[y]=s.aw(v,L,O,Z)||L,P.projectionCache.offsets[y]}function Do(y,n,a,f,m,v,S,P,M){const L=f?y-n:y+n;let z=L>0?1:-1,$=0;f&&(z*=-1,$=Math.PI),z<0&&($+=Math.PI);let O,Z=z>0?v+m:v+m+1;P.projectionCache.cachedAnchorPoint?O=P.projectionCache.cachedAnchorPoint:(O=dt(P.tileAnchorPoint.x,P.tileAnchorPoint.y,P).point,P.projectionCache.cachedAnchorPoint=O);let Q,ae,se=O,le=O,ue=0,ge=0;const he=Math.abs(L),_e=[];let be;for(;ue+ge<=he;){if(Z+=z,Z<v||Z>=S)return null;ue+=ge,le=se,ae=Q;const Ne={absOffsetX:he,direction:z,distanceFromAnchor:ue,previousVertex:le};if(se=ba(Z,P,Ne),a===0)_e.push(le),be=se.sub(le);else{let Ae;const Ie=se.sub(le);Ae=Ie.mag()===0?Li(ba(Z+z,P,Ne).sub(se),a,z):Li(Ie,a,z),ae||(ae=le.add(Ae)),Q=dh(Z,Ae,se,v,S,ae,a,P,Ne),_e.push(ae),be=Q.sub(ae)}ge=be.mag()}const me=be._mult((he-ue)/ge)._add(ae||le),Ce=$+Math.atan2(se.y-le.y,se.x-le.x);return _e.push(me),{point:me,angle:M?Ce:0,path:_e}}const Wt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function os(y,n){for(let a=0;a<y;a++){const f=n.length;n.resize(f+4),n.float32.set(Wt,3*f)}}function wa(y,n,a){const f=n[0],m=n[1];return y[0]=a[0]*f+a[4]*m+a[12],y[1]=a[1]*f+a[5]*m+a[13],y[3]=a[3]*f+a[7]*m+a[15],y}const rn=100;class Mc{constructor(n,a=new xt(n.width+200,n.height+200,25),f=new xt(n.width+200,n.height+200,25)){this.transform=n,this.grid=a,this.ignoredGrid=f,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+rn,this.screenBottomBoundary=n.height+rn,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,a,f,m,v,S,P,M,L,z,$,O){const Z=this.projectAndGetPerspectiveRatio(n.anchorPointX+M[0],n.anchorPointY+M[1],v,z,O),Q=f*Z.perspectiveRatio;let ae;if(S||P)ae=this._projectCollisionBox(n,Q,m,v,S,P,M,Z,z,$,O);else{const be=Z.x+($?$.x*Q:0),me=Z.y+($?$.y*Q:0);ae={allPointsOccluded:!1,box:[be+n.x1*Q,me+n.y1*Q,be+n.x2*Q,me+n.y2*Q]}}const[se,le,ue,ge]=ae.box,he=S?ae.allPointsOccluded:Z.isOccluded;let _e=he;return _e||(_e=Z.perspectiveRatio<this.perspectiveRatioCutoff),_e||(_e=!this.isInsideGrid(se,le,ue,ge)),_e||a!=="always"&&this.grid.hitTest(se,le,ue,ge,a,L)?{box:[se,le,ue,ge],placeable:!1,offscreen:!1,occluded:he}:{box:[se,le,ue,ge],placeable:!0,offscreen:this.isOffscreen(se,le,ue,ge),occluded:he}}placeCollisionCircles(n,a,f,m,v,S,P,M,L,z,$,O,Z,Q){const ae=[],se=new s.P(a.anchorX,a.anchorY),le=this.getPerspectiveRatio(se.x,se.y,S,Q),ue=(L?v*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,S)/le:v*le)/s.aA,ge={getElevation:Q,pitchedLabelPlaneMatrix:P,lineVertexArray:f,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:Z},he=lt(ue,m,a.lineOffsetX*ue,a.lineOffsetY*ue,!1,a,!1,ge);let _e=!1,be=!1,me=!0;if(he){const Ce=.5*$*le+O,Ne=new s.P(-100,-100),Ae=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Ie=new vt,je=he.first,ht=he.last;let ct=[];for(let $t=je.path.length-1;$t>=1;$t--)ct.push(je.path[$t]);for(let $t=1;$t<ht.path.length;$t++)ct.push(ht.path[$t]);const Ye=2.5*Ce;if(L){const $t=this.projectPathToScreenSpace(ct,ge);ct=$t.some(fr=>fr.signedDistanceFromCamera<=0)?[]:$t.map(fr=>fr.point)}let bt=[];if(ct.length>0){const $t=ct[0].clone(),fr=ct[0].clone();for(let jr=1;jr<ct.length;jr++)$t.x=Math.min($t.x,ct[jr].x),$t.y=Math.min($t.y,ct[jr].y),fr.x=Math.max(fr.x,ct[jr].x),fr.y=Math.max(fr.y,ct[jr].y);bt=$t.x>=Ne.x&&fr.x<=Ae.x&&$t.y>=Ne.y&&fr.y<=Ae.y?[ct]:fr.x<Ne.x||$t.x>Ae.x||fr.y<Ne.y||$t.y>Ae.y?[]:s.ax([ct],Ne.x,Ne.y,Ae.x,Ae.y)}for(const $t of bt){Ie.reset($t,.25*Ce);let fr=0;fr=Ie.length<=.5*Ce?1:Math.ceil(Ie.paddedLength/Ye)+1;for(let jr=0;jr<fr;jr++){const Sr=jr/Math.max(fr-1,1),Or=Ie.lerp(Sr),Cr=Or.x+rn,Tr=Or.y+rn;ae.push(Cr,Tr,Ce,0);const Pr=Cr-Ce,Vn=Tr-Ce,cr=Cr+Ce,kn=Tr+Ce;if(me=me&&this.isOffscreen(Pr,Vn,cr,kn),be=be||this.isInsideGrid(Pr,Vn,cr,kn),n!=="always"&&this.grid.hitTestCircle(Cr,Tr,Ce,n,z)&&(_e=!0,!M))return{circles:[],offscreen:!1,collisionDetected:_e}}}}return{circles:!M&&_e||!be||le<this.perspectiveRatioCutoff?[]:ae,offscreen:me,collisionDetected:_e}}projectPathToScreenSpace(n,a){const f=function(m,v){const S=s.L();return s.ap(S,v.pitchedLabelPlaneMatrix),m.map(P=>{const M=Gt(P.x,P.y,S,v.getElevation),L=v.transform.projectTileCoordinates(M.point.x,M.point.y,v.unwrappedTileID,v.getElevation);return L.point.x=(.5*L.point.x+.5)*v.width,L.point.y=(.5*-L.point.y+.5)*v.height,L})}(n,a);return function(m){let v=0,S=0,P=0,M=0;for(let L=0;L<m.length;L++)m[L].isOccluded?(P=L+1,M=0):(M++,M>S&&(S=M,v=P));return m.slice(v,v+S)}(f)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],f=new s.a1;for(const $ of n){const O=new s.P($.x+rn,$.y+rn);f.extend(O),a.push(O)}const{minX:m,minY:v,maxX:S,maxY:P}=f,M=this.grid.query(m,v,S,P).concat(this.ignoredGrid.query(m,v,S,P)),L={},z={};for(const $ of M){const O=$.key;if(L[O.bucketInstanceId]===void 0&&(L[O.bucketInstanceId]={}),L[O.bucketInstanceId][O.featureIndex])continue;const Z=[new s.P($.x1,$.y1),new s.P($.x2,$.y1),new s.P($.x2,$.y2),new s.P($.x1,$.y2)];s.ay(a,Z)&&(L[O.bucketInstanceId][O.featureIndex]=!0,z[O.bucketInstanceId]===void 0&&(z[O.bucketInstanceId]=[]),z[O.bucketInstanceId].push(O.featureIndex))}return z}insertCollisionBox(n,a,f,m,v,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:v,collisionGroupID:S,overlapMode:a},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,a,f,m,v,S){const P=f?this.ignoredGrid:this.grid,M={bucketInstanceId:m,featureIndex:v,collisionGroupID:S,overlapMode:a};for(let L=0;L<n.length;L+=4)P.insertCircle(M,n[L],n[L+1],n[L+2])}projectAndGetPerspectiveRatio(n,a,f,m,v){if(v){let S;m?(S=[n,a,m(n,a),1],s.av(S,S,v)):(S=[n,a,0,1],wa(S,S,v));const P=S[3];return{x:(S[0]/P+1)/2*this.transform.width+rn,y:(-S[1]/P+1)/2*this.transform.height+rn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P*.5,isOccluded:!1,signedDistanceFromCamera:P}}{const S=this.transform.projectTileCoordinates(n,a,f,m);return{x:(S.point.x+1)/2*this.transform.width+rn,y:(1-S.point.y)/2*this.transform.height+rn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(n,a,f,m){const v=this.transform.projectTileCoordinates(n,a,f,m);return .5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5}isOffscreen(n,a,f,m){return f<rn||n>=this.screenRightBoundary||m<rn||a>this.screenBottomBoundary}isInsideGrid(n,a,f,m){return f>=0&&n<this.gridRightBoundary&&m>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const n=s.af([]);return s.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,a,f,m,v,S,P,M,L,z,$){let O=1,Z=0,Q=0,ae=1;const se=n.anchorPointX+P[0],le=n.anchorPointY+P[1];if(S&&!v){const ct=this.projectAndGetPerspectiveRatio(se+1,le,m,L,$),Ye=ct.x-M.x,bt=Math.atan((ct.y-M.y)/Ye)+(Ye<0?Math.PI:0),$t=Math.sin(bt),fr=Math.cos(bt);O=fr,Z=$t,Q=-$t,ae=fr}else if(!S&&v){const ct=Ut(this.transform);O=ct.vecEast[0],Z=ct.vecEast[1],Q=ct.vecSouth[0],ae=ct.vecSouth[1]}let ue=M.x,ge=M.y,he=a;v&&(ue=se,ge=le,he=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),he*=this.transform.getPitchedTextCorrection(se,le,m),z||(he*=s.ag(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),z&&(ue+=O*z.x*he+Q*z.y*he,ge+=Z*z.x*he+ae*z.y*he);const _e=n.x1*he,be=n.x2*he,me=(_e+be)/2,Ce=n.y1*he,Ne=n.y2*he,Ae=(Ce+Ne)/2,Ie=[{offsetX:_e,offsetY:Ce},{offsetX:me,offsetY:Ce},{offsetX:be,offsetY:Ce},{offsetX:be,offsetY:Ae},{offsetX:be,offsetY:Ne},{offsetX:me,offsetY:Ne},{offsetX:_e,offsetY:Ne},{offsetX:_e,offsetY:Ae}];let je=[];for(const{offsetX:ct,offsetY:Ye}of Ie)je.push(new s.P(ue+O*ct+Q*Ye,ge+Z*ct+ae*Ye));let ht=!1;if(v){const ct=je.map(Ye=>this.projectAndGetPerspectiveRatio(Ye.x,Ye.y,m,L,$));ht=ct.some(Ye=>!Ye.isOccluded),je=ct.map(Ye=>new s.P(Ye.x,Ye.y))}else ht=!0;return{box:s.az(je),allPointsOccluded:!ht}}}class kc{constructor(n,a,f,m){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):m&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class ss{constructor(n,a,f,m,v){this.text=new kc(n?n.text:null,a,f,v),this.icon=new kc(n?n.icon:null,a,m,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ac{constructor(n,a,f){this.text=n,this.icon=a,this.skipFade=f}}class Di{constructor(n,a,f,m,v){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=f,this.bucketIndex=m,this.tileID=v}}class Dr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:f=>f.collisionGroupID===a}}return this.collisionGroups[n]}}function Pg(y,n,a,f,m){const{horizontalAlign:v,verticalAlign:S}=s.aG(y);return new s.P(-(v-.5)*n+f[0]*m,-(S-.5)*a+f[1]*m)}class Ic{constructor(n,a,f,m,v){this.transform=n.clone(),this.terrain=a,this.collisionIndex=new Mc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Dr(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const a=this.terrain;return a?(f,m)=>a.getElevation(n,f,m):null}getBucketParts(n,a,f,m){const v=f.getBucket(a),S=f.latestFeatureIndex;if(!v||!S||a.id!==v.layerIds[0])return;const P=f.collisionBoxArray,M=v.layers[0].layout,L=v.layers[0].paint,z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),$=f.tileSize/s.$,O=f.tileID.toUnwrapped(),Z=M.get("text-rotation-alignment")==="map",Q=s.aB(f,1,this.transform.zoom),ae=s.aC(this.collisionIndex.transform,f,L.get("text-translate"),L.get("text-translate-anchor")),se=s.aC(this.collisionIndex.transform,f,L.get("icon-translate"),L.get("icon-translate-anchor")),le=At(Z,this.transform,Q);this.retainedQueryData[v.bucketInstanceId]=new Di(v.bucketInstanceId,S,v.sourceLayerIndex,v.index,f.tileID);const ue={bucket:v,layout:M,translationText:ae,translationIcon:se,unwrappedTileID:O,pitchedLabelPlaneMatrix:le,scale:z,textPixelRatio:$,holdingForFade:f.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:s.am(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(m)for(const ge of v.sortKeyRanges){const{sortKey:he,symbolInstanceStart:_e,symbolInstanceEnd:be}=ge;n.push({sortKey:he,symbolInstanceStart:_e,symbolInstanceEnd:be,parameters:ue})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(n,a,f,m,v,S,P,M,L,z,$,O,Z,Q,ae,se,le,ue,ge,he){const _e=s.aD[n.textAnchor],be=[n.textOffset0,n.textOffset1],me=Pg(_e,f,m,be,v),Ce=this.collisionIndex.placeCollisionBox(a,O,M,L,z,P,S,se,$.predicate,ge,me,he);if((!ue||this.collisionIndex.placeCollisionBox(ue,O,M,L,z,P,S,le,$.predicate,ge,me,he).placeable)&&Ce.placeable){let Ne;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(Ne=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:be,width:f,height:m,anchor:_e,textBoxScale:v,prevAnchor:Ne},this.markUsedJustification(Q,_e,Z,ae),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,ae,Z),this.placedOrientations[Z.crossTileID]=ae),{shift:me,placedGlyphBoxes:Ce}}}placeLayerBucketPart(n,a,f){const{bucket:m,layout:v,translationText:S,translationIcon:P,unwrappedTileID:M,pitchedLabelPlaneMatrix:L,textPixelRatio:z,holdingForFade:$,collisionBoxArray:O,partiallyEvaluatedTextSize:Z,collisionGroup:Q}=n.parameters,ae=v.get("text-optional"),se=v.get("icon-optional"),le=s.aE(v,"text-overlap","text-allow-overlap"),ue=le==="always",ge=s.aE(v,"icon-overlap","icon-allow-overlap"),he=ge==="always",_e=v.get("text-rotation-alignment")==="map",be=v.get("text-pitch-alignment")==="map",me=v.get("icon-text-fit")!=="none",Ce=v.get("symbol-z-order")==="viewport-y",Ne=ue&&(he||!m.hasIconData()||se),Ae=he&&(ue||!m.hasTextData()||ae);!m.collisionArrays&&O&&m.deserializeCollisionBoxes(O);const Ie=this.retainedQueryData[m.bucketInstanceId].tileID,je=this._getTerrainElevationFunc(Ie),ht=this.transform.getFastPathSimpleProjectionMatrix(Ie),ct=(Ye,bt,$t)=>{var fr,jr;if(a[Ye.crossTileID])return;if($)return void(this.placements[Ye.crossTileID]=new Ac(!1,!1,!1));let Sr=!1,Or=!1,Cr=!0,Tr=null,Pr={box:null,placeable:!1,offscreen:null,occluded:!1},Vn={placeable:!1},cr=null,kn=null,Un=null,Ws=0,Hs=0,Ks=0;bt.textFeatureIndex?Ws=bt.textFeatureIndex:Ye.useRuntimeCollisionCircles&&(Ws=Ye.featureIndex),bt.verticalTextFeatureIndex&&(Hs=bt.verticalTextFeatureIndex);const Bo=bt.textBox;if(Bo){const wi=Kr=>{let kr=s.an.horizontal;if(m.allowVerticalPlacement&&!Kr&&this.prevPlacement){const ui=this.prevPlacement.placedOrientations[Ye.crossTileID];ui&&(this.placedOrientations[Ye.crossTileID]=ui,kr=ui,this.markUsedOrientation(m,kr,Ye))}return kr},fo=(Kr,kr)=>{if(m.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&bt.verticalTextBox){for(const ui of m.writingModes)if(ui===s.an.vertical?(Pr=kr(),Vn=Pr):Pr=Kr(),Pr&&Pr.placeable)break}else Pr=Kr()},Xs=Ye.textAnchorOffsetStartIndex,Da=Ye.textAnchorOffsetEndIndex;if(Da===Xs){const Kr=(kr,ui)=>{const vn=this.collisionIndex.placeCollisionBox(kr,le,z,Ie,M,be,_e,S,Q.predicate,je,void 0,ht);return vn&&vn.placeable&&(this.markUsedOrientation(m,ui,Ye),this.placedOrientations[Ye.crossTileID]=ui),vn};fo(()=>Kr(Bo,s.an.horizontal),()=>{const kr=bt.verticalTextBox;return m.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&kr?Kr(kr,s.an.vertical):{box:null,offscreen:null}}),wi(Pr&&Pr.placeable)}else{let Kr=s.aD[(jr=(fr=this.prevPlacement)===null||fr===void 0?void 0:fr.variableOffsets[Ye.crossTileID])===null||jr===void 0?void 0:jr.anchor];const kr=(vn,_y,yx)=>{const yf=vn.x2-vn.x1,lu=vn.y2-vn.y1,Ll=Ye.textBoxScale,hs=me&&ge==="never"?_y:null;let Gn=null,ds=le==="never"?1:2,vf="never";Kr&&ds++;for(let Ys=0;Ys<ds;Ys++){for(let _f=Xs;_f<Da;_f++){const xf=m.textAnchorOffsets.get(_f);if(Kr&&xf.textAnchor!==Kr)continue;const cu=this.attemptAnchorPlacement(xf,vn,yf,lu,Ll,_e,be,z,Ie,M,Q,vf,Ye,m,yx,S,P,hs,je);if(cu&&(Gn=cu.placedGlyphBoxes,Gn&&Gn.placeable))return Sr=!0,Tr=cu.shift,Gn}Kr?Kr=null:vf=le}return f&&!Gn&&(Gn={box:this.collisionIndex.placeCollisionBox(Bo,"always",z,Ie,M,be,_e,S,Q.predicate,je,void 0,ht).box,offscreen:!1,placeable:!1,occluded:!1}),Gn};fo(()=>kr(Bo,bt.iconBox,s.an.horizontal),()=>{const vn=bt.verticalTextBox;return m.allowVerticalPlacement&&(!Pr||!Pr.placeable)&&Ye.numVerticalGlyphVertices>0&&vn?kr(vn,bt.verticalIconBox,s.an.vertical):{box:null,occluded:!0,offscreen:null}}),Pr&&(Sr=Pr.placeable,Cr=Pr.offscreen);const ui=wi(Pr&&Pr.placeable);if(!Sr&&this.prevPlacement){const vn=this.prevPlacement.variableOffsets[Ye.crossTileID];vn&&(this.variableOffsets[Ye.crossTileID]=vn,this.markUsedJustification(m,vn.anchor,Ye,ui))}}}if(cr=Pr,Sr=cr&&cr.placeable,Cr=cr&&cr.offscreen,Ye.useRuntimeCollisionCircles){const wi=m.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),fo=s.ao(m.textSizeData,Z,wi),Xs=v.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(le,wi,m.lineVertexArray,m.glyphOffsetArray,fo,M,L,f,be,Q.predicate,Ye.collisionCircleDiameter,Xs,S,je),kn.circles.length&&kn.collisionDetected&&!f&&s.w("Collisions detected, but collision boxes are not shown"),Sr=ue||kn.circles.length>0&&!kn.collisionDetected,Cr=Cr&&kn.offscreen}if(bt.iconFeatureIndex&&(Ks=bt.iconFeatureIndex),bt.iconBox){const wi=fo=>this.collisionIndex.placeCollisionBox(fo,ge,z,Ie,M,be,_e,P,Q.predicate,je,me&&Tr?Tr:void 0,ht);Vn&&Vn.placeable&&bt.verticalIconBox?(Un=wi(bt.verticalIconBox),Or=Un.placeable):(Un=wi(bt.iconBox),Or=Un.placeable),Cr=Cr&&Un.offscreen}const su=ae||Ye.numHorizontalGlyphVertices===0&&Ye.numVerticalGlyphVertices===0,au=se||Ye.numIconVertices===0;su||au?au?su||(Or=Or&&Sr):Sr=Or&&Sr:Or=Sr=Or&&Sr;const Rl=Or&&Un.placeable;if(Sr&&cr.placeable&&this.collisionIndex.insertCollisionBox(cr.box,le,v.get("text-ignore-placement"),m.bucketInstanceId,Vn&&Vn.placeable&&Hs?Hs:Ws,Q.ID),Rl&&this.collisionIndex.insertCollisionBox(Un.box,ge,v.get("icon-ignore-placement"),m.bucketInstanceId,Ks,Q.ID),kn&&Sr&&this.collisionIndex.insertCollisionCircles(kn.circles,le,v.get("text-ignore-placement"),m.bucketInstanceId,Ws,Q.ID),f&&this.storeCollisionData(m.bucketInstanceId,$t,bt,cr,Un,kn),Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ye.crossTileID]=new Ac((Sr||Ne)&&!(cr!=null&&cr.occluded),(Or||Ae)&&!(Un!=null&&Un.occluded),Cr||m.justReloaded),a[Ye.crossTileID]=!0};if(Ce){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ye=m.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let bt=Ye.length-1;bt>=0;--bt){const $t=Ye[bt];ct(m.symbolInstances.get($t),m.collisionArrays[$t],$t)}}else for(let Ye=n.symbolInstanceStart;Ye<n.symbolInstanceEnd;Ye++)ct(m.symbolInstances.get(Ye),m.collisionArrays[Ye],Ye);m.justReloaded=!1}storeCollisionData(n,a,f,m,v,S){if(f.textBox||f.iconBox){let P,M;this.collisionBoxArrays.has(n)?P=this.collisionBoxArrays.get(n):(P=new Map,this.collisionBoxArrays.set(n,P)),P.has(a)?M=P.get(a):(M={text:null,icon:null},P.set(a,M)),f.textBox&&(M.text=m.box),f.iconBox&&(M.icon=v.box)}if(S){let P=this.collisionCircleArrays[n];P===void 0&&(P=this.collisionCircleArrays[n]=[]);for(let M=0;M<S.circles.length;M+=4)P.push(S.circles[M+0]-rn),P.push(S.circles[M+1]-rn),P.push(S.circles[M+2]),P.push(S.collisionDetected?1:0)}}markUsedJustification(n,a,f,m){let v;v=m===s.an.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[s.aF(a)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const P of S)P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=v>=0&&P!==v?0:f.crossTileID)}markUsedOrientation(n,a,f){const m=a===s.an.horizontal||a===s.an.horizontalOnly?a:0,v=a===s.an.vertical?a:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const P of S)n.text.placedSymbolArray.get(P).placedOrientation=m;f.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let f=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const m=a?a.symbolFadeChange(n):1,v=a?a.opacities:{},S=a?a.variableOffsets:{},P=a?a.placedOrientations:{};for(const M in this.placements){const L=this.placements[M],z=v[M];z?(this.opacities[M]=new ss(z,m,L.text,L.icon),f=f||L.text!==z.text.placed||L.icon!==z.icon.placed):(this.opacities[M]=new ss(null,m,L.text,L.icon,L.skipFade),f=f||L.text||L.icon)}for(const M in v){const L=v[M];if(!this.opacities[M]){const z=new ss(L,m,!1,!1);z.isHidden()||(this.opacities[M]=z,f=f||L.text.placed||L.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in P)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=P[M]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)}updateLayerOpacities(n,a){const f={};for(const m of a){const v=m.getBucket(n);v&&m.latestFeatureIndex&&n.id===v.layerIds[0]&&this.updateBucketOpacities(v,m.tileID,f,m.collisionBoxArray)}}updateBucketOpacities(n,a,f,m){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const v=n.layers[0],S=v.layout,P=new ss(null,0,!1,!1,!0),M=S.get("text-allow-overlap"),L=S.get("icon-allow-overlap"),z=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=S.get("text-rotation-alignment")==="map",O=S.get("text-pitch-alignment")==="map",Z=S.get("icon-text-fit")!=="none",Q=new ss(null,0,M&&(L||!n.hasIconData()||S.get("icon-optional")),L&&(M||!n.hasTextData()||S.get("text-optional")),!0);!n.collisionArrays&&m&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(m);const ae=(le,ue,ge)=>{for(let he=0;he<ue/4;he++)le.opacityVertexArray.emplaceBack(ge);le.hasVisibleVertices=le.hasVisibleVertices||ge!==Rc},se=this.collisionBoxArrays.get(n.bucketInstanceId);for(let le=0;le<n.symbolInstances.length;le++){const ue=n.symbolInstances.get(le),{numHorizontalGlyphVertices:ge,numVerticalGlyphVertices:he,crossTileID:_e}=ue;let be=this.opacities[_e];f[_e]?be=P:be||(be=Q,this.opacities[_e]=be),f[_e]=!0;const me=ue.numIconVertices>0,Ce=this.placedOrientations[ue.crossTileID],Ne=Ce===s.an.vertical,Ae=Ce===s.an.horizontal||Ce===s.an.horizontalOnly;if(ge>0||he>0){const je=Ig(be.text);ae(n.text,ge,Ne?Rc:je),ae(n.text,he,Ae?Rc:je);const ht=be.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(bt=>{bt>=0&&(n.text.placedSymbolArray.get(bt).hidden=ht||Ne?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=ht||Ae?1:0);const ct=this.variableOffsets[ue.crossTileID];ct&&this.markUsedJustification(n,ct.anchor,ue,Ce);const Ye=this.placedOrientations[ue.crossTileID];Ye&&(this.markUsedJustification(n,"left",ue,Ye),this.markUsedOrientation(n,Ye,ue))}if(me){const je=Ig(be.icon),ht=!(Z&&ue.verticalPlacedIconSymbolIndex&&Ne);ue.placedIconSymbolIndex>=0&&(ae(n.icon,ue.numIconVertices,ht?je:Rc),n.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=be.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(ae(n.icon,ue.numVerticalIconVertices,ht?Rc:je),n.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=be.icon.isHidden())}const Ie=se&&se.has(le)?se.get(le):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const je=n.collisionArrays[le];if(je){let ht=new s.P(0,0);if(je.textBox||je.verticalTextBox){let ct=!0;if(z){const Ye=this.variableOffsets[_e];Ye?(ht=Pg(Ye.anchor,Ye.width,Ye.height,Ye.textOffset,Ye.textBoxScale),$&&ht._rotate(O?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ct=!1}if(je.textBox||je.verticalTextBox){let Ye;je.textBox&&(Ye=Ne),je.verticalTextBox&&(Ye=Ae),ph(n.textCollisionBox.collisionVertexArray,be.text.placed,!ct||Ye,Ie.text,ht.x,ht.y)}}if(je.iconBox||je.verticalIconBox){const ct=!!(!Ae&&je.verticalIconBox);let Ye;je.iconBox&&(Ye=ct),je.verticalIconBox&&(Ye=!ct),ph(n.iconCollisionBox.collisionVertexArray,be.icon.placed,Ye,Ie.icon,Z?ht.x:0,Z?ht.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,a){const f=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function ph(y,n,a,f,m,v){f&&f.length!==0||(f=[0,0,0,0]);const S=f[0]-rn,P=f[1]-rn,M=f[2]-rn,L=f[3]-rn;y.emplaceBack(n?1:0,a?1:0,m||0,v||0,S,P),y.emplaceBack(n?1:0,a?1:0,m||0,v||0,M,P),y.emplaceBack(n?1:0,a?1:0,m||0,v||0,M,L),y.emplaceBack(n?1:0,a?1:0,m||0,v||0,S,L)}const Sa=Math.pow(2,25),Bs=Math.pow(2,24),Eg=Math.pow(2,17),Mg=Math.pow(2,16),kg=Math.pow(2,9),sl=Math.pow(2,8),Ag=Math.pow(2,1);function Ig(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const n=y.placed?1:0,a=Math.floor(127*y.opacity);return a*Sa+n*Bs+a*Eg+n*Mg+a*kg+n*sl+a*Ag+n}const Rc=0;class q_{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,a,f,m,v){const S=this._bucketParts;for(;this._currentTileIndex<n.length;)if(a.getBucketParts(S,m,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((P,M)=>P.sortKey-M.sortKey));this._currentPartIndex<S.length;)if(a.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,v())return!0;return!1}}class Rg{constructor(n,a,f,m,v,S,P,M){this.placement=new Ic(n,a,S,P,M),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(n,a,f){const m=I.now(),v=()=>!this._forceFullPlacement&&I.now()-m>2;for(;this._currentPlacementIndex>=0;){const S=a[n[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=P)&&(!S.maxzoom||S.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new q_(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const al=512/s.$/2;class Cp{constructor(n,a,f){this.tileID=n,this.bucketInstanceId=f,this._symbolsByKey={};const m=new Map;for(let v=0;v<a.length;v++){const S=a.get(v),P=S.key,M=m.get(P);M?M.push(S):m.set(P,[S])}for(const[v,S]of m){const P={positions:S.map(M=>({x:Math.floor(M.anchorX*al),y:Math.floor(M.anchorY*al)})),crossTileIDs:S.map(M=>M.crossTileID)};if(P.positions.length>128){const M=new s.aH(P.positions.length,16,Uint16Array);for(const{x:L,y:z}of P.positions)M.add(L,z);M.finish(),delete P.positions,P.index=M}this._symbolsByKey[v]=P}}getScaledCoordinates(n,a){const{x:f,y:m,z:v}=this.tileID.canonical,{x:S,y:P,z:M}=a.canonical,L=al/Math.pow(2,M-v),z=(P*s.$+n.anchorY)*L,$=m*s.$*al;return{x:Math.floor((S*s.$+n.anchorX)*L-f*s.$*al),y:Math.floor(z-$)}}findMatches(n,a,f){const m=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let v=0;v<n.length;v++){const S=n.get(v);if(S.crossTileID)continue;const P=this._symbolsByKey[S.key];if(!P)continue;const M=this.getScaledCoordinates(S,a);if(P.index){const L=P.index.range(M.x-m,M.y-m,M.x+m,M.y+m).sort();for(const z of L){const $=P.crossTileIDs[z];if(!f[$]){f[$]=!0,S.crossTileID=$;break}}}else if(P.positions)for(let L=0;L<P.positions.length;L++){const z=P.positions[L],$=P.crossTileIDs[L];if(Math.abs(z.x-M.x)<=m&&Math.abs(z.y-M.y)<=m&&!f[$]){f[$]=!0,S.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class Pp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Lg{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const a=Math.round((n-this.lng)/360);if(a!==0)for(const f in this.indexes){const m=this.indexes[f],v={};for(const S in m){const P=m[S];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+a),v[P.tileID.key]=P}this.indexes[f]=v}this.lng=n}addBucket(n,a,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<a.symbolInstances.length;v++)a.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const m=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const S=this.indexes[v];if(Number(v)>n.overscaledZ)for(const P in S){const M=S[P];M.tileID.isChildOf(n)&&M.findMatches(a.symbolInstances,n,m)}else{const P=S[n.scaledTo(Number(v)).key];P&&P.findMatches(a.symbolInstances,n,m)}}for(let v=0;v<a.symbolInstances.length;v++){const S=a.symbolInstances.get(v);S.crossTileID||(S.crossTileID=f.generate(),m[S.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Cp(n,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(n,a){for(const f of a.getCrossTileIDsLists())for(const m of f)delete this.usedCrossTileIDs[n][m]}removeStaleBuckets(n){let a=!1;for(const f in this.indexes){const m=this.indexes[f];for(const v in m)n[m[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,m[v]),delete m[v],a=!0)}return a}}class fh{constructor(){this.layerIndexes={},this.crossTileIDs=new Pp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,a,f){let m=this.layerIndexes[n.id];m===void 0&&(m=this.layerIndexes[n.id]=new Lg);let v=!1;const S={};m.handleWrapJump(f);for(const P of a){const M=P.getBucket(n);M&&n.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(P.tileID,M,this.crossTileIDs)&&(v=!0),S[M.bucketInstanceId]=!0)}return m.removeStaleBuckets(S)&&(v=!0),v}pruneUnusedLayers(n){const a={};n.forEach(f=>{a[f]=!0});for(const f in this.layerIndexes)a[f]||delete this.layerIndexes[f]}}var mh="void main() {fragColor=vec4(1.0);}";const zo={prelude:Yt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Yt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Yt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Yt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Yt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Yt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Yt(mh,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Yt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Yt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Yt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Yt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Yt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Yt(mh,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Yt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Yt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Yt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Yt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Yt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Yt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Yt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Yt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Yt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Yt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Yt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Yt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Yt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Yt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Yt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Yt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Yt(y,n){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=n.match(/in ([\w]+) ([\w]+)/g),m=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=v?v.concat(m):m,P={};return{fragmentSource:y=y.replace(a,(M,L,z,$,O)=>(P[O]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${O}
in ${z} ${$} ${O};
#else
uniform ${z} ${$} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${z} ${$} ${O} = u_${O};
#endif
`)),vertexSource:n=n.replace(a,(M,L,z,$,O)=>{const Z=$==="float"?"vec2":"vec4",Q=O.match(/color/)?"color":Z;return P[O]?L==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${z} ${Z} a_${O};
out ${z} ${$} ${O};
#else
uniform ${z} ${$} u_${O};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${z} ${$} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${Q}(a_${O}, u_${O}_t);
#else
    ${z} ${$} ${O} = u_${O};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${z} ${Z} a_${O};
#else
uniform ${z} ${$} u_${O};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${z} ${$} ${O} = a_${O};
#else
    ${z} ${$} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${z} ${$} ${O} = unpack_mix_${Q}(a_${O}, u_${O}_t);
#else
    ${z} ${$} ${O} = u_${O};
#endif
`}),staticAttributes:f,staticUniforms:S}}class as{constructor(n,a,f){this.vertexBuffer=n,this.indexBuffer=a,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ls=s.aI([{name:"a_pos",type:"Int16",components:2}]);const Ta="#define PROJECTION_MERCATOR",Ep="mercator";class Mp{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ep}get shaderDefine(){return Ta}get shaderPreludeCode(){return zo.projectionMercator}get vertexShaderPreludeCode(){return zo.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,a,f,m,v){if(this._cachedMesh)return this._cachedMesh;const S=new s.aK;S.emplaceBack(0,0),S.emplaceBack(s.$,0),S.emplaceBack(0,s.$),S.emplaceBack(s.$,s.$);const P=n.createVertexBuffer(S,ls.members),M=s.aL.simpleSegment(0,0,4,2),L=new s.aM;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3);const z=n.createIndexBuffer(L);return this._cachedMesh=new as(P,z,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class Xi{constructor(n=0,a=0,f=0,m=0){if(isNaN(n)||n<0||isNaN(a)||a<0||isNaN(f)||f<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=f,this.right=m}interpolate(n,a,f){return a.top!=null&&n.top!=null&&(this.top=s.C.number(n.top,a.top,f)),a.bottom!=null&&n.bottom!=null&&(this.bottom=s.C.number(n.bottom,a.bottom,f)),a.left!=null&&n.left!=null&&(this.left=s.C.number(n.left,a.left,f)),a.right!=null&&n.right!=null&&(this.right=s.C.number(n.right,a.right,f)),this}getCenter(n,a){const f=s.ag((this.left+n-this.right)/2,0,n),m=s.ag((this.top+a-this.bottom)/2,0,a);return new s.P(f,m)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Xi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function cs(y,n){if(!y.renderWorldCopies||y.lngRange)return;const a=n.lng-y.center.lng;n.lng+=a>180?-360:a<-180?360:0}function Qt(y){return Math.max(0,Math.floor(y))}class Lc{constructor(n,a,f,m,v,S){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=a||0,this._maxZoom=f||22,this._minPitch=m??0,this._maxPitch=v??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Qt(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Xi,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,a,f){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=Qt(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new Xi(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!f&&n.autoCalculateNearFarZ,a&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const a=s.aN(n,-180,180)*Math.PI/180;var f,m,v,S,P,M,L,z,$;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=w(),f=this._rotationMatrix,v=-this._bearingInRadians,S=(m=this._rotationMatrix)[0],P=m[1],M=m[2],L=m[3],z=Math.sin(v),$=Math.cos(v),f[0]=S*$+M*z,f[1]=P*$+L*z,f[2]=S*-z+M*$,f[3]=P*-z+L*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const a=s.ag(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const a=n/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aO(this._fovInRadians)}setFov(n){n=s.ag(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=s.ad(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const a=this.getConstrained(this._center,n).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=s.ae(a),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,a){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,a,f){this._unmodified=!1,this._edgeInsets.interpolate(n,a,f),this._constrain(),this._calcMatrices()}resize(n,a,f=!0){this._width=n,this._height=a,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new vr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ah,s.ah])}getConstrained(n,a){return this._callbacks.getConstrained(n,a)}getCameraQueryGeometry(n,a){if(a.length===1)return[a[0],n];{const{minX:f,minY:m,maxX:v,maxY:S}=s.a1.fromPoints(a).extend(n);return[new s.P(f,m),new s.P(v,m),new s.P(v,S),new s.P(f,S),new s.P(f,m)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:a,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(a),this.setZoom(f),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=s.af(new Float64Array(16));s.N(n,n,[this._width/2,-this._height/2,1]),s.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=s.af(new Float64Array(16)),s.N(n,n,[1,-1,1]),s.M(n,n,[-1,-1,0]),s.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,a,f,m){const v=f!==void 0?f:this.bearing,S=m=m!==void 0?m:this.pitch,P=s.a0.fromLngLat(n,a),M=-Math.cos(s.ad(S)),L=Math.sin(s.ad(S)),z=L*Math.sin(s.ad(v)),$=-L*Math.cos(s.ad(v));let O=this.elevation;const Z=a-O;let Q;M*Z>=0||Math.abs(M)<.1?(Q=1e4,O=a+Q*M):Q=-Z/M;let ae,se,le=s.aP(1,P.y),ue=0;do{if(ue+=1,ue>10)break;se=Q/le,ae=new s.a0(P.x+z*se,P.y+$*se),le=1/ae.meterInMercatorCoordinateUnits()}while(Math.abs(Q-se*le)>1e-12);return{center:ae.toLngLat(),elevation:O,zoom:s.aj(this.height/2/Math.tan(this.fovInRadians/2)/se/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const a=s.ai(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/a,m=s.a0.fromLngLat(this.center,this.elevation),v=fe(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=n;const S=this.calculateCenterFromCameraLngLatAlt(v.toLngLat(),s.aP(v.z,m.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const a=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/a,n.canonical.y/a,1/a/s.$,1/a/s.$]}}class gh{constructor(n,a){this.min=n,this.max=a,this.center=s.aQ([],s.aR([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],f=s.aS(this.min),m=s.aS(this.max);for(let v=0;v<a.length;v++)f[v]=a[v]?this.min[v]:this.center[v],m[v]=a[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new gh(f,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let a=!0;for(let f=0;f<n.planes.length;f++){const m=this.intersectsPlane(n.planes[f]);if(m===0)return 0;m===1&&(a=!1)}return a?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let a=n[3],f=n[3];for(let m=0;m<3;m++)n[m]>0?(a+=n[m]*this.min[m],f+=n[m]*this.max[m]):(f+=n[m]*this.min[m],a+=n[m]*this.max[m]);return a>=0?2:f<0?0:1}}class kp{distanceToTile2d(n,a,f,m){const v=m.distanceX([n,a]),S=m.distanceY([n,a]);return Math.hypot(v,S)}getWrap(n,a,f){return f}getTileBoundingVolume(n,a,f,m){var v,S;let P=f,M=f;if(m!=null&&m.terrain){const z=new s.Z(n.z,a,n.z,n.x,n.y),$=m.terrain.getMinMaxElevation(z);P=(v=$.minElevation)!==null&&v!==void 0?v:f,M=(S=$.maxElevation)!==null&&S!==void 0?S:f}const L=1<<n.z;return new gh([a+n.x/L,n.y/L,P],[a+(n.x+1)/L,(n.y+1)/L,M])}allowVariableZoom(n,a){const f=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,m=s.ag(78.5-f/2,0,60);return!!a.terrain||n.pitch>m}allowWorldCopies(){return!0}prepareNextFrame(){}}class Yn{constructor(n,a,f){this.points=n,this.planes=a,this.aabb=f}static fromInvProjectionMatrix(n,a=1,f=0,m,v){const S=v?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],P=Math.pow(2,f),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>function(Z,Q,ae,se){const le=s.av([],Z,Q),ue=1/le[3]/ae*se;return s.aX(le,le,[ue,ue,1/le[3],ue])}(O,n,a,P));m&&function(O,Z,Q,ae){const se=ae?4:0,le=ae?0:4;let ue=0;const ge=[],he=[];for(let me=0;me<4;me++){const Ce=s.aT([],O[me+le],O[me+se]),Ne=s.aY(Ce);s.aQ(Ce,Ce,1/Ne),ge.push(Ne),he.push(Ce)}for(let me=0;me<4;me++){const Ce=s.aZ(O[me+se],he[me],Q);ue=Ce!==null&&Ce>=0?Math.max(ue,Ce):Math.max(ue,ge[me])}const _e=function(me,Ce){const Ne=s.aT([],me[Ce[0]],me[Ce[1]]),Ae=s.aT([],me[Ce[2]],me[Ce[1]]),Ie=[0,0,0,0];return s.aU(Ie,s.aV([],Ne,Ae)),Ie[3]=-s.aW(Ie,me[Ce[0]]),Ie}(O,Z),be=function(me,Ce){const Ne=s.a_(me),Ae=s.a$([],me,1/Ne),Ie=s.aT([],Ce,s.aQ([],Ae,s.aW(Ce,Ae))),je=s.a_(Ie);if(je>0){const ht=Math.sqrt(1-Ae[3]*Ae[3]),ct=s.aQ([],Ae,-Ae[3]),Ye=s.aR([],ct,s.aQ([],Ie,ht/je));return s.b0(Ce,Ye)}return null}(Q,_e);if(be!==null){const me=be/s.aW(he[0],_e);ue=Math.min(ue,me)}for(let me=0;me<4;me++){const Ce=Math.min(ue,ge[me]);O[me+le]=[O[me+se][0]+he[me][0]*Ce,O[me+se][1]+he[me][1]*Ce,O[me+se][2]+he[me][2]*Ce,1]}}(M,S[0],m,v);const L=S.map(O=>{const Z=s.aT([],M[O[0]],M[O[1]]),Q=s.aT([],M[O[2]],M[O[1]]),ae=s.aU([],s.aV([],Z,Q)),se=-s.aW(ae,M[O[1]]);return ae.concat(se)}),z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const O of M)for(let Z=0;Z<3;Z++)z[Z]=Math.min(z[Z],O[Z]),$[Z]=Math.max($[Z],O[Z]);return new Yn(M,L,new gh(z,$))}}class hn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,a,f){return this._helper.interpolatePadding(n,a,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,a,f=!0){this._helper.resize(n,a,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,a){this._helper.overrideNearFarZ(n,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,a){}constructor(n,a,f,m,v){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Lc({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,P)=>this.getConstrained(S,P)},n,a,f,m,v),this._coveringTilesDetailsProvider=new kp}clone(){const n=new hn;return n.apply(this),n}apply(n,a,f){this._helper.apply(n,a,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const a=[new s.b1(0,n)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new s.P(0,0)),m=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),v=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),P=Math.floor(Math.min(f.x,m.x,v.x,S.x)),M=Math.floor(Math.max(f.x,m.x,v.x,S.x)),L=1;for(let z=P-L;z<=M+L;z++)z!==0&&a.push(new s.b1(z,n))}return a}getCameraFrustum(){return Yn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const a=this.screenPointToLocation(this.centerPoint,n),f=n?n.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(n,a){const f=s.ai(this.elevation,this.center.lat),m=this.screenPointToMercatorCoordinateAtZ(a,f),v=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=s.a0.fromLngLat(n),P=new s.a0(S.x-(m.x-v.x),S.y-(m.y-v.y));this.setCenter(P==null?void 0:P.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,a){return a?this.coordinatePoint(s.a0.fromLngLat(n),a.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a0.fromLngLat(n))}screenPointToLocation(n,a){var f;return(f=this.screenPointToMercatorCoordinate(n,a))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(n,a){if(a){const f=a.pointCoordinate(n);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,a){const f=a||0,m=[n.x,n.y,0,1],v=[n.x,n.y,1,1];s.av(m,m,this._pixelMatrixInverse),s.av(v,v,this._pixelMatrixInverse);const S=m[3],P=v[3],M=m[1]/S,L=v[1]/P,z=m[2]/S,$=v[2]/P,O=z===$?0:(f-z)/($-z);return new s.a0(s.C.number(m[0]/S,v[0]/P,O)/this.worldSize,s.C.number(M,L,O)/this.worldSize,f)}coordinatePoint(n,a=0,f=this._pixelMatrix){const m=[n.x*this.worldSize,n.y*this.worldSize,a,1];return s.av(m,m,f),new s.P(m[0]/m[3],m[1]/m[3])}getBounds(){const n=Math.max(0,this._helper._height/2-te(this));return new vr().extend(this.screenPointToLocation(new s.P(0,n))).extend(this.screenPointToLocation(new s.P(this._helper._width,n))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(n,a){return a?a.pointCoordinate(n)!=null:n.y>this.height/2-te(this)}calculatePosMatrix(n,a=!1,f){var m;const v=(m=n.key)!==null&&m!==void 0?m:s.b2(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),S=a?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(v)){const L=S.get(v);return f?L.f32:L.f64}const P=oe(n,this.worldSize);s.O(P,a?this._alignedProjMatrix:this._viewProjMatrix,P);const M={f64:P,f32:new Float32Array(P)};return S.set(v,M),f?M.f32:M.f64}calculateFogMatrix(n){const a=n.key,f=this._fogMatrixCacheF32;if(f.has(a))return f.get(a);const m=oe(n,this.worldSize);return s.O(m,this._fogMatrix,m),f.set(a,new Float32Array(m)),f.get(a)}getConstrained(n,a){a=s.ag(+a,this.minZoom,this.maxZoom);const f={center:new s.S(n.lng,n.lat),zoom:a};let m=this._helper._lngRange;if(!this._helper._renderWorldCopies&&m===null){const ge=179.9999999999;m=[-ge,ge]}const v=this.tileSize*s.ae(f.zoom);let S=0,P=v,M=0,L=v,z=0,$=0;const{x:O,y:Z}=this.size;if(this._helper._latRange){const ge=this._helper._latRange;S=s.U(ge[1])*v,P=s.U(ge[0])*v,P-S<Z&&(z=Z/(P-S))}m&&(M=s.aN(s.V(m[0])*v,0,v),L=s.aN(s.V(m[1])*v,0,v),L<M&&(L+=v),L-M<O&&($=O/(L-M)));const{x:Q,y:ae}=Ee(v,n);let se,le;const ue=Math.max($||0,z||0);if(ue){const ge=new s.P($?(L+M)/2:Q,z?(P+S)/2:ae);return f.center=ee(v,ge).wrap(),f.zoom+=s.aj(ue),f}if(this._helper._latRange){const ge=Z/2;ae-ge<S&&(le=S+ge),ae+ge>P&&(le=P-ge)}if(m){const ge=(M+L)/2;let he=Q;this._helper._renderWorldCopies&&(he=s.aN(Q,ge-v/2,ge+v/2));const _e=O/2;he-_e<M&&(se=M+_e),he+_e>L&&(se=L-_e)}if(se!==void 0||le!==void 0){const ge=new s.P(se??Q,le??ae);f.center=ee(v,ge).wrap()}return f}calculateCenterFromCameraLngLatAlt(n,a,f,m){return this._helper.calculateCenterFromCameraLngLatAlt(n,a,f,m)}_calculateNearFarZIfNeeded(n,a,f){if(!this._helper.autoCalculateNearFarZ)return;const m=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),v=n-m*this._helper._pixelPerMeter/Math.cos(a),S=m<0?v:n,P=Math.PI/2+this.pitchInRadians,M=s.ad(this.fov)*(Math.abs(Math.cos(s.ad(this.roll)))*this.height+Math.abs(Math.sin(s.ad(this.roll)))*this.width)/this.height*(.5+f.y/this.height),L=Math.sin(M)*S/Math.sin(s.ag(Math.PI-P-M,.01,Math.PI-.01)),z=te(this),$=Math.atan(z/this._helper.cameraToCenterDistance),O=s.ad(.75),Z=$>O?2*$*(.5+f.y/(2*z)):O,Q=Math.sin(Z)*S/Math.sin(s.ag(Math.PI-P-Z,.01,Math.PI-.01)),ae=Math.min(L,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*ae+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,a=Ee(this.worldSize,this.center),f=a.x,m=a.y;this._helper._pixelPerMeter=s.ai(1,this.center.lat)*this.worldSize;const v=s.ad(Math.min(this.pitch,co)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(v));let P;this._calculateNearFarZIfNeeded(S,v,n),P=new Float64Array(16),s.b3(P,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.ap(this._invProjMatrix,P),P[8]=2*-n.x/this._helper._width,P[9]=2*n.y/this._helper._height,this._projectionMatrix=s.b4(P),s.N(P,P,[1,-1,1]),s.M(P,P,[0,0,-this._helper.cameraToCenterDistance]),s.b5(P,P,-this.rollInRadians),s.b6(P,P,this.pitchInRadians),s.b5(P,P,-this.bearingInRadians),s.M(P,P,[-f,-m,0]),this._mercatorMatrix=s.N([],P,[this.worldSize,this.worldSize,this.worldSize]),s.N(P,P,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P),s.M(P,P,[0,0,-this.elevation]),this._viewProjMatrix=P,this._invViewProjMatrix=s.ap([],P);const M=[0,0,-1,1];s.av(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),s.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-f,-m,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P);const L=this._helper._width%2/2,z=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),O=Math.sin(-this.bearingInRadians),Z=f-Math.round(f)+$*L+O*z,Q=m-Math.round(m)+$*z+O*L,ae=new Float64Array(P);if(s.M(ae,ae,[Z>.5?Z-1:Z,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=ae,P=s.ap(new Float64Array(16),this._pixelMatrix),!P)throw new Error("failed to invert matrix");this._pixelMatrixInverse=P,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new s.P(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return s.av(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,a){const f=s.a0.fromLngLat(n),m=[f.x*this.worldSize,f.y*this.worldSize,a,1];return s.av(m,m,this._viewProjMatrix),m[2]/m[3]}getProjectionData(n){const{overscaledTileID:a,aligned:f,applyTerrainMatrix:m}=n,v=this._helper.getMercatorTileCoordinates(a),S=a?this.calculatePosMatrix(a,f,!0):null;let P;return P=a&&a.terrainRttPosMatrix32f&&m?a.terrainRttPosMatrix32f:S||s.b7(),{mainMatrix:P,tileMercatorCoords:v,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:P}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,a,f){return 1}transformLightDirection(n){return s.aS(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,a,f,m){const v=this.calculatePosMatrix(f);let S;m?(S=[n,a,m(n,a),1],s.av(S,S,v)):(S=[n,a,0,1],wa(S,S,v));const P=S[3];return{point:new s.P(S[0]/P,S[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}populateCache(n){for(const a of n)this.calculatePosMatrix(a)}getMatrixForModel(n,a){const f=s.a0.fromLngLat(n,a),m=f.meterInMercatorCoordinateUnits(),v=s.b8();return s.M(v,v,[f.x,f.y,f.z]),s.b5(v,v,Math.PI),s.b6(v,v,Math.PI/2),s.N(v,v,[-m,m,m]),v}getProjectionDataForCustomLayer(n=!0){const a=new s.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:n}),m=oe(a,this.worldSize);s.O(m,this._viewProjMatrix,m),f.tileMercatorCoords=[0,0,1,1];const v=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],S=s.b9();return s.N(S,m,v),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function Qn(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function En(y){if(y.useSlerp)if(y.k<1){const n=s.ba(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),a=s.ba(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),f=new Float64Array(4);s.bb(f,n,a,y.k);const m=s.bc(f);y.tr.setRoll(m.roll),y.tr.setPitch(m.pitch),y.tr.setBearing(m.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(s.C.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(s.C.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(s.C.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function zr(y,n,a,f,m){const v=m.padding,S=Ee(m.worldSize,a.getNorthWest()),P=Ee(m.worldSize,a.getNorthEast()),M=Ee(m.worldSize,a.getSouthEast()),L=Ee(m.worldSize,a.getSouthWest()),z=s.ad(-f),$=S.rotate(z),O=P.rotate(z),Z=M.rotate(z),Q=L.rotate(z),ae=new s.P(Math.max($.x,O.x,Q.x,Z.x),Math.max($.y,O.y,Q.y,Z.y)),se=new s.P(Math.min($.x,O.x,Q.x,Z.x),Math.min($.y,O.y,Q.y,Z.y)),le=ae.sub(se),ue=(m.width-(v.left+v.right+n.left+n.right))/le.x,ge=(m.height-(v.top+v.bottom+n.top+n.bottom))/le.y;if(ge<0||ue<0)return void Qn();const he=Math.min(s.aj(m.scale*Math.min(ue,ge)),y.maxZoom),_e=s.P.convert(y.offset),be=new s.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(s.ad(f)),me=_e.add(be).mult(m.scale/s.ae(he));return{center:ee(m.worldSize,S.add(M).div(2).sub(me)),zoom:he,bearing:f}}class yh{get useGlobeControls(){return!1}handlePanInertia(n,a){return{easingOffset:n,easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(n,a){n.bearingDelta&&a.setBearing(a.bearing+n.bearingDelta),n.pitchDelta&&a.setPitch(a.pitch+n.pitchDelta),n.rollDelta&&a.setRoll(a.roll+n.rollDelta),n.zoomDelta&&a.setZoom(a.zoom+n.zoomDelta)}handleMapControlsPan(n,a,f){n.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(f,n.around)}cameraForBoxAndBearing(n,a,f,m,v){return zr(n,a,f,m,v)}handleJumpToCenterZoom(n,a){n.zoom!==(a.zoom!==void 0?+a.zoom:n.zoom)&&n.setZoom(+a.zoom),a.center!==void 0&&n.setCenter(s.S.convert(a.center))}handleEaseTo(n,a){const f=n.zoom,m=n.padding,v={roll:n.roll,pitch:n.pitch,bearing:n.bearing},S={roll:a.roll===void 0?n.roll:a.roll,pitch:a.pitch===void 0?n.pitch:a.pitch,bearing:a.bearing===void 0?n.bearing:a.bearing},P=a.zoom!==void 0,M=!n.isPaddingEqual(a.padding);let L=!1;const z=P?+a.zoom:n.zoom;let $=n.centerPoint.add(a.offsetAsPoint);const O=n.screenPointToLocation($),{center:Z,zoom:Q}=n.getConstrained(s.S.convert(a.center||O),z??f);cs(n,Z);const ae=Ee(n.worldSize,O),se=Ee(n.worldSize,Z).sub(ae),le=s.ae(Q-f);return L=Q!==f,{easeFunc:ue=>{if(L&&n.setZoom(s.C.number(f,Q,ue)),s.bd(v,S)||En({startEulerAngles:v,endEulerAngles:S,tr:n,k:ue,useSlerp:v.roll!=S.roll}),M&&(n.interpolatePadding(m,a.padding,ue),$=n.centerPoint.add(a.offsetAsPoint)),a.around)n.setLocationAtPoint(a.around,a.aroundPoint);else{const ge=s.ae(n.zoom-f),he=Q>f?Math.min(2,le):Math.max(.5,le),_e=Math.pow(he,1-ue),be=ee(n.worldSize,ae.add(se.mult(ue*_e)).mult(ge));n.setLocationAtPoint(n.renderWorldCopies?be.wrap():be,$)}},isZooming:L,elevationCenter:Z}}handleFlyTo(n,a){const f=a.zoom!==void 0,m=n.zoom,v=n.getConstrained(s.S.convert(a.center||a.locationAtOffset),f?+a.zoom:m),S=v.center,P=v.zoom;cs(n,S);const M=Ee(n.worldSize,a.locationAtOffset),L=Ee(n.worldSize,S).sub(M),z=L.mag(),$=s.ae(P-m);let O;if(a.minZoom!==void 0){const Z=Math.min(+a.minZoom,m,P),Q=n.getConstrained(S,Z).zoom;O=s.ae(Q-m)}return{easeFunc:(Z,Q,ae,se)=>{n.setZoom(Z===1?P:m+s.aj(Q));const le=Z===1?S:ee(n.worldSize,M.add(L.mult(ae)).mult(Q));n.setLocationAtPoint(n.renderWorldCopies?le.wrap():le,se)},scaleOfZoom:$,targetCenter:S,scaleOfMinZoom:O,pixelPathLength:z}}}class or{constructor(n,a,f){this.blendFunction=n,this.blendColor=a,this.mask=f}}or.Replace=[1,0],or.disabled=new or(or.Replace,s.be.transparent,[!1,!1,!1,!1]),or.unblended=new or(or.Replace,s.be.transparent,[!0,!0,!0,!0]),or.alphaBlended=new or([1,771],s.be.transparent,[!0,!0,!0,!0]);const vi=2305;class Ot{constructor(n,a,f){this.enable=n,this.mode=a,this.frontFace=f}}Ot.disabled=new Ot(!1,1029,vi),Ot.backCCW=new Ot(!0,1029,vi),Ot.frontCCW=new Ot(!0,1028,vi);class Bt{constructor(n,a,f){this.func=n,this.mask=a,this.range=f}}Bt.ReadOnly=!1,Bt.ReadWrite=!0,Bt.disabled=new Bt(519,Bt.ReadOnly,[0,1]);const Ca=7680;class zt{constructor(n,a,f,m,v,S){this.test=n,this.ref=a,this.mask=f,this.fail=m,this.depthFail=v,this.pass=S}}zt.disabled=new zt({func:519,mask:0},0,0,Ca,Ca,Ca);const Pa=new WeakMap;function si(y){var n;if(Pa.has(y))return Pa.get(y);{const a=(n=y.getParameter(y.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Pa.set(y,a),a}}class ll{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const a=n.context,f=a.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const m=new s.aK;m.emplaceBack(-1,-1),m.emplaceBack(2,-1),m.emplaceBack(-1,2);const v=new s.aM;v.emplaceBack(0,1,2),this._fullscreenTriangle=new as(a.createVertexBuffer(m,ls.members),a.createIndexBuffer(v),s.aL.simpleSegment(0,0,m.length,v.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),si(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,a){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,a=n.gl;n.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,a){const f=this._cachedRenderContext.context,m=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:s.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,m.TRIANGLES,Bt.disabled,zt.disabled,or.unblended,Ot.disabled,((v,S)=>({u_input:v,u_output_expected:S}))(n,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&si(m)){m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.readBuffer(m.COLOR_ATTACHMENT0),m.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),m.bindBuffer(m.PIXEL_PACK_BUFFER,null);const v=m.fenceSync(m.SYNC_GPU_COMMANDS_COMPLETE,0);m.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:v}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&si(n)){const a=n.clientWaitSync(this._readbackQueue.sync,0,0);if(a===n.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ll._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let a=0;return a+=n[0]/256,a+=n[1]/65536,a+=n[2]/16777216,n[3]<127&&(a=-a),a/128}}const _i=s.$/128;function Ap(y,n){const a=y.granularity!==void 0?Math.max(y.granularity,1):1,f=a+(y.generateBorders?2:0),m=a+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),v=f+1,S=m+1,P=y.generateBorders?-1:0,M=y.generateBorders||y.extendToNorthPole?-1:0,L=a+(y.generateBorders?1:0),z=a+(y.generateBorders||y.extendToSouthPole?1:0),$=v*S,O=f*m*6,Z=v*S>65536;if(Z&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=Z||n==="32bit",ae=new Int16Array(2*$);let se=0;for(let ge=M;ge<=z;ge++)for(let he=P;he<=L;he++){let _e=he/a*s.$;he===-1&&(_e=-_i),he===a+1&&(_e=s.$+_i);let be=ge/a*s.$;ge===-1&&(be=y.extendToNorthPole?s.bg:-_i),ge===a+1&&(be=y.extendToSouthPole?s.bh:s.$+_i),ae[se++]=_e,ae[se++]=be}const le=Q?new Uint32Array(O):new Uint16Array(O);let ue=0;for(let ge=0;ge<m;ge++)for(let he=0;he<f;he++){const _e=he+1+ge*v,be=he+(ge+1)*v,me=he+1+(ge+1)*v;le[ue++]=he+ge*v,le[ue++]=be,le[ue++]=_e,le[ue++]=_e,le[ue++]=be,le[ue++]=me}return{vertices:ae.buffer.slice(0),indices:le.buffer.slice(0),uses32bitIndices:Q}}const No=new s.aJ({fill:new s.bi(128,2),line:new s.bi(512,0),tile:new s.bi(128,32),stencil:new s.bi(128,1),circle:3});class Dg{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return zo.projectionGlobe}get vertexShaderPreludeCode(){return zo.projectionMercator.vertexSource}get subdivisionGranularity(){return No}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new ll(n));const a=s.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,m=this._errorMeasurement.updateErrorLoop(a,f),v=I.now();m!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=m,this._errorMeasurementLastChangeTime=v);const S=Math.min(Math.max((v-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bk(S))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,a,f,m,v){const S=(v==="stencil"?No.stencil:No.tile).getGranularityForZoomLevel(a.z);return this._getMesh(n,{granularity:S,generateBorders:f,extendToNorthPole:a.y===0&&m,extendToSouthPole:a.y===(1<<a.z)-1&&m})}_getMesh(n,a){const f=this._getMeshKey(a);if(f in this._tileMeshCache)return this._tileMeshCache[f];const m=function(v,S){const P=Ap(S,"16bit"),M=s.aK.deserialize({arrayBuffer:P.vertices,length:P.vertices.byteLength/2/2}),L=s.aM.deserialize({arrayBuffer:P.indices,length:P.indices.byteLength/2/3});return new as(v.createVertexBuffer(M,ls.members),v.createIndexBuffer(L),s.aL.simpleSegment(0,0,M.length,L.length))}(n,a);return this._tileMeshCache[f]=m,m}recalculate(n){}hasTransition(){const n=I.now();let a=!1;return a=a||(n-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const zg=new s.r({type:new s.D(s.v.projection.type)});class Dc extends s.E{constructor(n){super(),this._transitionable=new s.t(zg),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new Mp,this._verticalPerspectiveProjection=new Dg}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof s.bl){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,a,f,m,v){return this.currentProjection.getMeshFromTileID(n,a,f,m,v)}setProjection(n){this._transitionable.setValue("type",(n==null?void 0:n.type)||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function zc(y){const n=cl(y.worldSize,y.center.lat);return 2*Math.PI*n}function uo(y,n,a,f,m){const v=1/(1<<m),S=n/s.$*v+f*v,P=s.bn((y/s.$*v+a*v)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,L=Math.cos(M),z=new Float64Array(3);return z[0]=Math.sin(P)*L,z[1]=Math.sin(M),z[2]=Math.cos(P)*L,z}function Mn(y){return function(n,a){const f=Math.cos(a),m=new Float64Array(3);return m[0]=Math.sin(n)*f,m[1]=Math.sin(a),m[2]=Math.cos(n)*f,m}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function cl(y,n){return y/(2*Math.PI)/Math.cos(n*Math.PI/180)}function Nc(y){const n=Math.asin(y[1])/Math.PI*180,a=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(a>1e-6){const f=y[0]/a,m=Math.acos(y[2]/a),v=(f>0?m:-m)/Math.PI*180;return new s.S(s.aN(v,-180,180),n)}return new s.S(0,n)}function ul(y){return Math.cos(y*Math.PI/180)}function dn(y,n){const a=ul(y),f=ul(n);return s.aj(f/a)}function jc(y,n){const a=y.rotate(n.bearingInRadians),f=n.zoom+dn(n.center.lat,0),m=s.bj(1/ul(n.center.lat),1/ul(Math.min(Math.abs(n.center.lat),60)),s.bm(f,7,3,0,1)),v=360/zc({worldSize:n.worldSize,center:{lat:n.center.lat}});return new s.S(n.center.lng-a.x*v*m,s.ag(n.center.lat+a.y*v,-s.ah,s.ah))}function hl(y){const n=.5*y,a=Math.sin(n),f=Math.cos(n);return Math.log(a+f)-Math.log(f-a)}function dl(y,n,a,f){const m=y.lat+a*f;if(Math.abs(a)>1){const v=(Math.sign(y.lat+a)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,S=Math.abs(y.lat+a)*Math.PI/180,P=hl(v+f*(S-v)),M=hl(v),L=hl(S);return new s.S(y.lng+n*((P-M)/(L-M)),m)}return new s.S(y.lng+n*f,m)}class Z_{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,a,f,m){const v=`${n.z}_${n.x}_${n.y}_${m!=null&&m.terrain?"t":""}`,S=this._cache.get(v);if(S)return S;const P=this._cachePrevious.get(v);if(P)return this._cache.set(v,P),P;const M=this._boundingVolumeFactory(n,a,f,m);return this._cache.set(v,M),this._hadAnyChanges=!0,M}}class $s{constructor(n,a,f,m){this.min=f,this.max=m,this.points=n,this.planes=a}static fromAabb(n,a){const f=[];for(let m=0;m<8;m++)f.push([1&~m?n[0]:a[0],(m>>1&1)==1?a[1]:n[1],(m>>2&1)==1?a[2]:n[2]]);return new $s(f,[[-1,0,0,a[0]],[1,0,0,-n[0]],[0,-1,0,a[1]],[0,1,0,-n[1]],[0,0,-1,a[2]],[0,0,1,-n[2]]],n,a)}static fromCenterSizeAngles(n,a,f){const m=s.bq([],f[0],f[1],f[2]),v=s.br([],[a[0],0,0],m),S=s.br([],[0,a[1],0],m),P=s.br([],[0,0,a[2]],m),M=[...n],L=[...n];for(let $=0;$<8;$++)for(let O=0;O<3;O++){const Z=n[O]+v[O]*(1&~$?-1:1)+S[O]*(($>>1&1)==1?1:-1)+P[O]*(($>>2&1)==1?1:-1);M[O]=Math.min(M[O],Z),L[O]=Math.max(L[O],Z)}const z=[];for(let $=0;$<8;$++){const O=[...n];s.aR(O,O,s.aQ([],v,1&~$?-1:1)),s.aR(O,O,s.aQ([],S,($>>1&1)==1?1:-1)),s.aR(O,O,s.aQ([],P,($>>2&1)==1?1:-1)),z.push(O)}return new $s(z,[[...v,-s.aW(v,z[0])],[...S,-s.aW(S,z[0])],[...P,-s.aW(P,z[0])],[-v[0],-v[1],-v[2],-s.aW(v,z[7])],[-S[0],-S[1],-S[2],-s.aW(S,z[7])],[-P[0],-P[1],-P[2],-s.aW(P,z[7])]],M,L)}intersectsFrustum(n){let a=!0;const f=this.points.length,m=this.planes.length,v=n.planes.length,S=n.points.length;for(let P=0;P<v;P++){const M=n.planes[P];let L=0;for(let z=0;z<f;z++){const $=this.points[z];M[0]*$[0]+M[1]*$[1]+M[2]*$[2]+M[3]>=0&&L++}if(L===0)return 0;L<f&&(a=!1)}if(a)return 2;for(let P=0;P<m;P++){const M=this.planes[P];let L=0;for(let z=0;z<S;z++){const $=n.points[z];M[0]*$[0]+M[1]*$[1]+M[2]*$[2]+M[3]>=0&&L++}if(L===0)return 0}return 1}intersectsPlane(n){const a=this.points.length;let f=0;for(let m=0;m<a;m++){const v=this.points[m];n[0]*v[0]+n[1]*v[1]+n[2]*v[2]+n[3]>=0&&f++}return f===a?2:f===0?0:1}}function Oc(y,n,a){const f=y-n;return f<0?-f:Math.max(0,f-a)}function Ip(y,n,a,f,m){const v=y-a;let S;return S=v<0?Math.min(-v,1+v-m):v>1?Math.min(Math.max(v-m,0),1-v):0,Math.max(S,Oc(n,f,m))}class W_{constructor(){this._boundingVolumeCache=new Z_(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,a,f,m){const v=1<<f.z,S=1/v,P=f.x/v,M=f.y/v;let L=2;return L=Math.min(L,Ip(n,a,P,M,S)),L=Math.min(L,Ip(n,a,P+.5,-M-S,S)),L=Math.min(L,Ip(n,a,P+.5,2-M-S,S)),L}getWrap(n,a,f){const m=1<<a.z,v=1/m,S=a.x/m,P=Oc(n.x,S,v),M=Oc(n.x,S-1,v),L=Oc(n.x,S+1,v),z=Math.min(P,M,L);return z===L?1:z===M?-1:0}allowVariableZoom(n,a){return $e(n,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,a,f,m){return this._boundingVolumeCache.getTileBoundingVolume(n,a,f,m)}_computeTileBoundingVolume(n,a,f,m){var v,S;let P=f,M=f;if(m!=null&&m.terrain){const L=new s.Z(n.z,a,n.z,n.x,n.y),z=m.terrain.getMinMaxElevation(L);P=(v=z.minElevation)!==null&&v!==void 0?v:f,M=(S=z.maxElevation)!==null&&S!==void 0?S:f}if(P/=s.bt,M/=s.bt,P+=1,M+=1,n.z<=0)return $s.fromAabb([-M,-M,-M],[M,M,M]);if(n.z===1)return $s.fromAabb([n.x===0?-M:0,n.y===0?0:-M,-M],[n.x===0?0:M,n.y===0?M:0,M]);{const L=[uo(0,0,n.x,n.y,n.z),uo(s.$,0,n.x,n.y,n.z),uo(s.$,s.$,n.x,n.y,n.z),uo(0,s.$,n.x,n.y,n.z)],z=[];for(const Ie of L)z.push(s.aQ([],Ie,M));if(M!==P)for(const Ie of L)z.push(s.aQ([],Ie,P));n.y===0&&z.push([0,1,0]),n.y===(1<<n.z)-1&&z.push([0,-1,0]);const $=[1,1,1],O=[-1,-1,-1];for(const Ie of z)for(let je=0;je<3;je++)$[je]=Math.min($[je],Ie[je]),O[je]=Math.max(O[je],Ie[je]);const Z=uo(s.$/2,s.$/2,n.x,n.y,n.z),Q=s.aV([],[0,1,0],Z);s.aU(Q,Q);const ae=s.aV([],Z,Q);s.aU(ae,ae);const se=s.aV([],L[2],L[1]);s.aU(se,se);const le=s.aV([],L[0],L[3]);s.aU(le,le),z.push(s.aQ([],Z,M)),n.y>=(1<<n.z)/2&&z.push(s.aQ([],uo(s.$/2,0,n.x,n.y,n.z),M)),n.y<(1<<n.z)/2&&z.push(s.aQ([],uo(s.$/2,s.$,n.x,n.y,n.z),M));const ue=ai(Z,z),ge=ai(ae,z),he=[-Z[0],-Z[1],-Z[2],ue.max],_e=[Z[0],Z[1],Z[2],-ue.min],be=[-ae[0],-ae[1],-ae[2],ge.max],me=[ae[0],ae[1],ae[2],-ge.min],Ce=[...se,0],Ne=[...le,0],Ae=[];return n.y===0?Ae.push(s.bs(Ne,Ce,he),s.bs(Ne,Ce,_e)):Ae.push(s.bs(be,Ce,he),s.bs(be,Ce,_e),s.bs(be,Ne,he),s.bs(be,Ne,_e)),n.y===(1<<n.z)-1?Ae.push(s.bs(Ne,Ce,he),s.bs(Ne,Ce,_e)):Ae.push(s.bs(me,Ce,he),s.bs(me,Ce,_e),s.bs(me,Ne,he),s.bs(me,Ne,_e)),new $s(Ae,[he,_e,be,me,Ce,Ne],$,O)}}}function ai(y,n){let a=1/0,f=-1/0;for(const m of n){const v=s.aW(y,m);a=Math.min(a,v),f=Math.max(f,v)}return{min:a,max:f}}class pl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,a,f){return this._helper.interpolatePadding(n,a,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,a){this._helper.resize(n,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,a){this._helper.overrideNearFarZ(n,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=s.bu(),this._projectionMatrix=s.b8(),this._globeViewProjMatrix32f=s.b7(),this._globeViewProjMatrixNoCorrection=s.b8(),this._globeViewProjMatrixNoCorrectionInverted=s.b8(),this._globeProjMatrixInverted=s.b8(),this._cameraPosition=s.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Lc({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,a)=>this.getConstrained(n,a)}),this._coveringTilesDetailsProvider=new W_}clone(){const n=new pl;return n.apply(this),n}apply(n,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=s.bo();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:a,applyGlobeMatrix:f}=n,m=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:m,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const a=this.pitchInRadians,f=this.cameraToCenterDistance/n,m=Math.sin(a)*f,v=Math.cos(a)*f+1,S=1/Math.sqrt(m*m+v*v)*1;let P=-m,M=v;const L=Math.sqrt(P*P+M*M);P/=L,M/=L;const z=[0,P,M];s.bv(z,z,[0,0,0],-this.bearingInRadians),s.bw(z,z,[0,0,0],-1*this.center.lat*Math.PI/180),s.bx(z,z,[0,0,0],this.center.lng*Math.PI/180);const $=1/s.aY(z);return s.aQ(z,z,$),[...z,-S*$]}isLocationOccluded(n){return!this.isSurfacePointVisible(Mn(n))}transformLightDirection(n){const a=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,m=Math.cos(f),v=[Math.sin(a)*m,Math.sin(f),Math.cos(a)*m],S=[v[2],0,-v[0]],P=[0,0,0];s.aV(P,S,v),s.aU(S,S),s.aU(P,P);const M=[0,0,0];return s.aU(M,[S[0]*n[0]+P[0]*n[1]+v[0]*n[2],S[1]*n[0]+P[1]*n[1]+v[1]*n[2],S[2]*n[0]+P[2]*n[1]+v[2]*n[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,a,f){const m=function(P,M,L){const z=1/(1<<L.z);return new s.a0(P/s.$*z+L.x*z,M/s.$*z+L.y*z)}(n,a,f.canonical),v=(S=m.y,[s.bn(m.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(v[1])}projectTileCoordinates(n,a,f,m){const v=f.canonical,S=uo(n,a,v.x,v.y,v.z),P=1+(m?m(n,a):0)/s.bt,M=[S[0]*P,S[1]*P,S[2]*P,1];s.av(M,M,this._globeViewProjMatrixNoCorrection);const L=this._cachedClippingPlane,z=L[0]*S[0]+L[1]*S[1]+L[2]*S[2]+L[3]<0;return{point:new s.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=cl(this.worldSize,this.center.lat),a=s.b9(),f=s.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),s.b3(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const m=this.centerOffset;a[8]=2*-m.x/this._helper._width,a[9]=2*m.y/this._helper._height,this._projectionMatrix=s.b4(a),this._globeProjMatrixInverted=s.b9(),s.ap(this._globeProjMatrixInverted,a),s.M(a,a,[0,0,-this.cameraToCenterDistance]),s.b5(a,a,this.rollInRadians),s.b6(a,a,-this.pitchInRadians),s.b5(a,a,this.bearingInRadians),s.M(a,a,[0,0,-n]);const v=s.bo();v[0]=n,v[1]=n,v[2]=n,s.b6(f,a,this.center.lat*Math.PI/180),s.by(f,f,-this.center.lng*Math.PI/180),s.N(f,f,v),this._globeViewProjMatrixNoCorrection=f,s.b6(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.by(a,a,-this.center.lng*Math.PI/180),s.N(a,a,v),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),s.ap(this._globeViewProjMatrixNoCorrectionInverted,f);const S=s.bo();this._cameraPosition=s.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/n,s.bv(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),s.bw(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),s.bv(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),s.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bw(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),s.bx(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const P=s.b4(this._globeViewProjMatrixNoCorrectionInverted);s.N(P,P,[1,1,-1]),this._cachedFrustum=Yn.fromInvProjectionMatrix(P,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){s.w("calculateFogMatrix is not supported on globe projection.");const a=s.b9();return s.af(a),a}getVisibleUnwrappedCoordinates(n){return[new s.b1(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Mn(n);s.aQ(f,f,1+a/s.bt);const m=s.bu();return s.av(m,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),m[2]/m[3]}populateCache(n){}getBounds(){const n=.5*this.width,a=.5*this.height,f=[new s.P(0,0),new s.P(n,0),new s.P(this.width,0),new s.P(this.width,a),new s.P(this.width,this.height),new s.P(n,this.height),new s.P(0,this.height),new s.P(0,a)],m=[];for(const $ of f)m.push(this.unprojectScreenPoint($));let v=0,S=0,P=0,M=0;const L=this.center;for(const $ of m){const O=s.bz(L.lng,$.lng),Z=s.bz(L.lat,$.lat);O<S&&(S=O),O>v&&(v=O),Z<M&&(M=Z),Z>P&&(P=Z)}const z=[L.lng+S,L.lat+M,L.lng+v,L.lat+P];return this.isSurfacePointOnScreen([0,1,0])&&(z[3]=90,z[0]=-180,z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(z[1]=-90,z[0]=-180,z[2]=180),new vr(z)}getConstrained(n,a){const f=s.ag(n.lat,-s.ah,s.ah),m=s.ag(+a,this.minZoom+dn(0,f),this.maxZoom);return{center:new s.S(n.lng,f),zoom:m}}calculateCenterFromCameraLngLatAlt(n,a,f,m){return this._helper.calculateCenterFromCameraLngLatAlt(n,a,f,m)}setLocationAtPoint(n,a){const f=Mn(this.unprojectScreenPoint(a)),m=Mn(n),v=s.bo();s.bA(v);const S=s.bo();s.bx(S,f,v,-this.center.lng*Math.PI/180),s.bw(S,S,v,this.center.lat*Math.PI/180);const P=m[0]*m[0]+m[2]*m[2],M=S[0]*S[0];if(P<M)return;const L=Math.sqrt(P-M),z=-L,$=s.bB(m[0],m[2],S[0],L),O=s.bB(m[0],m[2],S[0],z),Z=s.bo();s.bx(Z,m,v,-$);const Q=s.bB(Z[1],Z[2],S[1],S[2]),ae=s.bo();s.bx(ae,m,v,-O);const se=s.bB(ae[1],ae[2],S[1],S[2]),le=.5*Math.PI,ue=Q>=-le&&Q<=le,ge=se>=-le&&se<=le;let he,_e;if(ue&&ge){const Ne=this.center.lng*Math.PI/180,Ae=this.center.lat*Math.PI/180;s.bC($,Ne)+s.bC(Q,Ae)<s.bC(O,Ne)+s.bC(se,Ae)?(he=$,_e=Q):(he=O,_e=se)}else if(ue)he=$,_e=Q;else{if(!ge)return;he=O,_e=se}const be=he/Math.PI*180,me=_e/Math.PI*180,Ce=this.center.lat;this.setCenter(new s.S(be,s.ag(me,-90,90))),this.setZoom(this.zoom+dn(Ce,this.center.lat))}locationToScreenPoint(n,a){const f=Mn(n);if(a){const m=a.getElevationForLngLatZoom(n,this._helper._tileZoom);s.aQ(f,f,1+m/s.bt)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(n){const a=s.bu();return s.av(a,[...n,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new s.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,a){if(a){const f=a.pointCoordinate(n);if(f)return f}return s.a0.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,a){var f;return(f=this.screenPointToMercatorCoordinate(n,a))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(n,a){const f=this._cameraPosition,m=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(f,m)}getRayDirectionFromPixel(n){const a=s.bu();a[0]=n.x/this.width*2-1,a[1]=-1*(n.y/this.height*2-1),a[2]=1,a[3]=1,s.av(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const f=s.bo();f[0]=a[0]-this._cameraPosition[0],f[1]=a[1]-this._cameraPosition[1],f[2]=a[2]-this._cameraPosition[2];const m=s.bo();return s.aU(m,f),m}isSurfacePointVisible(n){const a=this._cachedClippingPlane;return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const a=s.bu();return s.av(a,[...n,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(n,a){const f=s.aW(n,a),m=s.bo(),v=s.bo();s.aQ(v,a,f),s.aT(m,n,v);const S=1-s.aW(m,m);if(S<0)return null;const P=s.aW(n,n)-1,M=-f+(f<0?1:-1)*Math.sqrt(S),L=P/M,z=M;return{tMin:Math.min(L,z),tMax:Math.max(L,z)}}unprojectScreenPoint(n){const a=this._cameraPosition,f=this.getRayDirectionFromPixel(n),m=this.rayPlanetIntersection(a,f);if(m){const z=s.bo();s.aR(z,a,[f[0]*m.tMin,f[1]*m.tMin,f[2]*m.tMin]);const $=s.bo();return s.aU($,z),Nc($)}const v=this._cachedClippingPlane,S=v[0]*f[0]+v[1]*f[1]+v[2]*f[2],P=-s.b0(v,a)/S,M=s.bo();if(P>0)s.aR(M,a,[f[0]*P,f[1]*P,f[2]*P]);else{const z=s.bo();s.aR(z,a,[2*f[0],2*f[1],2*f[2]]);const $=s.b0(this._cachedClippingPlane,z);s.aT(M,z,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const L=function(z){const $=s.bo();return $[0]=z[0]*-z[3],$[1]=z[1]*-z[3],$[2]=z[2]*-z[3],{center:$,radius:Math.sqrt(1-z[3]*z[3])}}(v);return Nc(function(z,$,O){const Z=s.bo();s.aT(Z,O,z);const Q=s.bo();return s.bp(Q,z,Z,$/s.a_(Z)),Q}(L.center,L.radius,M))}getMatrixForModel(n,a){const f=s.S.convert(n),m=1/s.bt,v=s.b8();return s.by(v,v,f.lng/180*Math.PI),s.b6(v,v,-f.lat/180*Math.PI),s.M(v,v,[0,0,1+a/s.bt]),s.b6(v,v,.5*Math.PI),s.N(v,v,[m,m,m]),v}getProjectionDataForCustomLayer(n=!0){const a=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:n});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(n){}}class zi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,a,f){return this._helper.interpolatePadding(n,a,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,a,f=!0){this._helper.resize(n,a,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,a){this._helper.overrideNearFarZ(n,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,a){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Lc({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,a)=>this.getConstrained(n,a)}),this._globeness=1,this._mercatorTransform=new hn,this._verticalPerspectiveTransform=new pl}clone(){const n=new zi;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const a=this._mercatorTransform.getProjectionData(n),f=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:a.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return s.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,a,f){const m=this._mercatorTransform.getPitchedTextCorrection(n,a,f),v=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,a,f);return s.bj(m,v,this._globeness)}projectTileCoordinates(n,a,f,m){return this.currentTransform.projectTileCoordinates(n,a,f,m)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,a){return this.currentTransform.lngLatToCameraDepth(n,a)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,a){return this.currentTransform.getConstrained(n,a)}calculateCenterFromCameraLngLatAlt(n,a,f,m){return this._helper.calculateCenterFromCameraLngLatAlt(n,a,f,m)}setLocationAtPoint(n,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,a){return this.currentTransform.locationToScreenPoint(n,a)}screenPointToMercatorCoordinate(n,a){return this.currentTransform.screenPointToMercatorCoordinate(n,a)}screenPointToLocation(n,a){return this.currentTransform.screenPointToLocation(n,a)}isPointOnMapSurface(n,a){return this.currentTransform.isPointOnMapSurface(n,a)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,a){return this.currentTransform.getMatrixForModel(n,a)}getProjectionDataForCustomLayer(n=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return a;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return f.fallbackMatrix=a.mainMatrix,f}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class xi{get useGlobeControls(){return!0}handlePanInertia(n,a){const f=jc(n,a);return Math.abs(f.lng-a.center.lng)>180&&(f.lng=a.center.lng+179.5*Math.sign(f.lng-a.center.lng)),{easingCenter:f,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,a){const f=n.around,m=a.screenPointToLocation(f);n.bearingDelta&&a.setBearing(a.bearing+n.bearingDelta),n.pitchDelta&&a.setPitch(a.pitch+n.pitchDelta),n.rollDelta&&a.setRoll(a.roll+n.rollDelta);const v=a.zoom;n.zoomDelta&&a.setZoom(a.zoom+n.zoomDelta);const S=a.zoom-v;if(S===0)return;const P=s.bz(a.center.lng,m.lng),M=P/(Math.abs(P/180)+1),L=s.bz(a.center.lat,m.lat),z=a.getRayDirectionFromPixel(f),$=a.cameraPosition,O=-1*s.aW($,z),Z=s.bo();s.aR(Z,$,[z[0]*O,z[1]*O,z[2]*O]);const Q=s.aY(Z)-1,ae=Math.exp(.5*-Math.max(Q-.3,0)),se=cl(a.worldSize,a.center.lat)/Math.min(a.width,a.height),le=s.bm(se,.9,.5,1,.25),ue=(1-s.ae(-S))*Math.min(ae,le),ge=a.center.lat,he=a.zoom,_e=new s.S(a.center.lng+M*ue,s.ag(a.center.lat+L*ue,-s.ah,s.ah));a.setLocationAtPoint(m,f);const be=a.center,me=s.bm(Math.abs(P),45,85,0,1),Ce=s.bm(se,.75,.35,0,1),Ne=Math.pow(Math.max(me,Ce),.25),Ae=s.bz(be.lng,_e.lng),Ie=s.bz(be.lat,_e.lat);a.setCenter(new s.S(be.lng+Ae*Ne,be.lat+Ie*Ne).wrap()),a.setZoom(he+dn(ge,a.center.lat))}handleMapControlsPan(n,a,f){if(!n.panDelta)return;const m=a.center.lat,v=a.zoom;a.setCenter(jc(n.panDelta,a).wrap()),a.setZoom(v+dn(m,a.center.lat))}cameraForBoxAndBearing(n,a,f,m,v){const S=zr(n,a,f,m,v),P=a.left/v.width*2-1,M=(v.width-a.right)/v.width*2-1,L=a.top/v.height*-2+1,z=(v.height-a.bottom)/v.height*-2+1,$=s.bz(f.getWest(),f.getEast())<0,O=$?f.getEast():f.getWest(),Z=$?f.getWest():f.getEast(),Q=Math.max(f.getNorth(),f.getSouth()),ae=Math.min(f.getNorth(),f.getSouth()),se=O+.5*s.bz(O,Z),le=Q+.5*s.bz(Q,ae),ue=v.clone();ue.setCenter(S.center),ue.setBearing(S.bearing),ue.setPitch(0),ue.setRoll(0),ue.setZoom(S.zoom);const ge=ue.modelViewProjectionMatrix,he=[Mn(f.getNorthWest()),Mn(f.getNorthEast()),Mn(f.getSouthWest()),Mn(f.getSouthEast()),Mn(new s.S(Z,le)),Mn(new s.S(O,le)),Mn(new s.S(se,Q)),Mn(new s.S(se,ae))],_e=Mn(S.center);let be=Number.POSITIVE_INFINITY;for(const me of he)P<0&&(be=xi.getLesserNonNegativeNonNull(be,xi.solveVectorScale(me,_e,ge,"x",P))),M>0&&(be=xi.getLesserNonNegativeNonNull(be,xi.solveVectorScale(me,_e,ge,"x",M))),L>0&&(be=xi.getLesserNonNegativeNonNull(be,xi.solveVectorScale(me,_e,ge,"y",L))),z<0&&(be=xi.getLesserNonNegativeNonNull(be,xi.solveVectorScale(me,_e,ge,"y",z)));if(Number.isFinite(be)&&be!==0)return S.zoom=ue.zoom+s.aj(be),S;Qn()}handleJumpToCenterZoom(n,a){const f=n.center.lat,m=n.getConstrained(a.center?s.S.convert(a.center):n.center,n.zoom).center;n.setCenter(m.wrap());const v=a.zoom!==void 0?+a.zoom:n.zoom+dn(f,m.lat);n.zoom!==v&&n.setZoom(v)}handleEaseTo(n,a){const f=n.zoom,m=n.center,v=n.padding,S={roll:n.roll,pitch:n.pitch,bearing:n.bearing},P={roll:a.roll===void 0?n.roll:a.roll,pitch:a.pitch===void 0?n.pitch:a.pitch,bearing:a.bearing===void 0?n.bearing:a.bearing},M=a.zoom!==void 0,L=!n.isPaddingEqual(a.padding);let z=!1;const $=a.center?s.S.convert(a.center):m,O=n.getConstrained($,f).center;cs(n,O);const Z=n.clone();Z.setCenter(O),Z.setZoom(M?+a.zoom:f+dn(m.lat,$.lat)),Z.setBearing(a.bearing);const Q=new s.P(s.ag(n.centerPoint.x+a.offsetAsPoint.x,0,n.width),s.ag(n.centerPoint.y+a.offsetAsPoint.y,0,n.height));Z.setLocationAtPoint(O,Q);const ae=(a.offset&&a.offsetAsPoint.mag())>0?Z.center:O,se=M?+a.zoom:f+dn(m.lat,ae.lat),le=f+dn(m.lat,0),ue=se+dn(ae.lat,0),ge=s.bz(m.lng,ae.lng),he=s.bz(m.lat,ae.lat),_e=s.ae(ue-le);return z=se!==f,{easeFunc:be=>{if(s.bd(S,P)||En({startEulerAngles:S,endEulerAngles:P,tr:n,k:be,useSlerp:S.roll!=P.roll}),L&&n.interpolatePadding(v,a.padding,be),a.around)s.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(a.around,a.aroundPoint);else{const me=ue>le?Math.min(2,_e):Math.max(.5,_e),Ce=Math.pow(me,1-be),Ne=dl(m,ge,he,be*Ce);n.setCenter(Ne.wrap())}if(z){const me=s.C.number(le,ue,be)+dn(0,n.center.lat);n.setZoom(me)}},isZooming:z,elevationCenter:ae}}handleFlyTo(n,a){const f=a.zoom!==void 0,m=n.center,v=n.zoom,S=n.padding,P=!n.isPaddingEqual(a.padding),M=n.getConstrained(s.S.convert(a.center||a.locationAtOffset),v).center,L=f?+a.zoom:n.zoom+dn(n.center.lat,M.lat),z=n.clone();z.setCenter(M),z.setZoom(L),z.setBearing(a.bearing);const $=new s.P(s.ag(n.centerPoint.x+a.offsetAsPoint.x,0,n.width),s.ag(n.centerPoint.y+a.offsetAsPoint.y,0,n.height));z.setLocationAtPoint(M,$);const O=z.center;cs(n,O);const Z=function(he,_e,be){const me=Mn(_e),Ce=Mn(be),Ne=s.aW(me,Ce),Ae=Math.acos(Ne),Ie=zc(he);return Ae/(2*Math.PI)*Ie}(n,m,O),Q=v+dn(m.lat,0),ae=L+dn(O.lat,0),se=s.ae(ae-Q);let le;if(typeof a.minZoom=="number"){const he=+a.minZoom+dn(O.lat,0),_e=Math.min(he,Q,ae)+dn(0,O.lat),be=n.getConstrained(O,_e).zoom+dn(O.lat,0);le=s.ae(be-Q)}const ue=s.bz(m.lng,O.lng),ge=s.bz(m.lat,O.lat);return{easeFunc:(he,_e,be,me)=>{const Ce=dl(m,ue,ge,be);P&&n.interpolatePadding(S,a.padding,he);const Ne=he===1?O:Ce;n.setCenter(Ne.wrap());const Ae=Q+s.aj(_e);n.setZoom(he===1?L:Ae+dn(0,Ne.lat))},scaleOfZoom:se,targetCenter:O,scaleOfMinZoom:le,pixelPathLength:Z}}static solveVectorScale(n,a,f,m,v){const S=m==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],P=[f[3],f[7],f[11],f[15]],M=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],L=n[0]*P[0]+n[1]*P[1]+n[2]*P[2],z=a[0]*S[0]+a[1]*S[1]+a[2]*S[2],$=a[0]*P[0]+a[1]*P[1]+a[2]*P[2];return z+v*L===M+v*$||P[3]*(M-z)+S[3]*($-L)+M*$==z*L?null:(z+S[3]-v*$-v*P[3])/(z-M-v*$+v*L)}static getLesserNonNegativeNonNull(n,a){return a!==null&&a>=0&&a<n?a:n}}class Rp{constructor(n){this._globe=n,this._mercatorCameraHelper=new yh,this._verticalPerspectiveCameraHelper=new xi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,a){return this.currentHelper.handlePanInertia(n,a)}handleMapControlsRollPitchBearingZoom(n,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,a)}handleMapControlsPan(n,a,f){this.currentHelper.handleMapControlsPan(n,a,f)}cameraForBoxAndBearing(n,a,f,m,v){return this.currentHelper.cameraForBoxAndBearing(n,a,f,m,v)}handleJumpToCenterZoom(n,a){this.currentHelper.handleJumpToCenterZoom(n,a)}handleEaseTo(n,a){return this.currentHelper.handleEaseTo(n,a)}handleFlyTo(n,a){return this.currentHelper.handleFlyTo(n,a)}}const Fc=(y,n)=>s.y(y,n&&n.filter(a=>a.identifier!=="source.canvas")),fl=s.bD();class Lp extends s.E{constructor(n,a={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const m=this.sourceCaches[f].getSource().type;m!=="vector"&&m!=="geojson"||this.sourceCaches[f].reload()}},this.map=n,this.dispatcher=new gr(lr(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,m)=>this.getGlyphs(f,m)),this.dispatcher.registerMessageHandler("GI",(f,m)=>this.getImages(f,m)),this.imageManager=new We,this.imageManager.setEventedParent(this),this.glyphManager=new Ct(n._requestManager,a.localIdeographFontFamily),this.lineAtlas=new De(256,512),this.crossTileSymbolIndex=new fh,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bF()),un().on(lo,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const m=this.sourceCaches[f.sourceId];if(!m)return;const v=m.getSource();if(v&&v.vectorLayerIds)for(const S in this._layers){const P=this._layers[S];P.source===v.id&&this._validateLayer(P)}})}setGlobalStateProperty(n,a){var f,m,v;this._checkLoaded();const S=a===null?(v=(m=(f=this.stylesheet.state)===null||f===void 0?void 0:f[n])===null||m===void 0?void 0:m.default)!==null&&v!==void 0?v:null:a;if(s.bG(S,this._globalState[n]))return this;this._globalState[n]=S;const P=this._findGlobalStateAffectedSources([n]);for(const M in this.sourceCaches)P.has(M)&&(this._reloadSource(M),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const a=[];for(const m in n)!s.bG(this._globalState[m],n[m].default)&&(a.push(m),this._globalState[m]=n[m].default);const f=this._findGlobalStateAffectedSources(a);for(const m in this.sourceCaches)f.has(m)&&(this._reloadSource(m),this._changed=!0)}_findGlobalStateAffectedSources(n){if(n.length===0)return new Set;const a=new Set;for(const f in this._layers){const m=this._layers[f],v=m.getLayoutAffectingGlobalStateRefs();for(const S of n)v.has(S)&&a.add(m.source)}return a}loadURL(n,a={},f){this.fire(new s.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const m=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const v=this._loadStyleRequest;s.j(m,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,a,f)}).catch(S=>{this._loadStyleRequest=null,S&&!v.signal.aborted&&this.fire(new s.k(S))})}loadJSON(n,a={},f){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,I.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(n,a,f)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(fl,{validate:!1})}_load(n,a,f){var m,v,S;const P=a.transformStyle?a.transformStyle(f,n):n;if(!a.validate||!Fc(this,s.z(P))){this._loaded=!0,this.stylesheet=P;for(const M in P.sources)this.addSource(M,P.sources[M],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new tt(this.stylesheet.light),this._setProjectionInternal(((m=this.stylesheet.projection)===null||m===void 0?void 0:m.type)||"mercator"),this.sky=new Ve(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.setGlobalState((S=this.stylesheet.state)!==null&&S!==void 0?S:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){const n=s.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of n){const f=s.bI(a);f.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=f}}_loadSprite(n,a=!1,f=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,S,P,M){return s._(this,void 0,void 0,function*(){const L=xe(v),z=P>1?"@2x":"",$={},O={};for(const{id:Z,url:Q}of L){const ae=S.transformRequest(ke(Q,z,".json"),"SpriteJSON");$[Z]=s.j(ae,M);const se=S.transformRequest(ke(Q,z,".png"),"SpriteImage");O[Z]=ne.getImage(se,M)}return yield Promise.all([...Object.values($),...Object.values(O)]),function(Z,Q){return s._(this,void 0,void 0,function*(){const ae={};for(const se in Z){ae[se]={};const le=I.getImageCanvasContext((yield Q[se]).data),ue=(yield Z[se]).data;for(const ge in ue){const{width:he,height:_e,x:be,y:me,sdf:Ce,pixelRatio:Ne,stretchX:Ae,stretchY:Ie,content:je,textFitWidth:ht,textFitHeight:ct}=ue[ge];ae[se][ge]={data:null,pixelRatio:Ne,sdf:Ce,stretchX:Ae,stretchY:Ie,content:je,textFitWidth:ht,textFitHeight:ct,spriteData:{width:he,height:_e,x:be,y:me,context:le}}}}return ae})}($,O)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const S in v){this._spritesImagesIds[S]=[];const P=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(M=>!(M in v)):[];for(const M of P)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in v[S]){const L=S==="default"?M:`${S}:${M}`;this._spritesImagesIds[S].push(L),L in this.imageManager.images?this.imageManager.updateImage(L,v[S][M],!1):this.imageManager.addImage(L,v[S][M]),a&&(this._changedImages[L]=!0)}}}).catch(v=>{this._spriteRequest=null,m=v,this.fire(new s.k(m))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),f&&f(m)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(n){const a=this.sourceCaches[n.source];if(!a)return;const f=n.sourceLayer;if(!f)return;const m=a.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(f)===-1)&&this.fire(new s.k(new Error(`Source layer "${f}" does not exist on source "${m.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,a=!1){const f=this._serializedAllLayers();if(!n||n.length===0)return Object.values(a?s.bJ(f):f);const m=[];for(const v of n)if(f[v]){const S=a?s.bJ(f[v]):f[v];m.push(S)}return m}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const a=Object.keys(this._layers);for(const f of a){const m=this._layers[f];m.type!=="custom"&&(n[f]=m.serialize())}return n}hasTransitions(){var n,a,f;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const m in this.sourceCaches)if(this.sourceCaches[m].hasTransition())return!0;for(const m in this._layers)if(this._layers[m].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const a=this._changed;if(a){const m=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(m.length||v.length)&&this._updateWorkerLayers(m,v);for(const S in this._updatedSources){const P=this._updatedSources[S];if(P==="reload")this._reloadSource(S);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const f={};for(const m in this.sourceCaches){const v=this.sourceCaches[m];f[m]=v.used,v.used=!1}for(const m of this._order){const v=this._layers[m];v.recalculate(n,this._availableImages),!v.isHidden(n.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const m in f){const v=this.sourceCaches[m];!!f[m]!=!!v.used&&v.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,a&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,a={}){var f;this._checkLoaded();const m=this.serialize();if(n=a.transformStyle?a.transformStyle(m,n):n,((f=a.validate)===null||f===void 0||f)&&Fc(this,s.z(n)))return!1;(n=s.bJ(n)).layers=s.bH(n.layers);const v=s.bK(m,n),S=this._getOperationsToPerform(v);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const P of S.operations)P();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const a=[],f=[];for(const m of n)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,m.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,m.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,m.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,m.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,m.args));break;case"addSource":a.push(()=>this.addSource.apply(this,m.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,m.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,m.args));break;case"setLight":a.push(()=>this.setLight.apply(this,m.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,m.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,m.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,m.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,m.args));break;case"setSky":a.push(()=>this.setSky.apply(this,m.args));break;case"setProjection":this.setProjection.apply(this,m.args);break;case"setGlobalState":a.push(()=>this.setGlobalState.apply(this,m.args));break;case"setTransition":a.push(()=>{});break;default:f.push(m.command)}return{operations:a,unimplemented:f}}addImage(n,a){if(this.getImage(n))return this.fire(new s.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,a),this._afterImageUpdated(n)}updateImage(n,a){this.imageManager.updateImage(n,a)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new s.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,a,f={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(s.z.source,`sources.${n}`,a,null,f))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const m=this.sourceCaches[n]=new qe(n,a,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:n})),m.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===n)return this.fire(new s.k(new Error(`Source "${n}" cannot be removed while layer "${f}" is using it.`)));const a=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],a.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,a){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const f=this.sourceCaches[n].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(a),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,a,f={}){this._checkLoaded();const m=n.id;if(this.getLayer(m))return void this.fire(new s.k(new Error(`Layer "${m}" already exists on this map.`)));let v;if(n.type==="custom"){if(Fc(this,s.bL(n)))return;v=s.bI(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(m,n.source),n=s.bJ(n),n=s.e(n,{source:m})),this._validate(s.z.layer,`layers.${m}`,n,{arrayIndex:-1},f))return;v=s.bI(n),this._validateLayer(v),v.setEventedParent(this,{layer:{id:m}})}const S=a?this._order.indexOf(a):this._order.length;if(a&&S===-1)this.fire(new s.k(new Error(`Cannot add layer "${m}" before non-existing layer "${a}".`)));else{if(this._order.splice(S,0,m),this._layerOrderChanged=!0,this._layers[m]=v,this._removedLayers[m]&&v.source&&v.type!=="custom"){const P=this._removedLayers[m];delete this._removedLayers[m],P.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(n,a){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new s.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===a)return;const f=this._order.indexOf(n);this._order.splice(f,1);const m=a?this._order.indexOf(a):this._order.length;a&&m===-1?this.fire(new s.k(new Error(`Cannot move layer "${n}" before non-existing layer "${a}".`))):(this._order.splice(m,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const a=this._layers[n];if(!a)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${n}".`)));a.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=a,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],a.onRemove&&a.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,a,f){this._checkLoaded();const m=this.getLayer(n);m?m.minzoom===a&&m.maxzoom===f||(a!=null&&(m.minzoom=a),f!=null&&(m.maxzoom=f),this._updateLayer(m)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,a,f={}){this._checkLoaded();const m=this.getLayer(n);if(m){if(!s.bG(m.filter,a))return a==null?(m.setFilter(void 0),void this._updateLayer(m)):void(this._validate(s.z.filter,`layers.${m.id}.filter`,a,null,f)||(m.setFilter(s.bJ(a)),this._updateLayer(m)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return s.bJ(this.getLayer(n).filter)}setLayoutProperty(n,a,f,m={}){this._checkLoaded();const v=this.getLayer(n);v?s.bG(v.getLayoutProperty(a),f)||(v.setLayoutProperty(a,f,m),this._updateLayer(v)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,a){const f=this.getLayer(n);if(f)return f.getLayoutProperty(a);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,a,f,m={}){this._checkLoaded();const v=this.getLayer(n);v?s.bG(v.getPaintProperty(a),f)||(v.setPaintProperty(a,f,m)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,a){return this.getLayer(n).getPaintProperty(a)}setFeatureState(n,a){this._checkLoaded();const f=n.source,m=n.sourceLayer,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new s.k(new Error(`The source '${f}' does not exist in the map's style.`)));const S=v.getSource().type;S==="geojson"&&m?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||m?(n.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),v.setFeatureState(m,n.id,a)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,a){this._checkLoaded();const f=n.source,m=this.sourceCaches[f];if(m===void 0)return void this.fire(new s.k(new Error(`The source '${f}' does not exist in the map's style.`)));const v=m.getSource().type,S=v==="vector"?n.sourceLayer:void 0;v!=="vector"||S?a&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(S,n.id,a):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const a=n.source,f=n.sourceLayer,m=this.sourceCaches[a];if(m!==void 0)return m.getSource().type!=="vector"||f?(n.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),m.getFeatureState(f,n.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=s.bM(this.sourceCaches,v=>v.serialize()),a=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,m=this.stylesheet;return s.bN({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,projection:m.projection,sources:n,layers:a,terrain:f},v=>v!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const a=S=>this._layers[S].type==="fill-extrusion",f={},m=[];for(let S=this._order.length-1;S>=0;S--){const P=this._order[S];if(a(P)){f[P]=S;for(const M of n){const L=M[P];if(L)for(const z of L)m.push(z)}}}m.sort((S,P)=>P.intersectionZ-S.intersectionZ);const v=[];for(let S=this._order.length-1;S>=0;S--){const P=this._order[S];if(a(P))for(let M=m.length-1;M>=0;M--){const L=m[M].feature;if(f[L.layer.id]<S)break;v.push(L),m.pop()}else for(const M of n){const L=M[P];if(L)for(const z of L)v.push(z.feature)}}return v}queryRenderedFeatures(n,a,f){a&&a.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",a.filter,null,a);const m={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const L of a.layers){const z=this._layers[L];if(!z)return this.fire(new s.k(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];m[z.source]=!0}}const v=[];a.availableImages=this._availableImages;const S=this._serializedAllLayers(),P=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,M=Object.assign(Object.assign({},a),{layers:P});for(const L in this.sourceCaches)a.layers&&!m[L]||v.push(yr(this.sourceCaches[L],this._layers,S,n,M,f,this.map.terrain?(z,$,O)=>this.map.terrain.getElevation(z,$,O):void 0));return this.placement&&v.push(function(L,z,$,O,Z,Q,ae){const se={},le=Q.queryRenderedSymbols(O),ue=[];for(const ge of Object.keys(le).map(Number))ue.push(ae[ge]);ue.sort(Cn);for(const ge of ue){const he=ge.featureIndex.lookupSymbolFeatures(le[ge.bucketInstanceId],z,ge.bucketIndex,ge.sourceLayerIndex,Z.filter,Z.layers,Z.availableImages,L);for(const _e in he){const be=se[_e]=se[_e]||[],me=he[_e];me.sort((Ce,Ne)=>{const Ae=ge.featureSortOrder;if(Ae){const Ie=Ae.indexOf(Ce.featureIndex);return Ae.indexOf(Ne.featureIndex)-Ie}return Ne.featureIndex-Ce.featureIndex});for(const Ce of me)be.push(Ce)}}return function(ge,he,_e){for(const be in ge)for(const me of ge[be])br(me,_e[he[be].source]);return ge}(se,L,$)}(this._layers,S,this.sourceCaches,n,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,a){a&&a.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",a.filter,null,a);const f=this.sourceCaches[n];return f?function(m,v){const S=m.getRenderableIds().map(L=>m.getTileByID(L)),P=[],M={};for(let L=0;L<S.length;L++){const z=S[L],$=z.tileID.canonical.key;M[$]||(M[$]=!0,z.querySourceFeatures(P,v))}return P}(f,a):[]}getLight(){return this.light.getLight()}setLight(n,a={}){this._checkLoaded();const f=this.light.getLight();let m=!1;for(const S in n)if(!s.bG(n[S],f[S])){m=!0;break}if(!m)return;const v={now:I.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,a),this.light.updateTransitions(v)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,a={}){this._checkLoaded();const f=this.getSky();let m=!1;if(!n&&!f)return;if(n&&!f)m=!0;else if(!n&&f)m=!0;else for(const S in n)if(!s.bG(n[S],f[S])){m=!0;break}if(!m)return;const v={now:I.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,a),this.sky.updateTransitions(v)}_setProjectionInternal(n){const a=function(f){if(Array.isArray(f)){const m=new Dc({type:f});return{projection:m,transform:new zi,cameraHelper:new Rp(m)}}switch(f){case"mercator":return{projection:new Mp,transform:new hn,cameraHelper:new yh};case"globe":{const m=new Dc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:m,transform:new zi,cameraHelper:new Rp(m)}}case"vertical-perspective":return{projection:new Dg,transform:new pl,cameraHelper:new xi};default:return s.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Mp,transform:new hn,cameraHelper:new yh}}}(n);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(n,a,f,m,v={}){return(!v||v.validate!==!1)&&Fc(this,n.call(s.z,s.e({key:a,style:this.serialize(),value:f,styleSpec:s.v},m)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),un().off(lo,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const f=this.sourceCaches[a];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const a in this.sourceCaches)this.sourceCaches[a].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,a,f,m,v=!1){let S=!1,P=!1;const M={};for(const L of this._order){const z=this._layers[L];if(z.type!=="symbol")continue;if(!M[z.source]){const O=this.sourceCaches[z.source];M[z.source]=O.getRenderableIds(!0).map(Z=>O.getTileByID(Z)).sort((Z,Q)=>Q.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(Q.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(z,M[z.source],n.center.lng);S=S||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(I.now(),n.zoom))&&(this.pauseablePlacement=new Rg(n,this.map.terrain,this._order,v,a,f,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(I.now()),P=!0),S&&this.pauseablePlacement.placement.setStale()),P||S)for(const L of this._order){const z=this._layers[L];z.type==="symbol"&&this.placement.updateLayerOpacities(z,M[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(I.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,a){return s._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const m=this.sourceCaches[a.source];return m&&m.setDependencies(a.tileID.key,a.type,a.icons),f})}getGlyphs(n,a){return s._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(a.stacks),m=this.sourceCaches[a.source];return m&&m.setDependencies(a.tileID.key,a.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,a={}){this._checkLoaded(),n&&this._validate(s.z.glyphs,"glyphs",n,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,a,f={},m){this._checkLoaded();const v=[{id:n,url:a}],S=[...xe(this.stylesheet.sprite),...v];this._validate(s.z.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(v,!0,m))}removeSprite(n){this._checkLoaded();const a=xe(this.stylesheet.sprite);if(a.find(f=>f.id===n)){if(this._spritesImagesIds[n])for(const f of this._spritesImagesIds[n])this.imageManager.removeImage(f),this._changedImages[f]=!0;a.splice(a.findIndex(f=>f.id===n),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return xe(this.stylesheet.sprite)}setSprite(n,a={},f){this._checkLoaded(),n&&this._validate(s.z.sprite,"sprite",n,null,a)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,f):(this._unloadSprite(),f&&f(null)))}}var H_=s.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class K_{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,a,f,m,v,S,P,M,L){this.context=n;let z=this.boundPaintVertexBuffers.length!==m.length;for(let $=0;!z&&$<m.length;$++)this.boundPaintVertexBuffers[$]!==m[$]&&(z=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==f||z||this.boundIndexBuffer!==v||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==P||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==L?this.freshBind(a,f,m,v,S,P,M,L):(n.bindVertexArray.set(this.vao),P&&P.bind(),v&&v.dynamicDraw&&v.bind(),M&&M.bind(),L&&L.bind())}freshBind(n,a,f,m,v,S,P,M){const L=n.numAttributes,z=this.context,$=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=m,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=M,a.enableAttributes($,n);for(const O of f)O.enableAttributes($,n);S&&S.enableAttributes($,n),P&&P.enableAttributes($,n),M&&M.enableAttributes($,n),a.bind(),a.setVertexAttribPointers($,n,v);for(const O of f)O.bind(),O.setVertexAttribPointers($,n,v);S&&(S.bind(),S.setVertexAttribPointers($,n,v)),m&&m.bind(),P&&(P.bind(),P.setVertexAttribPointers($,n,v)),M&&(M.bind(),M.setVertexAttribPointers($,n,v)),z.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const X_=(y,n,a,f,m)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:n,u_fog_color:a?a.properties.get("fog-color"):s.be.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:m?0:a?a.calculateFogBlendOpacity(f):0,u_horizon_color:a?a.properties.get("horizon-color"):s.be.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:m?1:0}),Y_={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function vh(y){const n=[];for(let a=0;a<y.length;a++){if(y[a]===null)continue;const f=y[a].split(" ");n.push(f.pop())}return n}class _h{constructor(n,a,f,m,v,S,P,M,L=[]){const z=n.gl;this.program=z.createProgram();const $=vh(a.staticAttributes),O=f?f.getBinderAttributes():[],Z=$.concat(O),Q=zo.prelude.staticUniforms?vh(zo.prelude.staticUniforms):[],ae=P.staticUniforms?vh(P.staticUniforms):[],se=a.staticUniforms?vh(a.staticUniforms):[],le=f?f.getBinderUniforms():[],ue=Q.concat(ae).concat(se).concat(le),ge=[];for(const Ae of ue)ge.indexOf(Ae)<0&&ge.push(Ae);const he=f?f.defines():[];si(z)&&he.unshift("#version 300 es"),v&&he.push("#define OVERDRAW_INSPECTOR;"),S&&he.push("#define TERRAIN3D;"),M&&he.push(M),L&&he.push(...L);let _e=he.concat(zo.prelude.fragmentSource,P.fragmentSource,a.fragmentSource).join(`
`),be=he.concat(zo.prelude.vertexSource,P.vertexSource,a.vertexSource).join(`
`);si(z)||(_e=function(Ae){return Ae.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(_e),be=function(Ae){return Ae.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(be));const me=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(me,_e),z.compileShader(me),!z.getShaderParameter(me,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(me)}`);z.attachShader(this.program,me);const Ce=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(Ce,be),z.compileShader(Ce),!z.getShaderParameter(Ce,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(Ce)}`);z.attachShader(this.program,Ce),this.attributes={};const Ne={};this.numAttributes=Z.length;for(let Ae=0;Ae<this.numAttributes;Ae++)Z[Ae]&&(z.bindAttribLocation(this.program,Ae,Z[Ae]),this.attributes[Z[Ae]]=Ae);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(Ce),z.deleteShader(me);for(let Ae=0;Ae<ge.length;Ae++){const Ie=ge[Ae];if(Ie&&!Ne[Ie]){const je=z.getUniformLocation(this.program,Ie);je&&(Ne[Ie]=je)}}this.fixedUniforms=m(n,Ne),this.terrainUniforms=((Ae,Ie)=>({u_depth:new s.bO(Ae,Ie.u_depth),u_terrain:new s.bO(Ae,Ie.u_terrain),u_terrain_dim:new s.bf(Ae,Ie.u_terrain_dim),u_terrain_matrix:new s.bQ(Ae,Ie.u_terrain_matrix),u_terrain_unpack:new s.bR(Ae,Ie.u_terrain_unpack),u_terrain_exaggeration:new s.bf(Ae,Ie.u_terrain_exaggeration)}))(n,Ne),this.projectionUniforms=((Ae,Ie)=>({u_projection_matrix:new s.bQ(Ae,Ie.u_projection_matrix),u_projection_tile_mercator_coords:new s.bR(Ae,Ie.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bR(Ae,Ie.u_projection_clipping_plane),u_projection_transition:new s.bf(Ae,Ie.u_projection_transition),u_projection_fallback_matrix:new s.bQ(Ae,Ie.u_projection_fallback_matrix)}))(n,Ne),this.binderUniforms=f?f.getUniforms(n,Ne):[]}draw(n,a,f,m,v,S,P,M,L,z,$,O,Z,Q,ae,se,le,ue,ge){const he=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(f),n.setStencilMode(m),n.setColorMode(v),n.setCullFace(S),M){n.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,M.depthTexture),n.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,M.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(M[be])}if(L)for(const be in L)this.projectionUniforms[Y_[be]].set(L[be]);if(P)for(const be in this.fixedUniforms)this.fixedUniforms[be].set(P[be]);se&&se.setUniforms(n,this.binderUniforms,Q,{zoom:ae});let _e=0;switch(a){case he.LINES:_e=2;break;case he.TRIANGLES:_e=3;break;case he.LINE_STRIP:_e=1}for(const be of Z.get()){const me=be.vaos||(be.vaos={});(me[z]||(me[z]=new K_)).bind(n,this,$,se?se.getPaintVertexBuffers():[],O,be.vertexOffset,le,ue,ge),he.drawElements(a,be.primitiveLength*_e,he.UNSIGNED_SHORT,be.primitiveOffset*_e*2)}}}function xh(y,n,a){const f=1/s.aB(a,1,n.transform.tileZoom),m=Math.pow(2,a.tileID.overscaledZ),v=a.tileSize*Math.pow(2,n.transform.tileZoom)/m,S=v*(a.tileID.canonical.x+a.tileID.wrap*m),P=v*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[f,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P]}}const Bc=(y,n,a,f)=>{const m=y.style.light,v=m.properties.get("position"),S=[v.x,v.y,v.z],P=s.bU();m.properties.get("anchor")==="viewport"&&s.bV(P,y.transform.bearingInRadians),s.bW(S,S,P);const M=y.transform.transformLightDirection(S),L=m.properties.get("color");return{u_lightpos:S,u_lightpos_globe:M,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+n,u_opacity:a,u_fill_translate:f}},Dp=(y,n,a,f,m,v,S)=>s.e(Bc(y,n,a,f),xh(v,y,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8}),bh=(y,n,a,f)=>s.e(xh(n,y,a),{u_fill_translate:f}),jo=(y,n)=>({u_world:y,u_fill_translate:n}),Q_=(y,n,a,f,m)=>s.e(bh(y,n,a,m),{u_world:f}),zp=(y,n,a,f,m)=>{const v=y.transform;let S,P,M=0;if(a.paint.get("circle-pitch-alignment")==="map"){const L=s.aB(n,1,v.zoom);S=!0,P=[L,L],M=L/(s.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*m}else S=!1,P=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:P,u_globe_extrude_scale:M,u_translate:f}},$c=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Vc=y=>({u_viewport_size:[y.width,y.height]}),Ng=(y,n=1)=>({u_color:y,u_overlay:0,u_overlay_scale:n}),Uc=(y,n,a,f)=>{const m=s.aB(y,1,n)/(s.$*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:s.aB(y,1,n),u_intensity:a,u_globe_extrude_scale:m}},jg=(y,n,a,f)=>{const m=s.L();s.bX(m,0,y.width,y.height,0,0,1);const v=y.context.gl;return{u_matrix:m,u_world:[v.drawingBufferWidth,v.drawingBufferHeight],u_image:a,u_color_ramp:f,u_opacity:n.paint.get("heatmap-opacity")}},ml=(y,n,a)=>{const f=a.paint.get("hillshade-accent-color");let m;switch(a.paint.get("hillshade-method")){case"basic":m=4;break;case"combined":m=1;break;case"igor":m=2;break;case"multidirectional":m=3;break;default:m=0}const v=a.getIlluminationProperties();for(let S=0;S<v.directionRadians.length;S++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(v.directionRadians[S]+=y.transform.bearingInRadians);return{u_image:0,u_latrange:Og(0,n.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:v.altitudeRadians,u_azimuths:v.directionRadians,u_accent:f,u_method:m,u_highlights:v.highlightColor,u_shadows:v.shadowColor}},J_=(y,n)=>{const a=n.stride,f=s.L();return s.bX(f,0,s.$,-s.$,0,0,1),s.M(f,f,[0,-s.$,0]),{u_matrix:f,u_image:1,u_dimension:[a,a],u_zoom:y.overscaledZ,u_unpack:n.getUnpackVector()}};function Og(y,n){const a=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new s.a0(0,f/a).toLngLat().lat,new s.a0(0,(f+1)/a).toLngLat().lat]}const ex=(y,n,a=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:y.paint.get("color-relief-opacity")}),wh=(y,n,a,f)=>{const m=y.transform;return{u_translation:Op(y,n,a),u_ratio:f/s.aB(n,1,m.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Np=(y,n,a,f,m)=>s.e(wh(y,n,a,f),{u_image:0,u_image_height:m}),Fg=(y,n,a,f,m)=>{const v=y.transform,S=jp(n,v);return{u_translation:Op(y,n,a),u_texsize:n.imageAtlasTexture.size,u_ratio:f/s.aB(n,1,v.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[S,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Bg=(y,n,a,f,m,v)=>{const S=y.lineAtlas,P=jp(n,y.transform),M=a.layout.get("line-cap")==="round",L=S.getDash(m.from,M),z=S.getDash(m.to,M),$=L.width*v.fromScale,O=z.width*v.toScale;return s.e(wh(y,n,a,f),{u_patternscale_a:[P/$,-L.height/2],u_patternscale_b:[P/O,-z.height/2],u_sdfgamma:S.width/(256*Math.min($,O)*y.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:z.y,u_mix:v.t})};function jp(y,n){return 1/s.aB(y,1,n.tileZoom)}function Op(y,n,a){return s.aC(y.transform,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Ea=(y,n,a,f,m)=>{return{u_tl_parent:y,u_scale_parent:n,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(v=f.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:$g(f.paint.get("raster-hue-rotate")),u_coords_top:[m[0].x,m[0].y,m[1].x,m[1].y],u_coords_bottom:[m[3].x,m[3].y,m[2].x,m[2].y]};var v,S};function $g(y){y*=Math.PI/180;const n=Math.sin(y),a=Math.cos(y);return[(2*a+1)/3,(-Math.sqrt(3)*n-a+1)/3,(Math.sqrt(3)*n-a+1)/3]}const Fp=(y,n,a,f,m,v,S,P,M,L,z,$,O)=>{const Z=S.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Z.width/Z.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:P,u_coord_matrix:M,u_is_text:+z,u_pitch_with_map:+f,u_is_along_line:m,u_is_variable_anchor:v,u_texsize:$,u_texture:0,u_translation:L,u_pitched_scale:O}},gl=(y,n,a,f,m,v,S,P,M,L,z,$,O,Z)=>{const Q=S.transform;return s.e(Fp(y,n,a,f,m,v,S,P,M,L,z,$,Z),{u_gamma_scale:f?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},tx=(y,n,a,f,m,v,S,P,M,L,z,$,O)=>s.e(gl(y,n,a,f,m,v,S,P,M,L,!0,z,0,O),{u_texsize_icon:$,u_texture_icon:1}),Sh=(y,n)=>({u_opacity:y,u_color:n}),rx=(y,n,a,f,m)=>s.e(function(v,S,P,M){const L=P.imageManager.getPattern(v.from.toString()),z=P.imageManager.getPattern(v.to.toString()),{width:$,height:O}=P.imageManager.getPixelSize(),Z=Math.pow(2,M.tileID.overscaledZ),Q=M.tileSize*Math.pow(2,P.transform.tileZoom)/Z,ae=Q*(M.tileID.canonical.x+M.tileID.wrap*Z),se=Q*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[$,O],u_mix:S.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/s.aB(M,1,P.transform.tileZoom),u_pixel_coord_upper:[ae>>16,se>>16],u_pixel_coord_lower:[65535&ae,65535&se]}}(a,m,n,f),{u_opacity:y}),Vg=(y,n)=>{},Ug={fillExtrusion:(y,n)=>({u_lightpos:new s.bS(y,n.u_lightpos),u_lightpos_globe:new s.bS(y,n.u_lightpos_globe),u_lightintensity:new s.bf(y,n.u_lightintensity),u_lightcolor:new s.bS(y,n.u_lightcolor),u_vertical_gradient:new s.bf(y,n.u_vertical_gradient),u_opacity:new s.bf(y,n.u_opacity),u_fill_translate:new s.bT(y,n.u_fill_translate)}),fillExtrusionPattern:(y,n)=>({u_lightpos:new s.bS(y,n.u_lightpos),u_lightpos_globe:new s.bS(y,n.u_lightpos_globe),u_lightintensity:new s.bf(y,n.u_lightintensity),u_lightcolor:new s.bS(y,n.u_lightcolor),u_vertical_gradient:new s.bf(y,n.u_vertical_gradient),u_height_factor:new s.bf(y,n.u_height_factor),u_opacity:new s.bf(y,n.u_opacity),u_fill_translate:new s.bT(y,n.u_fill_translate),u_image:new s.bO(y,n.u_image),u_texsize:new s.bT(y,n.u_texsize),u_pixel_coord_upper:new s.bT(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(y,n.u_pixel_coord_lower),u_scale:new s.bS(y,n.u_scale),u_fade:new s.bf(y,n.u_fade)}),fill:(y,n)=>({u_fill_translate:new s.bT(y,n.u_fill_translate)}),fillPattern:(y,n)=>({u_image:new s.bO(y,n.u_image),u_texsize:new s.bT(y,n.u_texsize),u_pixel_coord_upper:new s.bT(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(y,n.u_pixel_coord_lower),u_scale:new s.bS(y,n.u_scale),u_fade:new s.bf(y,n.u_fade),u_fill_translate:new s.bT(y,n.u_fill_translate)}),fillOutline:(y,n)=>({u_world:new s.bT(y,n.u_world),u_fill_translate:new s.bT(y,n.u_fill_translate)}),fillOutlinePattern:(y,n)=>({u_world:new s.bT(y,n.u_world),u_image:new s.bO(y,n.u_image),u_texsize:new s.bT(y,n.u_texsize),u_pixel_coord_upper:new s.bT(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(y,n.u_pixel_coord_lower),u_scale:new s.bS(y,n.u_scale),u_fade:new s.bf(y,n.u_fade),u_fill_translate:new s.bT(y,n.u_fill_translate)}),circle:(y,n)=>({u_camera_to_center_distance:new s.bf(y,n.u_camera_to_center_distance),u_scale_with_map:new s.bO(y,n.u_scale_with_map),u_pitch_with_map:new s.bO(y,n.u_pitch_with_map),u_extrude_scale:new s.bT(y,n.u_extrude_scale),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_globe_extrude_scale:new s.bf(y,n.u_globe_extrude_scale),u_translate:new s.bT(y,n.u_translate)}),collisionBox:(y,n)=>({u_pixel_extrude_scale:new s.bT(y,n.u_pixel_extrude_scale)}),collisionCircle:(y,n)=>({u_viewport_size:new s.bT(y,n.u_viewport_size)}),debug:(y,n)=>({u_color:new s.bP(y,n.u_color),u_overlay:new s.bO(y,n.u_overlay),u_overlay_scale:new s.bf(y,n.u_overlay_scale)}),depth:Vg,clippingMask:Vg,heatmap:(y,n)=>({u_extrude_scale:new s.bf(y,n.u_extrude_scale),u_intensity:new s.bf(y,n.u_intensity),u_globe_extrude_scale:new s.bf(y,n.u_globe_extrude_scale)}),heatmapTexture:(y,n)=>({u_matrix:new s.bQ(y,n.u_matrix),u_world:new s.bT(y,n.u_world),u_image:new s.bO(y,n.u_image),u_color_ramp:new s.bO(y,n.u_color_ramp),u_opacity:new s.bf(y,n.u_opacity)}),hillshade:(y,n)=>({u_image:new s.bO(y,n.u_image),u_latrange:new s.bT(y,n.u_latrange),u_exaggeration:new s.bf(y,n.u_exaggeration),u_altitudes:new s.bZ(y,n.u_altitudes),u_azimuths:new s.bZ(y,n.u_azimuths),u_accent:new s.bP(y,n.u_accent),u_method:new s.bO(y,n.u_method),u_shadows:new s.bY(y,n.u_shadows),u_highlights:new s.bY(y,n.u_highlights)}),hillshadePrepare:(y,n)=>({u_matrix:new s.bQ(y,n.u_matrix),u_image:new s.bO(y,n.u_image),u_dimension:new s.bT(y,n.u_dimension),u_zoom:new s.bf(y,n.u_zoom),u_unpack:new s.bR(y,n.u_unpack)}),colorRelief:(y,n)=>({u_image:new s.bO(y,n.u_image),u_unpack:new s.bR(y,n.u_unpack),u_dimension:new s.bT(y,n.u_dimension),u_elevation_stops:new s.bO(y,n.u_elevation_stops),u_color_stops:new s.bO(y,n.u_color_stops),u_color_ramp_size:new s.bO(y,n.u_color_ramp_size),u_opacity:new s.bf(y,n.u_opacity)}),line:(y,n)=>({u_translation:new s.bT(y,n.u_translation),u_ratio:new s.bf(y,n.u_ratio),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_units_to_pixels:new s.bT(y,n.u_units_to_pixels)}),lineGradient:(y,n)=>({u_translation:new s.bT(y,n.u_translation),u_ratio:new s.bf(y,n.u_ratio),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_units_to_pixels:new s.bT(y,n.u_units_to_pixels),u_image:new s.bO(y,n.u_image),u_image_height:new s.bf(y,n.u_image_height)}),linePattern:(y,n)=>({u_translation:new s.bT(y,n.u_translation),u_texsize:new s.bT(y,n.u_texsize),u_ratio:new s.bf(y,n.u_ratio),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_image:new s.bO(y,n.u_image),u_units_to_pixels:new s.bT(y,n.u_units_to_pixels),u_scale:new s.bS(y,n.u_scale),u_fade:new s.bf(y,n.u_fade)}),lineSDF:(y,n)=>({u_translation:new s.bT(y,n.u_translation),u_ratio:new s.bf(y,n.u_ratio),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_units_to_pixels:new s.bT(y,n.u_units_to_pixels),u_patternscale_a:new s.bT(y,n.u_patternscale_a),u_patternscale_b:new s.bT(y,n.u_patternscale_b),u_sdfgamma:new s.bf(y,n.u_sdfgamma),u_image:new s.bO(y,n.u_image),u_tex_y_a:new s.bf(y,n.u_tex_y_a),u_tex_y_b:new s.bf(y,n.u_tex_y_b),u_mix:new s.bf(y,n.u_mix)}),raster:(y,n)=>({u_tl_parent:new s.bT(y,n.u_tl_parent),u_scale_parent:new s.bf(y,n.u_scale_parent),u_buffer_scale:new s.bf(y,n.u_buffer_scale),u_fade_t:new s.bf(y,n.u_fade_t),u_opacity:new s.bf(y,n.u_opacity),u_image0:new s.bO(y,n.u_image0),u_image1:new s.bO(y,n.u_image1),u_brightness_low:new s.bf(y,n.u_brightness_low),u_brightness_high:new s.bf(y,n.u_brightness_high),u_saturation_factor:new s.bf(y,n.u_saturation_factor),u_contrast_factor:new s.bf(y,n.u_contrast_factor),u_spin_weights:new s.bS(y,n.u_spin_weights),u_coords_top:new s.bR(y,n.u_coords_top),u_coords_bottom:new s.bR(y,n.u_coords_bottom)}),symbolIcon:(y,n)=>({u_is_size_zoom_constant:new s.bO(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(y,n.u_is_size_feature_constant),u_size_t:new s.bf(y,n.u_size_t),u_size:new s.bf(y,n.u_size),u_camera_to_center_distance:new s.bf(y,n.u_camera_to_center_distance),u_pitch:new s.bf(y,n.u_pitch),u_rotate_symbol:new s.bO(y,n.u_rotate_symbol),u_aspect_ratio:new s.bf(y,n.u_aspect_ratio),u_fade_change:new s.bf(y,n.u_fade_change),u_label_plane_matrix:new s.bQ(y,n.u_label_plane_matrix),u_coord_matrix:new s.bQ(y,n.u_coord_matrix),u_is_text:new s.bO(y,n.u_is_text),u_pitch_with_map:new s.bO(y,n.u_pitch_with_map),u_is_along_line:new s.bO(y,n.u_is_along_line),u_is_variable_anchor:new s.bO(y,n.u_is_variable_anchor),u_texsize:new s.bT(y,n.u_texsize),u_texture:new s.bO(y,n.u_texture),u_translation:new s.bT(y,n.u_translation),u_pitched_scale:new s.bf(y,n.u_pitched_scale)}),symbolSDF:(y,n)=>({u_is_size_zoom_constant:new s.bO(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(y,n.u_is_size_feature_constant),u_size_t:new s.bf(y,n.u_size_t),u_size:new s.bf(y,n.u_size),u_camera_to_center_distance:new s.bf(y,n.u_camera_to_center_distance),u_pitch:new s.bf(y,n.u_pitch),u_rotate_symbol:new s.bO(y,n.u_rotate_symbol),u_aspect_ratio:new s.bf(y,n.u_aspect_ratio),u_fade_change:new s.bf(y,n.u_fade_change),u_label_plane_matrix:new s.bQ(y,n.u_label_plane_matrix),u_coord_matrix:new s.bQ(y,n.u_coord_matrix),u_is_text:new s.bO(y,n.u_is_text),u_pitch_with_map:new s.bO(y,n.u_pitch_with_map),u_is_along_line:new s.bO(y,n.u_is_along_line),u_is_variable_anchor:new s.bO(y,n.u_is_variable_anchor),u_texsize:new s.bT(y,n.u_texsize),u_texture:new s.bO(y,n.u_texture),u_gamma_scale:new s.bf(y,n.u_gamma_scale),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_is_halo:new s.bO(y,n.u_is_halo),u_translation:new s.bT(y,n.u_translation),u_pitched_scale:new s.bf(y,n.u_pitched_scale)}),symbolTextAndIcon:(y,n)=>({u_is_size_zoom_constant:new s.bO(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(y,n.u_is_size_feature_constant),u_size_t:new s.bf(y,n.u_size_t),u_size:new s.bf(y,n.u_size),u_camera_to_center_distance:new s.bf(y,n.u_camera_to_center_distance),u_pitch:new s.bf(y,n.u_pitch),u_rotate_symbol:new s.bO(y,n.u_rotate_symbol),u_aspect_ratio:new s.bf(y,n.u_aspect_ratio),u_fade_change:new s.bf(y,n.u_fade_change),u_label_plane_matrix:new s.bQ(y,n.u_label_plane_matrix),u_coord_matrix:new s.bQ(y,n.u_coord_matrix),u_is_text:new s.bO(y,n.u_is_text),u_pitch_with_map:new s.bO(y,n.u_pitch_with_map),u_is_along_line:new s.bO(y,n.u_is_along_line),u_is_variable_anchor:new s.bO(y,n.u_is_variable_anchor),u_texsize:new s.bT(y,n.u_texsize),u_texsize_icon:new s.bT(y,n.u_texsize_icon),u_texture:new s.bO(y,n.u_texture),u_texture_icon:new s.bO(y,n.u_texture_icon),u_gamma_scale:new s.bf(y,n.u_gamma_scale),u_device_pixel_ratio:new s.bf(y,n.u_device_pixel_ratio),u_is_halo:new s.bO(y,n.u_is_halo),u_translation:new s.bT(y,n.u_translation),u_pitched_scale:new s.bf(y,n.u_pitched_scale)}),background:(y,n)=>({u_opacity:new s.bf(y,n.u_opacity),u_color:new s.bP(y,n.u_color)}),backgroundPattern:(y,n)=>({u_opacity:new s.bf(y,n.u_opacity),u_image:new s.bO(y,n.u_image),u_pattern_tl_a:new s.bT(y,n.u_pattern_tl_a),u_pattern_br_a:new s.bT(y,n.u_pattern_br_a),u_pattern_tl_b:new s.bT(y,n.u_pattern_tl_b),u_pattern_br_b:new s.bT(y,n.u_pattern_br_b),u_texsize:new s.bT(y,n.u_texsize),u_mix:new s.bf(y,n.u_mix),u_pattern_size_a:new s.bT(y,n.u_pattern_size_a),u_pattern_size_b:new s.bT(y,n.u_pattern_size_b),u_scale_a:new s.bf(y,n.u_scale_a),u_scale_b:new s.bf(y,n.u_scale_b),u_pixel_coord_upper:new s.bT(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(y,n.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bf(y,n.u_tile_units_to_pixels)}),terrain:(y,n)=>({u_texture:new s.bO(y,n.u_texture),u_ele_delta:new s.bf(y,n.u_ele_delta),u_fog_matrix:new s.bQ(y,n.u_fog_matrix),u_fog_color:new s.bP(y,n.u_fog_color),u_fog_ground_blend:new s.bf(y,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bf(y,n.u_fog_ground_blend_opacity),u_horizon_color:new s.bP(y,n.u_horizon_color),u_horizon_fog_blend:new s.bf(y,n.u_horizon_fog_blend),u_is_globe_mode:new s.bf(y,n.u_is_globe_mode)}),terrainDepth:(y,n)=>({u_ele_delta:new s.bf(y,n.u_ele_delta)}),terrainCoords:(y,n)=>({u_texture:new s.bO(y,n.u_texture),u_terrain_coords_id:new s.bf(y,n.u_terrain_coords_id),u_ele_delta:new s.bf(y,n.u_ele_delta)}),projectionErrorMeasurement:(y,n)=>({u_input:new s.bf(y,n.u_input),u_output_expected:new s.bf(y,n.u_output_expected)}),atmosphere:(y,n)=>({u_sun_pos:new s.bS(y,n.u_sun_pos),u_atmosphere_blend:new s.bf(y,n.u_atmosphere_blend),u_globe_position:new s.bS(y,n.u_globe_position),u_globe_radius:new s.bf(y,n.u_globe_radius),u_inv_proj_matrix:new s.bQ(y,n.u_inv_proj_matrix)}),sky:(y,n)=>({u_sky_color:new s.bP(y,n.u_sky_color),u_horizon_color:new s.bP(y,n.u_horizon_color),u_horizon:new s.bT(y,n.u_horizon),u_horizon_normal:new s.bT(y,n.u_horizon_normal),u_sky_horizon_blend:new s.bf(y,n.u_sky_horizon_blend),u_sky_blend:new s.bf(y,n.u_sky_blend)})};class Gg{constructor(n,a,f){this.context=n;const m=n.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qg={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bp{constructor(n,a,f,m){this.length=a.length,this.attributes=f,this.itemSize=a.bytesPerElement,this.dynamicDraw=m,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,a){for(let f=0;f<this.attributes.length;f++){const m=a.attributes[this.attributes[f].name];m!==void 0&&n.enableVertexAttribArray(m)}}setVertexAttribPointers(n,a,f){for(let m=0;m<this.attributes.length;m++){const v=this.attributes[m],S=a.attributes[v.name];S!==void 0&&n.vertexAttribPointer(S,v.components,n[qg[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class pr{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Th extends pr{getDefault(){return s.be.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class us extends pr{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class $p extends pr{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Vp extends pr{getDefault(){return[!0,!0,!0,!0]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Up extends pr{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Zg extends pr{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Gp extends pr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const a=this.current;(n.func!==a.func||n.ref!==a.ref||n.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Ma extends pr{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class qp extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=n,this.dirty=!1}}class nx extends pr{getDefault(){return[0,1]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class ix extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=n,this.dirty=!1}}class ox extends pr{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class sx extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.BLEND):a.disable(a.BLEND),this.current=n,this.dirty=!1}}class Wg extends pr{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class ax extends pr{getDefault(){return s.be.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hg extends pr{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Ch extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=n,this.dirty=!1}}class Ph extends pr{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Eh extends pr{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Zp extends pr{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class ka extends pr{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Gc extends pr{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class yl extends pr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Yi extends pr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Kg extends pr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Xg extends pr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Wp extends pr{getDefault(){return null}set(n){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Aa extends pr{getDefault(){return null}set(n){var a;if(n===this.current&&!this.dirty)return;const f=this.gl;si(f)?f.bindVertexArray(n):(a=f.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Mh extends pr{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class kh extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class qc extends pr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class vl extends pr{constructor(n,a){super(n),this.context=n,this.parent=a}getDefault(){return null}}class Yg extends vl{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class _l extends vl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class xl extends vl{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Hp="Framebuffer is not complete";class Kp{constructor(n,a,f,m,v){this.context=n,this.width=a,this.height=f;const S=n.gl,P=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Yg(n,P),m)this.depthAttachment=v?new xl(n,P):new _l(n,P);else if(v)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Hp)}destroy(){const n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){const f=this.depthAttachment.get();f&&n.deleteRenderbuffer(f)}n.deleteFramebuffer(this.framebuffer)}}class Jt{constructor(n){var a,f;if(this.gl=n,this.clearColor=new Th(this),this.clearDepth=new us(this),this.clearStencil=new $p(this),this.colorMask=new Vp(this),this.depthMask=new Up(this),this.stencilMask=new Zg(this),this.stencilFunc=new Gp(this),this.stencilOp=new Ma(this),this.stencilTest=new qp(this),this.depthRange=new nx(this),this.depthTest=new ix(this),this.depthFunc=new ox(this),this.blend=new sx(this),this.blendFunc=new Wg(this),this.blendColor=new ax(this),this.blendEquation=new Hg(this),this.cullFace=new Ch(this),this.cullFaceSide=new Ph(this),this.frontFace=new Eh(this),this.program=new Zp(this),this.activeTexture=new ka(this),this.viewport=new Gc(this),this.bindFramebuffer=new yl(this),this.bindRenderbuffer=new Yi(this),this.bindTexture=new Kg(this),this.bindVertexBuffer=new Xg(this),this.bindElementBuffer=new Wp(this),this.bindVertexArray=new Aa(this),this.pixelStoreUnpack=new Mh(this),this.pixelStoreUnpackPremultiplyAlpha=new kh(this),this.pixelStoreUnpackFlipY=new qc(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),si(n)){this.HALF_FLOAT=n.HALF_FLOAT;const m=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=n.RGBA16F)!==null&&a!==void 0?a:m==null?void 0:m.RGBA16F_EXT,this.RGB16F=(f=n.RGB16F)!==null&&f!==void 0?f:m==null?void 0:m.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const m=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=m==null?void 0:m.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,a){return new Gg(this,n,a)}createVertexBuffer(n,a,f){return new Bp(this,n,a,f)}createRenderbuffer(n,a,f){const m=this.gl,v=m.createRenderbuffer();return this.bindRenderbuffer.set(v),m.renderbufferStorage(m.RENDERBUFFER,n,a,f),this.bindRenderbuffer.set(null),v}createFramebuffer(n,a,f,m){return new Kp(this,n,a,f,m)}clear({color:n,depth:a,stencil:f}){const m=this.gl;let v=0;n&&(v|=m.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(v|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),f!==void 0&&(v|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),m.clear(v)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){s.bG(n.blendFunction,or.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return si(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var a;return si(this.gl)?this.gl.deleteVertexArray(n):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let Ia;function Qg(y,n,a,f,m){const v=y.context,S=y.transform,P=v.gl,M=y.useProgram("collisionBox"),L=[];let z=0,$=0;for(let le=0;le<f.length;le++){const ue=f[le],ge=n.getTile(ue).getBucket(a);if(!ge)continue;const he=m?ge.textCollisionBox:ge.iconCollisionBox,_e=ge.collisionCircleArray;_e.length>0&&(L.push({circleArray:_e,circleOffset:$,coord:ue}),z+=_e.length/4,$=z),he&&M.draw(v,P.LINES,Bt.disabled,zt.disabled,y.colorModeForRenderPass(),Ot.disabled,$c(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ue),S.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,y.transform.zoom,null,null,he.collisionVertexBuffer)}if(!m||!L.length)return;const O=y.useProgram("collisionCircle"),Z=new s.b_;Z.resize(4*z),Z._trim();let Q=0;for(const le of L)for(let ue=0;ue<le.circleArray.length/4;ue++){const ge=4*ue,he=le.circleArray[ge+0],_e=le.circleArray[ge+1],be=le.circleArray[ge+2],me=le.circleArray[ge+3];Z.emplace(Q++,he,_e,be,me,0),Z.emplace(Q++,he,_e,be,me,1),Z.emplace(Q++,he,_e,be,me,2),Z.emplace(Q++,he,_e,be,me,3)}(!Ia||Ia.length<2*z)&&(Ia=function(le){const ue=2*le,ge=new s.c0;ge.resize(ue),ge._trim();for(let he=0;he<ue;he++){const _e=6*he;ge.uint16[_e+0]=4*he+0,ge.uint16[_e+1]=4*he+1,ge.uint16[_e+2]=4*he+2,ge.uint16[_e+3]=4*he+2,ge.uint16[_e+4]=4*he+3,ge.uint16[_e+5]=4*he+0}return ge}(z));const ae=v.createIndexBuffer(Ia,!0),se=v.createVertexBuffer(Z,s.b$.members,!0);for(const le of L){const ue=Vc(y.transform);O.draw(v,P.TRIANGLES,Bt.disabled,zt.disabled,y.colorModeForRenderPass(),Ot.disabled,ue,y.style.map.terrain&&y.style.map.terrain.getTerrainData(le.coord),null,a.id,se,ae,s.aL.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,y.transform.zoom,null,null,null)}se.destroy(),ae.destroy()}const Jg=s.af(new Float32Array(16));function Zc(y,n,a,f,m,v){const{horizontalAlign:S,verticalAlign:P}=s.aG(y);return new s.P((-(S-.5)*n/m+f[0])*v,(-(P-.5)*a/m+f[1])*v)}function lx(y,n,a,f,m,v){const S=n.tileAnchorPoint.add(new s.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let P=f.mult(v);a||(P=P.rotate(-m));const M=S.add(P);return Gt(M.x,M.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(a){const P=dt(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(y),M=Math.atan(P.y/P.x)+(P.x<0?Math.PI:0);return y.add(f.rotate(M))}return y.add(f)}function cx(y,n,a,f,m,v,S,P,M,L,z,$){const O=y.text.placedSymbolArray,Z=y.text.dynamicLayoutVertexArray,Q=y.icon.dynamicLayoutVertexArray,ae={};Z.clear();for(let se=0;se<O.length;se++){const le=O.get(se),ue=le.hidden||!le.crossTileID||y.allowVerticalPlacement&&!le.placedOrientation?null:f[le.crossTileID];if(ue){const ge=new s.P(le.anchorX,le.anchorY),he={getElevation:$,width:m.width,height:m.height,pitchedLabelPlaneMatrix:v,pitchWithMap:a,transform:m,tileAnchorPoint:ge,translation:L,unwrappedTileID:z},_e=a?Zt(ge.x,ge.y,he):dt(ge.x,ge.y,he),be=Nt(m.cameraToCenterDistance,_e.signedDistanceFromCamera);let me=s.ao(y.textSizeData,P,le)*be/s.aA;a&&(me*=y.tilePixelRatio/S);const{width:Ce,height:Ne,anchor:Ae,textOffset:Ie,textBoxScale:je}=ue,ht=Zc(Ae,Ce,Ne,Ie,je,me),ct=m.getPitchedTextCorrection(ge.x+L[0],ge.y+L[1],z),Ye=lx(_e.point,he,n,ht,-m.bearingInRadians,ct),bt=y.allowVerticalPlacement&&le.placedOrientation===s.an.vertical?Math.PI/2:0;for(let $t=0;$t<le.numGlyphs;$t++)s.au(Z,Ye,bt);M&&le.associatedIconIndex>=0&&(ae[le.associatedIconIndex]={shiftedAnchor:Ye,angle:bt})}else os(le.numGlyphs,Z)}if(M){Q.clear();const se=y.icon.placedSymbolArray;for(let le=0;le<se.length;le++){const ue=se.get(le);if(ue.hidden)os(ue.numGlyphs,Q);else{const ge=ae[le];if(ge)for(let he=0;he<ue.numGlyphs;he++)s.au(Q,ge.shiftedAnchor,ge.angle);else os(ue.numGlyphs,Q)}}y.icon.dynamicLayoutVertexBuffer.updateData(Q)}y.text.dynamicLayoutVertexBuffer.updateData(Z)}function ey(y,n,a){return a.iconsInText&&n?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ty(y,n,a,f,m,v,S,P,M,L,z,$,O){const Z=y.context,Q=Z.gl,ae=y.transform,se=P==="map",le=M==="map",ue=P!=="viewport"&&a.layout.get("symbol-placement")!=="point",ge=se&&!le&&!ue,he=!a.layout.get("symbol-sort-key").isConstant();let _e=!1;const be=y.getDepthModeForSublayer(0,Bt.ReadOnly),me=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ce=[],Ne=ae.getCircleRadiusCorrection();for(const Ae of f){const Ie=n.getTile(Ae),je=Ie.getBucket(a);if(!je)continue;const ht=m?je.text:je.icon;if(!ht||!ht.segments.get().length||!ht.hasVisibleVertices)continue;const ct=ht.programConfigurations.get(a.id),Ye=m||je.sdfIcons,bt=m?je.textSizeData:je.iconSizeData,$t=le||ae.pitch!==0,fr=y.useProgram(ey(Ye,m,je),ct),jr=s.am(bt,ae.zoom),Sr=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ae);let Or,Cr,Tr,Pr,Vn=[0,0],cr=null;if(m)Cr=Ie.glyphAtlasTexture,Tr=Q.LINEAR,Or=Ie.glyphAtlasTexture.size,je.iconsInText&&(Vn=Ie.imageAtlasTexture.size,cr=Ie.imageAtlasTexture,Pr=$t||y.options.rotating||y.options.zooming||bt.kind==="composite"||bt.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const Kr=a.layout.get("icon-size").constantOr(0)!==1||je.iconsNeedLinear;Cr=Ie.imageAtlasTexture,Tr=Ye||y.options.rotating||y.options.zooming||Kr||$t?Q.LINEAR:Q.NEAREST,Or=Ie.imageAtlasTexture.size}const kn=s.aB(Ie,1,y.transform.zoom),Un=At(se,y.transform,kn),Ws=s.L();s.ap(Ws,Un);const Hs=ur(le,se,y.transform,kn),Ks=s.aC(ae,Ie,v,S),Bo=ae.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),su=me&&je.hasTextData(),au=a.layout.get("icon-text-fit")!=="none"&&su&&je.hasIconData();if(ue){const Kr=y.style.map.terrain?(ui,vn)=>y.style.map.terrain.getElevation(Ae,ui,vn):null,kr=a.layout.get("text-rotation-alignment")==="map";Pn(je,y,m,Un,Ws,le,L,kr,Ae.toUnwrapped(),ae.width,ae.height,Ks,Kr)}const Rl=m&&me||au,wi=ue||Rl?Jg:le?Un:y.transform.clipSpaceToPixelsMatrix,fo=Ye&&a.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Xs;Xs=Ye?je.iconsInText?tx(bt.kind,jr,ge,le,ue,Rl,y,wi,Hs,Ks,Or,Vn,Ne):gl(bt.kind,jr,ge,le,ue,Rl,y,wi,Hs,Ks,m,Or,0,Ne):Fp(bt.kind,jr,ge,le,ue,Rl,y,wi,Hs,Ks,m,Or,Ne);const Da={program:fr,buffers:ht,uniformValues:Xs,projectionData:Bo,atlasTexture:Cr,atlasTextureIcon:cr,atlasInterpolation:Tr,atlasInterpolationIcon:Pr,isSDF:Ye,hasHalo:fo};if(he&&je.canOverlap){_e=!0;const Kr=ht.segments.get();for(const kr of Kr)Ce.push({segments:new s.aL([kr]),sortKey:kr.sortKey,state:Da,terrainData:Sr})}else Ce.push({segments:ht.segments,sortKey:0,state:Da,terrainData:Sr})}_e&&Ce.sort((Ae,Ie)=>Ae.sortKey-Ie.sortKey);for(const Ae of Ce){const Ie=Ae.state;if(Z.activeTexture.set(Q.TEXTURE0),Ie.atlasTexture.bind(Ie.atlasInterpolation,Q.CLAMP_TO_EDGE),Ie.atlasTextureIcon&&(Z.activeTexture.set(Q.TEXTURE1),Ie.atlasTextureIcon&&Ie.atlasTextureIcon.bind(Ie.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Ie.isSDF){const je=Ie.uniformValues;Ie.hasHalo&&(je.u_is_halo=1,Ah(Ie.buffers,Ae.segments,a,y,Ie.program,be,z,$,je,Ie.projectionData,Ae.terrainData)),je.u_is_halo=0}Ah(Ie.buffers,Ae.segments,a,y,Ie.program,be,z,$,Ie.uniformValues,Ie.projectionData,Ae.terrainData)}}function Ah(y,n,a,f,m,v,S,P,M,L,z){const $=f.context;m.draw($,$.gl.TRIANGLES,v,S,P,Ot.backCCW,M,z,L,a.id,y.layoutVertexBuffer,y.indexBuffer,n,a.paint,f.transform.zoom,y.programConfigurations.get(a.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function Ih(y,n,a,f,m){const v=y.context,S=v.gl,P=zt.disabled,M=new or([S.ONE,S.ONE],s.be.transparent,[!0,!0,!0,!0]),L=n.getBucket(a);if(!L)return;const z=f.key;let $=a.heatmapFbos.get(z);$||($=Wc(v,n.tileSize,n.tileSize),a.heatmapFbos.set(z,$)),v.bindFramebuffer.set($.framebuffer),v.viewport.set([0,0,n.tileSize,n.tileSize]),v.clear({color:s.be.transparent});const O=L.programConfigurations.get(a.id),Z=y.useProgram("heatmap",O,!m),Q=y.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ae=y.style.map.terrain.getTerrainData(f);Z.draw(v,S.TRIANGLES,Bt.disabled,P,M,Ot.disabled,Uc(n,y.transform.zoom,a.paint.get("heatmap-intensity"),1),ae,Q,a.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,a.paint,y.transform.zoom,O)}function Rh(y,n,a,f,m){const v=y.context,S=v.gl,P=y.transform;v.setColorMode(y.colorModeForRenderPass());const M=Lh(v,n),L=a.key,z=n.heatmapFbos.get(L);if(!z)return;v.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,z.colorAttachment.get()),v.activeTexture.set(S.TEXTURE1),M.bind(S.LINEAR,S.CLAMP_TO_EDGE);const $=P.getProjectionData({overscaledTileID:a,applyTerrainMatrix:m,applyGlobeMatrix:!f});y.useProgram("heatmapTexture").draw(v,S.TRIANGLES,Bt.disabled,zt.disabled,y.colorModeForRenderPass(),Ot.disabled,jg(y,n,0,1),null,$,n.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,n.paint,P.zoom),z.destroy(),n.heatmapFbos.delete(L)}function Wc(y,n,a){var f,m;const v=y.gl,S=v.createTexture();v.bindTexture(v.TEXTURE_2D,S),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR);const P=(f=y.HALF_FLOAT)!==null&&f!==void 0?f:v.UNSIGNED_BYTE,M=(m=y.RGBA16F)!==null&&m!==void 0?m:v.RGBA;v.texImage2D(v.TEXTURE_2D,0,M,n,a,0,v.RGBA,P,null);const L=y.createFramebuffer(n,a,!1,!1);return L.colorAttachment.set(S),L}function Lh(y,n){return n.colorRampTexture||(n.colorRampTexture=new s.T(y,n.colorRamp,y.gl.RGBA)),n.colorRampTexture}function Xp(y,n,a,f,m){if(!a||!f||!f.imageAtlas)return;const v=f.imageAtlas.patternPositions;let S=v[a.to.toString()],P=v[a.from.toString()];if(!S&&P&&(S=P),!P&&S&&(P=S),!S||!P){const M=m.getPaintProperty(n);S=v[M],P=v[M]}S&&P&&y.setConstantPatternPositions(S,P)}function Hc(y,n,a,f,m,v,S,P){const M=y.context.gl,L="fill-pattern",z=a.paint.get(L),$=z&&z.constantOr(1),O=a.getCrossfadeParameters();let Z,Q,ae,se,le;const ue=y.transform,ge=a.paint.get("fill-translate"),he=a.paint.get("fill-translate-anchor");S?(Q=$&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=M.LINES):(Q=$?"fillPattern":"fill",Z=M.TRIANGLES);const _e=z.constantOr(null);for(const be of f){const me=n.getTile(be);if($&&!me.patternsLoaded())continue;const Ce=me.getBucket(a);if(!Ce)continue;const Ne=Ce.programConfigurations.get(a.id),Ae=y.useProgram(Q,Ne),Ie=y.style.map.terrain&&y.style.map.terrain.getTerrainData(be);$&&(y.context.activeTexture.set(M.TEXTURE0),me.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Ne.updatePaintBuffers(O)),Xp(Ne,L,_e,me,a);const je=ue.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),ht=s.aC(ue,me,ge,he);if(S){se=Ce.indexBuffer2,le=Ce.segments2;const Ye=[M.drawingBufferWidth,M.drawingBufferHeight];ae=Q==="fillOutlinePattern"&&$?Q_(y,O,me,Ye,ht):jo(Ye,ht)}else se=Ce.indexBuffer,le=Ce.segments,ae=$?bh(y,O,me,ht):{u_fill_translate:ht};const ct=y.stencilModeForClipping(be);Ae.draw(y.context,Z,m,ct,v,Ot.backCCW,ae,Ie,je,a.id,Ce.layoutVertexBuffer,se,le,a.paint,y.transform.zoom,Ne)}}function bl(y,n,a,f,m,v,S,P){const M=y.context,L=M.gl,z="fill-extrusion-pattern",$=a.paint.get(z),O=$.constantOr(1),Z=a.getCrossfadeParameters(),Q=a.paint.get("fill-extrusion-opacity"),ae=$.constantOr(null),se=y.transform;for(const le of f){const ue=n.getTile(le),ge=ue.getBucket(a);if(!ge)continue;const he=y.style.map.terrain&&y.style.map.terrain.getTerrainData(le),_e=ge.programConfigurations.get(a.id),be=y.useProgram(O?"fillExtrusionPattern":"fillExtrusion",_e);O&&(y.context.activeTexture.set(L.TEXTURE0),ue.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),_e.updatePaintBuffers(Z));const me=se.getProjectionData({overscaledTileID:le,applyGlobeMatrix:!P,applyTerrainMatrix:!0});Xp(_e,z,ae,ue,a);const Ce=s.aC(se,ue,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ne=a.paint.get("fill-extrusion-vertical-gradient"),Ae=O?Dp(y,Ne,Q,Ce,le,Z,ue):Bc(y,Ne,Q,Ce);be.draw(M,M.gl.TRIANGLES,m,v,S,Ot.backCCW,Ae,he,me,a.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,a.paint,y.transform.zoom,_e,y.style.map.terrain&&ge.centroidVertexBuffer)}}function wl(y,n,a,f,m,v,S,P,M){var L;const z=y.style.projection,$=y.context,O=y.transform,Z=$.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],ae=y.useProgram("hillshade",null,!1,Q),se=!y.options.moving;for(const le of f){const ue=n.getTile(le),ge=ue.fbo;if(!ge)continue;const he=z.getMeshFromTileID($,le.canonical,P,!0,"raster"),_e=(L=y.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(le);$.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,ge.colorAttachment.get());const be=O.getProjectionData({overscaledTileID:le,aligned:se,applyGlobeMatrix:!M,applyTerrainMatrix:!0});ae.draw($,Z.TRIANGLES,v,m[le.overscaledZ],S,Ot.backCCW,ml(y,ue,a),_e,be,a.id,he.vertexBuffer,he.indexBuffer,he.segments)}}function Kc(y,n,a,f,m,v,S,P,M){var L;const z=y.style.projection,$=y.context,O=y.transform,Z=$.gl,Q=y.useProgram("colorRelief"),ae=!y.options.moving;let se=!0,le=0;for(const ue of f){const ge=n.getTile(ue),he=ge.dem;if(se){const Ae=Z.getParameter(Z.MAX_TEXTURE_SIZE),{elevationTexture:Ie,colorTexture:je}=a.getColorRampTextures($,Ae,he.getUnpackVector());$.activeTexture.set(Z.TEXTURE1),Ie.bind(Z.NEAREST,Z.CLAMP_TO_EDGE),$.activeTexture.set(Z.TEXTURE4),je.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),se=!1,le=Ie.size[0]}if(!he||!he.data)continue;const _e=he.stride,be=he.getPixels();if($.activeTexture.set(Z.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),ge.demTexture=ge.demTexture||y.getTileTexture(_e),ge.demTexture){const Ae=ge.demTexture;Ae.update(be,{premultiply:!1}),Ae.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}else ge.demTexture=new s.T($,be,Z.RGBA,{premultiply:!1}),ge.demTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const me=z.getMeshFromTileID($,ue.canonical,P,!0,"raster"),Ce=(L=y.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(ue),Ne=O.getProjectionData({overscaledTileID:ue,aligned:ae,applyGlobeMatrix:!M,applyTerrainMatrix:!0});Q.draw($,Z.TRIANGLES,v,m[ue.overscaledZ],S,Ot.backCCW,ex(a,ge.dem,le),Ce,Ne,a.id,me.vertexBuffer,me.indexBuffer,me.segments)}}const Yp=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function Vs(y,n,a,f,m,v,S,P,M=!1,L=!1){const z=f[f.length-1].overscaledZ,$=y.context,O=$.gl,Z=y.useProgram("raster"),Q=y.transform,ae=y.style.projection,se=y.colorModeForRenderPass(),le=!y.options.moving;for(const ue of f){const ge=y.getDepthModeForSublayer(ue.overscaledZ-z,a.paint.get("raster-opacity")===1?Bt.ReadWrite:Bt.ReadOnly,O.LESS),he=n.getTile(ue);he.registerFadeDuration(a.paint.get("raster-fade-duration"));const _e=n.findLoadedParent(ue,0),be=n.findLoadedSibling(ue),me=ux(he,_e||be||null,n,a,y.transform,y.style.map.terrain);let Ce,Ne;const Ae=a.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;$.activeTexture.set(O.TEXTURE0),he.texture.bind(Ae,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(O.TEXTURE1),_e?(_e.texture.bind(Ae,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,_e.tileID.overscaledZ-he.tileID.overscaledZ),Ne=[he.tileID.canonical.x*Ce%1,he.tileID.canonical.y*Ce%1]):he.texture.bind(Ae,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&$.extTextureFilterAnisotropic&&y.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const Ie=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ue),je=Q.getProjectionData({overscaledTileID:ue,aligned:le,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),ht=Ea(Ne||[0,0],Ce||1,me,a,P),ct=ae.getMeshFromTileID($,ue.canonical,v,S,"raster");Z.draw($,O.TRIANGLES,ge,m?m[ue.overscaledZ]:zt.disabled,se,M?Ot.frontCCW:Ot.backCCW,ht,Ie,je,a.id,ct.vertexBuffer,ct.indexBuffer,ct.segments)}}function ux(y,n,a,f,m,v){const S=f.paint.get("raster-fade-duration");if(!v&&S>0){const P=I.now(),M=(P-y.timeAdded)/S,L=n?(P-n.timeAdded)/S:-1,z=a.getSource(),$=$e(m,{tileSize:z.tileSize,roundZoom:z.roundZoom}),O=!n||Math.abs(n.tileID.overscaledZ-$)>Math.abs(y.tileID.overscaledZ-$),Z=O&&y.refreshedUponExpiration?1:s.ag(O?M:1-L,0,1);return y.refreshedUponExpiration&&M>=1&&(y.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const ry=new s.be(1,0,0,1),Dh=new s.be(0,1,0,1),Qp=new s.be(0,0,1,1),ny=new s.be(1,0,1,1),iy=new s.be(0,1,1,1);function Xc(y,n,a,f){Nh(y,0,n+a/2,y.transform.width,a,f)}function zh(y,n,a,f){Nh(y,n-a/2,0,a,y.transform.height,f)}function Nh(y,n,a,f,m,v){const S=y.context,P=S.gl;P.enable(P.SCISSOR_TEST),P.scissor(n*y.pixelRatio,a*y.pixelRatio,f*y.pixelRatio,m*y.pixelRatio),S.clear({color:v}),P.disable(P.SCISSOR_TEST)}function oy(y,n,a){const f=y.context,m=f.gl,v=y.useProgram("debug"),S=Bt.disabled,P=zt.disabled,M=y.colorModeForRenderPass(),L="$debug",z=y.style.map.terrain&&y.style.map.terrain.getTerrainData(a);f.activeTexture.set(m.TEXTURE0);const $=n.getTileByID(a.key).latestRawTileData,O=Math.floor(($&&$.byteLength||0)/1024),Z=n.getTile(a).tileSize,Q=512/Math.min(Z,512)*(a.overscaledZ/y.transform.zoom)*.5;let ae=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ae+=` => ${a.overscaledZ}`),function(le,ue){le.initDebugOverlayCanvas();const ge=le.debugOverlayCanvas,he=le.context.gl,_e=le.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,ge.width,ge.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(ue,5,5),_e.strokeText(ue,5,5),le.debugOverlayTexture.update(ge),le.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(y,`${ae} ${O}kB`);const se=y.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(f,m.TRIANGLES,S,P,or.alphaBlended,Ot.disabled,Ng(s.be.transparent,Q),null,se,L,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),v.draw(f,m.LINE_STRIP,S,P,M,Ot.disabled,Ng(s.be.red),z,se,L,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Vr(y,n,a,f){const{isRenderingGlobe:m}=f,v=y.context,S=v.gl,P=y.transform,M=y.colorModeForRenderPass(),L=y.getDepthModeFor3D(),z=y.useProgram("terrain");v.bindFramebuffer.set(null),v.viewport.set([0,0,y.width,y.height]);for(const $ of a){const O=n.getTerrainMesh($.tileID),Z=y.renderToTexture.getTexture($),Q=n.getTerrainData($.tileID);v.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,Z.texture);const ae=n.getMeshFrameDelta(P.zoom),se=P.calculateFogMatrix($.tileID.toUnwrapped()),le=X_(ae,se,y.style.sky,P.pitch,m),ue=P.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});z.draw(v,S.TRIANGLES,L,zt.disabled,M,Ot.backCCW,le,Q,ue,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}}function Us(y,n){if(!n.mesh){const a=new s.aK;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const f=new s.aM;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),n.mesh=new as(y.createVertexBuffer(a,ls.members),y.createIndexBuffer(f),s.aL.simpleSegment(0,0,a.length,f.length))}return n.mesh}class Qi{constructor(n,a){this.context=new Jt(n),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=qe.maxUnderzooming+qe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fh}resize(n,a,f){if(this.width=Math.floor(n*f),this.height=Math.floor(a*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const n=this.context,a=new s.aK;a.emplaceBack(0,0),a.emplaceBack(s.$,0),a.emplaceBack(0,s.$),a.emplaceBack(s.$,s.$),this.tileExtentBuffer=n.createVertexBuffer(a,ls.members),this.tileExtentSegments=s.aL.simpleSegment(0,0,4,2);const f=new s.aK;f.emplaceBack(0,0),f.emplaceBack(s.$,0),f.emplaceBack(0,s.$),f.emplaceBack(s.$,s.$),this.debugBuffer=n.createVertexBuffer(f,ls.members),this.debugSegments=s.aL.simpleSegment(0,0,4,5);const m=new s.c5;m.emplaceBack(0,0,0,0),m.emplaceBack(s.$,0,s.$,0),m.emplaceBack(0,s.$,0,s.$),m.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=n.createVertexBuffer(m,H_.members),this.rasterBoundsSegments=s.aL.simpleSegment(0,0,4,2);const v=new s.aK;v.emplaceBack(0,0),v.emplaceBack(s.$,0),v.emplaceBack(0,s.$),v.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(v,ls.members),this.rasterBoundsSegmentsPosOnly=s.aL.simpleSegment(0,0,4,5);const S=new s.aK;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(S,ls.members),this.viewportSegments=s.aL.simpleSegment(0,0,4,2);const P=new s.c6;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(P);const M=new s.aM;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(M);const L=this.context.gl;this.stencilClearMode=new zt({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.tileExtentMesh=new as(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=s.L();s.bX(f,0,this.width,this.height,0,0,1),s.N(f,f,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const m={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(n,a.TRIANGLES,Bt.disabled,this.stencilClearMode,or.disabled,Ot.disabled,null,null,m,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,a,f){if(this.currentStencilSource===n.source||!n.isTileClipped()||!a||!a.length)return;this.currentStencilSource=n.source,this.nextStencilID+a.length>256&&this.clearStencil();const m=this.context;m.setColorMode(or.disabled),m.setDepthMode(Bt.disabled);const v={};for(const S of a)v[S.key]=this.nextStencilID++;this._renderTileMasks(v,a,f,!0),this._renderTileMasks(v,a,f,!1),this._tileClippingMaskIDs=v}_renderTileMasks(n,a,f,m){const v=this.context,S=v.gl,P=this.style.projection,M=this.transform,L=this.useProgram("clippingMask");for(const z of a){const $=n[z.key],O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),Z=P.getMeshFromTileID(this.context,z.canonical,m,!0,"stencil"),Q=M.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!f,applyTerrainMatrix:!0});L.draw(v,S.TRIANGLES,Bt.disabled,new zt({func:S.ALWAYS,mask:0},$,255,S.KEEP,S.KEEP,S.REPLACE),or.disabled,f?Ot.disabled:Ot.backCCW,null,O,Q,"$clipping",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}_renderTilesDepthBuffer(){const n=this.context,a=n.gl,f=this.style.projection,m=this.transform,v=this.useProgram("depth"),S=this.getDepthModeFor3D(),P=Fe(m,{tileSize:m.tileSize});for(const M of P){const L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),z=f.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),$=m.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(n,a.TRIANGLES,S,zt.disabled,or.disabled,Ot.backCCW,null,L,$,"$clipping",z.vertexBuffer,z.indexBuffer,z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,a=this.context.gl;return new zt({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(n){const a=this.context.gl;return new zt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const a=this.context.gl,f=n.sort((S,P)=>P.overscaledZ-S.overscaledZ),m=f[f.length-1].overscaledZ,v=f[0].overscaledZ-m+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const S={};for(let P=0;P<v;P++)S[P+m]=new zt({func:a.GEQUAL,mask:255},P+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=v,[S,f]}return[{[m]:zt.disabled},f]}stencilConfigForOverlapTwoPass(n){const a=this.context.gl,f=n.sort((S,P)=>P.overscaledZ-S.overscaledZ),m=f[f.length-1].overscaledZ,v=f[0].overscaledZ-m+1;if(this.clearStencil(),v>1){const S={},P={};for(let M=0;M<v;M++)S[M+m]=new zt({func:a.GREATER,mask:255},v+1+M,255,a.KEEP,a.KEEP,a.REPLACE),P[M+m]=new zt({func:a.GREATER,mask:255},1+M,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*v+1,[S,P,f]}return this.nextStencilID=3,[{[m]:new zt({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[m]:new zt({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new or([n.CONSTANT_COLOR,n.ONE],new s.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?or.unblended:or.alphaBlended}getDepthModeForSublayer(n,a,f){if(!this.opaquePassEnabledForLayer())return Bt.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Bt(f||this.context.gl.LEQUAL,a,[m,m])}getDepthModeFor3D(){return new Bt(this.context.gl.LEQUAL,Bt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,a){var f,m;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(I.now()),this.imageManager.beginFrame();const v=this.style._order,S=this.style.sourceCaches,P={},M={},L={},z={isRenderingToTexture:!1,isRenderingGlobe:((f=n.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const O in S){const Z=S[O];Z.used&&Z.prepare(this.context),P[O]=Z.getVisibleCoordinates(!1),M[O]=P[O].slice().reverse(),L[O]=Z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let O=0;O<v.length;O++)if(this.style._layers[v[O]].is3D()){this.opaquePassCutoff=O;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const O of v){const Z=this.style._layers[O];if(!Z.hasOffscreenPass()||Z.isHidden(this.transform.zoom))continue;const Q=M[Z.source];(Z.type==="custom"||Q.length)&&this.renderLayer(this,S[Z.source],Z,Q,z)}if((m=this.style.projection)===null||m===void 0||m.updateGPUdependent({context:this.context,useProgram:O=>this.useProgram(O)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?s.be.black:s.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(O,Z){const Q=O.context,ae=Q.gl,se=((be,me,Ce)=>{const Ne=Math.cos(me.rollInRadians),Ae=Math.sin(me.rollInRadians),Ie=te(me),je=me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:be.properties.get("sky-color"),u_horizon_color:be.properties.get("horizon-color"),u_horizon:[(me.width/2-Ie*Ae)*Ce,(me.height/2+Ie*Ne)*Ce],u_horizon_normal:[-Ae,Ne],u_sky_horizon_blend:be.properties.get("sky-horizon-blend")*me.height/2*Ce,u_sky_blend:je}})(Z,O.style.map.transform,O.pixelRatio),le=new Bt(ae.LEQUAL,Bt.ReadWrite,[0,1]),ue=zt.disabled,ge=O.colorModeForRenderPass(),he=O.useProgram("sky"),_e=Us(Q,Z);he.draw(Q,ae.TRIANGLES,le,ue,ge,Ot.disabled,se,null,void 0,"sky",_e.vertexBuffer,_e.indexBuffer,_e.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const O=this.style._layers[v[this.currentLayer]],Z=S[O.source],Q=P[O.source];this._renderTileClippingMasks(O,Q,!1),this.renderLayer(this,Z,O,Q,z)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const O=this.style._layers[v[this.currentLayer]],Z=S[O.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(O,z))continue;this.opaquePassEnabledForLayer()||$||($=!0,z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(O.type==="symbol"?L:M)[O.source];this._renderTileClippingMasks(O,P[O.source],!!this.renderToTexture),this.renderLayer(this,Z,O,Q,z)}if(z.isRenderingGlobe&&function(O,Z,Q){const ae=O.context,se=ae.gl,le=O.useProgram("atmosphere"),ue=new Bt(se.LEQUAL,Bt.ReadOnly,[0,1]),ge=O.transform,he=function(je,ht){const ct=je.properties.get("position"),Ye=[-ct.x,-ct.y,-ct.z],bt=s.af(new Float64Array(16));return je.properties.get("anchor")==="map"&&(s.b5(bt,bt,ht.rollInRadians),s.b6(bt,bt,-ht.pitchInRadians),s.b5(bt,bt,ht.bearingInRadians),s.b6(bt,bt,ht.center.lat*Math.PI/180),s.by(bt,bt,-ht.center.lng*Math.PI/180)),s.c4(Ye,Ye,bt),Ye}(Q,O.transform),_e=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),be=Z.properties.get("atmosphere-blend")*_e.projectionTransition;if(be===0)return;const me=cl(ge.worldSize,ge.center.lat),Ce=ge.inverseProjectionMatrix,Ne=new Float64Array(4);Ne[3]=1,s.av(Ne,Ne,ge.modelViewProjectionMatrix),Ne[0]/=Ne[3],Ne[1]/=Ne[3],Ne[2]/=Ne[3],Ne[3]=1,s.av(Ne,Ne,Ce),Ne[0]/=Ne[3],Ne[1]/=Ne[3],Ne[2]/=Ne[3],Ne[3]=1;const Ae=((je,ht,ct,Ye,bt)=>({u_sun_pos:je,u_atmosphere_blend:ht,u_globe_position:ct,u_globe_radius:Ye,u_inv_proj_matrix:bt}))(he,be,[Ne[0],Ne[1],Ne[2]],me,Ce),Ie=Us(ae,Z);le.draw(ae,se.TRIANGLES,ue,zt.disabled,or.alphaBlended,Ot.disabled,Ae,null,null,"atmosphere",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const O=function(Z,Q){let ae=null;const se=Object.values(Z._layers).flatMap(he=>he.source&&!he.isHidden(Q)?[Z.sourceCaches[he.source]]:[]),le=se.filter(he=>he.getSource().type==="vector"),ue=se.filter(he=>he.getSource().type!=="vector"),ge=he=>{(!ae||ae.getSource().maxzoom<he.getSource().maxzoom)&&(ae=he)};return le.forEach(he=>ge(he)),ae||ue.forEach(he=>ge(he)),ae}(this.style,this.transform.zoom);O&&function(Z,Q,ae){for(let se=0;se<ae.length;se++)oy(Z,Q,ae[se])}(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const Z=O.transform.padding;Xc(O,O.transform.height-(Z.top||0),3,ry),Xc(O,Z.bottom||0,3,Dh),zh(O,Z.left||0,3,Qp),zh(O,O.transform.width-(Z.right||0),3,ny);const Q=O.transform.centerPoint;(function(ae,se,le,ue){Nh(ae,se-1,le-10,2,20,ue),Nh(ae,se-10,le-1,20,2,ue)})(O,Q.x,O.transform.height-Q.y,iy)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let m=this.terrainFacilitator.dirty;m||(m=n?!s.c7(a,f):!s.c8(a,f)),m||(m=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),m&&(s.c9(a,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,S){const P=v.context,M=P.gl,L=v.transform,z=or.unblended,$=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),O=S.sourceCache.getRenderableTiles(),Z=v.useProgram("terrainDepth");P.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),P.clear({color:s.be.transparent,depth:1});for(const Q of O){const ae=S.getTerrainMesh(Q.tileID),se=S.getTerrainData(Q.tileID),le=L.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ue={u_ele_delta:S.getMeshFrameDelta(L.zoom)};Z.draw(P,M.TRIANGLES,$,zt.disabled,z,Ot.backCCW,ue,se,le,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,S){const P=v.context,M=P.gl,L=v.transform,z=or.unblended,$=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),O=S.getCoordsTexture(),Z=S.sourceCache.getRenderableTiles(),Q=v.useProgram("terrainCoords");P.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),P.clear({color:s.be.transparent,depth:1}),S.coordsIndex=[];for(const ae of Z){const se=S.getTerrainMesh(ae.tileID),le=S.getTerrainData(ae.tileID);P.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,O.texture);const ue={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(L.zoom)},ge=L.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(P,M.TRIANGLES,$,zt.disabled,z,Ot.backCCW,ue,le,ge,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),S.coordsIndex.push(ae.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(n,a,f,m,v){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(m||[]).length)&&(this.id=f.id,s.ca(f)?function(S,P,M,L,z,$){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:O}=$,Z=zt.disabled,Q=S.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ae,se,le,ue,ge,he,_e,be,me){const Ce=se.transform,Ne=se.style.map.terrain,Ae=ge==="map",Ie=he==="map";for(const je of ae){const ht=ue.getTile(je),ct=ht.getBucket(le);if(!ct||!ct.text||!ct.text.segments.get().length)continue;const Ye=s.am(ct.textSizeData,Ce.zoom),bt=s.aB(ht,1,se.transform.zoom),$t=At(Ae,se.transform,bt),fr=le.layout.get("icon-text-fit")!=="none"&&ct.hasIconData();if(Ye){const jr=Math.pow(2,Ce.zoom-ht.tileID.overscaledZ),Sr=Ne?(Or,Cr)=>Ne.getElevation(je,Or,Cr):null;cx(ct,Ae,Ie,me,Ce,$t,jr,Ye,fr,s.aC(Ce,ht,_e,be),je.toUnwrapped(),Sr)}}}(L,S,M,P,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),z),M.paint.get("icon-opacity").constantOr(1)!==0&&ty(S,P,M,L,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),Z,Q,O),M.paint.get("text-opacity").constantOr(1)!==0&&ty(S,P,M,L,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),Z,Q,O),P.map.showCollisionBoxes&&(Qg(S,P,M,L,!0),Qg(S,P,M,L,!1))}(n,a,f,m,this.style.placement.variableOffsets,v):s.cb(f)?function(S,P,M,L,z){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:$}=z,O=M.paint.get("circle-opacity"),Z=M.paint.get("circle-stroke-width"),Q=M.paint.get("circle-stroke-opacity"),ae=!M.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&(Z.constantOr(1)===0||Q.constantOr(1)===0))return;const se=S.context,le=se.gl,ue=S.transform,ge=S.getDepthModeForSublayer(0,Bt.ReadOnly),he=zt.disabled,_e=S.colorModeForRenderPass(),be=[],me=ue.getCircleRadiusCorrection();for(let Ce=0;Ce<L.length;Ce++){const Ne=L[Ce],Ae=P.getTile(Ne),Ie=Ae.getBucket(M);if(!Ie)continue;const je=M.paint.get("circle-translate"),ht=M.paint.get("circle-translate-anchor"),ct=s.aC(ue,Ae,je,ht),Ye=Ie.programConfigurations.get(M.id),bt=S.useProgram("circle",Ye),$t=Ie.layoutVertexBuffer,fr=Ie.indexBuffer,jr=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ne),Sr={programConfiguration:Ye,program:bt,layoutVertexBuffer:$t,indexBuffer:fr,uniformValues:zp(S,Ae,M,ct,me),terrainData:jr,projectionData:ue.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(ae){const Or=Ie.segments.get();for(const Cr of Or)be.push({segments:new s.aL([Cr]),sortKey:Cr.sortKey,state:Sr})}else be.push({segments:Ie.segments,sortKey:0,state:Sr})}ae&&be.sort((Ce,Ne)=>Ce.sortKey-Ne.sortKey);for(const Ce of be){const{programConfiguration:Ne,program:Ae,layoutVertexBuffer:Ie,indexBuffer:je,uniformValues:ht,terrainData:ct,projectionData:Ye}=Ce.state;Ae.draw(se,le.TRIANGLES,ge,he,_e,Ot.backCCW,ht,ct,Ye,M.id,Ie,je,Ce.segments,M.paint,S.transform.zoom,Ne)}}(n,a,f,m,v):s.cc(f)?function(S,P,M,L,z){if(M.paint.get("heatmap-opacity")===0)return;const $=S.context,{isRenderingToTexture:O,isRenderingGlobe:Z}=z;if(S.style.map.terrain){for(const Q of L){const ae=P.getTile(Q);P.hasRenderableParent(Q)||(S.renderPass==="offscreen"?Ih(S,ae,M,Q,Z):S.renderPass==="translucent"&&Rh(S,M,Q,O,Z))}$.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(Q,ae,se,le){const ue=Q.context,ge=ue.gl,he=Q.transform,_e=zt.disabled,be=new or([ge.ONE,ge.ONE],s.be.transparent,[!0,!0,!0,!0]);(function(me,Ce,Ne){const Ae=me.gl;me.activeTexture.set(Ae.TEXTURE1),me.viewport.set([0,0,Ce.width/4,Ce.height/4]);let Ie=Ne.heatmapFbos.get(s.c1);Ie?(Ae.bindTexture(Ae.TEXTURE_2D,Ie.colorAttachment.get()),me.bindFramebuffer.set(Ie.framebuffer)):(Ie=Wc(me,Ce.width/4,Ce.height/4),Ne.heatmapFbos.set(s.c1,Ie))})(ue,Q,se),ue.clear({color:s.be.transparent});for(let me=0;me<le.length;me++){const Ce=le[me];if(ae.hasRenderableParent(Ce))continue;const Ne=ae.getTile(Ce),Ae=Ne.getBucket(se);if(!Ae)continue;const Ie=Ae.programConfigurations.get(se.id),je=Q.useProgram("heatmap",Ie),ht=he.getProjectionData({overscaledTileID:Ce,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ct=he.getCircleRadiusCorrection();je.draw(ue,ge.TRIANGLES,Bt.disabled,_e,be,Ot.backCCW,Uc(Ne,he.zoom,se.paint.get("heatmap-intensity"),ct),null,ht,se.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,se.paint,he.zoom,Ie)}ue.viewport.set([0,0,Q.width,Q.height])}(S,P,M,L):S.renderPass==="translucent"&&function(Q,ae){const se=Q.context,le=se.gl;se.setColorMode(Q.colorModeForRenderPass());const ue=ae.heatmapFbos.get(s.c1);ue&&(se.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,ue.colorAttachment.get()),se.activeTexture.set(le.TEXTURE1),Lh(se,ae).bind(le.LINEAR,le.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(se,le.TRIANGLES,Bt.disabled,zt.disabled,Q.colorModeForRenderPass(),Ot.disabled,jg(Q,ae,0,1),null,null,ae.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,ae.paint,Q.transform.zoom))}(S,M)}(n,a,f,m,v):s.cd(f)?function(S,P,M,L,z){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:$}=z,O=M.paint.get("line-opacity"),Z=M.paint.get("line-width");if(O.constantOr(1)===0||Z.constantOr(1)===0)return;const Q=S.getDepthModeForSublayer(0,Bt.ReadOnly),ae=S.colorModeForRenderPass(),se=M.paint.get("line-dasharray"),le=M.paint.get("line-pattern"),ue=le.constantOr(1),ge=M.paint.get("line-gradient"),he=M.getCrossfadeParameters(),_e=ue?"linePattern":se?"lineSDF":ge?"lineGradient":"line",be=S.context,me=be.gl,Ce=S.transform;let Ne=!0;for(const Ae of L){const Ie=P.getTile(Ae);if(ue&&!Ie.patternsLoaded())continue;const je=Ie.getBucket(M);if(!je)continue;const ht=je.programConfigurations.get(M.id),ct=S.context.program.get(),Ye=S.useProgram(_e,ht),bt=Ne||Ye.program!==ct,$t=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ae),fr=le.constantOr(null);if(fr&&Ie.imageAtlas){const Tr=Ie.imageAtlas,Pr=Tr.patternPositions[fr.to.toString()],Vn=Tr.patternPositions[fr.from.toString()];Pr&&Vn&&ht.setConstantPatternPositions(Pr,Vn)}const jr=Ce.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Sr=Ce.getPixelScale(),Or=ue?Fg(S,Ie,M,Sr,he):se?Bg(S,Ie,M,Sr,se,he):ge?Np(S,Ie,M,Sr,je.lineClipsArray.length):wh(S,Ie,M,Sr);if(ue)be.activeTexture.set(me.TEXTURE0),Ie.imageAtlasTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),ht.updatePaintBuffers(he);else if(se&&(bt||S.lineAtlas.dirty))be.activeTexture.set(me.TEXTURE0),S.lineAtlas.bind(be);else if(ge){const Tr=je.gradients[M.id];let Pr=Tr.texture;if(M.gradientVersion!==Tr.version){let Vn=256;if(M.stepInterpolant){const cr=P.getSource().maxzoom,kn=Ae.canonical.z===cr?Math.ceil(1<<S.transform.maxZoom-Ae.canonical.z):1;Vn=s.ag(s.c2(je.maxLineLength/s.$*1024*kn),256,be.maxTextureSize)}Tr.gradient=s.c3({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:Vn,image:Tr.gradient||void 0,clips:je.lineClipsArray}),Tr.texture?Tr.texture.update(Tr.gradient):Tr.texture=new s.T(be,Tr.gradient,me.RGBA),Tr.version=M.gradientVersion,Pr=Tr.texture}be.activeTexture.set(me.TEXTURE0),Pr.bind(M.stepInterpolant?me.NEAREST:me.LINEAR,me.CLAMP_TO_EDGE)}const Cr=S.stencilModeForClipping(Ae);Ye.draw(be,me.TRIANGLES,Q,Cr,ae,Ot.disabled,Or,$t,jr,M.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,M.paint,S.transform.zoom,ht,je.layoutVertexBuffer2),Ne=!1}}(n,a,f,m,v):s.ce(f)?function(S,P,M,L,z){const $=M.paint.get("fill-color"),O=M.paint.get("fill-opacity");if(O.constantOr(1)===0)return;const{isRenderingToTexture:Z}=z,Q=S.colorModeForRenderPass(),ae=M.paint.get("fill-pattern"),se=S.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&$.constantOr(s.be.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===se){const le=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?Bt.ReadWrite:Bt.ReadOnly);Hc(S,P,M,L,le,Q,!1,Z)}if(S.renderPass==="translucent"&&M.paint.get("fill-antialias")){const le=S.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,Bt.ReadOnly);Hc(S,P,M,L,le,Q,!0,Z)}}(n,a,f,m,v):s.cf(f)?function(S,P,M,L,z){const $=M.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:O}=z;if(S.renderPass==="translucent"){const Z=new Bt(S.context.gl.LEQUAL,Bt.ReadWrite,S.depthRangeFor3D);if($!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))bl(S,P,M,L,Z,zt.disabled,or.disabled,O),bl(S,P,M,L,Z,S.stencilModeFor3D(),S.colorModeForRenderPass(),O);else{const Q=S.colorModeForRenderPass();bl(S,P,M,L,Z,zt.disabled,Q,O)}}}(n,a,f,m,v):s.cg(f)?function(S,P,M,L,z){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:$}=z,O=S.context,Z=S.style.projection.useSubdivision,Q=S.getDepthModeForSublayer(0,Bt.ReadOnly),ae=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(se,le,ue,ge,he,_e,be){const me=se.context,Ce=me.gl;for(const Ne of ue){const Ae=le.getTile(Ne),Ie=Ae.dem;if(!Ie||!Ie.data||!Ae.needsHillshadePrepare)continue;const je=Ie.dim,ht=Ie.stride,ct=Ie.getPixels();if(me.activeTexture.set(Ce.TEXTURE1),me.pixelStoreUnpackPremultiplyAlpha.set(!1),Ae.demTexture=Ae.demTexture||se.getTileTexture(ht),Ae.demTexture){const bt=Ae.demTexture;bt.update(ct,{premultiply:!1}),bt.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE)}else Ae.demTexture=new s.T(me,ct,Ce.RGBA,{premultiply:!1}),Ae.demTexture.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);me.activeTexture.set(Ce.TEXTURE0);let Ye=Ae.fbo;if(!Ye){const bt=new s.T(me,{width:je,height:je,data:null},Ce.RGBA);bt.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Ye=Ae.fbo=me.createFramebuffer(je,je,!0,!1),Ye.colorAttachment.set(bt.texture)}me.bindFramebuffer.set(Ye.framebuffer),me.viewport.set([0,0,je,je]),se.useProgram("hillshadePrepare").draw(me,Ce.TRIANGLES,he,_e,be,Ot.disabled,J_(Ae.tileID,Ie),null,null,ge.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),Ae.needsHillshadePrepare=!1}})(S,P,L,M,Q,zt.disabled,ae),O.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(Z){const[se,le,ue]=S.stencilConfigForOverlapTwoPass(L);wl(S,P,M,ue,se,Q,ae,!1,$),wl(S,P,M,ue,le,Q,ae,!0,$)}else{const[se,le]=S.getStencilConfigForOverlapAndUpdateStencilID(L);wl(S,P,M,le,se,Q,ae,!1,$)}}(n,a,f,m,v):s.ch(f)?function(S,P,M,L,z){if(S.renderPass!=="translucent"||!L.length)return;const{isRenderingToTexture:$}=z,O=S.style.projection.useSubdivision,Z=S.getDepthModeForSublayer(0,Bt.ReadOnly),Q=S.colorModeForRenderPass();if(O){const[ae,se,le]=S.stencilConfigForOverlapTwoPass(L);Kc(S,P,M,le,ae,Z,Q,!1,$),Kc(S,P,M,le,se,Z,Q,!0,$)}else{const[ae,se]=S.getStencilConfigForOverlapAndUpdateStencilID(L);Kc(S,P,M,se,ae,Z,Q,!1,$)}}(n,a,f,m,v):s.ci(f)?function(S,P,M,L,z){if(S.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!L.length)return;const{isRenderingToTexture:$}=z,O=P.getSource(),Z=S.style.projection.useSubdivision;if(O instanceof tn)Vs(S,P,M,L,null,!1,!1,O.tileCoords,O.flippedWindingOrder,$);else if(Z){const[Q,ae,se]=S.stencilConfigForOverlapTwoPass(L);Vs(S,P,M,se,Q,!1,!0,Yp,!1,$),Vs(S,P,M,se,ae,!0,!0,Yp,!1,$)}else{const[Q,ae]=S.getStencilConfigForOverlapAndUpdateStencilID(L);Vs(S,P,M,ae,Q,!1,!0,Yp,!1,$)}}(n,a,f,m,v):s.cj(f)?function(S,P,M,L,z){const $=M.paint.get("background-color"),O=M.paint.get("background-opacity");if(O===0)return;const{isRenderingToTexture:Z}=z,Q=S.context,ae=Q.gl,se=S.style.projection,le=S.transform,ue=le.tileSize,ge=M.paint.get("background-pattern");if(S.isPatternMissing(ge))return;const he=!ge&&$.a===1&&O===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==he)return;const _e=zt.disabled,be=S.getDepthModeForSublayer(0,he==="opaque"?Bt.ReadWrite:Bt.ReadOnly),me=S.colorModeForRenderPass(),Ce=S.useProgram(ge?"backgroundPattern":"background"),Ne=L||Fe(le,{tileSize:ue,terrain:S.style.map.terrain});ge&&(Q.activeTexture.set(ae.TEXTURE0),S.imageManager.bind(S.context));const Ae=M.getCrossfadeParameters();for(const Ie of Ne){const je=le.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),ht=ge?rx(O,S,ge,{tileID:Ie,tileSize:ue},Ae):Sh(O,$),ct=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ie),Ye=se.getMeshFromTileID(Q,Ie.canonical,!1,!0,"raster");Ce.draw(Q,ae.TRIANGLES,be,_e,me,Ot.backCCW,ht,ct,je,M.id,Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}}(n,0,f,m,v):s.ck(f)&&function(S,P,M,L){const{isRenderingGlobe:z}=L,$=S.context,O=M.implementation,Z=S.style.projection,Q=S.transform,ae=Q.getProjectionDataForCustomLayer(z),se={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:Z.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Z.shaderPreludeCode.vertexSource}`,define:Z.shaderDefine},defaultProjectionData:ae},le=O.renderingMode?O.renderingMode:"2d";if(S.renderPass==="offscreen"){const ue=O.prerender;ue&&(S.setCustomLayerDefaults(),$.setColorMode(S.colorModeForRenderPass()),ue.call(O,$.gl,se),$.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),$.setColorMode(S.colorModeForRenderPass()),$.setStencilMode(zt.disabled);const ue=le==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Bt.ReadOnly);$.setDepthMode(ue),O.render($.gl,se),$.setDirty(),S.setBaseState(),$.bindFramebuffer.set(null)}}(n,0,f,v))}saveTileTexture(n){const a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const a=this._tileTextures[n];return a&&a.length>0?a.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const a=this.imageManager.getPattern(n.from.toString()),f=this.imageManager.getPattern(n.to.toString());return!a||!f}useProgram(n,a,f=!1,m=[]){this.cache=this.cache||{};const v=!!this.style.map.terrain,S=this.style.projection,P=f?zo.projectionMercator:S.shaderPreludeCode,M=f?Ta:S.shaderDefine,L=n+(a?a.cacheKey:"")+`/${f?Ep:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(v?"/terrain":"")+(m?`/${m.join("/")}`:"");return this.cache[L]||(this.cache[L]=new _h(this.context,zo[n],a,Ug[n],this._showOverdrawInspector,v,P,M,m)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:a}=this.context.gl;return this.width!==n||this.height!==a}}function jh(y,n){let a,f=!1,m=null,v=null;const S=()=>{m=null,f&&(y.apply(v,a),m=setTimeout(S,n),f=!1)};return(...P)=>(f=!0,v=this,a=P,m||S(),m)}class Yc{constructor(n){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let f;return a.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(f=m)}),(f&&f[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:f,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const f=a.join("/");let m=f;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${f}`);let v=window.location.hash.replace(m,"");v.startsWith("#&")?v=v.slice(0,1)+v.slice(2):v==="#"&&(v="");let S=window.location.href.replace(/(#.+)?$/,v);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=jh(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const a=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,m=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,m),S=Math.round(a.lng*v)/v,P=Math.round(a.lat*v)/v,M=this._map.getBearing(),L=this._map.getPitch();let z="";if(z+=n?`/${S}/${P}/${f}`:`${f}/${P}/${S}`,(M||L)&&(z+="/"+Math.round(10*M)/10),L&&(z+=`/${Math.round(L)}`),this._hashName){const $=this._hashName;let O=!1;const Z=window.location.hash.slice(1).split("&").map(Q=>{const ae=Q.split("=")[0];return ae===$?(O=!0,`${ae}=${z}`):Q}).filter(Q=>Q);return O||Z.push(`${$}=${z}`),`#${Z.join("&")}`}return`#${z}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new s.S(+n[2],+n[1])}catch{return!1}const a=+n[0],f=+(n[3]||0),m=+(n[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&f>=-180&&f<=180&&m>=this._map.getMinPitch()&&m<=this._map.getMaxPitch()}}const Sl={linearity:.3,easing:s.cl(0,0,.3,1)},Tl=s.e({deceleration:2500,maxSpeed:1400},Sl),Jp=s.e({deceleration:20,maxSpeed:1400},Sl),Qc=s.e({deceleration:1e3,maxSpeed:360},Sl),ef=s.e({deceleration:1e3,maxSpeed:90},Sl),sy=s.e({deceleration:1e3,maxSpeed:360},Sl);class ay{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:I.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,a=I.now();for(;n.length>0&&a-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)a.zoom+=v.zoomDelta||0,a.bearing+=v.bearingDelta||0,a.pitch+=v.pitchDelta||0,a.roll+=v.rollDelta||0,v.panDelta&&a.pan._add(v.panDelta),v.around&&(a.around=v.around),v.pinchAround&&(a.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(a.pan.mag()){const v=Pl(a.pan.mag(),f,s.e({},Tl,n||{})),S=a.pan.mult(v.amount/a.pan.mag()),P=this._map.cameraHelper.handlePanInertia(S,this._map.transform);m.center=P.easingCenter,m.offset=P.easingOffset,Cl(m,v)}if(a.zoom){const v=Pl(a.zoom,f,Jp);m.zoom=this._map.transform.zoom+v.amount,Cl(m,v)}if(a.bearing){const v=Pl(a.bearing,f,Qc);m.bearing=this._map.transform.bearing+s.ag(v.amount,-179,179),Cl(m,v)}if(a.pitch){const v=Pl(a.pitch,f,ef);m.pitch=this._map.transform.pitch+v.amount,Cl(m,v)}if(a.roll){const v=Pl(a.roll,f,sy);m.roll=this._map.transform.roll+s.ag(v.amount,-179,179),Cl(m,v)}if(m.zoom||m.bearing){const v=a.pinchAround===void 0?a.around:a.pinchAround;m.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),s.e(m,{noMoveStart:!0})}}function Cl(y,n){(!y.duration||y.duration<n.duration)&&(y.duration=n.duration,y.easing=n.easing)}function Pl(y,n,a){const{maxSpeed:f,linearity:m,deceleration:v}=a,S=s.ag(y*m/(n/1e3),-f,f),P=Math.abs(S)/(v*m);return{easing:a.easing,duration:1e3*P,amount:S*(P/2)}}class bi extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,f,m={}){f=f instanceof MouseEvent?f:new MouseEvent(n,f);const v=A.mousePos(a.getCanvas(),f),S=a.unproject(v);super(n,s.e({point:v,lngLat:S,originalEvent:f},m)),this._defaultPrevented=!1,this.target=a}}class ho extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,f){const m=n==="touchend"?f.changedTouches:f.touches,v=A.touchPos(a.getCanvasContainer(),m),S=v.map(M=>a.unproject(M)),P=v.reduce((M,L,z,$)=>M.add(L.div($.length)),new s.P(0,0));super(n,{points:v,point:P,lngLats:S,lngLat:a.unproject(P),originalEvent:f}),this._defaultPrevented=!1}}class tf extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,f){super(n,{originalEvent:f}),this._defaultPrevented=!1}}class ly{constructor(n,a){this._map=n,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new tf(n.type,this._map,n))}mousedown(n,a){return this._mousedownPos=a,this._firePreventable(new bi(n.type,this._map,n))}mouseup(n){this._map.fire(new bi(n.type,this._map,n))}click(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new bi(n.type,this._map,n))}dblclick(n){return this._firePreventable(new bi(n.type,this._map,n))}mouseover(n){this._map.fire(new bi(n.type,this._map,n))}mouseout(n){this._map.fire(new bi(n.type,this._map,n))}touchstart(n){return this._firePreventable(new ho(n.type,this._map,n))}touchmove(n){this._map.fire(new ho(n.type,this._map,n))}touchend(n){this._map.fire(new ho(n.type,this._map,n))}touchcancel(n){this._map.fire(new ho(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cy{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new bi(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new bi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class El{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(s.P.convert(n),this._map.terrain)}}class rf{constructor(n,a){this._map=n,this._tr=new El(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(A.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(n,a){if(!this._active)return;const f=a;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=f,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const v=Math.min(m.x,f.x),S=Math.max(m.x,f.x),P=Math.min(m.y,f.y),M=Math.max(m.y,f.y);A.setTransform(this._box,`translate(${v}px,${P}px)`),this._box.style.width=S-v+"px",this._box.style.height=M-P+"px"}mouseupWindow(n,a){if(!this._active||n.button!==0)return;const f=this._startPos,m=a;if(this.reset(),A.suppressClick(),f.x!==m.x||f.y!==m.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(f,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,a){return this._map.fire(new s.l(n,{originalEvent:a}))}}function Oh(y,n){if(y.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${n.length}`);const a={};for(let f=0;f<y.length;f++)a[y[f].identifier]=n[f];return a}class uy{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,a,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=function(m){const v=new s.P(0,0);for(const S of m)v._add(S);return v.div(m.length)}(a),this.touches=Oh(f,a)))}touchmove(n,a,f){if(this.aborted||!this.centroid)return;const m=Oh(f,a);for(const v in this.touches){const S=m[v];(!S||S.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(n,a,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class Fh{constructor(n){this.singleTap=new uy(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,a,f){this.singleTap.touchstart(n,a,f)}touchmove(n,a,f){this.singleTap.touchmove(n,a,f)}touchend(n,a,f){const m=this.singleTap.touchend(n,a,f);if(m){const v=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(m)<30;if(v&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class Bh{constructor(n){this._tr=new El(n),this._zoomIn=new Fh({numTouches:1,numTaps:2}),this._zoomOut=new Fh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,a,f){this._zoomIn.touchstart(n,a,f),this._zoomOut.touchstart(n,a,f)}touchmove(n,a,f){this._zoomIn.touchmove(n,a,f),this._zoomOut.touchmove(n,a,f)}touchend(n,a,f){const m=this._zoomIn.touchend(n,a,f),v=this._zoomOut.touchend(n,a,f),S=this._tr;return m?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(m)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ml{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const a=this._moveFunction(...n);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(n,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,a){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const m=Array.isArray(a)?a[0]:a;return!this._moved&&m.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(f,m))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&A.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ji=0,po=2,hy={[Ji]:1,[po]:2};class li{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const a=A.mouseButton(n);this._eventButton=a}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(a,f){const m=hy[f];return a.buttons===void 0||(a.buttons&m)!==m}(n,this._eventButton)}isValidEndEvent(n){return A.mouseButton(n)===this._eventButton}}class kl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class hx{constructor(n=new li({checkCorrectEvent:()=>!0}),a=new kl){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(n,a,f){return n instanceof MouseEvent?a(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?f(n):void 0}startMove(n){this._executeRelevantHandler(n,a=>this.mouseMoveStateManager.startMove(a),a=>this.oneFingerTouchMoveStateManager.startMove(a))}endMove(n){this._executeRelevantHandler(n,a=>this.mouseMoveStateManager.endMove(a),a=>this.oneFingerTouchMoveStateManager.endMove(a))}isValidStartEvent(n){return this._executeRelevantHandler(n,a=>this.mouseMoveStateManager.isValidStartEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a))}isValidMoveEvent(n){return this._executeRelevantHandler(n,a=>this.mouseMoveStateManager.isValidMoveEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a))}isValidEndEvent(n){return this._executeRelevantHandler(n,a=>this.mouseMoveStateManager.isValidEndEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a))}}const $h=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=n=>{n.preventDefault()}};class dx{constructor(n,a){this._clickTolerance=n.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,a,f){return this._calculateTransform(n,a,f)}touchmove(n,a,f){if(this._active){if(!this._shouldBePrevented(f.length))return n.preventDefault(),this._calculateTransform(n,a,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,a,f){this._calculateTransform(n,a,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,a,f){f.length>0&&(this._active=!0);const m=Oh(f,a),v=new s.P(0,0),S=new s.P(0,0);let P=0;for(const L in m){const z=m[L],$=this._touches[L];$&&(v._add(z),S._add(z.sub($)),P++,m[L]=z)}if(this._touches=m,this._shouldBePrevented(P)||!S.mag())return;const M=S.div(P);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(P),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nf{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,a,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([a[0],a[1]]))}touchmove(n,a,f){if(!this._firstTwoTouches)return;n.preventDefault();const[m,v]=this._firstTwoTouches,S=Jc(f,a,m),P=Jc(f,a,v);if(!S||!P)return;const M=this._aroundCenter?null:S.add(P).div(2);return this._move([S,P],M,n)}touchend(n,a,f){if(!this._firstTwoTouches)return;const[m,v]=this._firstTwoTouches,S=Jc(f,a,m),P=Jc(f,a,v);S&&P||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Jc(y,n,a){for(let f=0;f<y.length;f++)if(y[f].identifier===a)return n[f]}function Al(y,n){return Math.log(y/n)/Math.LN2}class Oo extends nf{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,a){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Al(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Al(this._distance,f),pinchAround:a}}}function _t(y,n){return 180*y.angleWith(n)/Math.PI}class of extends nf{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,a,f){const m=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_t(this._vector,m),pinchAround:a}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const a=25/(Math.PI*this._minDiameter)*360,f=_t(n,this._startVector);return Math.abs(f)<a}}function eu(y){return Math.abs(y.y)>Math.abs(y.x)}class sf extends nf{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,a,f){super.touchstart(n,a,f),this._currentTouchCount=f.length}_start(n){this._lastPoints=n,eu(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,a,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const m=n[0].sub(this._lastPoints[0]),v=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,v,f.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(m.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(n,a,f){if(this._valid!==void 0)return this._valid;const m=n.mag()>=2,v=a.mag()>=2;if(!m&&!v)return;if(!m||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=n.y>0==a.y>0;return eu(n)&&eu(a)&&S}}const tu={panStep:100,bearingStep:15,pitchStep:10};class Il{constructor(n){this._tr=new El(n);const a=tu;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let a=0,f=0,m=0,v=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,m=0),{cameraAnimation:P=>{const M=this._tr;P.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:a?Math.round(M.zoom)+a*(n.shiftKey?2:1):M.zoom,bearing:M.bearing+f*this._bearingStep,pitch:M.pitch+m*this._pitchStep,offset:[-v*this._panStep,-S*this._panStep],center:M.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function af(y){return y*(2-y)}const er=4.000244140625,lf=1/450;class dy{constructor(n,a){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=n,this._tr=new El(n),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=lf}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let a=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=I.now(),m=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,a!==0&&a%er==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(m*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=A.mousePos(this._map.getCanvas(),n),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(s.S.convert(f.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const P=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=P),typeof this._targetZoom=="number"&&(this._targetZoom+=P)}if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>er?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&M!==0&&(M=1/M);const L=typeof this._targetZoom!="number"?n.scale:s.ae(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),s.aj(L*M)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,f=this._startZoom,m=this._easing;let v,S=!1;if(this._type==="wheel"&&f&&m){const P=I.now()-this._lastWheelEventTime,M=Math.min((P+5)/200,1),L=m(M);v=s.C.number(f,a,L),M<1?this._frameId||(this._frameId=!0):S=!0}else v=a,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=v,{noInertia:!0,needsRenderFrame:!S,zoomDelta:v-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let a=s.cn;if(this._prevEase){const f=this._prevEase,m=(I.now()-f.start)/f.duration,v=f.easing(m+.01)-f.easing(m),S=.27/Math.sqrt(v*v+1e-4)*.01,P=Math.sqrt(.0729-S*S);a=s.cl(S,P,.25,1)}return this._prevEase={start:I.now(),duration:n,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Vh{constructor(n,a){this._clickZoom=n,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class px{constructor(n){this._tr=new El(n),this.reset()}reset(){this._active=!1}dblclick(n,a){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fx{constructor(){this._tap=new Fh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,a,f){if(!this._swipePoint)if(this._tapTime){const m=a[0],v=n.timeStamp-this._tapTime<500,S=this._tapPoint.dist(m)<30;v&&S?f.length>0&&(this._swipePoint=m,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(n,a,f)}touchmove(n,a,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const m=a[0],v=m.y-this._swipePoint.y;return this._swipePoint=m,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,a,f)}touchend(n,a,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const m=this._tap.touchend(n,a,f);m&&(this._tapTime=n.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cf{constructor(n,a,f){this._el=n,this._mousePan=a,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Uh{constructor(n,a,f,m){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=a,this._mousePitch=f,this._mouseRoll=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class uf{constructor(n,a,f,m){this._el=n,this._touchZoom=a,this._touchRotate=f,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class py{constructor(n,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",n);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=a,this._container.appendChild(m);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=f,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,a){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:n,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ru=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class mx extends s.l{}function hf(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class Gs{constructor(n,a){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,v)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=m.type==="renderFrame"?void 0:m,P={needsRenderFrame:!1},M={},L={};for(const{handlerName:O,handler:Z,allowed:Q}of this._handlers){if(!Z.isEnabled())continue;let ae;if(this._blockedByActive(L,Q,O))Z.reset();else if(Z[v||m.type]){if(s.co(m,v||m.type)){const se=A.mousePos(this._map.getCanvas(),m);ae=Z[v||m.type](m,se)}else if(s.cp(m,v||m.type)){const se=this._getMapTouches(m.touches),le=A.touchPos(this._map.getCanvas(),se);ae=Z[v||m.type](m,le,se)}else s.cq(v||m.type)||(ae=Z[v||m.type](m));this.mergeHandlerResult(P,M,ae,O,S),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()}(ae||Z.isActive())&&(L[O]=Z)}const z={};for(const O in this._previousActiveHandlers)L[O]||(z[O]=S);this._previousActiveHandlers=L,(Object.keys(z).length||hf(P))&&(this._changes.push([P,M,z]),this._triggerRenderFrame()),(Object.keys(L).length||hf(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=P;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ay(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,v,S]of this._listeners)A.addEventListener(m,v,m===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[n,a,f]of this._listeners)A.removeEventListener(n,a,n===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(n){const a=this._map,f=a.getCanvasContainer();this._add("mapEvent",new ly(a,n));const m=a.boxZoom=new rf(a,n);this._add("boxZoom",m),n.interactive&&n.boxZoom&&m.enable();const v=a.cooperativeGestures=new py(a,n.cooperativeGestures);this._add("cooperativeGestures",v),n.cooperativeGestures&&v.enable();const S=new Bh(a),P=new px(a);a.doubleClickZoom=new Vh(P,S),this._add("tapZoom",S),this._add("clickZoom",P),n.interactive&&n.doubleClickZoom&&a.doubleClickZoom.enable();const M=new fx;this._add("tapDragZoom",M);const L=a.touchPitch=new sf(a);this._add("touchPitch",L),n.interactive&&n.touchPitch&&a.touchPitch.enable(n.touchPitch);const z=()=>a.project(a.getCenter()),$=function({enable:he,clickTolerance:_e,aroundCenter:be=!0,minPixelCenterThreshold:me=100,rotateDegreesPerPixelMoved:Ce=.8},Ne){const Ae=new li({checkCorrectEvent:Ie=>A.mouseButton(Ie)===0&&Ie.ctrlKey||A.mouseButton(Ie)===2&&!Ie.ctrlKey});return new Ml({clickTolerance:_e,move:(Ie,je)=>{const ht=Ne();if(be&&Math.abs(ht.y-Ie.y)>me)return{bearingDelta:s.cm(new s.P(Ie.x,je.y),je,ht)};let ct=(je.x-Ie.x)*Ce;return be&&je.y<ht.y&&(ct=-ct),{bearingDelta:ct}},moveStateManager:Ae,enable:he,assignEvents:$h})}(n,z),O=function({enable:he,clickTolerance:_e,pitchDegreesPerPixelMoved:be=-.5}){const me=new li({checkCorrectEvent:Ce=>A.mouseButton(Ce)===0&&Ce.ctrlKey||A.mouseButton(Ce)===2});return new Ml({clickTolerance:_e,move:(Ce,Ne)=>({pitchDelta:(Ne.y-Ce.y)*be}),moveStateManager:me,enable:he,assignEvents:$h})}(n),Z=function({enable:he,clickTolerance:_e,rollDegreesPerPixelMoved:be=.3},me){const Ce=new li({checkCorrectEvent:Ne=>A.mouseButton(Ne)===2&&Ne.ctrlKey});return new Ml({clickTolerance:_e,move:(Ne,Ae)=>{const Ie=me();let je=(Ae.x-Ne.x)*be;return Ae.y<Ie.y&&(je=-je),{rollDelta:je}},moveStateManager:Ce,enable:he,assignEvents:$h})}(n,z);a.dragRotate=new Uh(n,$,O,Z),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",O,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Z,["mousePitch"]),n.interactive&&n.dragRotate&&a.dragRotate.enable();const Q=function({enable:he,clickTolerance:_e}){const be=new li({checkCorrectEvent:me=>A.mouseButton(me)===0&&!me.ctrlKey});return new Ml({clickTolerance:_e,move:(me,Ce)=>({around:Ce,panDelta:Ce.sub(me)}),activateOnStart:!0,moveStateManager:be,enable:he,assignEvents:$h})}(n),ae=new dx(n,a);a.dragPan=new cf(f,Q,ae),this._add("mousePan",Q),this._add("touchPan",ae,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&a.dragPan.enable(n.dragPan);const se=new of,le=new Oo;a.touchZoomRotate=new uf(f,le,se,M),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&a.touchZoomRotate.enable(n.touchZoomRotate);const ue=a.scrollZoom=new dy(a,()=>this._triggerRenderFrame());this._add("scrollZoom",ue,["mousePan"]),n.interactive&&n.scrollZoom&&a.scrollZoom.enable(n.scrollZoom);const ge=a.keyboard=new Il(a);this._add("keyboard",ge),n.interactive&&n.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new cy(a))}_add(n,a,f){this._handlers.push({handlerName:n,handler:a,allowed:f}),this._handlersById[n]=a}stop(n){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ru(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,a,f){for(const m in n)if(m!==f&&(!a||a.indexOf(m)<0))return!0;return!1}_getMapTouches(n){const a=[];for(const f of n)this._el.contains(f.target)&&a.push(f);return a}mergeHandlerResult(n,a,f,m,v){if(!f)return;s.e(n,f);const S={handlerName:m,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(a.zoom=S),f.panDelta!==void 0&&(a.drag=S),f.rollDelta!==void 0&&(a.roll=S),f.pitchDelta!==void 0&&(a.pitch=S),f.bearingDelta!==void 0&&(a.rotate=S)}_applyChanges(){const n={},a={},f={};for(const[m,v,S]of this._changes)m.panDelta&&(n.panDelta=(n.panDelta||new s.P(0,0))._add(m.panDelta)),m.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+m.pitchDelta),m.rollDelta&&(n.rollDelta=(n.rollDelta||0)+m.rollDelta),m.around!==void 0&&(n.around=m.around),m.pinchAround!==void 0&&(n.pinchAround=m.pinchAround),m.noInertia&&(n.noInertia=m.noInertia),s.e(a,v),s.e(f,S);this._updateMapTransform(n,a,f),this._changes=[]}_updateMapTransform(n,a,f){const m=this._map,v=m._getTransformForUpdate(),S=m.terrain;if(!(hf(n)||S&&this._terrainMovement))return this._fireEvents(a,f,!0);m._stop(!0);let{panDelta:P,zoomDelta:M,bearingDelta:L,pitchDelta:z,rollDelta:$,around:O,pinchAround:Z}=n;Z!==void 0&&(O=Z),O=O||m.transform.centerPoint,S&&!v.isPointOnMapSurface(O)&&(O=v.centerPoint);const Q={panDelta:P,zoomDelta:M,rollDelta:$,pitchDelta:z,bearingDelta:L,around:O};this._map.cameraHelper.useGlobeControls&&!v.isPointOnMapSurface(O)&&(O=v.centerPoint);const ae=O.distSqr(v.centerPoint)<.01?v.center:v.screenPointToLocation(P?O.sub(P):O);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,v),this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?v.setCenter(v.screenPointToLocation(v.centerPoint.sub(P))):this._map.cameraHelper.handleMapControlsPan(Q,v,ae):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Q,v,ae))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,v),this._map.cameraHelper.handleMapControlsPan(Q,v,ae)),m._applyUpdatedTransform(v),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,f,!0)}_fireEvents(n,a,f){const m=ru(this._eventsInProgress),v=ru(n),S={};for(const $ in n){const{originalEvent:O}=n[$];this._eventsInProgress[$]||(S[`${$}start`]=O),this._eventsInProgress[$]=n[$]}!m&&v&&this._fireEvent("movestart",v.originalEvent);for(const $ in S)this._fireEvent($,S[$]);v&&this._fireEvent("move",v.originalEvent);for(const $ in n){const{originalEvent:O}=n[$];this._fireEvent($,O)}const P={};let M;for(const $ in this._eventsInProgress){const{handlerName:O,originalEvent:Z}=this._eventsInProgress[$];this._handlersById[O].isActive()||(delete this._eventsInProgress[$],M=a[O]||Z,P[`${$}end`]=M)}for(const $ in P)this._fireEvent($,P[$]);const L=ru(this._eventsInProgress),z=(m||v)&&!L;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(f&&z){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),O=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!$||!$.essential&&I.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:M})),O(this._map.getBearing())&&this._map.resetNorth()):(O($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(n,a){this._map.fire(new s.l(n,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new mx("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Rr extends s.E{constructor(n,a,f){super(),this._renderFrameCallback=()=>{const m=Math.min((I.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=f.bearingSnap,this.cameraHelper=a,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(n,a){n.apply(this.transform),this.transform=n,this.cameraHelper=a}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,a){return this.jumpTo({center:n},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,a){return this.jumpTo({elevation:n},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,a,f){return n=s.P.convert(n).mult(-1),this.panTo(this.transform.center,s.e({offset:n},a),f)}panTo(n,a,f){return this.easeTo(s.e({center:n},a),f)}getZoom(){return this.transform.zoom}setZoom(n,a){return this.jumpTo({zoom:n},a),this}zoomTo(n,a,f){return this.easeTo(s.e({zoom:n},a),f)}zoomIn(n,a){return this.zoomTo(this.getZoom()+1,n,a),this}zoomOut(n,a){return this.zoomTo(this.getZoom()-1,n,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,a){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new s.l("movestart",a)).fire(new s.l("move",a)).fire(new s.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(n,a){return this.jumpTo({bearing:n},a),this}getPadding(){return this.transform.padding}setPadding(n,a){return this.jumpTo({padding:n},a),this}rotateTo(n,a,f){return this.easeTo(s.e({bearing:n},a),f)}resetNorth(n,a){return this.rotateTo(0,s.e({duration:1e3},n),a),this}resetNorthPitch(n,a){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},n),a),this}snapToNorth(n,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,a):this}getPitch(){return this.transform.pitch}setPitch(n,a){return this.jumpTo({pitch:n},a),this}getRoll(){return this.transform.roll}setRoll(n,a){return this.jumpTo({roll:n},a),this}cameraForBounds(n,a){n=vr.convert(n).adjustAntiMeridian();const f=a&&a.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),f,a)}_cameraForBoxAndBearing(n,a,f,m){const v={top:0,bottom:0,right:0,left:0};if(typeof(m=s.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const L=m.padding;m.padding={top:L,bottom:L,right:L,left:L}}const S=s.e(v,m.padding);m.padding=S;const P=this.transform,M=new vr(n,a);return this.cameraHelper.cameraForBoxAndBearing(m,S,M,f,P)}fitBounds(n,a,f){return this._fitInternal(this.cameraForBounds(n,a),a,f)}fitScreenCoordinates(n,a,f,m,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(n)),this.transform.screenPointToLocation(s.P.convert(a)),f,m),m,v)}_fitInternal(n,a,f){return n?(delete(a=s.e(n,a)).padding,a.linear?this.easeTo(a,f):this.flyTo(a,f)):this}jumpTo(n,a){this.stop();const f=this._getTransformForUpdate();let m=!1,v=!1,S=!1;const P=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,n);const M=f.zoom!==P;return"elevation"in n&&f.elevation!==+n.elevation&&f.setElevation(+n.elevation),"bearing"in n&&f.bearing!==+n.bearing&&(m=!0,f.setBearing(+n.bearing)),"pitch"in n&&f.pitch!==+n.pitch&&(v=!0,f.setPitch(+n.pitch)),"roll"in n&&f.roll!==+n.roll&&(S=!0,f.setRoll(+n.roll)),n.padding==null||f.isPaddingEqual(n.padding)||f.setPadding(n.padding),this._applyUpdatedTransform(f),this.fire(new s.l("movestart",a)).fire(new s.l("move",a)),M&&this.fire(new s.l("zoomstart",a)).fire(new s.l("zoom",a)).fire(new s.l("zoomend",a)),m&&this.fire(new s.l("rotatestart",a)).fire(new s.l("rotate",a)).fire(new s.l("rotateend",a)),v&&this.fire(new s.l("pitchstart",a)).fire(new s.l("pitch",a)).fire(new s.l("pitchend",a)),S&&this.fire(new s.l("rollstart",a)).fire(new s.l("roll",a)).fire(new s.l("rollend",a)),this.fire(new s.l("moveend",a))}calculateCameraOptionsFromTo(n,a,f,m=0){const v=s.a0.fromLngLat(n,a),S=s.a0.fromLngLat(f,m),P=S.x-v.x,M=S.y-v.y,L=S.z-v.z,z=Math.hypot(P,M,L);if(z===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(P,M),O=s.aj(this.transform.cameraToCenterDistance/z/this.transform.tileSize),Z=180*Math.atan2(P,-M)/Math.PI;let Q=180*Math.acos($/z)/Math.PI;return Q=L<0?90-Q:90+Q,{center:S.toLngLat(),elevation:m,zoom:O,pitch:Q,bearing:Z}}calculateCameraOptionsFromCameraLngLatAltRotation(n,a,f,m,v){const S=this.transform.calculateCenterFromCameraLngLatAlt(n,a,f,m);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:m,roll:v}}easeTo(n,a){this._stop(!1,n.easeId),((n=s.e({offset:[0,0],duration:500,easing:s.cn},n)).animate===!1||!n.essential&&I.prefersReducedMotion)&&(n.duration=0);const f=this._getTransformForUpdate(),m=this.getBearing(),v=f.pitch,S=f.roll,P="bearing"in n?this._normalizeBearing(n.bearing,m):m,M="pitch"in n?+n.pitch:v,L="roll"in n?this._normalizeBearing(n.roll,S):S,z="padding"in n?n.padding:f.padding,$=s.P.convert(n.offset);let O,Z;n.around&&(O=s.S.convert(n.around),Z=f.locationToScreenPoint(O));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ae=this.cameraHelper.handleEaseTo(f,{bearing:P,pitch:M,roll:L,padding:z,around:O,aroundPoint:Z,offsetAsPoint:$,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||m!==P,this._pitching=this._pitching||M!==v,this._rolling=this._rolling||L!==S,this._padding=!f.isPaddingEqual(z),this._zooming=this._zooming||ae.isZooming,this._easeId=n.easeId,this._prepareEase(a,n.noMoveStart,Q),this.terrain&&this._prepareElevation(ae.elevationCenter),this._ease(se=>{ae.easeFunc(se),this.terrain&&!n.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(f),this._fireMoveEvents(a)},se=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(a,se)},n),this}_prepareEase(n,a,f={}){this._moving=!0,a||f.moving||this.fire(new s.l("movestart",n)),this._zooming&&!f.zooming&&this.fire(new s.l("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new s.l("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new s.l("pitchstart",n)),this._rolling&&!f.rolling&&this.fire(new s.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&a!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(f-(a-(f*n+this._elevationStart))/(1-n)),this._elevationTarget=a}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const a=n.getCameraLngLat(),f=n.getCameraAltitude(),m=this.terrain?this.terrain.getElevationForLngLatZoom(a,n.zoom):0;if(f<m){const v=this.calculateCameraOptionsFromTo(a,m,n.center,n.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(n){const a=[];if(a.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&a.push(m=>this.transformCameraUpdate(m)),!a.length)return;const f=n.clone();for(const m of a){const v=f.clone(),{center:S,zoom:P,roll:M,pitch:L,bearing:z,elevation:$}=m(v);S&&v.setCenter(S),$!==void 0&&v.setElevation($),P!==void 0&&v.setZoom(P),M!==void 0&&v.setRoll(M),L!==void 0&&v.setPitch(L),z!==void 0&&v.setBearing(z),f.apply(v)}this.transform.apply(f)}_fireMoveEvents(n){this.fire(new s.l("move",n)),this._zooming&&this.fire(new s.l("zoom",n)),this._rotating&&this.fire(new s.l("rotate",n)),this._pitching&&this.fire(new s.l("pitch",n)),this._rolling&&this.fire(new s.l("roll",n))}_afterEase(n,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const f=this._zooming,m=this._rotating,v=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new s.l("zoomend",n)),m&&this.fire(new s.l("rotateend",n)),v&&this.fire(new s.l("pitchend",n)),S&&this.fire(new s.l("rollend",n)),this.fire(new s.l("moveend",n))}flyTo(n,a){if(!n.essential&&I.prefersReducedMotion){const je=s.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(je,a)}this.stop(),n=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cn},n);const f=this._getTransformForUpdate(),m=f.bearing,v=f.pitch,S=f.roll,P=f.padding,M="bearing"in n?this._normalizeBearing(n.bearing,m):m,L="pitch"in n?+n.pitch:v,z="roll"in n?this._normalizeBearing(n.roll,S):S,$="padding"in n?n.padding:f.padding,O=s.P.convert(n.offset);let Z=f.centerPoint.add(O);const Q=f.screenPointToLocation(Z),ae=this.cameraHelper.handleFlyTo(f,{bearing:M,pitch:L,roll:z,padding:$,locationAtOffset:Q,offsetAsPoint:O,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let se=n.curve;const le=Math.max(f.width,f.height),ue=le/ae.scaleOfZoom,ge=ae.pixelPathLength;typeof ae.scaleOfMinZoom=="number"&&(se=Math.sqrt(le/ae.scaleOfMinZoom/ge*2));const he=se*se;function _e(je){const ht=(ue*ue-le*le+(je?-1:1)*he*he*ge*ge)/(2*(je?ue:le)*he*ge);return Math.log(Math.sqrt(ht*ht+1)-ht)}function be(je){return(Math.exp(je)-Math.exp(-je))/2}function me(je){return(Math.exp(je)+Math.exp(-je))/2}const Ce=_e(!1);let Ne=function(je){return me(Ce)/me(Ce+se*je)},Ae=function(je){return le*((me(Ce)*(be(ht=Ce+se*je)/me(ht))-be(Ce))/he)/ge;var ht},Ie=(_e(!0)-Ce)/se;if(Math.abs(ge)<2e-6||!isFinite(Ie)){if(Math.abs(le-ue)<1e-6)return this.easeTo(n,a);const je=ue<le?-1:1;Ie=Math.abs(Math.log(ue/le))/se,Ae=()=>0,Ne=ht=>Math.exp(je*se*ht)}return n.duration="duration"in n?+n.duration:1e3*Ie/("screenSpeed"in n?+n.screenSpeed/se:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=m!==M,this._pitching=L!==v,this._rolling=z!==S,this._padding=!f.isPaddingEqual($),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ae.targetCenter),this._ease(je=>{const ht=je*Ie,ct=1/Ne(ht),Ye=Ae(ht);this._rotating&&f.setBearing(s.C.number(m,M,je)),this._pitching&&f.setPitch(s.C.number(v,L,je)),this._rolling&&f.setRoll(s.C.number(S,z,je)),this._padding&&(f.interpolatePadding(P,$,je),Z=f.centerPoint.add(O)),ae.easeFunc(je,ct,Ye,Z),this.terrain&&!n.freezeElevation&&this._updateElevation(je),this._applyUpdatedTransform(f),this._fireMoveEvents(a)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,a){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,a)}return n||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(n,a,f){f.animate===!1||f.duration===0?(n(1),a()):(this._easeStart=I.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,a){n=s.aN(n,-180,180);const f=Math.abs(n-a);return Math.abs(n-360-a)<f&&(n-=360),Math.abs(n+360-a)<f&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(n),this.transform.tileZoom):null}}const nu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Gh{constructor(n=nu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,a){const f=this._map._getUIString(`AttributionControl.${a}`);n.title=f,n.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const a=this._map.style.sourceCaches;for(const m in a){const v=a[m];if(v.used||v.usedForTerrain){const S=v.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n=n.filter(m=>String(m).trim()),n.sort((m,v)=>m.length-v.length),n=n.filter((m,v)=>{for(let S=v+1;S<n.length;S++)if(n[S].indexOf(m)>=0)return!1;return!0});const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=A.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class df{constructor(n={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const f=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const a=A.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class fy{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a}remove(n){const a=this._currentlyRunning,f=a?this._queue.concat(a):this._queue;for(const m of f)if(m.id===n)return void(m.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const f of a)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var my=s.aI([{name:"a_pos3d",type:"Int16",components:3}]);class gx extends s.E{constructor(n){super(),this._lastTilesetChange=I.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,a){this.sourceCache.update(n,a),this._renderableTilesKeys=[];const f={};for(const m of Fe(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.terrainRttPosMatrix32f=new Float64Array(16),s.bX(m.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[m.key]=new Ki(m,this.tileSize),this._lastTilesetChange=I.now());for(const m in this._tiles)f[m]||delete this._tiles[m]}freeRtt(n){for(const a in this._tiles){const f=this._tiles[a];(!n||f.tileID.equals(n)||f.tileID.isChildOf(n)||n.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,a){return a?this._getTerrainCoordsForTileRanges(n,a):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const a={};for(const f of this._renderableTilesKeys){const m=this._tiles[f].tileID,v=n.clone(),S=s.b9();if(m.canonical.equals(n.canonical))s.bX(S,0,s.$,s.$,0,0,1);else if(m.canonical.isChildOf(n.canonical)){const P=m.canonical.z-n.canonical.z,M=m.canonical.x-(m.canonical.x>>P<<P),L=m.canonical.y-(m.canonical.y>>P<<P),z=s.$>>P;s.bX(S,0,z,z,0,0,1),s.M(S,S,[-M*z,-L*z,0])}else{if(!n.canonical.isChildOf(m.canonical))continue;{const P=n.canonical.z-m.canonical.z,M=n.canonical.x-(n.canonical.x>>P<<P),L=n.canonical.y-(n.canonical.y>>P<<P),z=s.$>>P;s.bX(S,0,s.$,s.$,0,0,1),s.M(S,S,[M*z,L*z,0]),s.N(S,S,[1/2**P,1/2**P,0])}}v.terrainRttPosMatrix32f=new Float32Array(S),a[f]=v}return a}_getTerrainCoordsForTileRanges(n,a){const f={};for(const m of this._renderableTilesKeys){const v=this._tiles[m].tileID;if(!this._isWithinTileRanges(v,a))continue;const S=n.clone(),P=s.b9();if(v.canonical.z===n.canonical.z){const M=n.canonical.x-v.canonical.x,L=n.canonical.y-v.canonical.y;s.bX(P,0,s.$,s.$,0,0,1),s.M(P,P,[M*s.$,L*s.$,0])}else if(v.canonical.z>n.canonical.z){const M=v.canonical.z-n.canonical.z,L=v.canonical.x-(v.canonical.x>>M<<M),z=v.canonical.y-(v.canonical.y>>M<<M),$=n.canonical.x-(v.canonical.x>>M),O=n.canonical.y-(v.canonical.y>>M),Z=s.$>>M;s.bX(P,0,Z,Z,0,0,1),s.M(P,P,[-L*Z+$*s.$,-z*Z+O*s.$,0])}else{const M=n.canonical.z-v.canonical.z,L=n.canonical.x-(n.canonical.x>>M<<M),z=n.canonical.y-(n.canonical.y>>M<<M),$=(n.canonical.x>>M)-v.canonical.x,O=(n.canonical.y>>M)-v.canonical.y,Z=s.$<<M;s.bX(P,0,Z,Z,0,0,1),s.M(P,P,[L*s.$+$*Z,z*s.$+O*Z,0])}S.terrainRttPosMatrix32f=new Float32Array(P),f[m]=S}return f}getSourceTile(n,a){const f=this.sourceCache._source;let m=n.overscaledZ-this.deltaZoom;if(m>f.maxzoom&&(m=f.maxzoom),m<f.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(m).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!v||!v.dem)&&a)for(;m>=f.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(n.scaledTo(m--).key);return v}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,a){return a[n.canonical.z]&&n.canonical.x>=a[n.canonical.z].minTileX&&n.canonical.x<=a[n.canonical.z].maxTileX&&n.canonical.y>=a[n.canonical.z].minTileY&&n.canonical.y<=a[n.canonical.z].maxTileY}}class Fo{constructor(n,a,f){this._meshCache={},this.painter=n,this.sourceCache=new gx(a),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,a,f,m=s.$){var v;if(!(a>=0&&a<m&&f>=0&&f<m))return 0;const S=this.getTerrainData(n),P=(v=S.tile)===null||v===void 0?void 0:v.dem;if(!P)return 0;const M=s.cr([],[a/m*s.$,f/m*s.$],S.u_terrain_matrix),L=[M[0]*P.dim,M[1]*P.dim],z=Math.floor(L[0]),$=Math.floor(L[1]),O=L[0]-z,Z=L[1]-$;return P.get(z,$)*(1-O)*(1-Z)+P.get(z+1,$)*O*(1-Z)+P.get(z,$+1)*(1-O)*Z+P.get(z+1,$+1)*O*Z}getElevationForLngLatZoom(n,a){if(!s.cs(a,n.wrap()))return 0;const{tileID:f,mercatorX:m,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(n,a);return this.getElevation(f,m%s.$,v%s.$,s.$)}getElevation(n,a,f,m=s.$){return this.getDEMElevation(n,a,f,m)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const m=this.painter.context,v=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(m,v,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(m,new s.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.af([])}const a=this.sourceCache.getSourceTile(n,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const m=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new s.T(m,a.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),a.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const f=a&&a+a.tileID.key+n.key;if(f&&!this._demMatrixCache[f]){const m=this.sourceCache.sourceCache._source.maxzoom;let v=n.canonical.z-a.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=m?v=n.canonical.z-m:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=n.canonical.x-(n.canonical.x>>v<<v),P=n.canonical.y-(n.canonical.y>>v<<v),M=s.ct(new Float64Array(16),[1/(s.$<<v),1/(s.$<<v),0]);s.M(M,M,[S*s.$,P*s.$,0]),this._demMatrixCache[n.key]={matrix:M,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(n){const a=this.painter,f=a.width/devicePixelRatio,m=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(a.context,{width:f,height:m,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(a.context,{width:f,height:m,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(f,m,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,f,m))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,S=0;v<this._coordsTextureSize;v++)for(let P=0;P<this._coordsTextureSize;P++,S+=4)a[S+0]=255&P,a[S+1]=255&v,a[S+2]=P>>8<<4|v>>8,a[S+3]=0;const f=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),m=new s.T(n,f,n.gl.RGBA,{premultiply:!1});return m.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),f=this.painter.context,m=f.gl,v=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),P=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(v,P-S-1,1,1,m.RGBA,m.UNSIGNED_BYTE,a),f.bindFramebuffer.set(null);const M=a[0]+(a[2]>>4<<8),L=a[1]+((15&a[2])<<8),z=this.coordsIndex[255-a[3]],$=z&&this.sourceCache.getTileByID(z);if(!$)return null;const O=this._coordsTextureSize,Z=(1<<$.tileID.canonical.z)*O;return new s.a0(($.tileID.canonical.x*O+M)/Z+$.tileID.wrap,($.tileID.canonical.y*O+L)/Z,this.getElevation($.tileID,M,L,O))}depthAtPoint(n){const a=new Uint8Array(4),f=this.painter.context,m=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,a),f.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(n){var a;const f=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,m=f&&n.canonical.y===0,v=f&&n.canonical.y===(1<<n.canonical.z)-1,S=`m_${m?"n":""}_${v?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const P=this.painter.context,M=new s.cu,L=new s.aM,z=this.meshSize,$=s.$/z,O=z*z;for(let me=0;me<=z;me++)for(let Ce=0;Ce<=z;Ce++)M.emplaceBack(Ce*$,me*$,0);for(let me=0;me<O;me+=z+1)for(let Ce=0;Ce<z;Ce++)L.emplaceBack(Ce+me,z+Ce+me+1,z+Ce+me+2),L.emplaceBack(Ce+me,z+Ce+me+2,Ce+me+1);const Z=M.length,Q=Z+(z+1),ae=(z+1)*z,se=m?s.bg:0,le=m?0:1,ue=v?s.bh:s.$,ge=v?0:1;for(let me=0;me<=z;me++)M.emplaceBack(me*$,se,le);for(let me=0;me<=z;me++)M.emplaceBack(me*$,ue,ge);for(let me=0;me<z;me++)L.emplaceBack(ae+me,Q+me,Q+me+1),L.emplaceBack(ae+me,Q+me+1,ae+me+1),L.emplaceBack(0+me,Z+me+1,Z+me),L.emplaceBack(0+me,0+me+1,Z+me+1);const he=M.length,_e=he+2*(z+1);for(const me of[0,1])for(let Ce=0;Ce<=z;Ce++)for(const Ne of[0,1])M.emplaceBack(me*s.$,Ce*$,Ne);for(let me=0;me<2*z;me+=2)L.emplaceBack(he+me,he+me+1,he+me+3),L.emplaceBack(he+me,he+me+3,he+me+2),L.emplaceBack(_e+me,_e+me+3,_e+me+1),L.emplaceBack(_e+me,_e+me+2,_e+me+3);const be=new as(P.createVertexBuffer(M,my.members),P.createIndexBuffer(L),s.aL.simpleSegment(0,0,M.length,L.length));return this._meshCache[S]=be,be}getMeshFrameDelta(n){return 2*Math.PI*s.bt/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,a){var f;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(n,a);return(f=this.getMinMaxElevation(m).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(n){const a=this.getTerrainData(n).tile,f={minElevation:null,maxElevation:null};return a&&a.dem&&(f.minElevation=a.dem.min*this.exaggeration,f.maxElevation=a.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(n,a){const f=s.a0.fromLngLat(n.wrap()),m=(1<<a)*s.$,v=f.x*m,S=f.y*m,P=Math.floor(v/s.$),M=Math.floor(S/s.$);return{tileID:new s.Z(a,0,a,P,M),mercatorX:v,mercatorY:S}}}class qh{constructor(n,a,f){this._context=n,this._size=a,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(f.texture),{id:n,fbo:a,texture:f,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>n.id!==a),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const St={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Dt{constructor(n,a){this.painter=n,this.terrain=a,this.pool=new qh(n.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(f=>!n._layers[f].isHidden(a)),this._coordsAscending={};for(const f in n.sourceCaches){this._coordsAscending[f]={};const m=n.sourceCaches[f].getVisibleCoordinates(),v=n.sourceCaches[f].getSource(),S=v instanceof tn?v.terrainTileRanges:null;for(const P of m){const M=this.terrain.sourceCache.getTerrainCoords(P,S);for(const L in M)this._coordsAscending[f][L]||(this._coordsAscending[f][L]=[]),this._coordsAscending[f][L].push(M[L])}}this._coordsAscendingStr={};for(const f of n._order){const m=n._layers[f],v=m.source;if(St[m.type]&&!this._coordsAscendingStr[v]){this._coordsAscendingStr[v]={};for(const S in this._coordsAscending[v])this._coordsAscendingStr[v][S]=this._coordsAscending[v][S].map(P=>P.key).sort().join()}}for(const f of this._renderableTiles)for(const m in this._coordsAscendingStr){const v=this._coordsAscendingStr[m][f.tileID.key];v&&v!==f.rttCoords[m]&&(f.rtt=[])}}renderLayer(n,a){if(n.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),m=n.type,v=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(St[m]&&(this._prevType&&St[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(n.id),!S))return!0;if(St[this._prevType]||St[m]&&S){this._prevType=m;const P=this._stacks.length-1,M=this._stacks[P]||[];for(const L of this._renderableTiles){if(this.pool.isFull()&&(Vr(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(L),L.rtt[P]){const $=this.pool.getObjectForId(L.rtt[P].id);if($.stamp===L.rtt[P].stamp){this.pool.useObject($);continue}}const z=this.pool.getOrCreateFreeObject();this.pool.useObject(z),this.pool.stampObject(z),L.rtt[P]={id:z.id,stamp:z.stamp},v.context.bindFramebuffer.set(z.fbo.framebuffer),v.context.clear({color:s.be.transparent,stencil:0}),v.currentStencilSource=void 0;for(let $=0;$<M.length;$++){const O=v.style._layers[M[$]],Z=O.source?this._coordsAscending[O.source][L.tileID.key]:[L.tileID];v.context.viewport.set([0,0,z.fbo.width,z.fbo.height]),v._renderTileClippingMasks(O,Z,!0),v.renderLayer(v,v.style.sourceCaches[O.source],O,Z,f),O.source&&(L.rttCoords[O.source]=this._coordsAscendingStr[O.source][L.tileID.key])}}return Vr(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),St[m]}return!1}}const Zh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},pf=b,iu={hash:!1,interactive:!0,bearingSnap:7,attributionControl:nu,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ci={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class gy{constructor(n,a,f=!1){this.mousedown=v=>{this.startMove(v,A.mousePos(this.element,v)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.move(v,A.mousePos(this.element,v))},this.mouseup=v=>{this._rotatePitchHanlder.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,v.targetTouches)[0],this.startMove(v,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,v.targetTouches)[0],this.move(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const m=new hx;this._rotatePitchHanlder=new Ml({clickTolerance:3,move:(v,S)=>{const P=a.getBoundingClientRect(),M=new s.P((P.bottom-P.top)/2,(P.right-P.left)/2);return{bearingDelta:s.cm(new s.P(v.x,S.y),S,M),pitchDelta:f?-.5*(S.y-v.y):void 0}},moveStateManager:m,enable:!0,assignEvents:()=>{}}),this.map=n,A.addEventListener(a,"mousedown",this.mousedown),A.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(a,"touchcancel",this.reset)}startMove(n,a){this._rotatePitchHanlder.dragStart(n,a),A.disableDrag()}move(n,a){const f=this.map,{bearingDelta:m,pitchDelta:v}=this._rotatePitchHanlder.dragMove(n,a)||{};m&&f.setBearing(f.getBearing()+m),v&&f.setPitch(f.getPitch()+v)}off(){const n=this.element;A.removeEventListener(n,"mousedown",this.mousedown),A.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let $n;function yy(y,n,a,f=!1){if(f||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return y==null?void 0:y.wrap();const m=new s.S(y.lng,y.lat);if(y=new s.S(y.lng,y.lat),n){const v=new s.S(y.lng-360,y.lat),S=new s.S(y.lng+360,y.lat),P=a.locationToScreenPoint(y).distSqr(n);a.locationToScreenPoint(v).distSqr(n)<P?y=v:a.locationToScreenPoint(S).distSqr(n)<P&&(y=S)}for(;Math.abs(y.lng-a.center.lng)>180;){const v=a.locationToScreenPoint(y);if(v.x>=0&&v.y>=0&&v.x<=a.width&&v.y<=a.height)break;y.lng>a.center.lng?y.lng-=360:y.lng+=360}return y.lng!==m.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(y))?y:m}const Ra={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Nr(y,n,a){const f=y.classList;for(const m in Ra)f.remove(`maplibregl-${a}-anchor-${m}`);f.add(`maplibregl-${a}-anchor-${n}`)}class Ur extends s.E{constructor(n){if(super(),this._onKeyPress=a=>{const f=a.code,m=a.charCode||a.keyCode;f!=="Space"&&f!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=a=>{const f=a.originalEvent.target,m=this._element;this._popup&&(f===m||m.contains(f))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=yy(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Ra[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${m}`),I.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=s.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const a=A.createNS("http://www.w3.org/2000/svg","svg"),f=41,m=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${f}px`),a.setAttributeNS(null,"width",`${m}px`),a.setAttributeNS(null,"viewBox",`0 0 ${m} ${f}`);const v=A.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const S=A.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const P=A.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const le of M){const ue=A.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",le.rx),ue.setAttributeNS(null,"ry",le.ry),P.appendChild(ue)}const L=A.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const z=A.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(z);const $=A.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const O=A.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(O);const Z=A.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const Q=A.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=A.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const se=A.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),Q.appendChild(ae),Q.appendChild(se),S.appendChild(P),S.appendChild(L),S.appendChild($),S.appendChild(Z),S.appendChild(Q),a.appendChild(S),a.setAttributeNS(null,"height",f*this._scale+"px"),a.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(a),this._offset=s.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Nr(this._element,this._anchor,"marker"),n&&n.className)for(const a of n.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=s.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const m=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var a,f;const m=(a=this._map)===null||a===void 0?void 0:a.terrain,v=this._map.transform.isLocationOccluded(this._lngLat);if(!m||v){const Z=v?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Z&&(this._element.style.opacity=Z))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const S=this._map,P=S.terrain.depthAtPoint(this._pos),M=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,M)-P<.006)return void(this._element.style.opacity=this._opacity);const L=-this._offset.y/S.transform.pixelsPerMeter,z=Math.sin(S.getPitch()*Math.PI/180)*L,$=S.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),O=S.transform.lngLatToCameraDepth(this._lngLat,M+z)-$>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&O&&this._popup.remove(),this._element.style.opacity=O?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=s.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,a){return(this._opacity===void 0||n===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const vy={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let qs=0,Zs=!1;const ff={maxWidth:100,unit:"metric"};function Wh(y,n,a){const f=a&&a.maxWidth||100,m=y._container.clientHeight/2,v=y._container.clientWidth/2,S=y.unproject([v-f/2,m]),P=y.unproject([v+f/2,m]),M=Math.round(y.project(P).x-y.project(S).x),L=Math.min(f,M,y._container.clientWidth),z=S.distanceTo(P);if(a&&a.unit==="imperial"){const $=3.2808*z;$>5280?La(n,L,$/5280,y._getUIString("ScaleControl.Miles")):La(n,L,$,y._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?La(n,L,z/1852,y._getUIString("ScaleControl.NauticalMiles")):z>=1e3?La(n,L,z/1e3,y._getUIString("ScaleControl.Kilometers")):La(n,L,z,y._getUIString("ScaleControl.Meters"))}function La(y,n,a,f){const m=function(v){const S=Math.pow(10,`${Math.floor(v)}`.length-1);let P=v/S;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(M){const L=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*L)/L}(P),S*P}(a);y.style.width=n*(m/a)+"px",y.innerHTML=`${m}&nbsp;${f}`}const ou={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},mf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Hh(y){if(y){if(typeof y=="number"){const n=Math.round(Math.abs(y)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,y),"top-left":new s.P(n,n),"top-right":new s.P(-n,n),bottom:new s.P(0,-y),"bottom-left":new s.P(n,-n),"bottom-right":new s.P(-n,-n),left:new s.P(y,0),right:new s.P(-y,0)}}if(y instanceof s.P||Array.isArray(y)){const n=s.P.convert(y);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:s.P.convert(y.center||[0,0]),top:s.P.convert(y.top||[0,0]),"top-left":s.P.convert(y["top-left"]||[0,0]),"top-right":s.P.convert(y["top-right"]||[0,0]),bottom:s.P.convert(y.bottom||[0,0]),"bottom-left":s.P.convert(y["bottom-left"]||[0,0]),"bottom-right":s.P.convert(y["bottom-right"]||[0,0]),left:s.P.convert(y.left||[0,0]),right:s.P.convert(y.right||[0,0])}}return Hh(new s.P(0,0))}const gf=b;h.AJAXError=s.cy,h.Event=s.l,h.Evented=s.E,h.LngLat=s.S,h.MercatorCoordinate=s.a0,h.Point=s.P,h.addProtocol=s.cz,h.config=s.a,h.removeProtocol=s.cA,h.AttributionControl=Gh,h.BoxZoomHandler=rf,h.CanvasSource=yi,h.CooperativeGesturesHandler=py,h.DoubleClickZoomHandler=Vh,h.DragPanHandler=cf,h.DragRotateHandler=Uh,h.EdgeInsets=Xi,h.FullscreenControl=class extends s.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var n;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=a==null?void 0:a.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},h.GeoJSONSource=yn,h.GeolocateControl=class extends s.E{constructor(y){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const a=new s.S(n.coords.longitude,n.coords.latitude),f=n.coords.accuracy,m=this._map.getBearing(),v=s.e({bearing:m},this.options.fitBoundsOptions),S=vr.fromLngLat(a,f);this._map.fitBounds(S,v,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const a=new s.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Zs)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ur({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ur({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},vy,y)}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(n=!1){if($n!==void 0&&!n)return $n;if(window.navigator.permissions===void 0)return $n=!!window.navigator.geolocation,$n;try{$n=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{$n=!!window.navigator.geolocation}return $n})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qs=0,Zs=!1}_isOutOfMapMaxBounds(y){const n=this._map.getMaxBounds(),a=y.coords;return n&&(a.longitude<n.getWest()||a.longitude>n.getEast()||a.latitude<n.getSouth()||a.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),n=y.getSouthEast(),a=y.getNorthEast(),f=n.distanceTo(a),m=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qs--,Zs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qs++,qs>1?(y={maximumAge:6e5,timeout:0},Zs=!0):(y=this.options.positionOptions,Zs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},h.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const n=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},h.Hash=Yc,h.ImageSource=tn,h.KeyboardHandler=Il,h.LngLatBounds=vr,h.LogoControl=df,h.Map=class extends Rr{constructor(y){var n,a;s.cv.mark(s.cw.create);const f=Object.assign(Object.assign(Object.assign({},iu),y),{canvasContextAttributes:Object.assign(Object.assign({},iu.canvasContextAttributes),y.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const m=new hn,v=new yh;if(f.minZoom!==void 0&&m.setMinZoom(f.minZoom),f.maxZoom!==void 0&&m.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&m.setMinPitch(f.minPitch),f.maxPitch!==void 0&&m.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&m.setRenderWorldCopies(f.renderWorldCopies),super(m,v,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new fy,this._controls=[],this._mapId=s.a6(),this._contextLost=P=>{P.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:P}))},this._contextRestored=P=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:P}))},this._onMapScroll=P=>{if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Zh),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ne.addThrottleControl(()=>this.isMoving()),this._requestManager=new de(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let P=!1;const M=jh(L=>{this._trackResize&&!this._removed&&(this.resize(L),this.redraw())},50);this._resizeObserver=new ResizeObserver(L=>{P?M(L):P=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Gs(this,f),this._hash=f.hash&&new Yc(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.e({},f.fitBoundsOptions,{duration:0}))));const S=typeof f.style=="string"||((a=(n=f.style)===null||n===void 0?void 0:n.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Gh(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new df,f.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const P=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(P)}}),this.on("data",P=>{this._update(P.dataType==="style"),this.fire(new s.l(`${P.dataType}data`,P))}),this.on("dataloading",P=>{this.fire(new s.l(`${P.dataType}dataloading`,P))}),this.on("dataabort",P=>{this.fire(new s.l("sourcedataabort",P))})}_getMapId(){return this._mapId}setGlobalStateProperty(y,n){return this.style.setGlobalStateProperty(y,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(y,n){if(n===void 0&&(n=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=y.onAdd(this);this._controls.push(y);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(a,f.firstChild):f.appendChild(a),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(y);return n>-1&&this._controls.splice(n,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,n,a,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,n,a,f)}resize(y,n=!0){const[a,f]=this._containerDimensions(),m=this._getClampedPixelRatio(a,f);if(this._resizeCanvas(a,f,m),this.painter.resize(a,f,m),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const P=this._getClampedPixelRatio(a,f);this._resizeCanvas(a,f,P),this.painter.resize(a,f,P)}this._resizeTransform(n);const v=!this._moving;return v&&(this.stop(),this.fire(new s.l("movestart",y)).fire(new s.l("move",y))),this.fire(new s.l("resize",y)),v&&this.fire(new s.l("moveend",y)),this}_resizeTransform(y=!0){var n;const[a,f]=this._containerDimensions();this.transform.resize(a,f,y),(n=this._requestedCameraState)===null||n===void 0||n.resize(a,f,y)}_getClampedPixelRatio(y,n){const{0:a,1:f}=this._maxCanvasSize,m=this.getPixelRatio(),v=y*m,S=n*m;return Math.min(v>a?a/v:1,S>f?f/S:1)*m}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(vr.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(s.S.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(s.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,n,a){if(y==="mouseenter"||y==="mouseover"){let f=!1;return{layers:n,listener:a,delegates:{mousemove:v=>{const S=n.filter(M=>this.getLayer(M)),P=S.length!==0?this.queryRenderedFeatures(v.point,{layers:S}):[];P.length?f||(f=!0,a.call(this,new bi(y,this,v.originalEvent,{features:P}))):f=!1},mouseout:()=>{f=!1}}}}if(y==="mouseleave"||y==="mouseout"){let f=!1;return{layers:n,listener:a,delegates:{mousemove:S=>{const P=n.filter(M=>this.getLayer(M));(P.length!==0?this.queryRenderedFeatures(S.point,{layers:P}):[]).length?f=!0:f&&(f=!1,a.call(this,new bi(y,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,a.call(this,new bi(y,this,S.originalEvent)))}}}}{const f=m=>{const v=n.filter(P=>this.getLayer(P)),S=v.length!==0?this.queryRenderedFeatures(m.point,{layers:v}):[];S.length&&(m.features=S,a.call(this,m),delete m.features)};return{layers:n,listener:a,delegates:{[y]:f}}}}_saveDelegatedListener(y,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(n)}_removeDelegatedListener(y,n,a){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const f=this._delegatedListeners[y];for(let m=0;m<f.length;m++){const v=f[m];if(v.listener===a&&v.layers.length===n.length&&v.layers.every(S=>n.includes(S))){for(const S in v.delegates)this.off(S,v.delegates[S]);return void f.splice(m,1)}}}on(y,n,a){if(a===void 0)return super.on(y,n);const f=typeof n=="string"?[n]:n,m=this._createDelegatedListener(y,f,a);this._saveDelegatedListener(y,m);for(const v in m.delegates)this.on(v,m.delegates[v]);return{unsubscribe:()=>{this._removeDelegatedListener(y,f,a)}}}once(y,n,a){if(a===void 0)return super.once(y,n);const f=typeof n=="string"?[n]:n,m=this._createDelegatedListener(y,f,a);for(const v in m.delegates){const S=m.delegates[v];m.delegates[v]=(...P)=>{this._removeDelegatedListener(y,f,a),S(...P)}}this._saveDelegatedListener(y,m);for(const v in m.delegates)this.once(v,m.delegates[v]);return this}off(y,n,a){return a===void 0?super.off(y,n):(this._removeDelegatedListener(y,typeof n=="string"?[n]:n,a),this)}queryRenderedFeatures(y,n){if(!this.style)return[];let a;const f=y instanceof s.P||Array.isArray(y),m=f?y:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(f?{}:y)||{},m instanceof s.P||typeof m[0]=="number")a=[s.P.convert(m)];else{const v=s.P.convert(m[0]),S=s.P.convert(m[1]);a=[v,new s.P(S.x,v.y),S,new s.P(v.x,S.y),v]}return this.style.queryRenderedFeatures(a,n,this.transform)}querySourceFeatures(y,n){return this.style.querySourceFeatures(y,n)}setStyle(y,n){return(n=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(y,n))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const n=this._locale[y];if(n==null)throw new Error(`Missing UI string '${y}'`);return n}_updateStyle(y,n){var a,f;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,n));const m=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Lp(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,n,m):this.style.loadJSON(y,n,m),this):((f=(a=this.style)===null||a===void 0?void 0:a.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Lp(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,n){if(typeof y=="string"){const a=this._requestManager.transformRequest(y,"Style");s.j(a,new AbortController).then(f=>{this._updateDiff(f.data,n)}).catch(f=>{f&&this.fire(new s.k(f))})}else typeof y=="object"&&this._updateDiff(y,n)}_updateDiff(y,n){try{this.style.setState(y,n)&&this._update(!0)}catch(a){s.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(y,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(y,n){return this._lazyInitEmptyStyle(),this.style.addSource(y,n),this._update(!0)}isSourceLoaded(y){const n=this.style&&this.style.sourceCaches[y];if(n!==void 0)return n.loaded();this.fire(new s.k(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const n=this.style.sourceCaches[y.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&n.reload();for(const a in this.style._layers){const f=this.style._layers[a];f.type==="hillshade"&&f.source===y.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===y.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Fo(this.painter,n,y),this.painter.renderToTexture=new Dt(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var f;a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=a.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:y})),this}getTerrain(){var y,n;return(n=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const n in y){const a=y[n]._tiles;for(const f in a){const m=a[f];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}setSourceTileLodParams(y,n,a){if(a){const f=this.getSource(a);if(!f)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);f.calculateTileZoom=Re(Math.max(1,y),Math.max(1,n))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Re(Math.max(1,y),Math.max(1,n));return this._update(!0),this}refreshTiles(y,n){const a=this.style.sourceCaches[y];if(!a)throw new Error(`There is no source cache with ID "${y}", cannot refresh tile`);n===void 0?a.reload(!0):a.refreshTiles(n.map(f=>new s.a3(f.z,f.x,f.y)))}addImage(y,n,a={}){const{pixelRatio:f=1,sdf:m=!1,stretchX:v,stretchY:S,content:P,textFitWidth:M,textFitHeight:L}=a;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||s.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:$,data:O}=n,Z=n;return this.style.addImage(y,{data:new s.R({width:z,height:$},new Uint8Array(O)),pixelRatio:f,stretchX:v,stretchY:S,content:P,textFitWidth:M,textFitHeight:L,sdf:m,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,y),this}}{const{width:z,height:$,data:O}=I.getImageData(n);this.style.addImage(y,{data:new s.R({width:z,height:$},O),pixelRatio:f,stretchX:v,stretchY:S,content:P,textFitWidth:M,textFitHeight:L,sdf:m,version:0})}}updateImage(y,n){const a=this.style.getImage(y);if(!a)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=n instanceof HTMLImageElement||s.b(n)?I.getImageData(n):n,{width:m,height:v,data:S}=f;if(m===void 0||v===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==a.data.width||v!==a.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(n instanceof HTMLImageElement||s.b(n));return a.data.replace(S,P),this.style.updateImage(y,a),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return ne.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,n){return this._lazyInitEmptyStyle(),this.style.addLayer(y,n),this._update(!0)}moveLayer(y,n){return this.style.moveLayer(y,n),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,n,a){return this.style.setLayerZoomRange(y,n,a),this._update(!0)}setFilter(y,n,a={}){return this.style.setFilter(y,n,a),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,n,a,f={}){return this.style.setPaintProperty(y,n,a,f),this._update(!0)}getPaintProperty(y,n){return this.style.getPaintProperty(y,n)}setLayoutProperty(y,n,a,f={}){return this.style.setLayoutProperty(y,n,a,f),this._update(!0)}getLayoutProperty(y,n){return this.style.getLayoutProperty(y,n)}setGlyphs(y,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,n,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,n,a,f=>{f||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,n,a=>{a||this._update(!0)}),this}setLight(y,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,n){return this.style.setFeatureState(y,n),this._update()}removeFeatureState(y,n){return this.style.removeFeatureState(y,n),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,n=0;return this._container&&(y=this._container.clientWidth||400,n=this._container.clientHeight||300),[y,n]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const n=this._canvasContainer=A.create("div","maplibregl-canvas-container",y);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),f=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],f);const m=this._controlContainer=A.create("div","maplibregl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{v[S]=A.create("div",`maplibregl-ctrl-${S} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,n,a){this._canvas.width=Math.floor(a*y),this._canvas.height=Math.floor(a*n),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{n={requestedAttributes:y},f&&(n.statusMessage=f.statusMessage,n.type=f.type)},{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!a){const f="Failed to initialize WebGL";throw n?(n.message=f,new Error(JSON.stringify(n))):new Error(f)}this.painter=new Qi(a,this.transform),B.testSupport(a)}migrateProjection(y,n){super.migrateProjection(y,n),this.painter.transform=y,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var n,a,f,m,v;const S=this._idleTriggered?this._fadeDuration:0,P=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,O=I.now();this.style.zoomHistory.update($,O);const Z=new s.F($,{now:O,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Q=Z.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(M=!0,this._crossFadingFactor=Q),this.style.update(Z)}const L=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==P;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((m=this.style.projection)===null||m===void 0?void 0:m.transitionState,(v=this.style.projection)===null||v===void 0?void 0:v.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||L)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,L),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cv.mark(s.cw.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const z=this._sourcesDirty||this._styleDirty||this._placementDirty;return z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,s.cv.mark(s.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ne.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cv.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,I.frame(this._frameRequest,y=>{s.cv.frame(y),this._frameRequest=null;try{this._render(y)}catch(n){if(!s.cx(n)&&!function(a){return a.message===Hp}(n))throw n}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return pf}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},h.MapMouseEvent=bi,h.MapTouchEvent=ho,h.MapWheelEvent=tf,h.Marker=Ur,h.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const n=this._map.getZoom(),a=n===this._map.getMaxZoom(),f=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,a)=>{const f=this._map._getUIString(`NavigationControl.${a}`);n.title=f,n.setAttribute("aria-label",f)},this.options=s.e({},ci,y),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gy(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,n){const a=A.create("button",y,this._container);return a.type="button",a.addEventListener("click",n),a}},h.Popup=class extends s.E{constructor(y){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=yy(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const a=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const m=Hh(this.options.offset);if(!f){const S=this._container.offsetWidth,P=this._container.offsetHeight;let M;M=a.y+m.bottom.y<P?["top"]:a.y>this._map.transform.height-P?["bottom"]:[],a.x<S/2?M.push("left"):a.x>this._map.transform.width-S/2&&M.push("right"),f=M.length===0?"bottom":M.join("-")}let v=a.add(m[f]);this.options.subpixelPositioning||(v=v.round()),A.setTransform(this._container,`${Ra[f]} translate(${v.x}px,${v.y}px)`),Nr(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(ou),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=s.S.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const n=document.createDocumentFragment(),a=document.createElement("body");let f;for(a.innerHTML=y;f=a.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(mf);y&&y.focus()}},h.RasterDEMTileSource=en,h.RasterTileSource=ao,h.ScaleControl=class{constructor(y){this._onMove=()=>{Wh(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,Wh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ff),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},h.ScrollZoomHandler=dy,h.Style=Lp,h.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},h.TwoFingersTouchPitchHandler=sf,h.TwoFingersTouchRotateHandler=of,h.TwoFingersTouchZoomHandler=Oo,h.TwoFingersTouchZoomRotateHandler=uf,h.VectorTileSource=Xn,h.VideoSource=Lo,h.addSourceType=(y,n)=>s._(void 0,void 0,void 0,function*(){if(oi(y))throw new Error(`A source type called "${y}" already exists.`);((a,f)=>{Os[a]=f})(y,n)}),h.clearPrewarmedResources=function(){const y=Et;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Ke),Et=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},h.createTileMesh=Ap,h.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},h.getRTLTextPluginStatus=function(){return un().getRTLTextPluginStatus()},h.getVersion=function(){return gf},h.getWorkerCount=function(){return nt.workerCount},h.getWorkerUrl=function(){return s.a.WORKER_URL},h.importScriptInWorkers=function(y){return Xt().broadcast("IS",y)},h.prewarm=function(){lr().acquire(Ke)},h.setMaxParallelImageRequests=function(y){s.a.MAX_PARALLEL_IMAGE_REQUESTS=y},h.setRTLTextPlugin=function(y,n){return un().setRTLTextPlugin(y,n)},h.setWorkerCount=function(y){nt.workerCount=y},h.setWorkerUrl=function(y){s.a.WORKER_URL=y}});var d=r;return d})})(i3);var Dq=i3.exports;const It=G0(Dq);function zq(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class Nq{constructor(){this._apiKey="",this._fetch=zq(),this.tileCacheSize=200}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}set fetch(t){this._fetch=t}get fetch(){return this._fetch}}const Bd=new Nq,jq={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},Oq={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!0},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!0},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!0},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!0},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!0},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!0},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!0},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!0},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!0},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},wg={...jq,...Oq};function Fq(e,t=wg){return e in t?e[e]:null}function Kw(e,t=wg){for(const r of Object.values(t))if(r.code===e)return r;return null}function Xw(e,t=wg){for(const r of Object.values(t))if(r.flag===e)return r;return null}function Bq(e){return e!==null&&typeof e=="object"&&"code"in e&&"flag"in e&&"name"in e&&"latin"in e&&"isMode"in e&&"geocoding"in e&&(typeof e.code=="string"||e.code===null)&&typeof e.flag=="string"&&typeof e.name=="string"&&typeof e.latin=="boolean"&&typeof e.isMode=="boolean"&&typeof e.geocoding=="boolean"}function yk(e,t=wg){return Bq(e)?Xw(e.flag,t):typeof e!="string"?null:Fq(e,t)||Kw(e,t)||Xw(e,t)||null}async function $q(e,t={}){if(Bd.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Bd.fetch(e,t)}const s3={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(s3);class Vq extends Error{constructor(t,r=""){super(`Call to enpoint ${t.url} failed with the status code ${t.status}. ${r}`),this.res=t}}const vk={403:"Key is missing, invalid or restricted"};async function Uq(e={}){const t=new URL("geolocation/ip.json",s3.maptilerApiURL);t.searchParams.set("key",e.apiKey??Bd.apiKey),"elevation"in e&&t.searchParams.set("elevation",e.elevation?"true":"false");const r=t.toString(),o=await $q(r);if(!o.ok)throw new Vq(o,o.status in vk?vk[o.status]:"");return await o.json()}const _k={info:Uq};function a3(e){const t=/^maptiler:\/\/(.*)/;let r;const o=e.trim();let u;return o.startsWith("http://")||o.startsWith("https://")?u=o:(r=t.exec(o))!==null?u=`https://api.maptiler.com/maps/${r[1]}/style.json`:u=`https://api.maptiler.com/maps/${o}/style.json`,u}class l3{constructor(t,r,o,u,d,h,s=!1){this.name=t,this.variantType=r,this.id=o,this.referenceStyle=u,this.description=d,this.imageURL=h,this.deprecated=s}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(t){return this.referenceStyle.hasVariant(t)}getVariant(t){const r=this.referenceStyle.getVariant(t);return this.warnIfDeprecated(r),r}getVariants(){return this.referenceStyle.getVariants().filter(t=>t!==this).map(t=>(this.warnIfDeprecated(t),t))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return a3(this.getId())}warnIfDeprecated(t=this){if(!t.deprecated)return t;const r=t.getFullName();return console.warn(`Style "${r}" is deprecated and will be removed in a future version.`),t}}class c3{constructor(t,r){this.name=t,this.id=r,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(t){this.variants[t.getType()]=t,this.orderedVariants.push(t)}hasVariant(t){return t in this.variants}getVariant(t){return t in this.variants?this.variants[t]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0].warnIfDeprecated()}}const ym=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",deprecated:!0,name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",deprecated:!0,variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",deprecated:!0,variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",deprecated:!0,variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",deprecated:!0,variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",deprecated:!0,variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",deprecated:!0,description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",deprecated:!0,description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"AQUARELLE",name:"Aquarelle",description:"Watercolor map for creative use",variants:[{id:"aquarelle",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"aquarelle-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"aquarelle-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]},{referenceStyleID:"LANDSCAPE",name:"Landscape",description:"Terrain map for data overlays and visualisations",variants:[{id:"landscape",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"landscape-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"landscape-vivid",name:"Vivid",variantType:"VIVID",description:"",imageURL:""}]}];function Gq(e){return new Proxy(e,{get(t,r,o){return t.hasVariant(r)?t.getVariant(r):r.toString().toUpperCase()===r?e.getDefaultVariant():Reflect.get(t,r,o)}})}function qq(){const e={};for(let t=0;t<ym.length;t+=1){const r=ym[t],o=Gq(new c3(r.name,r.referenceStyleID));for(let u=0;u<r.variants.length;u+=1){const d=r.variants[u],h=new l3(d.name,d.variantType,d.id,o,d.description,d.imageURL,d.deprecated);o.addVariant(h)}e[r.referenceStyleID]=o}return e}const vm=qq();var JS={exports:{}},$d=typeof Reflect=="object"?Reflect:null,xk=$d&&typeof $d.apply=="function"?$d.apply:function(t,r,o){return Function.prototype.apply.call(t,r,o)},Ov;$d&&typeof $d.ownKeys=="function"?Ov=$d.ownKeys:Object.getOwnPropertySymbols?Ov=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ov=function(t){return Object.getOwnPropertyNames(t)};function Zq(e){console&&console.warn&&console.warn(e)}var u3=Number.isNaN||function(t){return t!==t};function Ir(){Ir.init.call(this)}JS.exports=Ir;JS.exports.once=Xq;Ir.EventEmitter=Ir;Ir.prototype._events=void 0;Ir.prototype._eventsCount=0;Ir.prototype._maxListeners=void 0;var bk=10;function P_(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Ir,"defaultMaxListeners",{enumerable:!0,get:function(){return bk},set:function(e){if(typeof e!="number"||e<0||u3(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");bk=e}});Ir.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ir.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||u3(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function h3(e){return e._maxListeners===void 0?Ir.defaultMaxListeners:e._maxListeners}Ir.prototype.getMaxListeners=function(){return h3(this)};Ir.prototype.emit=function(t){for(var r=[],o=1;o<arguments.length;o++)r.push(arguments[o]);var u=t==="error",d=this._events;if(d!==void 0)u=u&&d.error===void 0;else if(!u)return!1;if(u){var h;if(r.length>0&&(h=r[0]),h instanceof Error)throw h;var s=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw s.context=h,s}var b=d[t];if(b===void 0)return!1;if(typeof b=="function")xk(b,this,r);else for(var w=b.length,C=g3(b,w),o=0;o<w;++o)xk(C[o],this,r);return!0};function d3(e,t,r,o){var u,d,h;if(P_(r),d=e._events,d===void 0?(d=e._events=Object.create(null),e._eventsCount=0):(d.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),d=e._events),h=d[t]),h===void 0)h=d[t]=r,++e._eventsCount;else if(typeof h=="function"?h=d[t]=o?[r,h]:[h,r]:o?h.unshift(r):h.push(r),u=h3(e),u>0&&h.length>u&&!h.warned){h.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=h.length,Zq(s)}return e}Ir.prototype.addListener=function(t,r){return d3(this,t,r,!1)};Ir.prototype.on=Ir.prototype.addListener;Ir.prototype.prependListener=function(t,r){return d3(this,t,r,!0)};function Wq(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p3(e,t,r){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},u=Wq.bind(o);return u.listener=r,o.wrapFn=u,u}Ir.prototype.once=function(t,r){return P_(r),this.on(t,p3(this,t,r)),this};Ir.prototype.prependOnceListener=function(t,r){return P_(r),this.prependListener(t,p3(this,t,r)),this};Ir.prototype.removeListener=function(t,r){var o,u,d,h,s;if(P_(r),u=this._events,u===void 0)return this;if(o=u[t],o===void 0)return this;if(o===r||o.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete u[t],u.removeListener&&this.emit("removeListener",t,o.listener||r));else if(typeof o!="function"){for(d=-1,h=o.length-1;h>=0;h--)if(o[h]===r||o[h].listener===r){s=o[h].listener,d=h;break}if(d<0)return this;d===0?o.shift():Hq(o,d),o.length===1&&(u[t]=o[0]),u.removeListener!==void 0&&this.emit("removeListener",t,s||r)}return this};Ir.prototype.off=Ir.prototype.removeListener;Ir.prototype.removeAllListeners=function(t){var r,o,u;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var d=Object.keys(o),h;for(u=0;u<d.length;++u)h=d[u],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=o[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(u=r.length-1;u>=0;u--)this.removeListener(t,r[u]);return this};function f3(e,t,r){var o=e._events;if(o===void 0)return[];var u=o[t];return u===void 0?[]:typeof u=="function"?r?[u.listener||u]:[u]:r?Kq(u):g3(u,u.length)}Ir.prototype.listeners=function(t){return f3(this,t,!0)};Ir.prototype.rawListeners=function(t){return f3(this,t,!1)};Ir.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):m3.call(e,t)};Ir.prototype.listenerCount=m3;function m3(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ir.prototype.eventNames=function(){return this._eventsCount>0?Ov(this._events):[]};function g3(e,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e[o];return r}function Hq(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Kq(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Xq(e,t){return new Promise(function(r,o){function u(h){e.removeListener(t,d),o(h)}function d(){typeof e.removeListener=="function"&&e.removeListener("error",u),r([].slice.call(arguments))}y3(e,t,d,{once:!0}),t!=="error"&&Yq(e,u,{once:!0})})}function Yq(e,t,r){typeof e.on=="function"&&y3(e,"error",t,r)}function y3(e,t,r,o){if(typeof e.on=="function")o.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function u(d){o.once&&e.removeEventListener(t,u),r(d)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Qq=JS.exports;const Jq=G0(Qq),di=[];for(let e=0;e<256;++e)di.push((e+256).toString(16).slice(1));function eZ(e,t=0){return(di[e[t+0]]+di[e[t+1]]+di[e[t+2]]+di[e[t+3]]+"-"+di[e[t+4]]+di[e[t+5]]+"-"+di[e[t+6]]+di[e[t+7]]+"-"+di[e[t+8]]+di[e[t+9]]+"-"+di[e[t+10]]+di[e[t+11]]+di[e[t+12]]+di[e[t+13]]+di[e[t+14]]+di[e[t+15]]).toLowerCase()}let rb;const tZ=new Uint8Array(16);function rZ(){if(!rb){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");rb=crypto.getRandomValues.bind(crypto)}return rb(tZ)}const nZ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wk={randomUUID:nZ};function iZ(e,t,r){var u;if(wk.randomUUID&&!e)return wk.randomUUID();e=e||{};const o=e.random??((u=e.rng)==null?void 0:u.call(e))??rZ();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,eZ(o)}const v3="3.7.7",oZ=v3,wp=typeof Buffer=="function",Sk=typeof TextDecoder=="function"?new TextDecoder:void 0,Tk=typeof TextEncoder=="function"?new TextEncoder:void 0,sZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",tm=Array.prototype.slice.call(sZ),hv=(e=>{let t={};return e.forEach((r,o)=>t[r]=o),t})(tm),aZ=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,fi=String.fromCharCode.bind(String),Ck=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),_3=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),x3=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),b3=e=>{let t,r,o,u,d="";const h=e.length%3;for(let s=0;s<e.length;){if((r=e.charCodeAt(s++))>255||(o=e.charCodeAt(s++))>255||(u=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");t=r<<16|o<<8|u,d+=tm[t>>18&63]+tm[t>>12&63]+tm[t>>6&63]+tm[t&63]}return h?d.slice(0,h-3)+"===".substring(h):d},eT=typeof btoa=="function"?e=>btoa(e):wp?e=>Buffer.from(e,"binary").toString("base64"):b3,Yw=wp?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let o=0,u=e.length;o<u;o+=4096)r.push(fi.apply(null,e.subarray(o,o+4096)));return eT(r.join(""))},Fv=(e,t=!1)=>t?_3(Yw(e)):Yw(e),lZ=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fi(192|t>>>6)+fi(128|t&63):fi(224|t>>>12&15)+fi(128|t>>>6&63)+fi(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return fi(240|t>>>18&7)+fi(128|t>>>12&63)+fi(128|t>>>6&63)+fi(128|t&63)}},cZ=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,w3=e=>e.replace(cZ,lZ),Pk=wp?e=>Buffer.from(e,"utf8").toString("base64"):Tk?e=>Yw(Tk.encode(e)):e=>eT(w3(e)),Vd=(e,t=!1)=>t?_3(Pk(e)):Pk(e),Ek=e=>Vd(e,!0),uZ=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,hZ=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return fi((r>>>10)+55296)+fi((r&1023)+56320);case 3:return fi((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fi((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},S3=e=>e.replace(uZ,hZ),T3=e=>{if(e=e.replace(/\s+/g,""),!aZ.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",o,u;for(let d=0;d<e.length;)t=hv[e.charAt(d++)]<<18|hv[e.charAt(d++)]<<12|(o=hv[e.charAt(d++)])<<6|(u=hv[e.charAt(d++)]),r+=o===64?fi(t>>16&255):u===64?fi(t>>16&255,t>>8&255):fi(t>>16&255,t>>8&255,t&255);return r},tT=typeof atob=="function"?e=>atob(x3(e)):wp?e=>Buffer.from(e,"base64").toString("binary"):T3,C3=wp?e=>Ck(Buffer.from(e,"base64")):e=>Ck(tT(e).split("").map(t=>t.charCodeAt(0))),P3=e=>C3(E3(e)),dZ=wp?e=>Buffer.from(e,"base64").toString("utf8"):Sk?e=>Sk.decode(C3(e)):e=>S3(tT(e)),E3=e=>x3(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),Qw=e=>dZ(E3(e)),pZ=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},M3=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),k3=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,M3(r));e("fromBase64",function(){return Qw(this)}),e("toBase64",function(t){return Vd(this,t)}),e("toBase64URI",function(){return Vd(this,!0)}),e("toBase64URL",function(){return Vd(this,!0)}),e("toUint8Array",function(){return P3(this)})},A3=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,M3(r));e("toBase64",function(t){return Fv(this,t)}),e("toBase64URI",function(){return Fv(this,!0)}),e("toBase64URL",function(){return Fv(this,!0)})},fZ=()=>{k3(),A3()},mZ={version:v3,VERSION:oZ,atob:tT,atobPolyfill:T3,btoa:eT,btoaPolyfill:b3,fromBase64:Qw,toBase64:Vd,encode:Vd,encodeURI:Ek,encodeURL:Ek,utob:w3,btou:S3,decode:Qw,isValid:pZ,fromUint8Array:Fv,toUint8Array:P3,extendString:k3,extendUint8Array:A3,extendBuiltins:fZ};var gZ=Object.defineProperty,I3=e=>{throw TypeError(e)},yZ=(e,t,r)=>t in e?gZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Tt=(e,t,r)=>yZ(e,typeof t!="symbol"?t+"":t,r),rT=(e,t,r)=>t.has(e)||I3("Cannot "+r),mr=(e,t,r)=>(rT(e,t,"read from private field"),r?r.call(e):t.get(e)),_u=(e,t,r)=>t.has(e)?I3("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),pd=(e,t,r,o)=>(rT(e,t,"write to private field"),t.set(e,r),r),_o=(e,t,r)=>(rT(e,t,"access private method"),r);const _r={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...wg};function Mk(){if(typeof navigator>"u"){const e=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return Kw(e)||_r.ENGLISH}return Array.from(new Set(navigator.languages.map(e=>e.split("-")[0]))).map(e=>Kw(e)).filter(e=>e)[0]??_r.LOCAL}const Ui={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:_r.STYLE,secondaryLanguage:_r.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Ui);const nT=iZ();class vZ extends Jq{constructor(){super(...arguments),Tt(this,"primaryLanguage",Ui.primaryLanguage),Tt(this,"secondaryLanguage"),Tt(this,"session",!0),Tt(this,"caching",!0),Tt(this,"telemetry",!0),Tt(this,"_unit","metric"),Tt(this,"_apiKey","")}set unit(t){this._unit=t,this.emit("unit",t)}get unit(){return this._unit}set apiKey(t){this._apiKey=t,Bd.apiKey=t,this.emit("apiKey",t)}get apiKey(){return this._apiKey}set fetch(t){Bd.fetch=t}get fetch(){return Bd.fetch}}const Nn=new vZ,Jw="localcache_source",e2="localcache",_Z="maptiler_sdk",xZ=1e3,bZ=100,t2=typeof caches<"u",{addProtocol:kk}=It;function wZ(e,t){if(t2&&Nn.caching&&Nn.session&&e.host===Ui.maptilerApiHost){if(t==="Source"&&e.href.includes("tiles.json"))return e.href.replace("https://",`${Jw}://`);if(t==="Tile"||t==="Glyphs")return e.href.replace("https://",`${e2}://`)}return e.href}let nb;async function R3(){return nb||(nb=await caches.open(_Z)),nb}let Ak=0;async function SZ(){const e=await R3(),t=await e.keys(),r=t.slice(0,Math.max(t.length-xZ,0));for(const o of r)e.delete(o)}function TZ(){kk(Jw,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${Jw}://`,"https://");const r=e;r.signal=t.signal;const o=await fetch(e.url,r),u=await o.json();return u.tiles&&u.tiles.length>0&&(u.tiles[0]+=`&last-modified=${o.headers.get("Last-Modified")}`),{data:u,cacheControl:o.headers.get("Cache-Control"),expires:o.headers.get("Expires")}}),kk(e2,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${e2}://`,"https://");const r=new URL(e.url),o=new URL(r);o.searchParams.delete("mtsid"),o.searchParams.delete("key");const u=o.toString(),d=new URL(r);d.searchParams.delete("last-modified");const h=d.toString(),s=async I=>({data:await I.arrayBuffer(),cacheControl:I.headers.get("Cache-Control"),expires:I.headers.get("Expires")}),b=await R3(),w=await b.match(u);if(w)return s(w);const C=e;C.signal=t.signal;const k=await fetch(h,C);return k.status>=200&&k.status<300&&(b.put(u,k.clone()).catch(()=>{}),++Ak>bZ&&(SZ(),Ak=0)),s(k)})}function CZ(){if(typeof window>"u")return;const e=It.getRTLTextPluginStatus();if(e==="unavailable"||e==="requested")try{It.setRTLTextPlugin(Ui.rtlPluginURL,!0)}catch{}}function PZ(e,t){for(const r of e)typeof t[r]=="function"&&(t[r]=t[r].bind(t))}function Ik(e,t){let r=null;try{r=new URL(e)}catch{return{url:e}}return r.host===Ui.maptilerApiHost&&(r.searchParams.has("key")||r.searchParams.append("key",Nn.apiKey),Nn.session&&r.searchParams.append("mtsid",nT)),{url:wZ(r,t)}}function Rk(e){return(t,r)=>{if(e!=null){const o=e(t,r),u=Ik((o==null?void 0:o.url)??"",r);return{...o,...u}}return Ik(t,r)}}function EZ(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function MZ(e){const t=EZ();if(!t)return;let r=null;if(typeof e=="string"?r=document.getElementById(e):e instanceof HTMLElement&&(r=e),!r)throw new Error("The Map container must be provided.");const o=document.createElement("div");throw o.innerHTML=t,o.classList.add("webgl-warning-div"),r.appendChild(o),new Error(t)}function Lk(e,t){return!(!Array.isArray(e)||e.length!==2||e[0]!=="get"||typeof e[1]!="string"||t&&!e[1].startsWith("name:")||!t&&e[1]!=="name")}function kZ(e,t,r){const o=structuredClone(e),u=d=>{if(typeof d!="string")for(let h=0;h<d.length;h+=1)Lk(d[h],r)?d[h]=structuredClone(t):u(d[h])};return Lk(o,r)?t:(u(o),o)}function AZ(e,t){const r=t?/\{name:\S+\}/:/\{name\}/;return{contains:r.test(e),exactMatch:new RegExp(`^${r.source}$`).test(e)}}function IZ(e,t,r){const o=r?/\{name:\S+\}/:/\{name\}/,u=e.split(o);return["concat",...u.flatMap((d,h)=>h===u.length-1?[d]:[d,t])]}function RZ(e){var t;const r=/\{name(?::(?<language>\S+))?\}/g,o=[];for(;;){const u=r.exec(e);if(!u)break;const d=((t=u.groups)==null?void 0:t.language)??null;o.push(d)}return o}function LZ(e){return!Array.isArray(e)||e.length!==2||e[0]!=="get"||typeof e[1]!="string"?null:e[1].trim()==="name"?{isLanguage:!0,localization:null}:e[1].trim().startsWith("name:")?{isLanguage:!0,localization:e[1].trim().split(":").pop()}:null}function DZ(e){const t=[],r=structuredClone(e),o=u=>{if(typeof u!="string")for(let d=0;d<u.length;d+=1){const h=LZ(u[d]);h?t.push(h.localization):o(u[d])}};return o([r]),t}function zZ(e,t){const r=[];for(const d of e){if(d.type!=="symbol")continue;const h=d,{id:s,layout:b}=h;if(!b||!("text-field"in b))continue;const w=t.getLayoutProperty(s,"text-field");if(w)if(typeof w=="string"){const C=RZ(w);r.push(C)}else{const C=DZ(w);r.push(C)}}const o=r.flat(),u={unlocalized:0,localized:{}};for(const d of o)d===null?u.unlocalized+=1:(d in u.localized||(u.localized[d]=0),u.localized[d]+=1);return u}let r2=class extends It.Marker{addTo(e){return super.addTo(e)}};class EY extends It.Popup{addTo(t){return super.addTo(t)}}class MY extends It.Style{constructor(t,r={}){super(t,r)}}class kY extends It.CanvasSource{onAdd(t){super.onAdd(t)}}class AY extends It.GeoJSONSource{onAdd(t){super.onAdd(t)}}class IY extends It.ImageSource{onAdd(t){super.onAdd(t)}}class RY extends It.RasterTileSource{onAdd(t){super.onAdd(t)}}class LY extends It.RasterDEMTileSource{onAdd(t){super.onAdd(t)}}class DY extends It.VectorTileSource{onAdd(t){super.onAdd(t)}}class zY extends It.VideoSource{onAdd(t){super.onAdd(t)}}class iT extends It.NavigationControl{onAdd(t){return super.onAdd(t)}}class NZ extends It.GeolocateControl{onAdd(t){return super.onAdd(t)}}class NY extends It.AttributionControl{onAdd(t){return super.onAdd(t)}}class jZ extends It.LogoControl{onAdd(t){return super.onAdd(t)}}class OZ extends It.ScaleControl{onAdd(t){return super.onAdd(t)}}class FZ extends It.FullscreenControl{onAdd(t){return super.onAdd(t)}}class jY extends It.TerrainControl{onAdd(t){return super.onAdd(t)}}class OY extends It.BoxZoomHandler{constructor(t,r){super(t,r)}}class FY extends It.ScrollZoomHandler{constructor(t,r){super(t,r)}}class BY extends It.CooperativeGesturesHandler{constructor(t,r){super(t,r)}}class $Y extends It.KeyboardHandler{constructor(t){super(t)}}class VY extends It.TwoFingersTouchPitchHandler{constructor(t){super(t)}}class UY extends It.MapWheelEvent{constructor(t,r,o){super(t,r,o)}}class GY extends It.MapTouchEvent{constructor(t,r,o){super(t,r,o)}}class qY extends It.MapMouseEvent{constructor(t,r,o,u={}){super(t,r,o,u)}}class Dk extends jZ{constructor(t={}){super(t),Tt(this,"logoURL",""),Tt(this,"linkURL",""),this.logoURL=t.logoURL??Ui.maptilerLogoURL,this.linkURL=t.linkURL??Ui.maptilerURL}onAdd(t){this._map=t,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const r=window.document.createElement("a");return r.style.backgroundRepeat="no-repeat",r.style.cursor="pointer",r.style.display="block",r.style.height="23px",r.style.margin="0 0 -4px -4px",r.style.overflow="hidden",r.style.width="88px",r.style.backgroundImage=`url(${this.logoURL})`,r.style.backgroundSize="100px 30px",r.style.width="100px",r.style.height="30px",r.target="_blank",r.rel="noopener",r.href=this.linkURL,r.setAttribute("aria-label","MapTiler logo"),r.setAttribute("rel","noopener"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var BZ=8,$Z={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},VZ={"*":{type:"source"}},UZ=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],GZ={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},qZ={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},ZZ={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},WZ={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},HZ={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},KZ={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},XZ={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},YZ=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],QZ={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},JZ={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},eW={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},tW={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},rW={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},nW={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},iW={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},oW={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},sW={type:"array",value:"*"},aW={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},lW={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},cW={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},uW={type:"array",value:"*",minimum:1},hW={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},dW={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},pW={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},fW={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},mW=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],gW={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},yW={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},vW={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},_W={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},xW={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},bW={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},wW={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},SW={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},TW={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},CW={"*":{type:"string"}},PW={$version:BZ,$root:$Z,sources:VZ,source:UZ,source_vector:GZ,source_raster:qZ,source_raster_dem:ZZ,source_geojson:WZ,source_video:HZ,source_image:KZ,layer:XZ,layout:YZ,layout_background:QZ,layout_fill:JZ,layout_circle:eW,layout_heatmap:tW,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:rW,layout_symbol:nW,layout_raster:iW,layout_hillshade:oW,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:sW,filter_operator:aW,geometry_type:lW,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:cW,expression:uW,light:hW,sky:dW,terrain:pW,projection:fW,paint:mW,paint_fill:gW,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:yW,paint_circle:vW,paint_heatmap:_W,paint_symbol:xW,paint_raster:bW,paint_hillshade:wW,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:SW,transition:TW,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:CW};class pt{constructor(t,r,o,u){this.message=(t?`${t}: `:"")+o,u&&(this.identifier=u),r!=null&&r.__line__&&(this.line=r.__line__)}}function D0(e,...t){for(const r of t)for(const o in r)e[o]=r[o];return e}class sa extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class oT{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[o,u]of r)this.bindings[o]=u}concat(t){return new oT(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return this.bindings[t]?!0:this.parent?this.parent.has(t):!1}}const E_={kind:"null"},gt={kind:"number"},sr={kind:"string"},tr={kind:"boolean"},pa={kind:"color"},M_={kind:"projectionDefinition"},Gu={kind:"object"},Kt={kind:"value"},EW={kind:"error"},k_={kind:"collator"},A_={kind:"formatted"},I_={kind:"padding"},Xm={kind:"colorArray"},R_={kind:"numberArray"},Sg={kind:"resolvedImage"},L_={kind:"variableAnchorOffsetCollection"};function So(e,t){return{kind:"array",itemType:e,N:t}}function Qr(e){if(e.kind==="array"){const t=Qr(e.itemType);return typeof e.N=="number"?`array<${t}, ${e.N}>`:e.itemType.kind==="value"?"array":`array<${t}>`}else return e.kind}const MW=[E_,gt,sr,tr,pa,M_,A_,Gu,So(Kt),I_,R_,Xm,Sg,L_];function Ym(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ym(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(const r of MW)if(!Ym(r,t))return null}}return`Expected ${Qr(e)} but found ${Qr(t)} instead.`}function sT(e,t){return t.some(r=>r.kind===e.kind)}function qu(e,t){return t.some(r=>r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e)}function $l(e,t){return e.kind==="array"&&t.kind==="array"?e.itemType.kind===t.itemType.kind&&typeof e.N=="number":e.kind===t.kind}const L3=.96422,D3=1,z3=.82521,N3=4/29,Ud=6/29,j3=3*Ud*Ud,kW=Ud*Ud*Ud,AW=Math.PI/180,IW=180/Math.PI;function O3(e){return e=e%360,e<0&&(e+=360),e}function F3([e,t,r,o]){e=ib(e),t=ib(t),r=ib(r);let u,d;const h=ob((.2225045*e+.7168786*t+.0606169*r)/D3);e===t&&t===r?u=d=h:(u=ob((.4360747*e+.3850649*t+.1430804*r)/L3),d=ob((.0139322*e+.0971045*t+.7141733*r)/z3));const s=116*h-16;return[s<0?0:s,500*(u-h),200*(h-d),o]}function ib(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ob(e){return e>kW?Math.pow(e,1/3):e/j3+N3}function B3([e,t,r,o]){let u=(e+16)/116,d=isNaN(t)?u:u+t/500,h=isNaN(r)?u:u-r/200;return u=D3*ab(u),d=L3*ab(d),h=z3*ab(h),[sb(3.1338561*d-1.6168667*u-.4906146*h),sb(-.9787684*d+1.9161415*u+.033454*h),sb(.0719453*d-.2289914*u+1.4052427*h),o]}function sb(e){return e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055,e<0?0:e>1?1:e}function ab(e){return e>Ud?e*e*e:j3*(e-N3)}function RW(e){const[t,r,o,u]=F3(e),d=Math.sqrt(r*r+o*o);return[Math.round(d*1e4)?O3(Math.atan2(o,r)*IW):NaN,d,t,u]}function LW([e,t,r,o]){return e=isNaN(e)?0:e*AW,B3([r,Math.cos(e)*t,Math.sin(e)*t,o])}function DW([e,t,r,o]){e=O3(e),t/=100,r/=100;function u(d){const h=(d+e/30)%12,s=t*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(h-3,9-h,1))}return[u(0),u(8),u(4),o]}const zW=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function _m(e,t){return zW(e,t)?e[t]:void 0}function NW(e){if(e=e.toLowerCase().trim(),e==="transparent")return[0,0,0,0];const t=_m(jW,e);if(t){const[u,d,h]=t;return[u/255,d/255,h/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const u=e.length<6?1:2;let d=1;return[dv(e.slice(d,d+=u)),dv(e.slice(d,d+=u)),dv(e.slice(d,d+=u)),dv(e.slice(d,d+u)||"ff")]}if(e.startsWith("rgb")){const u=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,d=e.match(u);if(d){const[h,s,b,w,C,k,I,A,B,F,X,q]=d,V=[w||" ",I||" ",F].join("");if(V==="  "||V==="  /"||V===",,"||V===",,,"){const U=[b,k,B].join(""),ne=U==="%%%"?100:U===""?255:0;if(ne){const de=[fd(+s/ne,0,1),fd(+C/ne,0,1),fd(+A/ne,0,1),X?zk(+X,q):1];if(Nk(de))return de}}return}}const r=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,o=e.match(r);if(o){const[u,d,h,s,b,w,C,k,I]=o,A=[h||" ",b||" ",C].join("");if(A==="  "||A==="  /"||A===",,"||A===",,,"){const B=[+d,fd(+s,0,100),fd(+w,0,100),k?zk(+k,I):1];if(Nk(B))return DW(B)}}}function dv(e){return parseInt(e.padEnd(2,e),16)/255}function zk(e,t){return fd(t?e/100:e,0,1)}function fd(e,t,r){return Math.min(Math.max(t,e),r)}function Nk(e){return!e.some(Number.isNaN)}const jW={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Zu(e,t,r){return e+r*(t-e)}function Qm(e,t,r){return e.map((o,u)=>Zu(o,t[u],r))}class Er{constructor(t,r,o,u=1,d=!0){this.r=t,this.g=r,this.b=o,this.a=u,d||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[t,r,o,u]))}static parse(t){if(t instanceof Er)return t;if(typeof t!="string")return;const r=NW(t);if(r)return new Er(...r,!1)}get rgb(){const{r:t,g:r,b:o,a:u}=this,d=u||1/0;return this.overwriteGetter("rgb",[t/d,r/d,o/d,u])}get hcl(){return this.overwriteGetter("hcl",RW(this.rgb))}get lab(){return this.overwriteGetter("lab",F3(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,o,u]=this.rgb;return`rgba(${[t,r,o].map(d=>Math.round(d*255)).join(",")},${u})`}static interpolate(t,r,o,u="rgb"){switch(u){case"rgb":{const[d,h,s,b]=Qm(t.rgb,r.rgb,o);return new Er(d,h,s,b,!1)}case"hcl":{const[d,h,s,b]=t.hcl,[w,C,k,I]=r.hcl;let A,B;if(!isNaN(d)&&!isNaN(w)){let U=w-d;w>d&&U>180?U-=360:w<d&&d-w>180&&(U+=360),A=d+o*U}else isNaN(d)?isNaN(w)?A=NaN:(A=w,(s===1||s===0)&&(B=C)):(A=d,(k===1||k===0)&&(B=h));const[F,X,q,V]=LW([A,B??Zu(h,C,o),Zu(s,k,o),Zu(b,I,o)]);return new Er(F,X,q,V,!1)}case"lab":{const[d,h,s,b]=B3(Qm(t.lab,r.lab,o));return new Er(d,h,s,b,!1)}}}}Er.black=new Er(0,0,0,1);Er.white=new Er(1,1,1,1);Er.transparent=new Er(0,0,0,0);Er.red=new Er(1,0,0,1);class aT{constructor(t,r,o){t?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const OW=["bottom","center","top"];class n2{constructor(t,r,o,u,d,h){this.text=t,this.image=r,this.scale=o,this.fontStack=u,this.textColor=d,this.verticalAlign=h}}class Ha{constructor(t){this.sections=t}static fromString(t){return new Ha([new n2(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Ha?t:Ha.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Es{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Es)return t;if(typeof t=="number")return new Es([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]];break}return new Es(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o){return new Es(Qm(t.values,r.values,o))}}class Ms{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ms)return t;if(typeof t=="number")return new Ms([t]);if(Array.isArray(t)){for(const r of t)if(typeof r!="number")return;return new Ms(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o){return new Ms(Qm(t.values,r.values,o))}}class Co{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Co)return t;if(typeof t=="string"){const o=Er.parse(t);return o?new Co([o]):void 0}if(!Array.isArray(t))return;const r=[];for(const o of t){if(typeof o!="string")return;const u=Er.parse(o);if(!u)return;r.push(u)}return new Co(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o,u="rgb"){const d=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let h=0;h<t.values.length;h++)d.push(Er.interpolate(t.values[h],r.values[h],o,u));return new Co(d)}}class sn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const FW=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class fa{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof fa)return t;if(!(!Array.isArray(t)||t.length<1||t.length%2!==0)){for(let r=0;r<t.length;r+=2){const o=t[r],u=t[r+1];if(typeof o!="string"||!FW.has(o)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new fa(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o){const u=t.values,d=r.values;if(u.length!==d.length)throw new sn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const h=[];for(let s=0;s<u.length;s+=2){if(u[s]!==d[s])throw new sn(`Cannot interpolate values containing mismatched anchors. from[${s}]: ${u[s]}, to[${s}]: ${d[s]}`);h.push(u[s]);const[b,w]=u[s+1],[C,k]=d[s+1];h.push([Zu(b,C,o),Zu(w,k,o)])}return new fa(h)}}class Ec{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ec({name:t,available:!1}):null}}class Cs{constructor(t,r,o){this.from=t,this.to=r,this.transition=o}static interpolate(t,r,o){return new Cs(t,r,o)}static parse(t){if(t instanceof Cs)return t;if(Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number")return new Cs(t[0],t[1],t[2]);if(typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number")return new Cs(t.from,t.to,t.transition);if(typeof t=="string")return new Cs(t,t,1)}}function $3(e,t,r,o){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?typeof o>"u"||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[e,t,r,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[e,t,r,o]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Jm(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Cs||e instanceof Er||e instanceof aT||e instanceof Ha||e instanceof Es||e instanceof Ms||e instanceof Co||e instanceof fa||e instanceof Ec)return!0;if(Array.isArray(e)){for(const t of e)if(!Jm(t))return!1;return!0}else if(typeof e=="object"){for(const t in e)if(!Jm(e[t]))return!1;return!0}else return!1}function On(e){if(e===null)return E_;if(typeof e=="string")return sr;if(typeof e=="boolean")return tr;if(typeof e=="number")return gt;if(e instanceof Er)return pa;if(e instanceof Cs)return M_;if(e instanceof aT)return k_;if(e instanceof Ha)return A_;if(e instanceof Es)return I_;if(e instanceof Ms)return R_;if(e instanceof Co)return Xm;if(e instanceof fa)return L_;if(e instanceof Ec)return Sg;if(Array.isArray(e)){const t=e.length;let r;for(const o of e){const u=On(o);if(!r)r=u;else{if(r===u)continue;r=Kt;break}}return So(r||Kt,t)}else return Gu}function xm(e){const t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Er||e instanceof Cs||e instanceof Ha||e instanceof Es||e instanceof Ms||e instanceof Co||e instanceof fa||e instanceof Ec?e.toString():JSON.stringify(e)}class dp{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Jm(t[1]))return r.error("invalid value");const o=t[1];let u=On(o);const d=r.expectedType;return u.kind==="array"&&u.N===0&&d&&d.kind==="array"&&(typeof d.N!="number"||d.N===0)&&(u=d),new dp(u,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const pv={string:sr,number:gt,boolean:tr,object:Gu};class Ps{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let o=1,u;const d=t[0];if(d==="array"){let s;if(t.length>2){const w=t[1];if(typeof w!="string"||!(w in pv)||w==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=pv[w],o++}else s=Kt;let b;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);b=t[2],o++}u=So(s,b)}else{if(!pv[d])throw new Error(`Types doesn't contain name = ${d}`);u=pv[d]}const h=[];for(;o<t.length;o++){const s=r.parse(t[o],o,Kt);if(!s)return null;h.push(s)}return new Ps(u,h)}evaluate(t){for(let r=0;r<this.args.length;r++){const o=this.args[r].evaluate(t);if(Ym(this.type,On(o))){if(r===this.args.length-1)throw new sn(`Expected value to be of type ${Qr(this.type)}, but found ${Qr(On(o))} instead.`)}else return o}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const jk={"to-boolean":tr,"to-color":pa,"to-number":gt,"to-string":sr};class oc{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const o=t[0];if(!jk[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return r.error("Expected one argument.");const u=jk[o],d=[];for(let h=1;h<t.length;h++){const s=r.parse(t[h],h,Kt);if(!s)return null;d.push(s)}return new oc(u,d)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,o;for(const u of this.args){if(r=u.evaluate(t),o=null,r instanceof Er)return r;if(typeof r=="string"){const d=t.parseColor(r);if(d)return d}else if(Array.isArray(r)&&(r.length<3||r.length>4?o=`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:o=$3(r[0],r[1],r[2],r[3]),!o))return new Er(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new sn(o||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const o of this.args){r=o.evaluate(t);const u=Es.parse(r);if(u)return u}throw new sn(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(const o of this.args){r=o.evaluate(t);const u=Ms.parse(r);if(u)return u}throw new sn(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(const o of this.args){r=o.evaluate(t);const u=Co.parse(r);if(u)return u}throw new sn(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const o of this.args){r=o.evaluate(t);const u=fa.parse(r);if(u)return u}throw new sn(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const o of this.args){if(r=o.evaluate(t),r===null)return 0;const u=Number(r);if(!isNaN(u))return u}throw new sn(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Ha.fromString(xm(this.args[0].evaluate(t)));case"resolvedImage":return Ec.fromString(xm(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return xm(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const BW=["Unknown","Point","LineString","Polygon"];class V3{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?BW[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=Er.parse(t),this._parseColorCache.set(t,r)),r}}class D_{constructor(t,r,o=[],u,d=new oT,h=[]){this.registry=t,this.path=o,this.key=o.map(s=>`[${s}]`).join(""),this.scope=d,this.errors=h,this.expectedType=u,this._isConstant=r}parse(t,r,o,u,d={}){return r?this.concat(r,o,u)._parse(t,d):this._parse(t,d)}_parse(t,r){(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number")&&(t=["literal",t]);function o(u,d,h){return h==="assert"?new Ps(d,[u]):h==="coerce"?new oc(d,[u]):u}if(Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=t[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const d=this.registry[u];if(d){let h=d.parse(t,this);if(!h)return null;if(this.expectedType){const s=this.expectedType,b=h.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&b.kind==="value")h=o(h,s,r.typeAnnotation||"assert");else if(s.kind==="projectionDefinition"&&["string","array"].includes(b.kind)||["color","formatted","resolvedImage"].includes(s.kind)&&["value","string"].includes(b.kind)||["padding","numberArray"].includes(s.kind)&&["value","number","array"].includes(b.kind)||s.kind==="colorArray"&&["value","string","array"].includes(b.kind)||s.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(b.kind))h=o(h,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,b))return null}if(!(h instanceof dp)&&h.type.kind!=="resolvedImage"&&this._isConstant(h)){const s=new V3;try{h=new dp(h.type,h.evaluate(s))}catch(b){return this.error(b.message),null}}return h}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof t>"u"?this.error("'undefined' value invalid. Use null instead."):typeof t=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,r,o){const u=typeof t=="number"?this.path.concat(t):this.path,d=o?this.scope.concat(o):this.scope;return new D_(this.registry,this._isConstant,u,r||null,d,this.errors)}error(t,...r){const o=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new sa(o,t))}checkSubtype(t,r){const o=Ym(t,r);return o&&this.error(o),o}}class z_{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let d=1;d<t.length-1;d+=2){const h=t[d];if(typeof h!="string")return r.error(`Expected string, but found ${typeof h} instead.`,d);if(/[^a-zA-Z0-9_]/.test(h))return r.error("Variable names must contain only alphanumeric characters or '_'.",d);const s=r.parse(t[d+1],d+1);if(!s)return null;o.push([h,s])}const u=r.parse(t[t.length-1],t.length-1,r.expectedType,o);return u?new z_(o,u):null}outputDefined(){return this.result.outputDefined()}}class N_{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const o=t[1];return r.scope.has(o)?new N_(o,r.scope.get(o)):r.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class lT{constructor(t,r,o){this.type=t,this.index=r,this.input=o}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,gt),u=r.parse(t[2],2,So(r.expectedType||Kt));if(!o||!u)return null;const d=u.type;return new lT(d.itemType,o,u)}evaluate(t){const r=this.index.evaluate(t),o=this.input.evaluate(t);if(r<0)throw new sn(`Array index out of bounds: ${r} < 0.`);if(r>=o.length)throw new sn(`Array index out of bounds: ${r} > ${o.length-1}.`);if(r!==Math.floor(r))throw new sn(`Array index must be an integer, but found ${r} instead.`);return o[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class cT{constructor(t,r){this.type=tr,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,Kt),u=r.parse(t[2],2,Kt);return!o||!u?null:sT(o.type,[tr,sr,gt,E_,Kt])?new cT(o,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(o.type)} instead`)}evaluate(t){const r=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!qu(r,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(On(r))} instead.`);if(!qu(o,["string","array"]))throw new sn(`Expected second argument to be of type array or string, but found ${Qr(On(o))} instead.`);return o.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class z0{constructor(t,r,o){this.type=gt,this.needle=t,this.haystack=r,this.fromIndex=o}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,Kt),u=r.parse(t[2],2,Kt);if(!o||!u)return null;if(!sT(o.type,[tr,sr,gt,E_,Kt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(o.type)} instead`);if(t.length===4){const d=r.parse(t[3],3,gt);return d?new z0(o,u,d):null}else return new z0(o,u)}evaluate(t){const r=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!qu(r,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(On(r))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(t)),qu(o,["string"])){const d=o.indexOf(r,u);return d===-1?-1:[...o.slice(0,d)].length}else{if(qu(o,["array"]))return o.indexOf(r,u);throw new sn(`Expected second argument to be of type array or string, but found ${Qr(On(o))} instead.`)}}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class uT{constructor(t,r,o,u,d,h){this.inputType=t,this.type=r,this.input=o,this.cases=u,this.outputs=d,this.otherwise=h}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!==1)return r.error("Expected an even number of arguments.");let o,u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const d={},h=[];for(let w=2;w<t.length-1;w+=2){let C=t[w];const k=t[w+1];Array.isArray(C)||(C=[C]);const I=r.concat(w);if(C.length===0)return I.error("Expected at least one branch label.");for(const B of C){if(typeof B!="number"&&typeof B!="string")return I.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return I.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return I.error("Numeric branch labels must be integer values.");if(!o)o=On(B);else if(I.checkSubtype(o,On(B)))return null;if(typeof d[String(B)]<"u")return I.error("Branch labels must be unique.");d[String(B)]=h.length}const A=r.parse(k,w,u);if(!A)return null;u=u||A.type,h.push(A)}const s=r.parse(t[1],1,Kt);if(!s)return null;const b=r.parse(t[t.length-1],t.length-1,u);return!b||s.type.kind!=="value"&&r.concat(1).checkSubtype(o,s.type)?null:new uT(o,u,s,d,h,b)}evaluate(t){const r=this.input.evaluate(t);return(On(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class hT{constructor(t,r,o){this.type=t,this.branches=r,this.otherwise=o}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!==0)return r.error("Expected an odd number of arguments.");let o;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);const u=[];for(let h=1;h<t.length-1;h+=2){const s=r.parse(t[h],h,tr);if(!s)return null;const b=r.parse(t[h+1],h+1,o);if(!b)return null;u.push([s,b]),o=o||b.type}const d=r.parse(t[t.length-1],t.length-1,o);if(!d)return null;if(!o)throw new Error("Can't infer output type");return new hT(o,u,d)}evaluate(t){for(const[r,o]of this.branches)if(r.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,o]of this.branches)t(r),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class N0{constructor(t,r,o,u){this.type=t,this.input=r,this.beginIndex=o,this.endIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,Kt),u=r.parse(t[2],2,gt);if(!o||!u)return null;if(!sT(o.type,[So(Kt),sr,Kt]))return r.error(`Expected first argument to be of type array or string, but found ${Qr(o.type)} instead`);if(t.length===4){const d=r.parse(t[3],3,gt);return d?new N0(o.type,o,u,d):null}else return new N0(o.type,o,u)}evaluate(t){const r=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let u;if(this.endIndex&&(u=this.endIndex.evaluate(t)),qu(r,["string"]))return[...r].slice(o,u).join("");if(qu(r,["array"]))return r.slice(o,u);throw new sn(`Expected first argument to be of type array or string, but found ${Qr(On(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function U3(e,t){const r=e.length-1;let o=0,u=r,d=0,h,s;for(;o<=u;)if(d=Math.floor((o+u)/2),h=e[d],s=e[d+1],h<=t){if(d===r||t<s)return d;o=d+1}else if(h>t)u=d-1;else throw new sn("Input is not a number.");return 0}class j_{constructor(t,r,o){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[u,d]of o)this.labels.push(u),this.outputs.push(d)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");const o=r.parse(t[1],1,gt);if(!o)return null;const u=[];let d=null;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);for(let h=1;h<t.length;h+=2){const s=h===1?-1/0:t[h],b=t[h+1],w=h,C=h+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(u.length&&u[u.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);const k=r.parse(b,C,d);if(!k)return null;d=d||k.type,u.push([s,k])}return new j_(d,o,u)}evaluate(t){const r=this.labels,o=this.outputs;if(r.length===1)return o[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return o[0].evaluate(t);const d=r.length;if(u>=r[d-1])return o[d-1].evaluate(t);const h=U3(r,u);return o[h].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function $W(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lb,Ok;function VW(){if(Ok)return lb;Ok=1,lb=e;function e(t,r,o,u){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=o,this.p2y=u}return e.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,u=0;u<8;u++){var d=this.sampleCurveX(o)-t;if(Math.abs(d)<r)return o;var h=this.sampleCurveDerivativeX(o);if(Math.abs(h)<1e-6)break;o=o-d/h}var s=0,b=1;for(o=t,u=0;u<20&&(d=this.sampleCurveX(o),!(Math.abs(d-t)<r));u++)t>d?s=o:b=o,o=(b-s)*.5+s;return o},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},lb}var UW=VW(),GW=$W(UW);class ma{constructor(t,r,o,u,d){this.type=t,this.operator=r,this.interpolation=o,this.input=u,this.labels=[],this.outputs=[];for(const[h,s]of d)this.labels.push(h),this.outputs.push(s)}static interpolationFactor(t,r,o,u){let d=0;if(t.name==="exponential")d=cb(r,t.base,o,u);else if(t.name==="linear")d=cb(r,1,o,u);else if(t.name==="cubic-bezier"){const h=t.controlPoints;d=new GW(h[0],h[1],h[2],h[3]).solve(cb(r,1,o,u))}return d}static parse(t,r){let[o,u,d,...h]=t;if(!Array.isArray(u)||u.length===0)return r.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const w=u[1];if(typeof w!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:w}}else if(u[0]==="cubic-bezier"){const w=u.slice(1);if(w.length!==4||w.some(C=>typeof C!="number"||C<0||C>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:w}}else return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(d=r.parse(d,2,gt),!d)return null;const s=[];let b=null;(o==="interpolate-hcl"||o==="interpolate-lab")&&r.expectedType!=Xm?b=pa:r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let w=0;w<h.length;w+=2){const C=h[w],k=h[w+1],I=w+3,A=w+4;if(typeof C!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(s.length&&s[s.length-1][0]>=C)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',I);const B=r.parse(k,A,b);if(!B)return null;b=b||B.type,s.push([C,B])}return!$l(b,gt)&&!$l(b,M_)&&!$l(b,pa)&&!$l(b,I_)&&!$l(b,R_)&&!$l(b,Xm)&&!$l(b,L_)&&!$l(b,So(gt))?r.error(`Type ${Qr(b)} is not interpolatable.`):new ma(b,o,u,d,s)}evaluate(t){const r=this.labels,o=this.outputs;if(r.length===1)return o[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return o[0].evaluate(t);const d=r.length;if(u>=r[d-1])return o[d-1].evaluate(t);const h=U3(r,u),s=r[h],b=r[h+1],w=ma.interpolationFactor(this.interpolation,u,s,b),C=o[h].evaluate(t),k=o[h+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Zu(C,k,w);case"color":return Er.interpolate(C,k,w);case"padding":return Es.interpolate(C,k,w);case"colorArray":return Co.interpolate(C,k,w);case"numberArray":return Ms.interpolate(C,k,w);case"variableAnchorOffsetCollection":return fa.interpolate(C,k,w);case"array":return Qm(C,k,w);case"projectionDefinition":return Cs.interpolate(C,k,w)}case"interpolate-hcl":switch(this.type.kind){case"color":return Er.interpolate(C,k,w,"hcl");case"colorArray":return Co.interpolate(C,k,w,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Er.interpolate(C,k,w,"lab");case"colorArray":return Co.interpolate(C,k,w,"lab")}}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function cb(e,t,r,o){const u=o-r,d=e-r;return u===0?0:t===1?d/u:(Math.pow(t,d)-1)/(Math.pow(t,u)-1)}class eg{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let o=null;const u=r.expectedType;u&&u.kind!=="value"&&(o=u);const d=[];for(const h of t.slice(1)){const s=r.parse(h,1+d.length,o,void 0,{typeAnnotation:"omit"});if(!s)return null;o=o||s.type,d.push(s)}if(!o)throw new Error("No output type");return u&&d.some(h=>Ym(u,h.type))?new eg(Kt,d):new eg(o,d)}evaluate(t){let r=null,o=0,u;for(const d of this.args)if(o++,r=d.evaluate(t),r&&r instanceof Ec&&!r.available&&(u||(u=r.name),r=null,o===this.args.length&&(r=u)),r!==null)break;return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Fk(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function qW(e,t,r){return t===r}function ZW(e,t,r){return t!==r}function WW(e,t,r){return t<r}function HW(e,t,r){return t>r}function KW(e,t,r){return t<=r}function XW(e,t,r){return t>=r}function G3(e,t,r,o){return o.compare(t,r)===0}function YW(e,t,r,o){return!G3(e,t,r,o)}function QW(e,t,r,o){return o.compare(t,r)<0}function JW(e,t,r,o){return o.compare(t,r)>0}function eH(e,t,r,o){return o.compare(t,r)<=0}function tH(e,t,r,o){return o.compare(t,r)>=0}function Sp(e,t,r){const o=e!=="=="&&e!=="!=";return class q3{constructor(d,h,s){this.type=tr,this.lhs=d,this.rhs=h,this.collator=s,this.hasUntypedArgument=d.type.kind==="value"||h.type.kind==="value"}static parse(d,h){if(d.length!==3&&d.length!==4)return h.error("Expected two or three arguments.");const s=d[0];let b=h.parse(d[1],1,Kt);if(!b)return null;if(!Fk(s,b.type))return h.concat(1).error(`"${s}" comparisons are not supported for type '${Qr(b.type)}'.`);let w=h.parse(d[2],2,Kt);if(!w)return null;if(!Fk(s,w.type))return h.concat(2).error(`"${s}" comparisons are not supported for type '${Qr(w.type)}'.`);if(b.type.kind!==w.type.kind&&b.type.kind!=="value"&&w.type.kind!=="value")return h.error(`Cannot compare types '${Qr(b.type)}' and '${Qr(w.type)}'.`);o&&(b.type.kind==="value"&&w.type.kind!=="value"?b=new Ps(w.type,[b]):b.type.kind!=="value"&&w.type.kind==="value"&&(w=new Ps(b.type,[w])));let C=null;if(d.length===4){if(b.type.kind!=="string"&&w.type.kind!=="string"&&b.type.kind!=="value"&&w.type.kind!=="value")return h.error("Cannot use collator to compare non-string types.");if(C=h.parse(d[3],3,k_),!C)return null}return new q3(b,w,C)}evaluate(d){const h=this.lhs.evaluate(d),s=this.rhs.evaluate(d);if(o&&this.hasUntypedArgument){const b=On(h),w=On(s);if(b.kind!==w.kind||!(b.kind==="string"||b.kind==="number"))throw new sn(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${b.kind}, ${w.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const b=On(h),w=On(s);if(b.kind!=="string"||w.kind!=="string")return t(d,h,s)}return this.collator?r(d,h,s,this.collator.evaluate(d)):t(d,h,s)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}}}const rH=Sp("==",qW,G3),nH=Sp("!=",ZW,YW),iH=Sp("<",WW,QW),oH=Sp(">",HW,JW),sH=Sp("<=",KW,eH),aH=Sp(">=",XW,tH);class O_{constructor(t,r,o){this.type=k_,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return r.error("Collator options argument must be an object.");const u=r.parse(o["case-sensitive"]===void 0?!1:o["case-sensitive"],1,tr);if(!u)return null;const d=r.parse(o["diacritic-sensitive"]===void 0?!1:o["diacritic-sensitive"],1,tr);if(!d)return null;let h=null;return o.locale&&(h=r.parse(o.locale,1,sr),!h)?null:new O_(u,d,h)}evaluate(t){return new aT(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class dT{constructor(t,r,o,u,d){this.type=sr,this.number=t,this.locale=r,this.currency=o,this.minFractionDigits=u,this.maxFractionDigits=d}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const o=r.parse(t[1],1,gt);if(!o)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=r.parse(u.locale,1,sr),!d))return null;let h=null;if(u.currency&&(h=r.parse(u.currency,1,sr),!h))return null;let s=null;if(u["min-fraction-digits"]&&(s=r.parse(u["min-fraction-digits"],1,gt),!s))return null;let b=null;return u["max-fraction-digits"]&&(b=r.parse(u["max-fraction-digits"],1,gt),!b)?null:new dT(o,d,h,s,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class pT{constructor(t){this.type=A_,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return r.error("First argument must be an image or text section.");const u=[];let d=!1;for(let h=1;h<=t.length-1;++h){const s=t[h];if(d&&typeof s=="object"&&!Array.isArray(s)){d=!1;let b=null;if(s["font-scale"]&&(b=r.parse(s["font-scale"],1,gt),!b))return null;let w=null;if(s["text-font"]&&(w=r.parse(s["text-font"],1,So(sr)),!w))return null;let C=null;if(s["text-color"]&&(C=r.parse(s["text-color"],1,pa),!C))return null;let k=null;if(s["vertical-align"]){if(typeof s["vertical-align"]=="string"&&!OW.includes(s["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${s["vertical-align"]}' instead.`);if(k=r.parse(s["vertical-align"],1,sr),!k)return null}const I=u[u.length-1];I.scale=b,I.font=w,I.textColor=C,I.verticalAlign=k}else{const b=r.parse(t[h],1,Kt);if(!b)return null;const w=b.type.kind;if(w!=="string"&&w!=="value"&&w!=="null"&&w!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:b,scale:null,font:null,textColor:null,verticalAlign:null})}}return new pT(u)}evaluate(t){const r=o=>{const u=o.content.evaluate(t);return On(u)===Sg?new n2("",u,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(t):null):new n2(xm(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null,o.verticalAlign?o.verticalAlign.evaluate(t):null)};return new Ha(this.sections.map(r))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class fT{constructor(t){this.type=Sg,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const o=r.parse(t[1],1,sr);return o?new fT(o):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),o=Ec.fromString(r);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(r)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class mT{constructor(t){this.type=gt,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=r.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Qr(o.type)} instead.`):new mT(o):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new sn(`Expected value to be of type string or array, but found ${Qr(On(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ga=8192;function lH(e,t){const r=cH(e[0]),o=hH(e[1]),u=Math.pow(2,t.z);return[Math.round(r*u*ga),Math.round(o*u*ga)]}function gT(e,t){const r=Math.pow(2,t.z),o=(e[0]/ga+t.x)/r,u=(e[1]/ga+t.y)/r;return[uH(o),dH(u)]}function cH(e){return(180+e)/360}function uH(e){return e*360-180}function hH(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function dH(e){return 360/Math.PI*Math.atan(Math.exp((180-e*360)*Math.PI/180))-90}function Tg(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function tg(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function pH(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function fH(e,t,r){const o=e[0]-t[0],u=e[1]-t[1],d=e[0]-r[0],h=e[1]-r[1];return o*h-d*u===0&&o*d<=0&&u*h<=0}function F_(e,t,r,o){const u=[t[0]-e[0],t[1]-e[1]],d=[o[0]-r[0],o[1]-r[1]];return vH(d,u)===0?!1:!!(Bk(e,t,r,o)&&Bk(r,o,e,t))}function mH(e,t,r){for(const o of r)for(let u=0;u<o.length-1;++u)if(F_(e,t,o[u],o[u+1]))return!0;return!1}function Tp(e,t,r=!1){let o=!1;for(const u of t)for(let d=0;d<u.length-1;d++){if(fH(e,u[d],u[d+1]))return r;pH(e,u[d],u[d+1])&&(o=!o)}return o}function gH(e,t){for(const r of t)if(Tp(e,r))return!0;return!1}function Z3(e,t){for(const r of e)if(!Tp(r,t))return!1;for(let r=0;r<e.length-1;++r)if(mH(e[r],e[r+1],t))return!1;return!0}function yH(e,t){for(const r of t)if(Z3(e,r))return!0;return!1}function vH(e,t){return e[0]*t[1]-e[1]*t[0]}function Bk(e,t,r,o){const u=e[0]-r[0],d=e[1]-r[1],h=t[0]-r[0],s=t[1]-r[1],b=o[0]-r[0],w=o[1]-r[1],C=u*w-b*d,k=h*w-b*s;return C>0&&k<0||C<0&&k>0}function yT(e,t,r){const o=[];for(let u=0;u<e.length;u++){const d=[];for(let h=0;h<e[u].length;h++){const s=lH(e[u][h],r);Tg(t,s),d.push(s)}o.push(d)}return o}function W3(e,t,r){const o=[];for(let u=0;u<e.length;u++){const d=yT(e[u],t,r);o.push(d)}return o}function H3(e,t,r,o){if(e[0]<r[0]||e[0]>r[2]){const u=o*.5;let d=e[0]-r[0]>u?-o:r[0]-e[0]>u?o:0;d===0&&(d=e[0]-r[2]>u?-o:r[2]-e[0]>u?o:0),e[0]+=d}Tg(t,e)}function _H(e){e[0]=e[1]=1/0,e[2]=e[3]=-1/0}function $k(e,t,r,o){const u=Math.pow(2,o.z)*ga,d=[o.x*ga,o.y*ga],h=[];for(const s of e)for(const b of s){const w=[b.x+d[0],b.y+d[1]];H3(w,t,r,u),h.push(w)}return h}function Vk(e,t,r,o){const u=Math.pow(2,o.z)*ga,d=[o.x*ga,o.y*ga],h=[];for(const s of e){const b=[];for(const w of s){const C=[w.x+d[0],w.y+d[1]];Tg(t,C),b.push(C)}h.push(b)}if(t[2]-t[0]<=u/2){_H(t);for(const s of h)for(const b of s)H3(b,t,r,u)}return h}function xH(e,t){const r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],u=e.canonicalID();if(t.type==="Polygon"){const d=yT(t.coordinates,o,u),h=$k(e.geometry(),r,o,u);if(!tg(r,o))return!1;for(const s of h)if(!Tp(s,d))return!1}if(t.type==="MultiPolygon"){const d=W3(t.coordinates,o,u),h=$k(e.geometry(),r,o,u);if(!tg(r,o))return!1;for(const s of h)if(!gH(s,d))return!1}return!0}function bH(e,t){const r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],u=e.canonicalID();if(t.type==="Polygon"){const d=yT(t.coordinates,o,u),h=Vk(e.geometry(),r,o,u);if(!tg(r,o))return!1;for(const s of h)if(!Z3(s,d))return!1}if(t.type==="MultiPolygon"){const d=W3(t.coordinates,o,u),h=Vk(e.geometry(),r,o,u);if(!tg(r,o))return!1;for(const s of h)if(!yH(s,d))return!1}return!0}class Wu{constructor(t,r){this.type=tr,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Jm(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const u=[];for(const d of o.features){const{type:h,coordinates:s}=d.geometry;h==="Polygon"&&u.push(s),h==="MultiPolygon"&&u.push(...s)}if(u.length){const d={type:"MultiPolygon",coordinates:u};return new Wu(o,d)}}else if(o.type==="Feature"){const u=o.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Wu(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Wu(o,o)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return xH(t,this.geometries);if(t.geometryType()==="LineString")return bH(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class K3{constructor(t=[],r=(o,u)=>o<u?-1:o>u?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:o}=this,u=r[t];for(;t>0;){const d=t-1>>1,h=r[d];if(o(u,h)>=0)break;r[t]=h,t=d}r[t]=u}_down(t){const{data:r,compare:o}=this,u=this.length>>1,d=r[t];for(;t<u;){let h=(t<<1)+1;const s=h+1;if(s<this.length&&o(r[s],r[h])<0&&(h=s),o(r[h],d)>=0)break;r[t]=r[h],t=h}r[t]=d}}function wH(e,t){if(e.length<=1)return[e];const r=[];let o,u;for(const d of e){const h=SH(d);h!==0&&(d.area=Math.abs(h),u===void 0&&(u=h<0),u===h<0?(o&&r.push(o),o=[d]):o.push(d))}return o&&r.push(o),r}function SH(e){let t=0;for(let r=0,o=e.length,u=o-1,d,h;r<o;u=r++)d=e[r],h=e[u],t+=(h.x-d.x)*(d.y+h.y);return t}const TH=6378.137,Uk=1/298.257223563,Gk=Uk*(2-Uk),qk=Math.PI/180;class vT{constructor(t){const r=qk*TH*1e3,o=Math.cos(t*qk),u=1/(1-Gk*(1-o*o)),d=Math.sqrt(u);this.kx=r*d*o,this.ky=r*d*u*(1-Gk)}distance(t,r){const o=this.wrap(t[0]-r[0])*this.kx,u=(t[1]-r[1])*this.ky;return Math.sqrt(o*o+u*u)}pointOnLine(t,r){let o=1/0,u,d,h,s;for(let b=0;b<t.length-1;b++){let w=t[b][0],C=t[b][1],k=this.wrap(t[b+1][0]-w)*this.kx,I=(t[b+1][1]-C)*this.ky,A=0;(k!==0||I!==0)&&(A=(this.wrap(r[0]-w)*this.kx*k+(r[1]-C)*this.ky*I)/(k*k+I*I),A>1?(w=t[b+1][0],C=t[b+1][1]):A>0&&(w+=k/this.kx*A,C+=I/this.ky*A)),k=this.wrap(r[0]-w)*this.kx,I=(r[1]-C)*this.ky;const B=k*k+I*I;B<o&&(o=B,u=w,d=C,h=b,s=A)}return{point:[u,d],index:h,t:Math.max(0,Math.min(1,s))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}const i2=100,o2=50;function X3(e,t){return t[0]-e[0]}function j0(e){return e[1]-e[0]+1}function il(e,t){return e[1]>=e[0]&&e[1]<t}function s2(e,t){if(e[0]>e[1])return[null,null];const r=j0(e);if(t){if(r===2)return[e,null];const u=Math.floor(r/2);return[[e[0],e[0]+u],[e[0]+u,e[1]]]}if(r===1)return[e,null];const o=Math.floor(r/2)-1;return[[e[0],e[0]+o],[e[0]+o+1,e[1]]]}function a2(e,t){if(!il(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)Tg(r,e[o]);return r}function l2(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const o of r)Tg(t,o);return t}function Zk(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function _T(e,t,r){if(!Zk(e)||!Zk(t))return NaN;let o=0,u=0;return e[2]<t[0]&&(o=t[0]-e[2]),e[0]>t[2]&&(o=e[0]-t[2]),e[1]>t[3]&&(u=e[1]-t[3]),e[3]<t[1]&&(u=t[1]-e[3]),r.distance([0,0],[o,u])}function Du(e,t,r){const o=r.pointOnLine(t,e);return r.distance(e,o.point)}function xT(e,t,r,o,u){const d=Math.min(Du(e,[r,o],u),Du(t,[r,o],u)),h=Math.min(Du(r,[e,t],u),Du(o,[e,t],u));return Math.min(d,h)}function CH(e,t,r,o,u){if(!(il(t,e.length)&&il(o,r.length)))return 1/0;let d=1/0;for(let h=t[0];h<t[1];++h){const s=e[h],b=e[h+1];for(let w=o[0];w<o[1];++w){const C=r[w],k=r[w+1];if(F_(s,b,C,k))return 0;d=Math.min(d,xT(s,b,C,k,u))}}return d}function PH(e,t,r,o,u){if(!(il(t,e.length)&&il(o,r.length)))return NaN;let d=1/0;for(let h=t[0];h<=t[1];++h)for(let s=o[0];s<=o[1];++s)if(d=Math.min(d,u.distance(e[h],r[s])),d===0)return d;return d}function EH(e,t,r){if(Tp(e,t,!0))return 0;let o=1/0;for(const u of t){const d=u[0],h=u[u.length-1];if(d!==h&&(o=Math.min(o,Du(e,[h,d],r)),o===0))return o;const s=r.pointOnLine(u,e);if(o=Math.min(o,r.distance(e,s.point)),o===0)return o}return o}function MH(e,t,r,o){if(!il(t,e.length))return NaN;for(let d=t[0];d<=t[1];++d)if(Tp(e[d],r,!0))return 0;let u=1/0;for(let d=t[0];d<t[1];++d){const h=e[d],s=e[d+1];for(const b of r)for(let w=0,C=b.length,k=C-1;w<C;k=w++){const I=b[k],A=b[w];if(F_(h,s,I,A))return 0;u=Math.min(u,xT(h,s,I,A,o))}}return u}function Wk(e,t){for(const r of e)for(const o of r)if(Tp(o,t,!0))return!0;return!1}function kH(e,t,r,o=1/0){const u=l2(e),d=l2(t);if(o!==1/0&&_T(u,d,r)>=o)return o;if(tg(u,d)){if(Wk(e,t))return 0}else if(Wk(t,e))return 0;let h=1/0;for(const s of e)for(let b=0,w=s.length,C=w-1;b<w;C=b++){const k=s[C],I=s[b];for(const A of t)for(let B=0,F=A.length,X=F-1;B<F;X=B++){const q=A[X],V=A[B];if(F_(k,I,q,V))return 0;h=Math.min(h,xT(k,I,q,V,r))}}return h}function Hk(e,t,r,o,u,d){if(!d)return;const h=_T(a2(o,d),u,r);h<t&&e.push([h,d,[0,0]])}function fv(e,t,r,o,u,d,h){if(!d||!h)return;const s=_T(a2(o,d),a2(u,h),r);s<t&&e.push([s,d,h])}function O0(e,t,r,o,u=1/0){let d=Math.min(o.distance(e[0],r[0][0]),u);if(d===0)return d;const h=new K3([[0,[0,e.length-1],[0,0]]],X3),s=l2(r);for(;h.length>0;){const b=h.pop();if(b[0]>=d)continue;const w=b[1],C=t?o2:i2;if(j0(w)<=C){if(!il(w,e.length))return NaN;if(t){const k=MH(e,w,r,o);if(isNaN(k)||k===0)return k;d=Math.min(d,k)}else for(let k=w[0];k<=w[1];++k){const I=EH(e[k],r,o);if(d=Math.min(d,I),d===0)return 0}}else{const k=s2(w,t);Hk(h,d,o,e,s,k[0]),Hk(h,d,o,e,s,k[1])}}return d}function F0(e,t,r,o,u,d=1/0){let h=Math.min(d,u.distance(e[0],r[0]));if(h===0)return h;const s=new K3([[0,[0,e.length-1],[0,r.length-1]]],X3);for(;s.length>0;){const b=s.pop();if(b[0]>=h)continue;const w=b[1],C=b[2],k=t?o2:i2,I=o?o2:i2;if(j0(w)<=k&&j0(C)<=I){if(!il(w,e.length)&&il(C,r.length))return NaN;let A;if(t&&o)A=CH(e,w,r,C,u),h=Math.min(h,A);else if(t&&!o){const B=e.slice(w[0],w[1]+1);for(let F=C[0];F<=C[1];++F)if(A=Du(r[F],B,u),h=Math.min(h,A),h===0)return h}else if(!t&&o){const B=r.slice(C[0],C[1]+1);for(let F=w[0];F<=w[1];++F)if(A=Du(e[F],B,u),h=Math.min(h,A),h===0)return h}else A=PH(e,w,r,C,u),h=Math.min(h,A)}else{const A=s2(w,t),B=s2(C,o);fv(s,h,u,e,r,A[0],B[0]),fv(s,h,u,e,r,A[0],B[1]),fv(s,h,u,e,r,A[1],B[0]),fv(s,h,u,e,r,A[1],B[1])}}return h}function AH(e,t){const r=e.geometry(),o=r.flat().map(h=>gT([h.x,h.y],e.canonical));if(r.length===0)return NaN;const u=new vT(o[0][1]);let d=1/0;for(const h of t){switch(h.type){case"Point":d=Math.min(d,F0(o,!1,[h.coordinates],!1,u,d));break;case"LineString":d=Math.min(d,F0(o,!1,h.coordinates,!0,u,d));break;case"Polygon":d=Math.min(d,O0(o,!1,h.coordinates,u,d));break}if(d===0)return d}return d}function IH(e,t){const r=e.geometry(),o=r.flat().map(h=>gT([h.x,h.y],e.canonical));if(r.length===0)return NaN;const u=new vT(o[0][1]);let d=1/0;for(const h of t){switch(h.type){case"Point":d=Math.min(d,F0(o,!0,[h.coordinates],!1,u,d));break;case"LineString":d=Math.min(d,F0(o,!0,h.coordinates,!0,u,d));break;case"Polygon":d=Math.min(d,O0(o,!0,h.coordinates,u,d));break}if(d===0)return d}return d}function RH(e,t){const r=e.geometry();if(r.length===0||r[0].length===0)return NaN;const o=wH(r).map(h=>h.map(s=>s.map(b=>gT([b.x,b.y],e.canonical)))),u=new vT(o[0][0][0][1]);let d=1/0;for(const h of t)for(const s of o){switch(h.type){case"Point":d=Math.min(d,O0([h.coordinates],!1,s,u,d));break;case"LineString":d=Math.min(d,O0(h.coordinates,!0,s,u,d));break;case"Polygon":d=Math.min(d,kH(s,h.coordinates,u,d));break}if(d===0)return d}return d}function ub(e){return e.type==="MultiPolygon"?e.coordinates.map(t=>({type:"Polygon",coordinates:t})):e.type==="MultiLineString"?e.coordinates.map(t=>({type:"LineString",coordinates:t})):e.type==="MultiPoint"?e.coordinates.map(t=>({type:"Point",coordinates:t})):[e]}class Hu{constructor(t,r){this.type=gt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Jm(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new Hu(o,o.features.map(u=>ub(u.geometry)).flat());if(o.type==="Feature")return new Hu(o,ub(o.geometry));if("type"in o&&"coordinates"in o)return new Hu(o,ub(o))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return AH(t,this.geometries);if(t.geometryType()==="LineString")return IH(t,this.geometries);if(t.geometryType()==="Polygon")return RH(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Cg{constructor(t){this.type=Kt,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=t[1];return o==null?r.error("Global state property must be defined."):typeof o!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Cg(o)}evaluate(t){var r;const o=(r=t.globals)===null||r===void 0?void 0:r.globalState;return!o||Object.keys(o).length===0?null:_m(o,this.key)}eachChild(){}outputDefined(){return!1}}const bT={"==":rH,"!=":nH,">":oH,"<":iH,">=":aH,"<=":sH,array:Ps,at:lT,boolean:Ps,case:hT,coalesce:eg,collator:O_,format:pT,image:fT,in:cT,"index-of":z0,interpolate:ma,"interpolate-hcl":ma,"interpolate-lab":ma,length:mT,let:z_,literal:dp,match:uT,number:Ps,"number-format":dT,object:Ps,slice:N0,step:j_,string:Ps,"to-boolean":oc,"to-color":oc,"to-number":oc,"to-string":oc,var:N_,within:Wu,distance:Hu,"global-state":Cg};class ks{constructor(t,r,o,u){this.name=t,this.type=r,this._evaluate=o,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const o=t[0],u=ks.definitions[o];if(!u)return r.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(u)?u[0]:u.type,h=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,s=h.filter(([w])=>!Array.isArray(w)||w.length===t.length-1);let b=null;for(const[w,C]of s){b=new D_(r.registry,B0,r.path,null,r.scope);const k=[];let I=!1;for(let A=1;A<t.length;A++){const B=t[A],F=Array.isArray(w)?w[A-1]:w.type,X=b.parse(B,1+k.length,F);if(!X){I=!0;break}k.push(X)}if(!I){if(Array.isArray(w)&&w.length!==k.length){b.error(`Expected ${w.length} arguments, but found ${k.length} instead.`);continue}for(let A=0;A<k.length;A++){const B=Array.isArray(w)?w[A]:w.type,F=k[A];b.concat(A+1).checkSubtype(B,F.type)}if(b.errors.length===0)return new ks(o,d,C,k)}}if(s.length===1)r.errors.push(...b.errors);else{const w=(s.length?s:h).map(([k])=>DH(k)).join(" | "),C=[];for(let k=1;k<t.length;k++){const I=r.parse(t[k],1+C.length);if(!I)return null;C.push(Qr(I.type))}r.error(`Expected arguments of type ${w}, but found (${C.join(", ")}) instead.`)}return null}static register(t,r){ks.definitions=r;for(const o in r)t[o]=ks}}function Kk(e,[t,r,o,u]){t=t.evaluate(e),r=r.evaluate(e),o=o.evaluate(e);const d=u?u.evaluate(e):1,h=$3(t,r,o,d);if(h)throw new sn(h);return new Er(t/255,r/255,o/255,d,!1)}function Xk(e,t){return e in t}function hb(e,t){const r=t[e];return typeof r>"u"?null:r}function LH(e,t,r,o){for(;r<=o;){const u=r+o>>1;if(t[u]===e)return!0;t[u]>e?o=u-1:r=u+1}return!1}function xu(e){return{type:e}}ks.register(bT,{error:[EW,[sr],(e,[t])=>{throw new sn(t.evaluate(e))}],typeof:[sr,[Kt],(e,[t])=>Qr(On(t.evaluate(e)))],"to-rgba":[So(gt,4),[pa],(e,[t])=>{const[r,o,u,d]=t.evaluate(e).rgb;return[r*255,o*255,u*255,d]}],rgb:[pa,[gt,gt,gt],Kk],rgba:[pa,[gt,gt,gt,gt],Kk],has:{type:tr,overloads:[[[sr],(e,[t])=>Xk(t.evaluate(e),e.properties())],[[sr,Gu],(e,[t,r])=>Xk(t.evaluate(e),r.evaluate(e))]]},get:{type:Kt,overloads:[[[sr],(e,[t])=>hb(t.evaluate(e),e.properties())],[[sr,Gu],(e,[t,r])=>hb(t.evaluate(e),r.evaluate(e))]]},"feature-state":[Kt,[sr],(e,[t])=>hb(t.evaluate(e),e.featureState||{})],properties:[Gu,[],e=>e.properties()],"geometry-type":[sr,[],e=>e.geometryType()],id:[Kt,[],e=>e.id()],zoom:[gt,[],e=>e.globals.zoom],"heatmap-density":[gt,[],e=>e.globals.heatmapDensity||0],elevation:[gt,[],e=>e.globals.elevation||0],"line-progress":[gt,[],e=>e.globals.lineProgress||0],accumulated:[Kt,[],e=>e.globals.accumulated===void 0?null:e.globals.accumulated],"+":[gt,xu(gt),(e,t)=>{let r=0;for(const o of t)r+=o.evaluate(e);return r}],"*":[gt,xu(gt),(e,t)=>{let r=1;for(const o of t)r*=o.evaluate(e);return r}],"-":{type:gt,overloads:[[[gt,gt],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[gt],(e,[t])=>-t.evaluate(e)]]},"/":[gt,[gt,gt],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[gt,[gt,gt],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[gt,[],()=>Math.LN2],pi:[gt,[],()=>Math.PI],e:[gt,[],()=>Math.E],"^":[gt,[gt,gt],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[gt,[gt],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[gt,[gt],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[gt,[gt],(e,[t])=>Math.log(t.evaluate(e))],log2:[gt,[gt],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[gt,[gt],(e,[t])=>Math.sin(t.evaluate(e))],cos:[gt,[gt],(e,[t])=>Math.cos(t.evaluate(e))],tan:[gt,[gt],(e,[t])=>Math.tan(t.evaluate(e))],asin:[gt,[gt],(e,[t])=>Math.asin(t.evaluate(e))],acos:[gt,[gt],(e,[t])=>Math.acos(t.evaluate(e))],atan:[gt,[gt],(e,[t])=>Math.atan(t.evaluate(e))],min:[gt,xu(gt),(e,t)=>Math.min(...t.map(r=>r.evaluate(e)))],max:[gt,xu(gt),(e,t)=>Math.max(...t.map(r=>r.evaluate(e)))],abs:[gt,[gt],(e,[t])=>Math.abs(t.evaluate(e))],round:[gt,[gt],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[gt,[gt],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[gt,[gt],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[tr,[sr,Kt],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[tr,[Kt],(e,[t])=>e.id()===t.value],"filter-type-==":[tr,[sr],(e,[t])=>e.geometryType()===t.value],"filter-<":[tr,[sr,Kt],(e,[t,r])=>{const o=e.properties()[t.value],u=r.value;return typeof o==typeof u&&o<u}],"filter-id-<":[tr,[Kt],(e,[t])=>{const r=e.id(),o=t.value;return typeof r==typeof o&&r<o}],"filter->":[tr,[sr,Kt],(e,[t,r])=>{const o=e.properties()[t.value],u=r.value;return typeof o==typeof u&&o>u}],"filter-id->":[tr,[Kt],(e,[t])=>{const r=e.id(),o=t.value;return typeof r==typeof o&&r>o}],"filter-<=":[tr,[sr,Kt],(e,[t,r])=>{const o=e.properties()[t.value],u=r.value;return typeof o==typeof u&&o<=u}],"filter-id-<=":[tr,[Kt],(e,[t])=>{const r=e.id(),o=t.value;return typeof r==typeof o&&r<=o}],"filter->=":[tr,[sr,Kt],(e,[t,r])=>{const o=e.properties()[t.value],u=r.value;return typeof o==typeof u&&o>=u}],"filter-id->=":[tr,[Kt],(e,[t])=>{const r=e.id(),o=t.value;return typeof r==typeof o&&r>=o}],"filter-has":[tr,[Kt],(e,[t])=>t.value in e.properties()],"filter-has-id":[tr,[],e=>e.id()!==null&&e.id()!==void 0],"filter-type-in":[tr,[So(sr)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[tr,[So(Kt)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[tr,[sr,So(Kt)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[tr,[sr,So(Kt)],(e,[t,r])=>LH(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:tr,overloads:[[[tr,tr],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[xu(tr),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:tr,overloads:[[[tr,tr],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[xu(tr),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[tr,[tr],(e,[t])=>!t.evaluate(e)],"is-supported-script":[tr,[sr],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return r?r(t.evaluate(e)):!0}],upcase:[sr,[sr],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[sr,[sr],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[sr,xu(Kt),(e,t)=>t.map(r=>xm(r.evaluate(e))).join("")],"resolved-locale":[sr,[k_],(e,[t])=>t.evaluate(e).resolvedLocale()]});function DH(e){return Array.isArray(e)?`(${e.map(Qr).join(", ")})`:`(${Qr(e.type)}...)`}function B0(e){if(e instanceof N_)return B0(e.boundExpression);if(e instanceof ks&&e.name==="error"||e instanceof O_||e instanceof Wu||e instanceof Hu||e instanceof Cg)return!1;const t=e instanceof oc||e instanceof Ps;let r=!0;return e.eachChild(o=>{t?r=r&&B0(o):r=r&&o instanceof dp}),r?B_(e)&&$_(e,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function B_(e){if(e instanceof ks&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Wu||e instanceof Hu)return!1;let t=!0;return e.eachChild(r=>{t&&!B_(r)&&(t=!1)}),t}function rg(e){if(e instanceof ks&&e.name==="feature-state")return!1;let t=!0;return e.eachChild(r=>{t&&!rg(r)&&(t=!1)}),t}function $_(e,t){if(e instanceof ks&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(o=>{r&&!$_(o,t)&&(r=!1)}),r}function c2(e){return{result:"success",value:e}}function md(e){return{result:"error",value:e}}function $0(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Y3(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Q3(e){return!!e.expression&&e.expression.interpolated}function hr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function wT(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&On(e)===Gu}class zH{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new V3,this._defaultValue=r?OH(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,o,u,d,h){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=o,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=h,this.expression.evaluate(this._evaluator)}evaluate(t,r,o,u,d,h){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=o||null,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=h||null;try{const s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new sn(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(s)} instead.`);return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}}function J3(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in bT}function ez(e,t){const r=new D_(bT,B0,[],t?jH(t):void 0),o=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?c2(new zH(o,t)):md(r.errors)}class Yk{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!rg(r.expression),this.globalStateRefs=ST(r.expression)}evaluateWithoutErrorHandling(t,r,o,u,d,h){return this._styleExpression.evaluateWithoutErrorHandling(t,r,o,u,d,h)}evaluate(t,r,o,u,d,h){return this._styleExpression.evaluate(t,r,o,u,d,h)}}class Qk{constructor(t,r,o,u){this.kind=t,this.zoomStops=o,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!rg(r.expression),this.globalStateRefs=ST(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,r,o,u,d,h){return this._styleExpression.evaluateWithoutErrorHandling(t,r,o,u,d,h)}evaluate(t,r,o,u,d,h){return this._styleExpression.evaluate(t,r,o,u,d,h)}interpolationFactor(t,r,o){return this.interpolationType?ma.interpolationFactor(this.interpolationType,t,r,o):0}}function NH(e,t){const r=ez(e,t);if(r.result==="error")return r;const o=r.value.expression,u=B_(o);if(!u&&!$0(t))return md([new sa("","data expressions not supported")]);const d=$_(o,["zoom"]);if(!d&&!Y3(t))return md([new sa("","zoom expressions not supported")]);const h=Bv(o);if(!h&&!d)return md([new sa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(h instanceof sa)return md([h]);if(h instanceof ma&&!Q3(t))return md([new sa("",'"interpolate" expressions cannot be used with this property')]);if(!h)return c2(u?new Yk("constant",r.value):new Yk("source",r.value));const s=h instanceof ma?h.interpolation:void 0;return c2(u?new Qk("camera",r.value,h.labels,s):new Qk("composite",r.value,h.labels,s))}function Bv(e){let t=null;if(e instanceof z_)t=Bv(e.result);else if(e instanceof eg){for(const r of e.args)if(t=Bv(r),t)break}else(e instanceof j_||e instanceof ma)&&e.input instanceof ks&&e.input.name==="zoom"&&(t=e);return t instanceof sa||e.eachChild(r=>{const o=Bv(r);o instanceof sa?t=o:!t&&o?t=new sa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new sa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ST(e,t=new Set){return e instanceof Cg&&t.add(e.key),e.eachChild(r=>{ST(r,t)}),t}function jH(e){const t={color:pa,string:sr,number:gt,enum:sr,boolean:tr,formatted:A_,padding:I_,numberArray:R_,colorArray:Xm,projectionDefinition:M_,resolvedImage:Sg,variableAnchorOffsetCollection:L_};return e.type==="array"?So(t[e.value]||Kt,e.length):t[e.type]}function OH(e){if(e.type==="color"&&wT(e.default))return new Er(0,0,0,0);switch(e.type){case"color":return Er.parse(e.default)||null;case"padding":return Es.parse(e.default)||null;case"numberArray":return Ms.parse(e.default)||null;case"colorArray":return Co.parse(e.default)||null;case"variableAnchorOffsetCollection":return fa.parse(e.default)||null;case"projectionDefinition":return Cs.parse(e.default)||null;default:return e.default===void 0?null:e.default}}function tz(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!tz(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function rz(e){const t=e.key,r=e.value;return r?[new pt(t,r,"constants have been deprecated as of v8")]:[]}function gn(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function rh(e){if(Array.isArray(e))return e.map(rh);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=rh(e[r]);return t}return gn(e)}function Xo(e){const t=e.key,r=e.value,o=e.valueSpec||{},u=e.objectElementValidators||{},d=e.style,h=e.styleSpec,s=e.validateSpec;let b=[];const w=hr(r);if(w!=="object")return[new pt(t,r,`object expected, ${w} found`)];for(const C in r){const k=C.split(".")[0],I=_m(o,k)||o["*"];let A;if(_m(u,k))A=u[k];else if(_m(o,k))A=s;else if(u["*"])A=u["*"];else if(o["*"])A=s;else{b.push(new pt(t,r[C],`unknown property "${C}"`));continue}b=b.concat(A({key:(t&&`${t}.`)+C,value:r[C],valueSpec:I,style:d,styleSpec:h,object:r,objectKey:C,validateSpec:s},r))}for(const C in o)u[C]||o[C].required&&o[C].default===void 0&&r[C]===void 0&&b.push(new pt(t,r,`missing required property "${C}"`));return b}function TT(e){const t=e.value,r=e.valueSpec,o=e.validateSpec,u=e.style,d=e.styleSpec,h=e.key,s=e.arrayElementValidator||o;if(hr(t)!=="array")return[new pt(h,t,`array expected, ${hr(t)} found`)];if(r.length&&t.length!==r.length)return[new pt(h,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new pt(h,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let b={type:r.value,values:r.values};d.$version<7&&(b.function=r.function),hr(r.value)==="object"&&(b=r.value);let w=[];for(let C=0;C<t.length;C++)w=w.concat(s({array:t,arrayIndex:C,value:t[C],valueSpec:b,validateSpec:e.validateSpec,style:u,styleSpec:d,key:`${h}[${C}]`}));return w}function V_(e){const t=e.key,r=e.value,o=e.valueSpec;let u=hr(r);return u==="number"&&r!==r&&(u="NaN"),u!=="number"?[new pt(t,r,`number expected, ${u} found`)]:"minimum"in o&&r<o.minimum?[new pt(t,r,`${r} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&r>o.maximum?[new pt(t,r,`${r} is greater than the maximum value ${o.maximum}`)]:[]}function nz(e){const t=e.valueSpec,r=gn(e.value.type);let o,u={},d,h;const s=r!=="categorical"&&e.value.property===void 0,b=!s,w=hr(e.value.stops)==="array"&&hr(e.value.stops[0])==="array"&&hr(e.value.stops[0][0])==="object",C=Xo({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:k,default:B}});return r==="identity"&&s&&C.push(new pt(e.key,e.value,'missing required property "property"')),r!=="identity"&&!e.value.stops&&C.push(new pt(e.key,e.value,'missing required property "stops"')),r==="exponential"&&e.valueSpec.expression&&!Q3(e.valueSpec)&&C.push(new pt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(b&&!$0(e.valueSpec)?C.push(new pt(e.key,e.value,"property functions not supported")):s&&!Y3(e.valueSpec)&&C.push(new pt(e.key,e.value,"zoom functions not supported"))),(r==="categorical"||w)&&e.value.property===void 0&&C.push(new pt(e.key,e.value,'"property" property is required')),C;function k(F){if(r==="identity")return[new pt(F.key,F.value,'identity function may not have a "stops" property')];let X=[];const q=F.value;return X=X.concat(TT({key:F.key,value:q,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:I})),hr(q)==="array"&&q.length===0&&X.push(new pt(F.key,q,"array must have at least one stop")),X}function I(F){let X=[];const q=F.value,V=F.key;if(hr(q)!=="array")return[new pt(V,q,`array expected, ${hr(q)} found`)];if(q.length!==2)return[new pt(V,q,`array length 2 expected, length ${q.length} found`)];if(w){if(hr(q[0])!=="object")return[new pt(V,q,`object expected, ${hr(q[0])} found`)];if(q[0].zoom===void 0)return[new pt(V,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new pt(V,q,"object stop key must have value")];if(h&&h>gn(q[0].zoom))return[new pt(V,q[0].zoom,"stop zoom values must appear in ascending order")];gn(q[0].zoom)!==h&&(h=gn(q[0].zoom),d=void 0,u={}),X=X.concat(Xo({key:`${V}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:V_,value:A}}))}else X=X.concat(A({key:`${V}[0]`,value:q[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},q));return J3(rh(q[1]))?X.concat([new pt(`${V}[1]`,q[1],"expressions are not allowed in function stops.")]):X.concat(F.validateSpec({key:`${V}[1]`,value:q[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function A(F,X){const q=hr(F.value),V=gn(F.value),U=F.value!==null?F.value:X;if(!o)o=q;else if(q!==o)return[new pt(F.key,U,`${q} stop domain type must match previous stop domain type ${o}`)];if(q!=="number"&&q!=="string"&&q!=="boolean")return[new pt(F.key,U,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&r!=="categorical"){let ne=`number expected, ${q} found`;return $0(t)&&r===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(F.key,U,ne)]}return r==="categorical"&&q==="number"&&(!isFinite(V)||Math.floor(V)!==V)?[new pt(F.key,U,`integer expected, found ${V}`)]:r!=="categorical"&&q==="number"&&d!==void 0&&V<d?[new pt(F.key,U,"stop domain values must appear in ascending order")]:(d=V,r==="categorical"&&V in u?[new pt(F.key,U,"stop domain values must be unique")]:(u[V]=!0,[]))}function B(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}function pp(e){const t=(e.expressionContext==="property"?NH:ez)(rh(e.value),e.valueSpec);if(t.result==="error")return t.value.map(o=>new pt(`${e.key}${o.key}`,e.value,o.message));const r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new pt(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!rg(r))return[new pt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!rg(r))return[new pt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!$_(r,["zoom","feature-state"]))return[new pt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!B_(r))return[new pt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function FH(e){const t=e.value,r=e.key,o=hr(t);return o!=="boolean"?[new pt(r,t,`boolean expected, ${o} found`)]:[]}function u2(e){const t=e.key,r=e.value,o=hr(r);return o!=="string"?[new pt(t,r,`color expected, ${o} found`)]:Er.parse(String(r))?[]:[new pt(t,r,`color expected, "${r}" found`)]}function ng(e){const t=e.key,r=e.value,o=e.valueSpec,u=[];return Array.isArray(o.values)?o.values.indexOf(gn(r))===-1&&u.push(new pt(t,r,`expected one of [${o.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(o.values).indexOf(gn(r))===-1&&u.push(new pt(t,r,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function CT(e){return tz(rh(e.value))?pp(D0({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):iz(e)}function iz(e){const t=e.value,r=e.key;if(hr(t)!=="array")return[new pt(r,t,`array expected, ${hr(t)} found`)];const o=e.styleSpec;let u,d=[];if(t.length<1)return[new pt(r,t,"filter array must have at least 1 element")];switch(d=d.concat(ng({key:`${r}[0]`,value:t[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),gn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&gn(t[1])==="$type"&&d.push(new pt(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&d.push(new pt(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=hr(t[1]),u!=="string"&&d.push(new pt(`${r}[1]`,t[1],`string expected, ${u} found`)));for(let h=2;h<t.length;h++)u=hr(t[h]),gn(t[1])==="$type"?d=d.concat(ng({key:`${r}[${h}]`,value:t[h],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&d.push(new pt(`${r}[${h}]`,t[h],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let h=1;h<t.length;h++)d=d.concat(iz({key:`${r}[${h}]`,value:t[h],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":u=hr(t[1]),t.length!==2?d.push(new pt(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&d.push(new pt(`${r}[1]`,t[1],`string expected, ${u} found`));break}return d}function oz(e,t){const r=e.key,o=e.validateSpec,u=e.style,d=e.styleSpec,h=e.value,s=e.objectKey,b=d[`${t}_${e.layerType}`];if(!b)return[];const w=s.match(/^(.*)-transition$/);if(t==="paint"&&w&&b[w[1]]&&b[w[1]].transition)return o({key:r,value:h,valueSpec:d.transition,style:u,styleSpec:d});const C=e.valueSpec||b[s];if(!C)return[new pt(r,h,`unknown property "${s}"`)];let k;if(hr(h)==="string"&&$0(C)&&!C.tokens&&(k=/^{([^}]+)}$/.exec(h)))return[new pt(r,h,`"${s}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(k[1])} }\`.`)];const I=[];return e.layerType==="symbol"&&(s==="text-field"&&u&&!u.glyphs&&I.push(new pt(r,h,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&wT(rh(h))&&gn(h.type)==="identity"&&I.push(new pt(r,h,'"text-font" does not support identity functions'))),I.concat(o({key:e.key,value:h,valueSpec:C,style:u,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:s}))}function sz(e){return oz(e,"paint")}function az(e){return oz(e,"layout")}function lz(e){let t=[];const r=e.value,o=e.key,u=e.style,d=e.styleSpec;if(hr(r)!=="object")return[new pt(o,r,`object expected, ${hr(r)} found`)];!r.type&&!r.ref&&t.push(new pt(o,r,'either "type" or "ref" is required'));let h=gn(r.type);const s=gn(r.ref);if(r.id){const b=gn(r.id);for(let w=0;w<e.arrayIndex;w++){const C=u.layers[w];gn(C.id)===b&&t.push(new pt(o,r.id,`duplicate layer id "${r.id}", previously used at line ${C.id.__line__}`))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(w=>{w in r&&t.push(new pt(o,r[w],`"${w}" is prohibited for ref layers`))});let b;u.layers.forEach(w=>{gn(w.id)===s&&(b=w)}),b?b.ref?t.push(new pt(o,r.ref,"ref cannot reference another ref layer")):h=gn(b.type):t.push(new pt(o,r.ref,`ref layer "${s}" not found`))}else if(h!=="background")if(!r.source)t.push(new pt(o,r,'missing required property "source"'));else{const b=u.sources&&u.sources[r.source],w=b&&gn(b.type);b?w==="vector"&&h==="raster"?t.push(new pt(o,r.source,`layer "${r.id}" requires a raster source`)):w!=="raster-dem"&&h==="hillshade"?t.push(new pt(o,r.source,`layer "${r.id}" requires a raster-dem source`)):w!=="raster-dem"&&h==="color-relief"?t.push(new pt(o,r.source,`layer "${r.id}" requires a raster-dem source`)):w==="raster"&&h!=="raster"?t.push(new pt(o,r.source,`layer "${r.id}" requires a vector source`)):w==="vector"&&!r["source-layer"]?t.push(new pt(o,r,`layer "${r.id}" must specify a "source-layer"`)):w==="raster-dem"&&h!=="hillshade"&&h!=="color-relief"?t.push(new pt(o,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):h==="line"&&r.paint&&r.paint["line-gradient"]&&(w!=="geojson"||!b.lineMetrics)&&t.push(new pt(o,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new pt(o,r.source,`source "${r.source}" not found`))}return t=t.concat(Xo({key:o,value:r,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(){return[]},type(){return e.validateSpec({key:`${o}.type`,value:r.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"})},filter:CT,layout(b){return Xo({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*"(w){return az(D0({layerType:h},w))}}})},paint(b){return Xo({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*"(w){return sz(D0({layerType:h},w))}}})}}})),t}function nh(e){const t=e.value,r=e.key,o=hr(t);return o!=="string"?[new pt(r,t,`string expected, ${o} found`)]:[]}function BH(e){var t;const r=(t=e.sourceName)!==null&&t!==void 0?t:"",o=e.value,u=e.styleSpec,d=u.source_raster_dem,h=e.style;let s=[];const b=hr(o);if(o===void 0)return s;if(b!=="object")return s.push(new pt("source_raster_dem",o,`object expected, ${b} found`)),s;const w=gn(o.encoding)==="custom",C=["redFactor","greenFactor","blueFactor","baseShift"],k=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const I in o)!w&&C.includes(I)?s.push(new pt(I,o[I],`In "${r}": "${I}" is only valid when "encoding" is set to "custom". ${k} encoding found`)):d[I]?s=s.concat(e.validateSpec({key:I,value:o[I],valueSpec:d[I],validateSpec:e.validateSpec,style:h,styleSpec:u})):s.push(new pt(I,o[I],`unknown property "${I}"`));return s}const Jk={promoteId:$H};function cz(e){const t=e.value,r=e.key,o=e.styleSpec,u=e.style,d=e.validateSpec;if(!t.type)return[new pt(r,t,'"type" is required')];const h=gn(t.type);let s;switch(h){case"vector":case"raster":return s=Xo({key:r,value:t,valueSpec:o[`source_${h.replace("-","_")}`],style:e.style,styleSpec:o,objectElementValidators:Jk,validateSpec:d}),s;case"raster-dem":return s=BH({sourceName:r,value:t,style:e.style,styleSpec:o,validateSpec:d}),s;case"geojson":if(s=Xo({key:r,value:t,valueSpec:o.source_geojson,style:u,styleSpec:o,validateSpec:d,objectElementValidators:Jk}),t.cluster)for(const b in t.clusterProperties){const[w,C]=t.clusterProperties[b],k=typeof w=="string"?[w,["accumulated"],["get",b]]:w;s.push(...pp({key:`${r}.${b}.map`,value:C,expressionContext:"cluster-map"})),s.push(...pp({key:`${r}.${b}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return s;case"video":return Xo({key:r,value:t,valueSpec:o.source_video,style:u,validateSpec:d,styleSpec:o});case"image":return Xo({key:r,value:t,valueSpec:o.source_image,style:u,validateSpec:d,styleSpec:o});case"canvas":return[new pt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ng({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function $H({key:e,value:t}){if(hr(t)==="string")return nh({key:e,value:t});{const r=[];for(const o in t)r.push(...nh({key:`${e}.${o}`,value:t[o]}));return r}}function uz(e){const t=e.value,r=e.styleSpec,o=r.light,u=e.style;let d=[];const h=hr(t);if(t===void 0)return d;if(h!=="object")return d=d.concat([new pt("light",t,`object expected, ${h} found`)]),d;for(const s in t){const b=s.match(/^(.*)-transition$/);b&&o[b[1]]&&o[b[1]].transition?d=d.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:u,styleSpec:r})):o[s]?d=d.concat(e.validateSpec({key:s,value:t[s],valueSpec:o[s],validateSpec:e.validateSpec,style:u,styleSpec:r})):d=d.concat([new pt(s,t[s],`unknown property "${s}"`)])}return d}function hz(e){const t=e.value,r=e.styleSpec,o=r.sky,u=e.style,d=hr(t);if(t===void 0)return[];if(d!=="object")return[new pt("sky",t,`object expected, ${d} found`)];let h=[];for(const s in t)o[s]?h=h.concat(e.validateSpec({key:s,value:t[s],valueSpec:o[s],style:u,styleSpec:r})):h=h.concat([new pt(s,t[s],`unknown property "${s}"`)]);return h}function dz(e){const t=e.value,r=e.styleSpec,o=r.terrain,u=e.style;let d=[];const h=hr(t);if(t===void 0)return d;if(h!=="object")return d=d.concat([new pt("terrain",t,`object expected, ${h} found`)]),d;for(const s in t)o[s]?d=d.concat(e.validateSpec({key:s,value:t[s],valueSpec:o[s],validateSpec:e.validateSpec,style:u,styleSpec:r})):d=d.concat([new pt(s,t[s],`unknown property "${s}"`)]);return d}function VH(e){return nh(e).length===0?[]:pp(e)}function UH(e){return nh(e).length===0?[]:pp(e)}function GH(e){const t=e.key,r=e.value;if(hr(r)==="array"){if(r.length<1||r.length>4)return[new pt(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const o={type:"number"};let u=[];for(let d=0;d<r.length;d++)u=u.concat(e.validateSpec({key:`${t}[${d}]`,value:r[d],validateSpec:e.validateSpec,valueSpec:o}));return u}else return V_({key:t,value:r,valueSpec:{}})}function qH(e){const t=e.key,r=e.value;if(hr(r)==="array"){const o={type:"number"};if(r.length<1)return[new pt(t,r,"array length at least 1 expected, length 0 found")];let u=[];for(let d=0;d<r.length;d++)u=u.concat(e.validateSpec({key:`${t}[${d}]`,value:r[d],validateSpec:e.validateSpec,valueSpec:o}));return u}else return V_({key:t,value:r,valueSpec:{}})}function ZH(e){const t=e.key,r=e.value;if(hr(r)==="array"){if(r.length<1)return[new pt(t,r,"array length at least 1 expected, length 0 found")];let o=[];for(let u=0;u<r.length;u++)o=o.concat(u2({key:`${t}[${u}]`,value:r[u]}));return o}else return u2({key:t,value:r})}function WH(e){const t=e.key,r=e.value,o=hr(r),u=e.styleSpec;if(o!=="array"||r.length<1||r.length%2!==0)return[new pt(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let d=[];for(let h=0;h<r.length;h+=2)d=d.concat(ng({key:`${t}[${h}]`,value:r[h],valueSpec:u.layout_symbol["text-anchor"]})),d=d.concat(TT({key:`${t}[${h+1}]`,value:r[h+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:u}));return d}function pz(e){let t=[];const r=e.value,o=e.key;if(Array.isArray(r)){const u=[],d=[];for(const h in r){r[h].id&&u.includes(r[h].id)&&t.push(new pt(o,r,`all the sprites' ids must be unique, but ${r[h].id} is duplicated`)),u.push(r[h].id),r[h].url&&d.includes(r[h].url)&&t.push(new pt(o,r,`all the sprites' URLs must be unique, but ${r[h].url} is duplicated`)),d.push(r[h].url);const s={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(Xo({key:`${o}[${h}]`,value:r[h],valueSpec:s,validateSpec:e.validateSpec}))}return t}else return nh({key:o,value:r})}function HH(e){const t=e.value,r=e.styleSpec,o=r.projection,u=e.style,d=hr(t);if(t===void 0)return[];if(d!=="object")return[new pt("projection",t,`object expected, ${d} found`)];let h=[];for(const s in t)o[s]?h=h.concat(e.validateSpec({key:s,value:t[s],valueSpec:o[s],style:u,styleSpec:r})):h=h.concat([new pt(s,t[s],`unknown property "${s}"`)]);return h}function KH(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const o=hr(r);return o==="array"&&!YH(r)&&!XH(r)?[new pt(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]:["array","string"].includes(o)?[]:[new pt(t,r,`projection expected, invalid type "${o}" found`)]}function XH(e){return!!["interpolate","step","literal"].includes(e[0])}function YH(e){return Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"}function QH(e){return!!e&&e.constructor===Object}function fz(e){return QH(e.value)?[]:[new pt(e.key,e.value,`object expected, ${hr(e.value)} found`)]}const eA={"*"(){return[]},array:TT,boolean:FH,number:V_,color:u2,constants:rz,enum:ng,filter:CT,function:nz,layer:lz,object:Xo,source:cz,light:uz,sky:hz,terrain:dz,projection:HH,projectionDefinition:KH,string:nh,formatted:VH,resolvedImage:UH,padding:GH,numberArray:qH,colorArray:ZH,variableAnchorOffsetCollection:WH,sprite:pz,state:fz};function V0(e){const t=e.value,r=e.valueSpec,o=e.styleSpec;return e.validateSpec=V0,r.expression&&wT(gn(t))?nz(e):r.expression&&J3(rh(t))?pp(e):r.type&&eA[r.type]?eA[r.type](e):Xo(D0({},e,{valueSpec:r.type?o[r.type]:r}))}function mz(e){const t=e.value,r=e.key,o=nh(e);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new pt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new pt(r,t,'"glyphs" url must include a "{range}" token'))),o}function Ro(e,t=PW){let r=[];return r=r.concat(V0({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:V0,objectElementValidators:{glyphs:mz,"*"(){return[]}}})),e.constants&&(r=r.concat(rz({key:"constants",value:e.constants}))),gz(r)}Ro.source=Ns(zs(cz));Ro.sprite=Ns(zs(pz));Ro.glyphs=Ns(zs(mz));Ro.light=Ns(zs(uz));Ro.sky=Ns(zs(hz));Ro.terrain=Ns(zs(dz));Ro.state=Ns(zs(fz));Ro.layer=Ns(zs(lz));Ro.filter=Ns(zs(CT));Ro.paintProperty=Ns(zs(sz));Ro.layoutProperty=Ns(zs(az));function zs(e){return function(t){return e({...t,validateSpec:V0})}}function gz(e){return[].concat(e).sort((t,r)=>t.line-r.line)}function Ns(e){return function(...t){return gz(e.apply(this,t))}}function tA(e){if(!e)return{style:vm[ym[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof e=="string"){const t=eK(e);return t.isValidStyle?{style:t.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:t.isValidJSON?{style:vm[ym[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:e.startsWith("http")?{style:e,requiresUrlMonitoring:!0,isFallback:!1}:e.toLowerCase().includes(".json")?{style:JH(e),requiresUrlMonitoring:!0,isFallback:!1}:{style:a3(e),requiresUrlMonitoring:!0,isFallback:!1}}return e instanceof l3?{style:e.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:e instanceof c3?{style:e.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:Ro(e).length===0?{style:e,requiresUrlMonitoring:!1,isFallback:!1}:{style:vm[ym[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function JH(e){try{return new URL(e).href}catch{}return new URL(e,location.origin).href}function eK(e){try{const t=JSON.parse(e),r=Ro(t);return{isValidJSON:!0,isValidStyle:r.length===0,styleObject:r.length===0?t:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}function Ka(e,t,r){const o=window.document.createElement(e);return t!==void 0&&(o.className=t),r&&r.appendChild(o),o}function PT(e){e.parentNode&&e.parentNode.removeChild(e)}class tK{constructor(){Tt(this,"_map"),Tt(this,"_container"),Tt(this,"_terrainButton"),PZ(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=Ka("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Ka("button","maplibregl-ctrl-terrain",this._container),Ka("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){PT(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class rK extends iT{constructor(t={}){super({showCompass:t.showCompass??!0,showZoom:t.showZoom??!0,visualizePitch:t.visualizePitch??!0}),Tt(this,"_rotateCompassArrow",()=>{const r=this._map.getBearing(),o=this._map.getPitch(),u=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(o*(Math.PI/180))**.5)}) rotateX(${Math.min(70,o)}deg) rotateZ(${-r}deg)`:`rotate(${-r}deg)`;this._compassIcon.style.transform=u}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",r=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}))}_createButton(t,r){const o=super._createButton(t,r);return o.clickFunction=r,o}}const rA=It.Marker,nA=It.LngLat,nK=It.LngLatBounds;class iK extends NZ{constructor(){super(...arguments),Tt(this,"lastUpdatedCenter",new nA(0,0)),Tt(this,"_updateCamera",t=>{var r;const o=new nA(t.coords.longitude,t.coords.latitude),u=t.coords.accuracy,d={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((r=this.options.fitBoundsOptions)==null?void 0:r.maxZoom)??30)&&(d.zoom=h),this._map.fitBounds(nK.fromLngLat(o,u),d,{geolocateSource:!0});let s=!1;const b=()=>{s=!0};this._map.once("click",b),this._map.once("dblclick",b),this._map.once("dragstart",b),this._map.once("mousedown",b),this._map.once("touchstart",b),this._map.once("wheel",b),this._map.once("moveend",()=>{this._map.off("click",b),this._map.off("dblclick",b),this._map.off("dragstart",b),this._map.off("mousedown",b),this._map.off("touchstart",b),this._map.off("wheel",b),!s&&(this.lastUpdatedCenter=this._map.getCenter())})}),Tt(this,"_finishSetupUI",t=>{if(this._map){if(t===!1){const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ka("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new rA({element:this._dotElement}),this._circleElement=Ka("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new rA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",r=>{const o=r.originalEvent&&r.originalEvent.type==="resize",u=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!r.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!o&&u>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Tt(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const t=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],r=this._map.project(t),o=this._map.unproject([r.x,r.y]),u=this._map.unproject([r.x+20,r.y]),d=o.distanceTo(u)/20,h=Math.ceil(2*this._accuracy/d);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var xo,ta,Eu,Mu,Uo,$v,Fi,yz,qo,vz;class db{constructor(t,r){_u(this,Fi),_u(this,xo),Tt(this,"map"),_u(this,ta),_u(this,Eu),_u(this,Mu),_u(this,Uo,!1),_u(this,$v),t.style!==void 0&&pd(this,Uo,!0),pd(this,xo,{zoomAdjust:-4,position:"top-right",...r,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...t,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...t.containerStyle??{}}}),t.lockZoom!==void 0&&(mr(this,xo).minZoom=t.lockZoom,mr(this,xo).maxZoom=t.lockZoom)}setStyle(t,r){mr(this,Uo)||this.map.setStyle(t,r),_o(this,Fi,qo).call(this)}addLayer(t,r){return mr(this,Uo)||this.map.addLayer(t,r),_o(this,Fi,qo).call(this),this.map}moveLayer(t,r){return mr(this,Uo)||this.map.moveLayer(t,r),_o(this,Fi,qo).call(this),this.map}removeLayer(t){return mr(this,Uo)||this.map.removeLayer(t),_o(this,Fi,qo).call(this),this}setLayerZoomRange(t,r,o){return mr(this,Uo)||this.map.setLayerZoomRange(t,r,o),_o(this,Fi,qo).call(this),this}setFilter(t,r,o){return mr(this,Uo)||this.map.setFilter(t,r,o),_o(this,Fi,qo).call(this),this}setPaintProperty(t,r,o,u){return mr(this,Uo)||this.map.setPaintProperty(t,r,o,u),_o(this,Fi,qo).call(this),this}setLayoutProperty(t,r,o,u){return mr(this,Uo)||this.map.setLayoutProperty(t,r,o,u),_o(this,Fi,qo).call(this),this}setGlyphs(t,r){return mr(this,Uo)||this.map.setGlyphs(t,r),_o(this,Fi,qo).call(this),this}onAdd(t){pd(this,ta,t),pd(this,Eu,Ka("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[r,o]of Object.entries(mr(this,xo).containerStyle))mr(this,Eu).style.setProperty(r,o);return mr(this,xo).container=mr(this,Eu),mr(this,xo).zoom=t.getZoom()+mr(this,xo).zoomAdjust,this.map=new MT(mr(this,xo)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{_o(this,Fi,yz).call(this,mr(this,xo).parentRect),pd(this,$v,_o(this,Fi,vz).call(this))}),mr(this,Eu)}onRemove(){var t;(t=mr(this,$v))==null||t.call(this),PT(mr(this,Eu))}}xo=new WeakMap,ta=new WeakMap,Eu=new WeakMap,Mu=new WeakMap,Uo=new WeakMap,$v=new WeakMap,Fi=new WeakSet,yz=function(e){e===void 0||e.linePaint===void 0&&e.fillPaint===void 0||(pd(this,Mu,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:mr(this,Mu)}),(e.lineLayout!==void 0||e.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...e.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...e.linePaint}}),e.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...e.fillPaint}}),_o(this,Fi,qo).call(this))},qo=function(){if(mr(this,Mu)===void 0)return;const{devicePixelRatio:e}=window,t=mr(this,ta).getCanvas(),r=t.width/e,o=t.height/e,u=mr(this,ta).unproject.bind(mr(this,ta)),d=u([0,0]),h=u([r,0]),s=u([0,o]),b=u([r,o]);mr(this,Mu).geometry.coordinates=[[s.toArray(),b.toArray(),h.toArray(),d.toArray(),s.toArray()]];const w=this.map.getSource("parentRect");w!==void 0&&w.setData(mr(this,Mu))},vz=function(){const{pitchAdjust:e}=mr(this,xo),t=()=>{d("parent")},r=()=>{d("minimap")},o=()=>{mr(this,ta).on("move",t),this.map.on("move",r)},u=()=>{mr(this,ta).off("move",t),this.map.off("move",r)},d=h=>{u();const s=h==="parent"?mr(this,ta):this.map,b=h==="parent"?this.map:mr(this,ta),w=s.getCenter(),C=s.getZoom()+mr(this,xo).zoomAdjust*(h==="parent"?1:-1),k=s.getBearing(),I=s.getPitch();b.jumpTo({center:w,zoom:C,bearing:k,pitch:e?I:0}),_o(this,Fi,qo).call(this),o()};return o(),()=>{u()}};class oK{constructor(){Tt(this,"map"),Tt(this,"container"),Tt(this,"projectionButton")}onAdd(t){return this.map=t,this.container=Ka("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=Ka("button","maplibregl-ctrl-projection",this.container),Ka("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),t.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){PT(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}const sK="3.6.1",aK={version:sK};class lK{constructor(t,r=2e3){Tt(this,"map"),Tt(this,"registeredModules",new Set),this.map=t,setTimeout(async()=>{if(!Nn.telemetry)return;const o=this.preparePayload();try{(await fetch(o,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(u){console.warn("The metrics could not be sent to MapTiler Cloud",u)}},Math.max(1e3,r))}registerModule(t,r){this.registeredModules.add(`${t}:${r}`)}preparePayload(){const t=new URL(Ui.telemetryURL);return t.searchParams.append("sdk",aK.version),t.searchParams.append("key",Nn.apiKey),t.searchParams.append("mtsid",nT),t.searchParams.append("session",Nn.session?"1":"0"),t.searchParams.append("caching",Nn.caching?"1":"0"),t.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),t.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),t.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&t.searchParams.append("modules",Array.from(this.registeredModules).join("|")),t.href}}var ig=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function bm(){var e=new ig(16);return ig!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function cK(e,t,r,o,u,d,h,s,b,w,C,k,I,A,B,F,X){return e[0]=t,e[1]=r,e[2]=o,e[3]=u,e[4]=d,e[5]=h,e[6]=s,e[7]=b,e[8]=w,e[9]=C,e[10]=k,e[11]=I,e[12]=A,e[13]=B,e[14]=F,e[15]=X,e}function uK(e,t,r){var o=t[0],u=t[1],d=t[2],h=t[3],s=t[4],b=t[5],w=t[6],C=t[7],k=t[8],I=t[9],A=t[10],B=t[11],F=t[12],X=t[13],q=t[14],V=t[15],U=r[0],ne=r[1],de=r[2],xe=r[3];return e[0]=U*o+ne*s+de*k+xe*F,e[1]=U*u+ne*b+de*I+xe*X,e[2]=U*d+ne*w+de*A+xe*q,e[3]=U*h+ne*C+de*B+xe*V,U=r[4],ne=r[5],de=r[6],xe=r[7],e[4]=U*o+ne*s+de*k+xe*F,e[5]=U*u+ne*b+de*I+xe*X,e[6]=U*d+ne*w+de*A+xe*q,e[7]=U*h+ne*C+de*B+xe*V,U=r[8],ne=r[9],de=r[10],xe=r[11],e[8]=U*o+ne*s+de*k+xe*F,e[9]=U*u+ne*b+de*I+xe*X,e[10]=U*d+ne*w+de*A+xe*q,e[11]=U*h+ne*C+de*B+xe*V,U=r[12],ne=r[13],de=r[14],xe=r[15],e[12]=U*o+ne*s+de*k+xe*F,e[13]=U*u+ne*b+de*I+xe*X,e[14]=U*d+ne*w+de*A+xe*q,e[15]=U*h+ne*C+de*B+xe*V,e}function hK(e,t,r){var o=r[0],u=r[1],d=r[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*u,e[5]=t[5]*u,e[6]=t[6]*u,e[7]=t[7]*u,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function iA(e,t,r){var o=Math.sin(r),u=Math.cos(r),d=t[4],h=t[5],s=t[6],b=t[7],w=t[8],C=t[9],k=t[10],I=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*u+w*o,e[5]=h*u+C*o,e[6]=s*u+k*o,e[7]=b*u+I*o,e[8]=w*u-d*o,e[9]=C*u-h*o,e[10]=k*u-s*o,e[11]=I*u-b*o,e}function dK(e,t,r){var o=Math.sin(r),u=Math.cos(r),d=t[0],h=t[1],s=t[2],b=t[3],w=t[8],C=t[9],k=t[10],I=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*u-w*o,e[1]=h*u-C*o,e[2]=s*u-k*o,e[3]=b*u-I*o,e[8]=d*o+w*u,e[9]=h*o+C*u,e[10]=s*o+k*u,e[11]=b*o+I*u,e}function oA(e,t,r){var o=Math.sin(r),u=Math.cos(r),d=t[0],h=t[1],s=t[2],b=t[3],w=t[4],C=t[5],k=t[6],I=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*u+w*o,e[1]=h*u+C*o,e[2]=s*u+k*o,e[3]=b*u+I*o,e[4]=w*u-d*o,e[5]=C*u-h*o,e[6]=k*u-s*o,e[7]=I*u-b*o,e}function pK(e,t,r,o,u){var d=1/Math.tan(t/2),h;return e[0]=d/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,u!=null&&u!==1/0?(h=1/(o-u),e[10]=(u+o)*h,e[14]=2*u*o*h):(e[10]=-1,e[14]=-2*o),e}var fK=pK;function Vv(){var e=new ig(3);return ig!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function mK(e,t,r){var o=new ig(3);return o[0]=e,o[1]=t,o[2]=r,o}function pb(e,t){var r=t[0],o=t[1],u=t[2],d=r*r+o*o+u*u;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e}function sA(e,t,r){var o=t[0],u=t[1],d=t[2],h=r[0],s=r[1],b=r[2];return e[0]=u*b-d*s,e[1]=d*h-o*b,e[2]=o*s-u*h,e}(function(){var e=Vv();return function(t,r,o,u,d,h){var s,b;for(r||(r=3),o||(o=0),u?b=Math.min(u*r+o,t.length):b=t.length,s=o;s<b;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],d(e,e,h),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}})();function gK(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var aA,lA;function yK(){return lA||(lA=1,aA={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),aA}var fb,cA;function _z(){if(cA)return fb;cA=1;const e=yK(),t={};for(const u of Object.keys(e))t[e[u]]=u;const r={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};fb=r;for(const u of Object.keys(r)){if(!("channels"in r[u]))throw new Error("missing channels property: "+u);if(!("labels"in r[u]))throw new Error("missing channel labels property: "+u);if(r[u].labels.length!==r[u].channels)throw new Error("channel and label counts mismatch: "+u);const{channels:d,labels:h}=r[u];delete r[u].channels,delete r[u].labels,Object.defineProperty(r[u],"channels",{value:d}),Object.defineProperty(r[u],"labels",{value:h})}r.rgb.hsl=function(u){const d=u[0]/255,h=u[1]/255,s=u[2]/255,b=Math.min(d,h,s),w=Math.max(d,h,s),C=w-b;let k,I;w===b?k=0:d===w?k=(h-s)/C:h===w?k=2+(s-d)/C:s===w&&(k=4+(d-h)/C),k=Math.min(k*60,360),k<0&&(k+=360);const A=(b+w)/2;return w===b?I=0:A<=.5?I=C/(w+b):I=C/(2-w-b),[k,I*100,A*100]},r.rgb.hsv=function(u){let d,h,s,b,w;const C=u[0]/255,k=u[1]/255,I=u[2]/255,A=Math.max(C,k,I),B=A-Math.min(C,k,I),F=function(X){return(A-X)/6/B+1/2};return B===0?(b=0,w=0):(w=B/A,d=F(C),h=F(k),s=F(I),C===A?b=s-h:k===A?b=1/3+d-s:I===A&&(b=2/3+h-d),b<0?b+=1:b>1&&(b-=1)),[b*360,w*100,A*100]},r.rgb.hwb=function(u){const d=u[0],h=u[1];let s=u[2];const b=r.rgb.hsl(u)[0],w=1/255*Math.min(d,Math.min(h,s));return s=1-1/255*Math.max(d,Math.max(h,s)),[b,w*100,s*100]},r.rgb.cmyk=function(u){const d=u[0]/255,h=u[1]/255,s=u[2]/255,b=Math.min(1-d,1-h,1-s),w=(1-d-b)/(1-b)||0,C=(1-h-b)/(1-b)||0,k=(1-s-b)/(1-b)||0;return[w*100,C*100,k*100,b*100]};function o(u,d){return(u[0]-d[0])**2+(u[1]-d[1])**2+(u[2]-d[2])**2}return r.rgb.keyword=function(u){const d=t[u];if(d)return d;let h=1/0,s;for(const b of Object.keys(e)){const w=e[b],C=o(u,w);C<h&&(h=C,s=b)}return s},r.keyword.rgb=function(u){return e[u]},r.rgb.xyz=function(u){let d=u[0]/255,h=u[1]/255,s=u[2]/255;d=d>.04045?((d+.055)/1.055)**2.4:d/12.92,h=h>.04045?((h+.055)/1.055)**2.4:h/12.92,s=s>.04045?((s+.055)/1.055)**2.4:s/12.92;const b=d*.4124+h*.3576+s*.1805,w=d*.2126+h*.7152+s*.0722,C=d*.0193+h*.1192+s*.9505;return[b*100,w*100,C*100]},r.rgb.lab=function(u){const d=r.rgb.xyz(u);let h=d[0],s=d[1],b=d[2];h/=95.047,s/=100,b/=108.883,h=h>.008856?h**(1/3):7.787*h+16/116,s=s>.008856?s**(1/3):7.787*s+16/116,b=b>.008856?b**(1/3):7.787*b+16/116;const w=116*s-16,C=500*(h-s),k=200*(s-b);return[w,C,k]},r.hsl.rgb=function(u){const d=u[0]/360,h=u[1]/100,s=u[2]/100;let b,w,C;if(h===0)return C=s*255,[C,C,C];s<.5?b=s*(1+h):b=s+h-s*h;const k=2*s-b,I=[0,0,0];for(let A=0;A<3;A++)w=d+1/3*-(A-1),w<0&&w++,w>1&&w--,6*w<1?C=k+(b-k)*6*w:2*w<1?C=b:3*w<2?C=k+(b-k)*(2/3-w)*6:C=k,I[A]=C*255;return I},r.hsl.hsv=function(u){const d=u[0];let h=u[1]/100,s=u[2]/100,b=h;const w=Math.max(s,.01);s*=2,h*=s<=1?s:2-s,b*=w<=1?w:2-w;const C=(s+h)/2,k=s===0?2*b/(w+b):2*h/(s+h);return[d,k*100,C*100]},r.hsv.rgb=function(u){const d=u[0]/60,h=u[1]/100;let s=u[2]/100;const b=Math.floor(d)%6,w=d-Math.floor(d),C=255*s*(1-h),k=255*s*(1-h*w),I=255*s*(1-h*(1-w));switch(s*=255,b){case 0:return[s,I,C];case 1:return[k,s,C];case 2:return[C,s,I];case 3:return[C,k,s];case 4:return[I,C,s];case 5:return[s,C,k]}},r.hsv.hsl=function(u){const d=u[0],h=u[1]/100,s=u[2]/100,b=Math.max(s,.01);let w,C;C=(2-h)*s;const k=(2-h)*b;return w=h*b,w/=k<=1?k:2-k,w=w||0,C/=2,[d,w*100,C*100]},r.hwb.rgb=function(u){const d=u[0]/360;let h=u[1]/100,s=u[2]/100;const b=h+s;let w;b>1&&(h/=b,s/=b);const C=Math.floor(6*d),k=1-s;w=6*d-C,C&1&&(w=1-w);const I=h+w*(k-h);let A,B,F;switch(C){default:case 6:case 0:A=k,B=I,F=h;break;case 1:A=I,B=k,F=h;break;case 2:A=h,B=k,F=I;break;case 3:A=h,B=I,F=k;break;case 4:A=I,B=h,F=k;break;case 5:A=k,B=h,F=I;break}return[A*255,B*255,F*255]},r.cmyk.rgb=function(u){const d=u[0]/100,h=u[1]/100,s=u[2]/100,b=u[3]/100,w=1-Math.min(1,d*(1-b)+b),C=1-Math.min(1,h*(1-b)+b),k=1-Math.min(1,s*(1-b)+b);return[w*255,C*255,k*255]},r.xyz.rgb=function(u){const d=u[0]/100,h=u[1]/100,s=u[2]/100;let b,w,C;return b=d*3.2406+h*-1.5372+s*-.4986,w=d*-.9689+h*1.8758+s*.0415,C=d*.0557+h*-.204+s*1.057,b=b>.0031308?1.055*b**(1/2.4)-.055:b*12.92,w=w>.0031308?1.055*w**(1/2.4)-.055:w*12.92,C=C>.0031308?1.055*C**(1/2.4)-.055:C*12.92,b=Math.min(Math.max(0,b),1),w=Math.min(Math.max(0,w),1),C=Math.min(Math.max(0,C),1),[b*255,w*255,C*255]},r.xyz.lab=function(u){let d=u[0],h=u[1],s=u[2];d/=95.047,h/=100,s/=108.883,d=d>.008856?d**(1/3):7.787*d+16/116,h=h>.008856?h**(1/3):7.787*h+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const b=116*h-16,w=500*(d-h),C=200*(h-s);return[b,w,C]},r.lab.xyz=function(u){const d=u[0],h=u[1],s=u[2];let b,w,C;w=(d+16)/116,b=h/500+w,C=w-s/200;const k=w**3,I=b**3,A=C**3;return w=k>.008856?k:(w-16/116)/7.787,b=I>.008856?I:(b-16/116)/7.787,C=A>.008856?A:(C-16/116)/7.787,b*=95.047,w*=100,C*=108.883,[b,w,C]},r.lab.lch=function(u){const d=u[0],h=u[1],s=u[2];let b;b=Math.atan2(s,h)*360/2/Math.PI,b<0&&(b+=360);const w=Math.sqrt(h*h+s*s);return[d,w,b]},r.lch.lab=function(u){const d=u[0],h=u[1],s=u[2]/360*2*Math.PI,b=h*Math.cos(s),w=h*Math.sin(s);return[d,b,w]},r.rgb.ansi16=function(u,d=null){const[h,s,b]=u;let w=d===null?r.rgb.hsv(u)[2]:d;if(w=Math.round(w/50),w===0)return 30;let C=30+(Math.round(b/255)<<2|Math.round(s/255)<<1|Math.round(h/255));return w===2&&(C+=60),C},r.hsv.ansi16=function(u){return r.rgb.ansi16(r.hsv.rgb(u),u[2])},r.rgb.ansi256=function(u){const d=u[0],h=u[1],s=u[2];return d===h&&h===s?d<8?16:d>248?231:Math.round((d-8)/247*24)+232:16+36*Math.round(d/255*5)+6*Math.round(h/255*5)+Math.round(s/255*5)},r.ansi16.rgb=function(u){let d=u%10;if(d===0||d===7)return u>50&&(d+=3.5),d=d/10.5*255,[d,d,d];const h=(~~(u>50)+1)*.5,s=(d&1)*h*255,b=(d>>1&1)*h*255,w=(d>>2&1)*h*255;return[s,b,w]},r.ansi256.rgb=function(u){if(u>=232){const w=(u-232)*10+8;return[w,w,w]}u-=16;let d;const h=Math.floor(u/36)/5*255,s=Math.floor((d=u%36)/6)/5*255,b=d%6/5*255;return[h,s,b]},r.rgb.hex=function(u){const d=(((Math.round(u[0])&255)<<16)+((Math.round(u[1])&255)<<8)+(Math.round(u[2])&255)).toString(16).toUpperCase();return"000000".substring(d.length)+d},r.hex.rgb=function(u){const d=u.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!d)return[0,0,0];let h=d[0];d[0].length===3&&(h=h.split("").map(k=>k+k).join(""));const s=parseInt(h,16),b=s>>16&255,w=s>>8&255,C=s&255;return[b,w,C]},r.rgb.hcg=function(u){const d=u[0]/255,h=u[1]/255,s=u[2]/255,b=Math.max(Math.max(d,h),s),w=Math.min(Math.min(d,h),s),C=b-w;let k,I;return C<1?k=w/(1-C):k=0,C<=0?I=0:b===d?I=(h-s)/C%6:b===h?I=2+(s-d)/C:I=4+(d-h)/C,I/=6,I%=1,[I*360,C*100,k*100]},r.hsl.hcg=function(u){const d=u[1]/100,h=u[2]/100,s=h<.5?2*d*h:2*d*(1-h);let b=0;return s<1&&(b=(h-.5*s)/(1-s)),[u[0],s*100,b*100]},r.hsv.hcg=function(u){const d=u[1]/100,h=u[2]/100,s=d*h;let b=0;return s<1&&(b=(h-s)/(1-s)),[u[0],s*100,b*100]},r.hcg.rgb=function(u){const d=u[0]/360,h=u[1]/100,s=u[2]/100;if(h===0)return[s*255,s*255,s*255];const b=[0,0,0],w=d%1*6,C=w%1,k=1-C;let I=0;switch(Math.floor(w)){case 0:b[0]=1,b[1]=C,b[2]=0;break;case 1:b[0]=k,b[1]=1,b[2]=0;break;case 2:b[0]=0,b[1]=1,b[2]=C;break;case 3:b[0]=0,b[1]=k,b[2]=1;break;case 4:b[0]=C,b[1]=0,b[2]=1;break;default:b[0]=1,b[1]=0,b[2]=k}return I=(1-h)*s,[(h*b[0]+I)*255,(h*b[1]+I)*255,(h*b[2]+I)*255]},r.hcg.hsv=function(u){const d=u[1]/100,h=u[2]/100,s=d+h*(1-d);let b=0;return s>0&&(b=d/s),[u[0],b*100,s*100]},r.hcg.hsl=function(u){const d=u[1]/100,h=u[2]/100*(1-d)+.5*d;let s=0;return h>0&&h<.5?s=d/(2*h):h>=.5&&h<1&&(s=d/(2*(1-h))),[u[0],s*100,h*100]},r.hcg.hwb=function(u){const d=u[1]/100,h=u[2]/100,s=d+h*(1-d);return[u[0],(s-d)*100,(1-s)*100]},r.hwb.hcg=function(u){const d=u[1]/100,h=1-u[2]/100,s=h-d;let b=0;return s<1&&(b=(h-s)/(1-s)),[u[0],s*100,b*100]},r.apple.rgb=function(u){return[u[0]/65535*255,u[1]/65535*255,u[2]/65535*255]},r.rgb.apple=function(u){return[u[0]/255*65535,u[1]/255*65535,u[2]/255*65535]},r.gray.rgb=function(u){return[u[0]/100*255,u[0]/100*255,u[0]/100*255]},r.gray.hsl=function(u){return[0,0,u[0]]},r.gray.hsv=r.gray.hsl,r.gray.hwb=function(u){return[0,100,u[0]]},r.gray.cmyk=function(u){return[0,0,0,u[0]]},r.gray.lab=function(u){return[u[0],0,0]},r.gray.hex=function(u){const d=Math.round(u[0]/100*255)&255,h=((d<<16)+(d<<8)+d).toString(16).toUpperCase();return"000000".substring(h.length)+h},r.rgb.gray=function(u){return[(u[0]+u[1]+u[2])/3/255*100]},fb}var mb,uA;function vK(){if(uA)return mb;uA=1;const e=_z();function t(){const d={},h=Object.keys(e);for(let s=h.length,b=0;b<s;b++)d[h[b]]={distance:-1,parent:null};return d}function r(d){const h=t(),s=[d];for(h[d].distance=0;s.length;){const b=s.pop(),w=Object.keys(e[b]);for(let C=w.length,k=0;k<C;k++){const I=w[k],A=h[I];A.distance===-1&&(A.distance=h[b].distance+1,A.parent=b,s.unshift(I))}}return h}function o(d,h){return function(s){return h(d(s))}}function u(d,h){const s=[h[d].parent,d];let b=e[h[d].parent][d],w=h[d].parent;for(;h[w].parent;)s.unshift(h[w].parent),b=o(e[h[w].parent][w],b),w=h[w].parent;return b.conversion=s,b}return mb=function(d){const h=r(d),s={},b=Object.keys(h);for(let w=b.length,C=0;C<w;C++){const k=b[C];h[k].parent!==null&&(s[k]=u(k,h))}return s},mb}var gb,hA;function _K(){if(hA)return gb;hA=1;const e=_z(),t=vK(),r={},o=Object.keys(e);function u(h){const s=function(...b){const w=b[0];return w==null?w:(w.length>1&&(b=w),h(b))};return"conversion"in h&&(s.conversion=h.conversion),s}function d(h){const s=function(...b){const w=b[0];if(w==null)return w;w.length>1&&(b=w);const C=h(b);if(typeof C=="object")for(let k=C.length,I=0;I<k;I++)C[I]=Math.round(C[I]);return C};return"conversion"in h&&(s.conversion=h.conversion),s}return o.forEach(h=>{r[h]={},Object.defineProperty(r[h],"channels",{value:e[h].channels}),Object.defineProperty(r[h],"labels",{value:e[h].labels});const s=t(h);Object.keys(s).forEach(b=>{const w=s[b];r[h][b]=d(w),r[h][b].raw=u(w)})}),gb=r,gb}var xK=_K();const bK=gK(xK);function dA({gl:e,type:t,source:r}){const o=e.createShader(t);if(o===null)throw new Error("Cannot create shader");if(e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw console.error("Shader compilation error:",e.getShaderInfoLog(o)),e.deleteShader(o),new Error("Cannot compile shader");return o}function wK({gl:e,vertexShaderSource:t,fragmentShaderSource:r}){const o=dA({gl:e,type:e.VERTEX_SHADER,source:t}),u=dA({gl:e,type:e.FRAGMENT_SHADER,source:r}),d=e.createProgram();if(e.attachShader(d,o),e.attachShader(d,u),e.linkProgram(d),!e.getProgramParameter(d,e.LINK_STATUS))throw console.error("Error: ",e.getProgramInfoLog(d)),new Error("Cannot link shader program");return d}function SK(e,t,r){const o=e.getUniformLocation(t,r);if(o===null)throw new Error(`Cannot get uniform location for ${r}`);return o}function xz({gl:e,vertexShaderSource:t,fragmentShaderSource:r,attributesKeys:o,uniformsKeys:u,vertices:d,indices:h}){const s=wK({gl:e,vertexShaderSource:t,fragmentShaderSource:r}),b=o.reduce((A,B)=>(A[B]=e.getAttribLocation(s,`a_${B}`),A),{}),w=u.reduce((A,B)=>(A[B]=SK(e,s,`u_${B}`),A),{}),C=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,C),e.bufferData(e.ARRAY_BUFFER,new Float32Array(d),e.STATIC_DRAW);let k,I;return h!==void 0&&(k=e.createBuffer(),I=h.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),e.STATIC_DRAW)),{shaderProgram:s,programInfo:{attributesLocations:b,uniformsLocations:w},positionBuffer:C,indexBuffer:k,indexBufferLength:I}}function Uv(e){if(!e)return[1,1,1,0];if(e==="transparent")return[1,1,1,0];try{const t=TK(e),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(t);if(r!=null&&r.length){const u=!!r[4];return[...bK.hex.rgb(t).map(d=>d/255),u?parseInt(r[4],16)/255:1]}const o=t.match(/(\d\.\d(\d+)?|\d{3}|\d{2}|\d{1})/gi)??["0","0","0"];if(t.includes("rgb")){const u=t.includes("rgba"),d=[...o.map(h=>parseFloat(h)).map((h,s)=>s<3?h/255:h)];return u||d.push(1),d}}catch{}return console.warn([`[parseColorStringToVec4]: Color ${e} is either not a valid color or its type is not supported, defaulting to black`]),[0,0,0,1]}let Kf;function TK(e){return Kf=Kf??document.createElement("canvas").getContext("2d"),Kf?(Kf.fillStyle=e,Kf.fillStyle):"#000000"}const ET=1,Yo=ET/2,Qo=ET/2,Jo=ET/2,CK=[-.5,-.5,Jo,Yo,-.5,Jo,Yo,Qo,Jo,-.5,Qo,Jo],PK=[-.5,-.5,-.5,-.5,Qo,-.5,Yo,Qo,-.5,Yo,-.5,-.5],EK=[-.5,Qo,-.5,-.5,Qo,Jo,Yo,Qo,Jo,Yo,Qo,-.5],MK=[-.5,-.5,-.5,Yo,-.5,-.5,Yo,-.5,Jo,-.5,-.5,Jo],kK=[Yo,-.5,-.5,Yo,Qo,-.5,Yo,Qo,Jo,Yo,-.5,Jo],AK=[-.5,-.5,-.5,-.5,-.5,Jo,-.5,Qo,Jo,-.5,Qo,-.5],IK=[...CK,...PK,...EK,...MK,...kK,...AK],RK=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],LK=`attribute vec3 a_vertexPosition;
varying vec3 vTextureCoord;

uniform mat4 u_projectionMatrix;
uniform mat4 u_modelViewMatrix;
  
void main(void) {
  vTextureCoord = vec3(-a_vertexPosition.x, a_vertexPosition.y, a_vertexPosition.z);
  gl_Position = u_projectionMatrix * u_modelViewMatrix * vec4(a_vertexPosition, 1.0);
}
`,pA=`precision mediump float;

varying vec3 vTextureCoord;

%USE_TEXTURE_MACRO_MARKER%

# ifdef USE_TEXTURE
uniform samplerCube u_cubeSampler;
uniform float u_fadeOpacity;
# endif

uniform vec4 u_bgColor;

void main(void) {
  #ifdef USE_TEXTURE
  vec4 texColor = textureCube(u_cubeSampler, vTextureCoord);

    gl_FragColor = mix(
      u_bgColor,
      texColor,
      min(texColor.a, u_fadeOpacity)
    );

    gl_FragColor.a = max(gl_FragColor.a, u_fadeOpacity);

  #else
  gl_FragColor = u_bgColor;
  #endif
}
`,Gd={stars:{color:"hsl(233,100%,92%)",preset:"stars"},space:{color:"hsl(210, 100%, 4%)",preset:"space"},milkyway:{color:"hsl(233,100%,92%)",preset:"milkyway"},"milkyway-subtle":{color:"hsl(233,100%,92%)",preset:"milkyway-subtle"},"milkyway-bright":{color:"hsl(233,100%,92%)",preset:"milkyway-bright"},"milkyway-colored":{color:"black",preset:"milkyway-colored"}};var ku=(e=>(e.POSITIVE_X="pX",e.NEGATIVE_X="nX",e.POSITIVE_Y="pY",e.NEGATIVE_Y="nY",e.POSITIVE_Z="pZ",e.NEGATIVE_Z="nZ",e))(ku||{});let mv,fA,mA;function DK({gl:e,faces:t,onReady:r,forceRefresh:o}){mv&&!o&&mA===JSON.stringify(t)&&r(mv,fA),mA=JSON.stringify(t);const u=mv??e.createTexture();if(e.bindTexture(e.TEXTURE_CUBE_MAP,u),!t){console.warn("[CubemapLayer][loadCubemapTexture]: Faces are null");return}const d=Object.keys(t).length;if(d!==6){console.warn(`[CubemapLayer][loadCubemapTexture]: Faces should contain exactly 6 images, but found ${d}`);return}const h=Object.entries(t).map(([s,b])=>new Promise((w,C)=>{const k=s;if(b===void 0){C(new Error(`[CubemapLayer][loadCubemapTexture]: Face ${s} is undefined`));return}const I=new Image;I.crossOrigin="anonymous";const A=()=>{w({image:I,key:k})};I.src=b,I.complete&&I.naturalWidth>0?A():I.onload=A,I.onerror=()=>{C(new Error(`[CubemapLayer][loadCubemapTexture]: Error loading image ${b}`))}}));Promise.all(h).then(s=>{for(let w=0;w<s.length;w++){const C=e.RGBA,k=e.RGBA,I=e.UNSIGNED_BYTE,{image:A,key:B}=s[w]??{};if(!A||!B){console.warn("[CubemapLayer][loadCubemapTexture]: Image or key is null");continue}const F=zK(e,B);e.bindTexture(e.TEXTURE_CUBE_MAP,u),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(F,0,C,k,I,A)}e.bindTexture(e.TEXTURE_CUBE_MAP,u),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR);const b=s.map(w=>w.image);r(u,b),fA=b,mv=u}).catch(s=>{console.error("[CubemapLayer][loadCubemapTexture]: Error loading cubemap texture",s)})}function zK(e,t){if(t===ku.POSITIVE_X)return e.TEXTURE_CUBE_MAP_POSITIVE_X;if(t===ku.NEGATIVE_X)return e.TEXTURE_CUBE_MAP_NEGATIVE_X;if(t===ku.POSITIVE_Y)return e.TEXTURE_CUBE_MAP_POSITIVE_Y;if(t===ku.NEGATIVE_Y)return e.TEXTURE_CUBE_MAP_NEGATIVE_Y;if(t===ku.POSITIVE_Z)return e.TEXTURE_CUBE_MAP_POSITIVE_Z;if(t===ku.NEGATIVE_Z)return e.TEXTURE_CUBE_MAP_NEGATIVE_Z;throw new Error(`[CubemapLayer][loadCubemapTexture]: Invalid key ${t}`)}function NK(e,t,r){return[sc(e[0],t[0],r),sc(e[1],t[1],r),sc(e[2],t[2],r),sc(e[3],t[3],r)]}function sc(e,t,r){return e+(t-e)*r}const cd="https://api.maptiler.com/resources/space",jK=["vertexPosition"],OK=["projectionMatrix","modelViewMatrix","cubeSampler","bgColor","fadeOpacity"],gA="%USE_TEXTURE_MACRO_MARKER%",FK="#define USE_TEXTURE",BK=Gd.stars;function $K(e,t){if(e===!0)return t;const r={...e};if(e.faces||e.path)return delete r.preset,r;const o=e.preset;if(o!==void 0&&!(o in Gd))throw new Error(`[CubemapLayer]: Invalid preset "${o}". Available presets: ${Object.keys(Gd).join(", ")}`);return{...r,color:r.color??Gd[o].color??"hsl(233,100%,92%)"}}class yb{constructor(t){Tt(this,"id","Cubemap Layer"),Tt(this,"type","custom"),Tt(this,"renderingMode","3d"),Tt(this,"map"),Tt(this,"faces"),Tt(this,"useCubemapTexture",!0),Tt(this,"currentFadeOpacity",0),Tt(this,"cubeMapNeedsUpdate",!1),Tt(this,"bgColor"),Tt(this,"previousBgColor",[0,0,0,0]),Tt(this,"targetBgColor",[0,0,0,0]),Tt(this,"transitionDelta",0),Tt(this,"gl"),Tt(this,"cubemap"),Tt(this,"texture"),Tt(this,"currentFacesDefinitionKey",""),Tt(this,"options"),Tt(this,"imageIsAnimating",!1),Tt(this,"imageFadeInDelta",0);const r=$K(t,BK);this.options=r,this.currentFacesDefinitionKey=JSON.stringify(r.faces??r.preset??r.path),this.bgColor=[0,0,0,0],this.targetBgColor=Uv(r.color),this.faces=yA(r),this.useCubemapTexture=this.faces!==null}updateCubemap({facesNeedUpdate:t}={facesNeedUpdate:!0}){this.useCubemapTexture=this.faces!==null;const r=OK.filter(o=>o==="cubeSampler"||o==="fadeOpacity"?this.useCubemapTexture:!0);this.cubemap=xz({gl:this.gl,vertexShaderSource:LK,fragmentShaderSource:this.useCubemapTexture?pA.replace(gA,FK):pA.replace(gA,""),attributesKeys:jK,uniformsKeys:r,vertices:IK,indices:RK}),this.cubeMapNeedsUpdate=t,this.useCubemapTexture&&this.updateTexture(this.gl,this.faces),this.animateColorChange()}onAdd(t,r){this.map=t,this.gl=r,this.updateCubemap()}onRemove(t,r){this.cubemap&&(r.deleteProgram(this.cubemap.shaderProgram),r.deleteBuffer(this.cubemap.positionBuffer))}updateTexture(t,r){if(this.cubeMapNeedsUpdate===!0&&!this.imageIsAnimating){if(this.cubeMapNeedsUpdate=!1,!this.useCubemapTexture)return;DK({gl:t,faces:r,onReady:o=>{this.texture=o,this.animateIn()}})}}prerender(t,r){this.faces&&this.updateTexture(this.gl,this.faces)}animateColorChange(){const t=()=>{this.transitionDelta<1&&(requestAnimationFrame(t),this.bgColor=NK(this.previousBgColor,this.targetBgColor,this.transitionDelta),this.transitionDelta+=.075,this.map.triggerRepaint())};requestAnimationFrame(t)}animateIn(){if(this.imageIsAnimating)return;this.imageIsAnimating=!0;const t=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=sc(0,1,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta<1){requestAnimationFrame(t);return}this.imageIsAnimating=!1,this.imageFadeInDelta=0};requestAnimationFrame(t)}animateOut(){return this.imageIsAnimating?Promise.resolve():new Promise(t=>{const r=()=>{if(this.imageFadeInDelta=Math.min(this.imageFadeInDelta+.05,1),this.currentFadeOpacity=sc(1,0,this.imageFadeInDelta),this.map.triggerRepaint(),this.imageFadeInDelta>=1){this.imageIsAnimating=!1,this.imageFadeInDelta=0,t();return}requestAnimationFrame(r)};requestAnimationFrame(r)})}render(t,r){if(!this.map.isGlobeProjection())return;if(this.map===void 0)throw new Error("[CubemapLayer]: Map is undefined");if(this.cubemap===void 0)throw new Error("[CubemapLayer]: Cubemap is undefined");this.texture,t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.DST_ALPHA),t.useProgram(this.cubemap.shaderProgram),t.bindBuffer(t.ARRAY_BUFFER,this.cubemap.positionBuffer),t.vertexAttribPointer(this.cubemap.programInfo.attributesLocations.vertexPosition,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.cubemap.programInfo.attributesLocations.vertexPosition);const o=.1,u=1e4,d=t.canvas,h=d.clientWidth/d.clientHeight,s=this.map.transform,b=s.fov*(Math.PI/180),w=bm();fK(w,b,h,o,u),oA(w,w,s.rollInRadians),iA(w,w,-s.pitchInRadians),oA(w,w,s.bearingInRadians);const C=s.center.lat*Math.PI/180,k=s.center.lng*Math.PI/180;iA(w,w,C),dK(w,w,-k),t.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.projectionMatrix,!1,w);const I=bm();if(t.uniformMatrix4fv(this.cubemap.programInfo.uniformsLocations.modelViewMatrix,!1,I),t.uniform4fv(this.cubemap.programInfo.uniformsLocations.bgColor,new Float32Array(this.bgColor)),t.uniform1f(this.cubemap.programInfo.uniformsLocations.fadeOpacity,this.currentFadeOpacity),this.useCubemapTexture&&this.texture&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture),t.uniform1i(this.cubemap.programInfo.uniformsLocations.cubeSampler,0)),this.cubemap.indexBuffer===void 0)throw new Error("Index buffer is undefined");if(this.cubemap.indexBufferLength===void 0)throw new Error("Index buffer length is undefined");t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.cubemap.indexBuffer),t.drawElements(t.TRIANGLES,this.cubemap.indexBufferLength,t.UNSIGNED_SHORT,0)}setBgColor(t){this.targetBgColor=t,this.previousBgColor=this.bgColor,this.transitionDelta=0}getConfig(){return this.options}async setCubemapFaces(t){if(await this.animateOut(),!t.faces&&!t.preset&&!t.path){this.faces=null,this.useCubemapTexture=!1,this.currentFacesDefinitionKey="empty",this.animateIn();return}this.faces=yA(t),this.currentFacesDefinitionKey=JSON.stringify(t.faces??t.preset??t.path)}async setCubemap(t){this.options=t;const r=JSON.stringify(t.faces??t.preset??t.path),o=this.currentFacesDefinitionKey!==r;o&&(await this.setCubemapFaces(t),this.cubeMapNeedsUpdate=!0);const u=Uv(t.color);if(t.color&&this.targetBgColor.toString()!==u.toString())this.setBgColor(u);else if(!t.color&&t.preset&&t.preset in Gd){const d=Gd[t.preset];this.setBgColor(Uv(d.color))}this.updateCubemap({facesNeedUpdate:o})}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}function yA(e){if(e.faces)return e.faces;if(e.preset)return{pX:`${cd}/${e.preset}/px.webp`,nX:`${cd}/${e.preset}/nx.webp`,pY:`${cd}/${e.preset}/py.webp`,nY:`${cd}/${e.preset}/ny.webp`,pZ:`${cd}/${e.preset}/pz.webp`,nZ:`${cd}/${e.preset}/nz.webp`};if(e.path){const t=e.path.baseUrl,r=e.path.format??"png";return{pX:`${t}/px.${r}`,nX:`${t}/nx.${r}`,pY:`${t}/py.${r}`,nY:`${t}/ny.${r}`,pZ:`${t}/pz.${r}`,nZ:`${t}/nz.${r}`}}return null}const VK=`attribute vec3 a_position;

uniform mat4 u_matrix;
uniform mat4 u_rotationMatrix;

uniform float u_scale;

varying vec2 v_pos;
varying float v_scale;

void main() {
  v_scale = u_scale;
  v_pos = a_position.xy * u_scale;
  gl_Position = u_matrix * u_rotationMatrix * vec4(a_position, 1.0);
}
`,UK=`precision mediump float;
varying vec2 v_pos;
      
uniform int u_stopsNumber;
uniform float u_stops[100];
uniform vec4 u_colors[100];
uniform float u_maxDistance;

varying float v_scale;

vec2 center = vec2(0.0, 0.0);
// TODO: We could look at implementing a color ramp instead.
// Render the color ramp to a canvas and then to a texture
// then select the color based on the distance from the center.
void main() {

  // QUASI SUCCESS
  // float distanceFromGlobeEdge = (distance(center, v_pos) - 2.0) / (sqrt(v_scale) * 1.05) + 1.0;
  // ORIGINAL
  // float distanceFromGlobeEdge = distance(center, v_pos) - 1.0; 
  float rawDistance = distance(center, v_pos);
  float distanceFromGlobeEdge = rawDistance - 1.0;

    vec4 color = u_colors[0];

  // if we're further than the max distance, we should not render anything.
  // This is to always render a circle, otherwise we end up rendering
  // to the corners of the plane.
  if (distance(center, v_pos) > u_maxDistance * v_scale) {
    discard;
  }

  for (int i = 1; i < 100; i++) {
    // if we're past the last stop
    // we should fill to the end with the last stop color
    if (i >= u_stopsNumber) {
      color = u_colors[i - 1];
      break;
    }

    float scaledStopPosition = u_stops[i] * pow(v_scale, 1.6);
    float lastScaledStopPosition = u_stops[i - 1] * pow(v_scale, 1.6);

    if (distanceFromGlobeEdge <= scaledStopPosition) {
      float stopBlendFactor = (distanceFromGlobeEdge - lastScaledStopPosition) / (scaledStopPosition - lastScaledStopPosition);
      color = mix(u_colors[i - 1], u_colors[i], stopBlendFactor);
      break;
    }
  }
  
  // gl_FragColor = color;
  gl_FragColor = vec4(color.rgb * color.a, color.a);
}
`,rm=2,GK=["position"],qK=["matrix","rotationMatrix","stopsNumber","stops","colors","maxDistance","scale"],ZK=[-2,-2,0,rm,-2,0,-2,rm,0,rm,rm,0],vA={scale:.9,stops:[[0,"rgba(176, 208, 240, 1)"],[.1,"rgba(98, 168, 229, 0.3)"],[.2,"rgba(98, 168, 229, 0.0)"]]},_A=.06;class vb{constructor(t){if(Tt(this,"id","Halo Layer"),Tt(this,"type","custom"),Tt(this,"renderingMode","3d"),Tt(this,"gradient"),Tt(this,"scale",0),Tt(this,"animationDelta",0),Tt(this,"map"),Tt(this,"plane"),typeof t=="boolean"){this.gradient=vA;return}this.gradient={...vA,...t}}onAdd(t,r){this.map=t,this.plane=xz({gl:r,vertexShaderSource:VK,fragmentShaderSource:UK,attributesKeys:GK,uniformsKeys:qK,vertices:ZK}),this.animateIn()}getConfig(){return this.gradient}async animateIn(){return new Promise(t=>{this.animationDelta=0;const r=()=>{if(this.animationDelta<1){this.scale=sc(0,this.gradient.scale,this.animationDelta),this.animationDelta+=_A,this.map.triggerRepaint(),requestAnimationFrame(r);return}t()};r()})}async animateOut(){return this.animationDelta=0,new Promise(t=>{const r=()=>{if(this.animationDelta<1){this.scale=sc(this.gradient.scale,0,this.animationDelta),this.animationDelta+=_A,this.map.triggerRepaint(),requestAnimationFrame(r);return}t()};r()})}onRemove(t,r){this.plane!==void 0&&(r.deleteProgram(this.plane.shaderProgram),r.deleteBuffer(this.plane.positionBuffer))}prerender(t,r){}render(t,r){if(this.map===void 0)throw new Error("[RadialGradientLayer]: Map is undefined");if(!this.map.isGlobeProjection())return;if(this.plane===void 0)throw new Error("[RadialGradientLayer]: Plane is undefined");t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.useProgram(this.plane.shaderProgram),t.bindBuffer(t.ARRAY_BUFFER,this.plane.positionBuffer);const o=this.plane.programInfo.attributesLocations.position;t.enableVertexAttribArray(o),t.vertexAttribPointer(o,3,t.FLOAT,!1,0,0);const u=bm(),d=this.scale;hK(u,u,[d,d,d]);const h=bm();uK(h,r.defaultProjectionData.mainMatrix,u);const s=this.plane.programInfo.uniformsLocations.matrix;t.uniformMatrix4fv(s,!1,h);const b=bm(),w=this.map.transform.cameraPosition,C=pb(Vv(),w),k=mK(0,1,0),I=Vv();sA(I,k,C),pb(I,I);const A=Vv();sA(A,C,I),pb(A,A),cK(b,I[0],I[1],I[2],0,A[0],A[1],A[2],0,C[0],C[1],C[2],0,0,0,0,1);const B=this.plane.programInfo.uniformsLocations.rotationMatrix;t.uniformMatrix4fv(B,!1,b);const F=this.gradient.stops.length,X=[],q=[];for(let V=0;V<=F;V++)if(V<F){X[V]=this.gradient.stops[V][0];const U=Uv(this.gradient.stops[V][1]);q.push(...U)}t.uniform1i(this.plane.programInfo.uniformsLocations.stopsNumber,F),t.uniform1fv(this.plane.programInfo.uniformsLocations.stops,new Float32Array(X)),t.uniform4fv(this.plane.programInfo.uniformsLocations.colors,new Float32Array(q)),t.uniform1f(this.plane.programInfo.uniformsLocations.maxDistance,rm),t.uniform1f(this.plane.programInfo.uniformsLocations.scale,d),t.drawArrays(t.TRIANGLE_STRIP,0,4)}async setGradient(t){await this.animateOut(),this.gradient=t,await this.animateIn()}show(){this.map.setLayoutProperty(this.id,"visibility","visible")}hide(){this.map.setLayoutProperty(this.id,"visibility","none")}}const WK={POINT:"POINT",COUNTRY:"COUNTRY"};let MT=class bz extends It.Map{constructor(t){MZ(t.container),t.apiKey&&(Nn.apiKey=t.apiKey);const{style:r,requiresUrlMonitoring:o,isFallback:u}=tA(t.style);u&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),Nn.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const d=location.hash;let h={compact:!1};t.customAttribution?h.customAttribution=t.customAttribution:t.attributionControl&&typeof t.attributionControl=="object"&&(h={...h,...t.attributionControl});const s={...t,style:r,maplibreLogo:!1,transformRequest:Rk(t.transformRequest),attributionControl:t.forceNoAttributionControl===!0?!1:h};delete s.style,super(s),Tt(this,"telemetry"),Tt(this,"space"),Tt(this,"halo"),Tt(this,"options"),Tt(this,"isTerrainEnabled",!1),Tt(this,"terrainExaggeration",1),Tt(this,"primaryLanguage"),Tt(this,"terrainGrowing",!1),Tt(this,"terrainFlattening",!1),Tt(this,"minimap"),Tt(this,"forceLanguageUpdate"),Tt(this,"languageAlwaysBeenStyle"),Tt(this,"isReady",!1),Tt(this,"terrainAnimationDuration",1e3),Tt(this,"monitoredStyleUrls"),Tt(this,"styleInProcess",!1),Tt(this,"curentProjection"),Tt(this,"originalLabelStyle",new window.Map),Tt(this,"isStyleLocalized",!1),Tt(this,"languageIsUpdated",!1),Tt(this,"spaceboxLoadingState",{styleLoadCallbackSet:!1}),this.options=t,this.setStyle(r),o&&this.monitorStyleUrl(r);const b=()=>{let A="The distant style could not be loaded.";this.getStyle()?A+="Leaving the style as is.":(this.setStyle(vm.STREETS),A+=`Loading default MapTiler Cloud style "${vm.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(A)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",A=>{if(A.error instanceof It.AJAXError){const B=A.error.url,F=new URL(B);F.search="";const X=F.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(X)&&(this.monitoredStyleUrls.delete(X),b());return}if(this.styleInProcess){b();return}}),Nn.caching&&!t2&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),Nn.caching&&t2&&TZ(),typeof t.language>"u")this.primaryLanguage=Nn.primaryLanguage;else{const A=yk(t.language,_r);this.primaryLanguage=A??Nn.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===_r.STYLE||this.primaryLanguage===_r.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===_r.STYLE,this.terrainExaggeration=t.terrainExaggeration??this.terrainExaggeration,this.curentProjection=t.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!t.geolocate||t.center||t.hash&&d)return;try{if(t.geolocate===WK.COUNTRY){await this.fitToIpBounds();return}}catch(B){console.warn(B.message)}let A;try{await this.centerOnIpPoint(t.zoom),A=this.getCameraHash()}catch(B){console.warn(B.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(B=>{A===this.getCameraHash()&&(this.terrain?this.easeTo({center:[B.coords.longitude,B.coords.latitude],zoom:t.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[B.coords.longitude,B.coords.latitude],zoom:t.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let A={logo:null};try{const B=Object.keys(this.style.sourceCaches).map(X=>this.getSource(X)).filter(X=>X&&"url"in X&&typeof X.url=="string"&&X.url.includes("tiles.json")),F=new URL(B[0].url);F.searchParams.has("key")||F.searchParams.append("key",Nn.apiKey),A=await(await fetch(F.href)).json()}catch{}if(t.forceNoAttributionControl!==!0)if("logo"in A&&A.logo){const B=A.logo;this.addControl(new Dk({logoURL:B}),t.logoPosition)}else t.maptilerLogo&&this.addControl(new Dk,t.logoPosition);if(t.scaleControl){const B=t.scaleControl===!0||t.scaleControl===void 0?"bottom-right":t.scaleControl,F=new OZ({unit:Nn.unit});this.addControl(F,B),Nn.on("unit",X=>{F.setUnit(X)})}if(t.navigationControl!==!1){const B=t.navigationControl===!0||t.navigationControl===void 0?"top-right":t.navigationControl;this.addControl(new rK,B)}if(t.geolocateControl!==!1){const B=t.geolocateControl===!0||t.geolocateControl===void 0?"top-right":t.geolocateControl;this.addControl(new iK({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),B)}if(t.terrainControl){const B=t.terrainControl===!0||t.terrainControl===void 0?"top-right":t.terrainControl;this.addControl(new tK,B)}if(t.projectionControl){const B=t.projectionControl===!0||t.projectionControl===void 0?"top-right":t.projectionControl;this.addControl(new oK,B)}if(t.fullscreenControl){const B=t.fullscreenControl===!0||t.fullscreenControl===void 0?"top-right":t.fullscreenControl;this.addControl(new FZ({}),B)}this.isReady=!0,this.fire("ready",{target:this})});let w=!1,C=!1,k;this.once("ready",()=>{w=!0,C&&this.fire("loadWithTerrain",k)}),this.once("style.load",()=>{const{minimap:A}=t;if(typeof A=="object"){const{zoom:B,center:F,style:X,language:q,apiKey:V,maptilerLogo:U,canvasContextAttributes:ne,refreshExpiredTiles:de,maxBounds:xe,scrollZoom:ke,minZoom:ze,maxZoom:We,boxZoom:rt,locale:Ze,fadeDuration:He,crossSourceCollisions:Ct,clickTolerance:st,bounds:Ge,fitBoundsOptions:tt,pixelRatio:ut,validateStyle:Ve}=t;this.minimap=new db(A,{zoom:B,center:F,style:X,language:q,apiKey:V,container:"null",maptilerLogo:U,canvasContextAttributes:ne,refreshExpiredTiles:de,maxBounds:xe,scrollZoom:ke,minZoom:ze,maxZoom:We,boxZoom:rt,locale:Ze,fadeDuration:He,crossSourceCollisions:Ct,clickTolerance:st,bounds:Ge,fitBoundsOptions:tt,pixelRatio:ut,validateStyle:Ve}),this.addControl(this.minimap,A.position??"bottom-left")}else A===!0?(this.minimap=new db({},t),this.addControl(this.minimap,"bottom-left")):A!==void 0&&A!==!1&&(this.minimap=new db({},t),this.addControl(this.minimap,A))});const I=A=>{A.terrain&&(C=!0,k={type:"loadWithTerrain",target:this,terrain:A.terrain},this.off("terrain",I),w&&this.fire("loadWithTerrain",k))};this.on("terrain",I),t.terrain&&this.enableTerrain(t.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",B=>{if(this._removed===!0){console.warn("[webglcontextlost]","WebGL context lost after map removal. This is harmless.");return}console.warn("[webglcontextlost]","Unexpected loss of WebGL context!"),this.fire("webglContextLost",B)});const A=this.getLayersOrder()[0];t.space&&this.initSpace({options:t,before:A}),t.halo&&this.initHalo({options:t,before:A})}),this.telemetry=new lK(this)}getSpace(){return this.space}setSpace(t){if(this.isGlobeProjection()){if(this.space){this.space.setCubemap(t);return}this.space=new yb(t),this.once("load",()=>{const r=this.getLayersOrder()[0];this.space&&this.addLayer(this.space,r)})}}setSpaceFromStyle({style:t}){var r,o,u;const d=(o=(r=t.metadata)==null?void 0:r.maptiler)==null?void 0:o.space;if(!d){this.setSpace({color:"transparent"});return}if(JSON.stringify((u=this.space)==null?void 0:u.getConfig())===JSON.stringify(d)){if(this.space&&!this.getLayer(this.space.id)){const h=this.getLayersOrder()[0];this.addLayer(this.space,h)}return}(()=>{if(this.space&&this.isGlobeProjection()){if(!this.getLayer(this.space.id)){const h=this.getLayersOrder()[0];this.addLayer(this.space,h)}this.space.setCubemap(d)}})()}setHaloFromStyle({style:t}){var r,o,u;const d=(r=t.metadata)==null?void 0:r.maptiler;if(JSON.stringify((o=this.halo)==null?void 0:o.getConfig())===JSON.stringify(d==null?void 0:d.halo)){if(this.halo&&!this.getLayer(this.halo.id)){const h=this.getLayersOrder().indexOf(((u=this.space)==null?void 0:u.id)??"")+1,s=this.getLayersOrder()[h];this.addLayer(this.halo,s)}return}if(!(d!=null&&d.halo)){this.setHalo({stops:[[0,"transparent"],[1,"transparent"]],scale:0});return}(()=>{var h;if(this.halo){if(!this.getLayer(this.halo.id)){const s=this.getLayersOrder().indexOf(((h=this.space)==null?void 0:h.id)??"")+1,b=this.getLayersOrder()[s];this.addLayer(this.halo,b)}this.halo.setGradient(d.halo)}})()}initSpace({options:t=this.options,before:r,spec:o}){if(this.space){this.getLayer(this.space.id)||this.addLayer(this.space,r);return}if(t.space===!1)return;const u=o;if(t.space){this.space=new yb(t.space),this.addLayer(this.space,r);return}u&&(this.space=new yb(u),this.addLayer(this.space,r))}initHalo({options:t=this.options,before:r,spec:o}){if(this.halo&&this.getLayer(this.halo.id)||t.halo===!1)return;const u=o;if(t.halo){this.halo=new vb(t.halo),this.addLayer(this.halo,r);return}u&&(this.halo=new vb(u),this.addLayer(this.halo,r))}getHalo(){return this.halo}setHalo(t){if(this.isGlobeProjection()){if(this.halo){this.halo.setGradient(t);return}this.halo=new vb(t),this.once("load",()=>{var r;const o=this.getLayersOrder(),u=o[0],d=o.indexOf(((r=this.space)==null?void 0:r.id)??"")+2,h=o[d];this.halo&&this.addLayer(this.halo,this.space?h:u)})}}recreate(){const t={center:this.getCenter(),zoom:this.getZoom(),bearing:this.getBearing(),pitch:this.getPitch()};this.remove(),Object.assign(this,new bz({...this.options})),this.once("load",()=>{this.jumpTo(t)})}setTerrainAnimationDuration(t){this.terrainAnimationDuration=Math.max(t,0)}async onLoadAsync(){return new Promise(t=>{if(this.loaded()){t(this);return}this.once("load",()=>{t(this)})})}async onReadyAsync(){return new Promise(t=>{if(this.isReady){t(this);return}this.once("ready",()=>{t(this)})})}async onLoadWithTerrainAsync(){return new Promise(t=>{if(this.isReady&&this.terrain){t(this);return}this.once("loadWithTerrain",()=>{t(this)})})}monitorStyleUrl(t){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const r=new URL(t);r.search="",this.monitoredStyleUrls.add(r.href)}setStyle(t,r){var o,u,d,h,s,b;this.originalLabelStyle.clear(),(o=this.minimap)==null||o.setStyle(t),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const w=tA(t);if(w.requiresUrlMonitoring&&this.monitorStyleUrl(w.style),w.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}this.styleInProcess=!0;const C=this.getStyle(),k=w.style;try{super.setStyle(w.style,r)}catch(B){this.styleInProcess=!1,console.error("[Map.setStyle]: Error while setting style:",B)}if(typeof w.style=="string"||w.requiresUrlMonitoring)return this;const I=()=>{this.setSpaceFromStyle({style:w.style}),this.setHaloFromStyle({style:w.style})},A=()=>{var B,F,X,q;const V=this.getLayersOrder()[0],U=w.style;this.space?this.setSpaceFromStyle({style:U}):this.initSpace({before:V,spec:(F=(B=U.metadata)==null?void 0:B.maptiler)==null?void 0:F.space}),this.halo?this.setHaloFromStyle({style:U}):this.initHalo({before:V,spec:(q=(X=U.metadata)==null?void 0:X.maptiler)==null?void 0:q.halo})};return this.styleInProcess&&!this.spaceboxLoadingState.styleLoadCallbackSet?(this.once("style.load",A),this.spaceboxLoadingState.styleLoadCallbackSet=!0,this):((u=C==null?void 0:C.terrain)==null?void 0:u.source)!==((d=k==null?void 0:k.terrain)==null?void 0:d.source)||((h=C==null?void 0:C.terrain)==null?void 0:h.exaggeration)!==((s=k==null?void 0:k.terrain)==null?void 0:s.exaggeration)?(this.once("terrain",I),this):(b=k==null?void 0:k.projection)!=null&&b.type?(A(),this):(this.styleInProcess=!0,this)}addLayer(t,r){var o;return(o=this.minimap)==null||o.addLayer(t,r),super.addLayer(t,r)}moveLayer(t,r){var o;return(o=this.minimap)==null||o.moveLayer(t,r),super.moveLayer(t,r)}removeLayer(t){var r;return(r=this.minimap)==null||r.removeLayer(t),super.removeLayer(t)}setLayerZoomRange(t,r,o){var u;return(u=this.minimap)==null||u.setLayerZoomRange(t,r,o),super.setLayerZoomRange(t,r,o)}setFilter(t,r,o){var u;return(u=this.minimap)==null||u.setFilter(t,r,o),super.setFilter(t,r,o)}setPaintProperty(t,r,o,u){var d;return(d=this.minimap)==null||d.setPaintProperty(t,r,o,u),super.setPaintProperty(t,r,o,u)}setLayoutProperty(t,r,o,u){var d;return(d=this.minimap)==null||d.setLayoutProperty(t,r,o,u),super.setLayoutProperty(t,r,o,u)}setGlyphs(t,r){var o;return(o=this.minimap)==null||o.setGlyphs(t,r),super.setGlyphs(t,r)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?Xw(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(t){var r;(r=this.minimap)==null||r.map.setLanguage(t),this.onStyleReady(()=>{this.setPrimaryLanguage(t)})}setPrimaryLanguage(t){const r=this.getStyleLanguage(),o=yk(t,_r);if(!o){console.warn(`The language "${o}" is not supported.`);return}if(!(o.flag===_r.STYLE.flag&&r&&(r.flag===_r.AUTO.flag||r.flag===_r.VISITOR.flag))&&(o.flag!==_r.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===o&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===_r.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=o;let u=o;if(o.flag===_r.STYLE.flag){if(!r){console.warn("The style has no default languages or has an invalid one.");return}u=r}let d=_r.LOCAL.flag,h=["get",d];u.flag===_r.VISITOR.flag?(d=Mk().flag,h=["case",["all",["has",d],["has",_r.LOCAL.flag]],["case",["==",["get",d],["get",_r.LOCAL.flag]],["get",_r.LOCAL.flag],["format",["get",d],{"font-scale":.8},`
`,["get",_r.LOCAL.flag],{"font-scale":1.1}]],["get",_r.LOCAL.flag]]):u.flag===_r.VISITOR_ENGLISH.flag?(d=_r.ENGLISH.flag,h=["case",["all",["has",d],["has",_r.LOCAL.flag]],["case",["==",["get",d],["get",_r.LOCAL.flag]],["get",_r.LOCAL.flag],["format",["get",d],{"font-scale":.8},`
`,["get",_r.LOCAL.flag],{"font-scale":1.1}]],["get",_r.LOCAL.flag]]):u.flag===_r.AUTO.flag?(d=Mk().flag,h=["coalesce",["get",d],["get",_r.LOCAL.flag]]):u===_r.LOCAL?(d=_r.LOCAL.flag,h=["get",d]):(d=u.flag,h=["coalesce",["get",d],["get",_r.LOCAL.flag]]);const{layers:s}=this.getStyle(),b=this.originalLabelStyle.size===0;if(b){const w=zZ(s,this);this.isStyleLocalized=Object.keys(w.localized).length>0}for(const w of s){if(w.type!=="symbol")continue;const C=w,k=this.getSource(C.source);if(!k||!("url"in k&&typeof k.url=="string")||new URL(k.url).host!==Ui.maptilerApiHost)continue;const{id:I,layout:A}=C;if(!A||!("text-field"in A))continue;let B;if(b?(B=this.getLayoutProperty(I,"text-field"),this.originalLabelStyle.set(I,B)):B=this.originalLabelStyle.get(I),typeof B=="string"){const{contains:F,exactMatch:X}=AZ(B,this.isStyleLocalized);if(!F)continue;if(X)this.setLayoutProperty(I,"text-field",h);else{const q=IZ(B,h,this.isStyleLocalized);this.setLayoutProperty(I,"text-field",q)}}else{const F=kZ(B,h,this.isStyleLocalized);this.setLayoutProperty(I,"text-field",F)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(t){if(!this.terrain)return;const r=performance.now(),o=this.terrain.exaggeration,u=t-o,d=()=>{if(!this.terrain||this.terrainFlattening)return;const h=(performance.now()-r)/this.terrainAnimationDuration;if(h<.99){const s=1-(1-h)**4,b=o+s*u;this.terrain.exaggeration=b,requestAnimationFrame(d)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=t,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(d)}enableTerrain(t=this.terrainExaggeration){if(t<0){console.warn("Terrain exaggeration cannot be negative.");return}const r=u=>{!this.terrain||u.type!=="data"||u.dataType!=="source"||!("source"in u)||u.sourceId!=="maptiler-terrain"||u.source.type!=="raster-dem"||u.isSourceLoaded&&(this.off("data",r),this.growTerrain(t))},o=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=t,this.on("data",r),this.addSource(Ui.terrainSourceId,{type:"raster-dem",url:Ui.terrainSourceURL}),this.setTerrain({source:Ui.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(t);return}if(this.loaded()||this.isTerrainEnabled)o();else{const u=()=>{this.getTerrain()&&this.getSource(Ui.terrainSourceId)||o()};this.once("load",()=>{u()}),this.once("moveend",()=>{u()})}}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=performance.now(),r=this.terrain.exaggeration,o=()=>{if(!this.terrain||this.terrainGrowing)return;const u=(performance.now()-t)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,u<.99){const d=(1-u)**4,h=r*d;this.terrain.exaggeration=h,requestAnimationFrame(o)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Ui.terrainSourceId)&&this.removeSource(Ui.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(o)}setTerrainExaggeration(t,r=!0){!r&&this.terrain?(this.terrainExaggeration=t,this.terrain.exaggeration=t,this.triggerRepaint()):this.enableTerrain(t)}onStyleReady(t){this.isStyleLoaded()?t():this.once("styledata",()=>{t()})}async fitToIpBounds(){const t=await _k.info();this.fitBounds(t.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(t){const r=await _k.info();this.jumpTo({center:[r.longitude??0,r.latitude??0],zoom:t||11})}getCameraHash(){const t=new Float32Array(5),r=this.getCenter();return t[0]=r.lng,t[1]=r.lat,t[2]=this.getZoom(),t[3]=this.getPitch(),t[4]=this.getBearing(),mZ.fromUint8Array(new Uint8Array(t.buffer))}getSdkConfig(){return Nn}getMaptilerSessionId(){return nT}setTransformRequest(t){return super.setTransformRequest(Rk(t)),this}isGlobeProjection(){const t=this.getProjection();return t?t.type==="globe":!1}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}};function gv(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function HK(e){return`#${gv(e[0])}${gv(e[1])}${gv(e[2])}${e.length===4?gv(e[3]):""}`}class jt extends Array{constructor(t={}){super(),Tt(this,"min",0),Tt(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(t){return new jt({stops:t.map(r=>({value:r[0],color:r[1]}))})}setStops(t,r={clone:!0}){const o=r.clone?this.clone():this;o.length=0;let u=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(let h=0;h<t.length;h+=1)u=Math.min(u,t[h].value),d=Math.max(d,t[h].value),o.push({value:t[h].value,color:t[h].color.slice()});return o.sort((h,s)=>h.value<s.value?-1:1),this.min=u,this.max=d,o}scale(t,r,o={clone:!0}){const u=o.clone,d=this[0].value,h=this.at(-1).value-d,s=r-t,b=[];for(let w=0;w<this.length;w+=1){const C=(this[w].value-d)/h*s+t;u?b.push({value:C,color:this[w].color.slice()}):this[w].value=C}return u?new jt({stops:b}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new jt({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let r=0;r<this.length;r+=1)t.push({value:this[r].value,color:this[r].color});return t}reverse(t={clone:!0}){const r=t.clone?this.clone():this;for(let o=0;o<~~(r.length/2);o+=1){const u=r[o].color;r[o].color=r.at(-(o+1)).color,r.at(-(o+1)).color=u}return r}getBounds(){return{min:this.min,max:this.max}}getColor(t,r={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let o=0;o<this.length-1;o+=1){if(t>this[o+1].value)continue;const u=this[o].color;if(!r.smooth)return u.slice();const d=this[o].value,h=this[o+1].value,s=this[o+1].color,b=(h-t)/(h-d);return u.map((w,C)=>Math.round(w*b+s[C]*(1-b)))}return[0,0,0]}getColorHex(t,r={smooth:!0,withAlpha:!1}){return HK(this.getColor(t,r))}getColorRelative(t,r={smooth:!0}){const o=this.getBounds();return this.getColor(o.min+t*(o.max-o.min),r)}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const r=document.createElement("canvas");r.width=t.horizontal?t.size:1,r.height=t.horizontal?1:t.size;const o=r.getContext("2d");if(!o)throw new Error("Canvs context is missing");const u=o.getImageData(0,0,r.width,r.height),d=u.data,h=t.size,s=this[0].value,b=(this.at(-1).value-s)/h;for(let w=0;w<h;w+=1){const C=this.getColor(s+w*b,{smooth:t.smooth});d[w*4]=C[0],d[w*4+1]=C[1],d[w*4+2]=C[2],d[w*4+3]=C.length>3?C[3]:255}return o.putImageData(u,0,0),r}resample(t,r=15){const o=this.getBounds(),u=this.scale(0,1),d=1/(r-1);let h;if(t==="ease-in-square")h=Array.from({length:r},(s,b)=>{const w=b*d,C=w**2,k=u.getColor(C);return{value:w,color:k}});else if(t==="ease-out-square")h=Array.from({length:r},(s,b)=>{const w=b*d,C=1-(1-w)**2,k=u.getColor(C);return{value:w,color:k}});else if(t==="ease-out-sqrt")h=Array.from({length:r},(s,b)=>{const w=b*d,C=w**.5,k=u.getColor(C);return{value:w,color:k}});else if(t==="ease-in-sqrt")h=Array.from({length:r},(s,b)=>{const w=b*d,C=1-(1-w)**.5,k=u.getColor(C);return{value:w,color:k}});else if(t==="ease-out-exp")h=Array.from({length:r},(s,b)=>{const w=b*d,C=1-2**(-10*w),k=u.getColor(C);return{value:w,color:k}});else if(t==="ease-in-exp")h=Array.from({length:r},(s,b)=>{const w=b*d,C=2**(10*w-10),k=u.getColor(C);return{value:w,color:k}});else throw new Error("Invalid ressampling method.");return new jt({stops:h}).scale(o.min,o.max)}transparentStart(){const t=this.getRawColorStops();t.unshift({value:t[0].value,color:t[0].color.slice()}),t[1].value+=.001;for(const r of t)r.color.length===3&&r.color.push(255);return t[0].color[3]=0,new jt({stops:t})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}new jt({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new jt({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new jt({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new jt({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new jt({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new jt({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new jt({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new jt({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new jt({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new jt({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new jt({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new jt({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new jt({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new jt({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new jt({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new jt({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new jt({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new jt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new jt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new jt({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new jt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new jt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new jt({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new jt({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new jt({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new jt({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new jt({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new jt({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new jt({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new jt({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new jt({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new jt({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new jt({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new jt({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new jt({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new jt({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new jt({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new jt({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new jt({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new jt({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new jt({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new jt({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});CZ();It.Map;It.Marker;It.Popup;It.Style;It.CanvasSource;It.GeoJSONSource;It.ImageSource;It.RasterTileSource;It.RasterDEMTileSource;It.VectorTileSource;It.VideoSource;It.NavigationControl;It.GeolocateControl;It.AttributionControl;It.LogoControl;It.ScaleControl;It.FullscreenControl;It.TerrainControl;It.BoxZoomHandler;It.ScrollZoomHandler;It.CooperativeGesturesHandler;It.KeyboardHandler;It.TwoFingersTouchPitchHandler;It.MapWheelEvent;It.MapTouchEvent;It.MapMouseEvent;It.config;It.getVersion;const{setRTLTextPlugin:ZY,getRTLTextPluginStatus:WY,LngLat:HY,LngLatBounds:KK,MercatorCoordinate:KY,Evented:XY,AJAXError:YY,prewarm:QY,clearPrewarmedResources:JY,Hash:eQ,Point:tQ,EdgeInsets:rQ,DragRotateHandler:nQ,DragPanHandler:iQ,TwoFingersTouchZoomRotateHandler:oQ,DoubleClickZoomHandler:sQ,TwoFingersTouchZoomHandler:aQ,TwoFingersTouchRotateHandler:lQ,getWorkerCount:cQ,setWorkerCount:uQ,getMaxParallelImageRequests:hQ,setMaxParallelImageRequests:dQ,getWorkerUrl:pQ,setWorkerUrl:fQ,addSourceType:mQ,importScriptInWorkers:gQ,addProtocol:yQ,removeProtocol:vQ}=It,qd=K.forwardRef(({className:e,type:t,...r},o)=>j.jsx("input",{type:t,className:Tn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:o,...r}));qd.displayName="Input";const Vo={lat:-21.9427,lng:-46.7167},wz=()=>{const e=K.useRef(null),t=K.useRef(null),[r,o]=K.useState(null),[u,d]=K.useState(null),[h,s]=K.useState("backdrop"),[b,w]=K.useState(!0),[C,k]=K.useState(!0),[I,A]=K.useState(""),[B,F]=K.useState([]),[X,q]=K.useState(!1),[V,U]=K.useState(!1),[ne,de]=K.useState(null),xe=K.useRef(new wz),{getCombinedData:ke,loading:ze,error:We}=QS(),rt=()=>{const De=ke("pt");if(De.length===0)return[];const Ke=JSON.parse(localStorage.getItem("technosutra-waypoint-positions")||"{}");return De.map((nt,ot)=>({id:nt.chapter,coordinates:Ke[nt.chapter]||[Vo.lng+(Math.random()-.5)*.012,Vo.lat+(Math.random()-.5)*.012],chapter:nt.chapter,title:`${nt.nome}`,subtitle:`Capítulo ${nt.chapter}`,description:nt.descPersonagem||nt.ensinamento.substring(0,200)+"...",fullDescription:nt.descPersonagem,teaching:nt.ensinamento,occupation:nt.ocupacao,meaning:nt.significado,location:nt.local,chapterSummary:nt.resumoCap,model:nt.linkModel,capUrl:nt.capUrl,qrCodeUrl:nt.qrCodeUrl}))},[Ze,He]=K.useState([]);K.useEffect(()=>{if(!ze&&!We){const De=rt();He(De),F(De)}},[ze,We]);const Ct=(De,Ke)=>{const nt=JSON.parse(localStorage.getItem("technosutra-waypoint-positions")||"{}");nt[De]=Ke,localStorage.setItem("technosutra-waypoint-positions",JSON.stringify(nt)),He(ot=>ot.map(Et=>Et.chapter===De?{...Et,coordinates:Ke}:Et))},st=()=>{U(!V),console.log(V?"✅ MODO DE EDIÇÃO DESATIVADO - Posições salvas":"🔧 MODO DE EDIÇÃO ATIVADO - Arraste os pontos para reposicionar")},Ge=(De,Ke=!1)=>{s(De),w(Ke)};K.useEffect(()=>{if(I){const De=Ze.filter(Ke=>Ke.title.toLowerCase().includes(I.toLowerCase())||Ke.subtitle.toLowerCase().includes(I.toLowerCase())||Ke.chapter.toString().includes(I)||Ke.occupation.toLowerCase().includes(I.toLowerCase())||Ke.location.toLowerCase().includes(I.toLowerCase()));F(De)}else F(Ze)},[I,Ze]),K.useEffect(()=>{if(!(!e.current||Ze.length===0))return k(!0),Nn.apiKey="rg7OAqXjLo7cLdwqlrVt",t.current=new MT({container:e.current,style:h,center:[Vo.lng,Vo.lat],zoom:12,pitch:45,bearing:0,attributionControl:!1}),b&&e.current?e.current.classList.add("cyberpunk-map"):e.current&&e.current.classList.remove("cyberpunk-map"),t.current.addControl(new iT({visualizePitch:!0}),"top-right"),t.current.on("load",()=>{k(!1)}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(De=>{const Ke=[De.coords.latitude,De.coords.longitude];o(Ke),new r2({color:"#00ffff",scale:1.2}).setLngLat([Ke[1],Ke[0]]).addTo(t.current)},De=>{console.warn("Geolocation not available:",De)}),t.current.on("load",()=>{if(!t.current||Ze.length===0)return;const De=[[Vo.lng-.001,Vo.lat-.001],...Ze.map(Ke=>Ke.coordinates),[Vo.lng+.001,Vo.lat+.001]];t.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:De}}}),t.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":b?"#ff00ff":"#00ffff","line-width":4,"line-opacity":.8}}),xe.current.forEach(Ke=>Ke.remove()),xe.current.clear(),Ze.forEach((Ke,nt)=>{const ot=document.createElement("div");ot.className=`waypoint-marker ${V?"waypoint-edit-mode waypoint-draggable":""}`,ot.style.cssText=`
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: linear-gradient(135deg, ${b?"#ff00ff, #00ffff":"#00ffff, #ff00ff"});
          border: 2px solid #ffffff;
          cursor: ${V?"grab":"pointer"};
          display: flex;
          align-items: center;
          justify-content: center;
          color: #000;
          font-weight: bold;
          font-size: 11px;
          box-shadow: 0 0 20px ${b?"#ff00ff":"#00ffff"};
          position: relative;
          z-index: ${V?"1000":"100"};
        `,ot.textContent=String(Ke.chapter),ot.title=`${Ke.title} - ${Ke.occupation}`,ot.addEventListener("click",Rt=>{V||d(Ke),Rt.stopPropagation()});const Et=new r2(ot,{draggable:V}).setLngLat(Ke.coordinates).addTo(t.current);V&&(Et.on("dragstart",()=>{de(Ke),ot.style.cursor="grabbing"}),Et.on("dragend",()=>{const Rt=Et.getLngLat(),lr=[Rt.lng,Rt.lat];Ct(Ke.chapter,lr),ot.style.cursor="grab",de(null),tt()})),xe.current.set(Ke.chapter,Et)})}),()=>{var De;e.current&&e.current.classList.remove("cyberpunk-map"),(De=t.current)==null||De.remove()}},[h,Ze,V,b]);const tt=()=>{if(!t.current)return;const De=[[Vo.lng-.001,Vo.lat-.001],...Ze.map(Ke=>Ke.coordinates),[Vo.lng+.001,Vo.lat+.001]];t.current.getSource("route")&&t.current.getSource("route").setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:De}})},ut=De=>{var Ke;(Ke=t.current)==null||Ke.flyTo({center:De.coordinates,zoom:16,pitch:60,duration:2e3})},Ve=()=>{q(!X)};return j.jsxs("div",{className:`${X?"fixed inset-0 z-50":"h-screen"} relative overflow-hidden bg-background`,children:[j.jsx(Km,{children:(C||ze)&&j.jsx(Vt.div,{initial:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-background flex items-center justify-center",children:j.jsxs("div",{className:"text-center",children:[j.jsx(Vt.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),j.jsx(Vt.h2,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"text-xl font-bold text-primary text-glow",children:ze?"Carregando dados do Sutra...":"Iniciando Sistema Techno Sutra..."}),We&&j.jsxs("p",{className:"text-destructive text-sm mt-2",children:["Erro ao carregar dados: ",We]})]})})}),j.jsx("div",{ref:e,className:"absolute inset-0"}),b&&j.jsx("div",{className:"cyberpunk-overlay"}),V&&j.jsx("div",{className:"edit-mode-overlay"}),j.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[j.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-background/30 to-transparent"}),j.jsx("div",{className:"absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-background/30 to-transparent"}),j.jsx("div",{className:"absolute top-0 left-0 w-32 h-full bg-gradient-to-r from-background/20 to-transparent"}),j.jsx("div",{className:"absolute top-0 right-0 w-32 h-full bg-gradient-to-l from-background/20 to-transparent"})]}),j.jsxs(Vt.div,{initial:{x:-100,opacity:0},animate:{x:0,opacity:1},className:"absolute top-4 left-4 space-y-3 pointer-events-auto max-w-xs",children:[j.jsxs(ri,{className:"cyberpunk-card p-4",children:[j.jsxs("div",{className:"flex items-center justify-between mb-2",children:[j.jsx("h3",{className:"text-primary text-glow font-bold",children:"Techno Sutra"}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(ar,{variant:"ghost",size:"sm",onClick:st,className:`${V?"text-yellow-400 bg-yellow-400/20":"text-muted-foreground"} hover:text-yellow-400 transition-colors`,title:V?"Desativar modo de edição":"Ativar modo de edição",children:j.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),j.jsx(ar,{variant:"ghost",size:"sm",onClick:Ve,className:"text-primary hover:text-accent",children:j.jsx(SB,{className:"w-4 h-4"})})]})]}),j.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:V?"🔧 Modo de Edição Ativo":"Rota Sagrada Original"}),j.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[j.jsx(eh,{className:"w-4 h-4 text-primary"}),j.jsx("span",{children:"Águas da Prata, SP"})]}),V&&j.jsx("div",{className:"mt-2 p-2 bg-yellow-400/10 border border-yellow-400/30 rounded text-xs text-yellow-200",children:"💡 Arraste os pontos no mapa para reposicioná-los na trilha correta"})]}),j.jsxs(ri,{className:"cyberpunk-card p-3",children:[j.jsxs("div",{className:"relative",children:[j.jsx(v0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),j.jsx(qd,{placeholder:"Buscar personagem ou capítulo...",value:I,onChange:De=>A(De.target.value),className:"pl-10 bg-muted/20 border-border text-foreground"})]}),I&&j.jsxs(Vt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-xs text-muted-foreground mt-2",children:[B.length," pontos encontrados"]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs(ar,{variant:"outline",size:"sm",className:`w-full transition-all duration-300 hover:scale-105 ${b?"gradient-neon text-black font-bold":"neon-glow"}`,onClick:()=>Ge("backdrop",!0),children:[j.jsx(Sw,{className:"w-4 h-4 mr-2"}),"Modo Cyberpunk"]}),j.jsxs(ar,{variant:"outline",size:"sm",className:`w-full transition-all duration-300 hover:scale-105 ${!b&&h==="backdrop"?"bg-muted text-foreground":"neon-glow"}`,onClick:()=>Ge("backdrop",!1),children:[j.jsx(ww,{className:"w-4 h-4 mr-2"}),"Modo Sombras"]}),j.jsxs(ar,{variant:"outline",size:"sm",className:`w-full purple-glow transition-all duration-300 hover:scale-105 ${!b&&h==="streets-v2"?"bg-muted text-foreground":""}`,onClick:()=>Ge("streets-v2",!1),children:[j.jsx(pS,{className:"w-4 h-4 mr-2"}),"Modo Clássico"]})]})]}),j.jsx(Km,{children:u&&j.jsx(Vt.div,{initial:{x:100,opacity:0,scale:.9},animate:{x:0,opacity:1,scale:1},exit:{x:100,opacity:0,scale:.9},transition:{type:"spring",damping:20,stiffness:300},className:"absolute top-4 right-4 w-80 pointer-events-auto",children:j.jsxs(ri,{className:"cyberpunk-card p-6 relative overflow-hidden",children:[j.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-accent/5 animate-pulse"}),j.jsxs("div",{className:"relative z-10",children:[j.jsxs("div",{className:"flex justify-between items-start mb-4",children:[j.jsxs("div",{children:[j.jsx(Vt.h3,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},className:"text-primary text-glow font-bold text-lg",children:u.title}),j.jsxs(Vt.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"flex items-center gap-2 text-xs text-accent mt-1",children:[j.jsx(Sw,{className:"w-3 h-3"}),j.jsxs("span",{children:[u.subtitle," • ",u.occupation]})]}),j.jsxs(Vt.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.15},className:"text-xs text-muted-foreground mt-1",children:["📍 ",u.location]})]}),j.jsx(ar,{variant:"ghost",size:"sm",onClick:()=>d(null),className:"text-muted-foreground hover:text-primary transition-colors",children:"✕"})]}),j.jsxs(Vt.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"text-muted-foreground mb-2 text-sm",children:[j.jsx("strong",{className:"text-yellow-400",children:"Significado:"})," ",u.meaning]}),j.jsx(Vt.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.25},className:"text-muted-foreground mb-4 text-sm",children:u.description}),j.jsxs("div",{className:"space-y-3",children:[j.jsx(Vt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},children:j.jsxs(ar,{onClick:()=>ut(u),className:"w-full gradient-neon text-black font-bold hover:scale-105 transition-transform",children:[j.jsx(ww,{className:"w-4 h-4 mr-2"}),"Voar para Local"]})}),j.jsx(Vt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},children:j.jsxs(ar,{variant:"outline",className:"w-full border-neon hover:scale-105 transition-transform",onClick:()=>{const De=u.model;window.open(`/model-viewer?url=${encodeURIComponent(De)}&title=${encodeURIComponent(u.title)}`,"_blank")},children:[j.jsx(_0,{className:"w-4 h-4 mr-2"}),"Ver Modelo 3D"]})}),j.jsx(Vt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},children:j.jsxs(ar,{variant:"outline",className:"w-full border-purple-500 text-purple-400 hover:scale-105 transition-transform",onClick:()=>{u.capUrl&&window.open(u.capUrl,"_blank")},children:[j.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Ler Capítulo"]})}),j.jsx(Vt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},children:j.jsxs(ar,{variant:"outline",className:"w-full border-cyan-500 text-cyan-400 hover:scale-105 transition-transform",onClick:()=>{u.qrCodeUrl&&window.open(u.qrCodeUrl,"_blank")},children:[j.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Ver QR Code"]})})]})]})]})})}),j.jsx(Vt.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},className:"absolute bottom-4 left-4 pointer-events-auto",children:j.jsxs(ri,{className:"cyberpunk-card p-4",children:[j.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[j.jsxs(Vt.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[j.jsx("div",{className:"text-primary text-glow font-bold text-xl",children:"56"}),j.jsx("div",{className:"text-muted-foreground",children:"Pontos"})]}),j.jsxs(Vt.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[j.jsx("div",{className:"text-accent text-glow font-bold text-xl",children:B.length}),j.jsx("div",{className:"text-muted-foreground",children:"Filtrados"})]}),j.jsxs(Vt.div,{whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[j.jsx("div",{className:"text-cyan-400 text-glow font-bold text-xl",children:r?"1":"0"}),j.jsx("div",{className:"text-muted-foreground",children:"Localizado"})]}),V&&j.jsxs(Vt.div,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},className:"text-center cursor-pointer",children:[j.jsx("div",{className:"text-yellow-400 text-glow font-bold text-xl",children:"✏️"}),j.jsx("div",{className:"text-muted-foreground",children:"Editando"})]})]}),V&&j.jsx("div",{className:"mt-2 text-xs text-yellow-400 text-center",children:"Posições sendo salvas automaticamente"})]})})]})},XK=mg("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h2({className:e,variant:t,...r}){return j.jsx("div",{className:Tn(XK({variant:t}),e),...r})}const YK=({character:e,isOpen:t,onClose:r})=>{if(!e)return null;const o=()=>{const h=encodeURIComponent(e.linkModel),s=encodeURIComponent(e.nome);window.open(`/model-viewer?url=${h}&title=${s}`,"_blank")},u=()=>{e.capUrl&&window.open(e.capUrl,"_blank")},d=()=>{e.qrCodeUrl&&window.open(e.qrCodeUrl,"_blank")};return j.jsx(Km,{children:t&&j.jsx(Vt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:r,children:j.jsxs(Vt.div,{initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:50},className:"cyberpunk-card max-w-4xl w-full max-h-[90vh] overflow-auto relative",onClick:h=>h.stopPropagation(),children:[j.jsx("div",{className:"p-6 border-b border-border",children:j.jsxs("div",{className:"flex justify-between items-start",children:[j.jsxs("div",{className:"flex-1",children:[j.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[j.jsx("h2",{className:"text-3xl font-bold text-primary text-glow",children:e.nome}),j.jsxs(h2,{variant:"outline",className:"text-accent",children:["Capítulo ",e.chapter]})]}),j.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(y0,{className:"w-4 h-4 text-accent"}),j.jsx("span",{children:e.ocupacao})]}),j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(eh,{className:"w-4 h-4 text-cyan-400"}),j.jsx("span",{children:e.local})]}),j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(MR,{className:"w-4 h-4 text-yellow-400"}),j.jsx("span",{children:e.significado})]})]})]}),j.jsx(ar,{variant:"ghost",size:"sm",onClick:r,className:"text-muted-foreground hover:text-primary",children:j.jsx(fS,{className:"w-5 h-5"})})]})}),j.jsxs("div",{className:"p-6 space-y-6",children:[j.jsxs("div",{children:[j.jsx("h3",{className:"text-xl font-bold text-primary mb-3",children:"Descrição do Personagem"}),j.jsx("p",{className:"text-muted-foreground leading-relaxed",children:e.descPersonagem||e.ensinamento})]}),j.jsxs("div",{children:[j.jsx("h3",{className:"text-xl font-bold text-primary mb-3",children:"Ensinamento"}),j.jsx("div",{className:"bg-muted/20 p-4 rounded-lg border border-border",children:j.jsx("p",{className:"text-foreground leading-relaxed",children:e.ensinamento})})]}),e.resumoCap&&j.jsxs("div",{children:[j.jsx("h3",{className:"text-xl font-bold text-primary mb-3",children:"Resumo do Capítulo"}),j.jsx("p",{className:"text-muted-foreground leading-relaxed",children:e.resumoCap})]}),e.encounter&&j.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[j.jsxs("div",{children:[j.jsx("h4",{className:"font-bold text-accent mb-2",children:"Encontro"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:e.encounter})]}),e.assembly&&j.jsxs("div",{children:[j.jsx("h4",{className:"font-bold text-accent mb-2",children:"Assembleia"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:e.assembly})]}),e.manifestation&&j.jsxs("div",{children:[j.jsx("h4",{className:"font-bold text-accent mb-2",children:"Manifestação"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:e.manifestation})]}),e.learning&&j.jsxs("div",{children:[j.jsx("h4",{className:"font-bold text-accent mb-2",children:"Aprendizado"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:e.learning})]})]}),j.jsxs("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-border",children:[j.jsxs(ar,{onClick:o,className:"gradient-neon text-black font-bold",children:[j.jsx(dS,{className:"w-4 h-4 mr-2"}),"Ver Modelo 3D"]}),e.capUrl&&j.jsxs(ar,{variant:"outline",onClick:u,className:"border-purple-500 text-purple-400",children:[j.jsx(y0,{className:"w-4 h-4 mr-2"}),"Ler Capítulo"]}),e.qrCodeUrl&&j.jsxs(ar,{variant:"outline",onClick:d,className:"border-cyan-500 text-cyan-400",children:[j.jsx(vB,{className:"w-4 h-4 mr-2"}),"Ver QR Code"]})]})]})]})})})},QK=()=>{const[e,t]=K.useState(""),[r,o]=K.useState("all"),[u,d]=K.useState(null),[h,s]=K.useState([]),[b,w]=K.useState(!1),{getCombinedData:C,loading:k,error:I}=QS();K.useEffect(()=>{if(!k&&!I){const q=C("pt").map((V,U)=>({id:V.chapter,title:V.nome,subtitle:`Capítulo ${V.chapter}`,description:V.descPersonagem||V.ensinamento.substring(0,150)+"...",fullDescription:V.descPersonagem,teaching:V.ensinamento,chapter:V.chapter,modelUrl:V.linkModel,thumbnailUrl:`https://via.placeholder.com/300x200/000011/00ffff?text=${encodeURIComponent(V.nome.substring(0,15))}`,tags:[V.ocupacao||"Místico","Budista","3D","Cyberpunk",V.local?"Localizado":"Espiritual"].filter(Boolean),rarity:V.chapter%7===0?"legendary":V.chapter%3===0?"epic":"common",downloads:Math.floor(Math.random()*1e4)+V.chapter*100,rating:(4+Math.random()).toFixed(1),occupation:V.ocupacao,meaning:V.significado,location:V.local,chapterSummary:V.resumoCap,capUrl:V.capUrl,qrCodeUrl:V.qrCodeUrl}));s(q)}},[k,I]);const A=h.filter(X=>{const q=X.title.toLowerCase().includes(e.toLowerCase())||X.description.toLowerCase().includes(e.toLowerCase())||X.occupation.toLowerCase().includes(e.toLowerCase())||X.location.toLowerCase().includes(e.toLowerCase())||X.chapter.toString().includes(e),V=r==="all"||X.rarity===r;return q&&V}),B=X=>{switch(X){case"legendary":return"bg-gradient-to-r from-yellow-400 to-orange-500";case"epic":return"bg-gradient-to-r from-purple-400 to-pink-500";default:return"bg-gradient-to-r from-blue-400 to-cyan-500"}},F=X=>{const q=encodeURIComponent(X.modelUrl),V=encodeURIComponent(X.title);window.open(`/model-viewer?url=${q}&title=${V}`,"_blank")};return j.jsxs("div",{className:"min-h-screen bg-background p-6",children:[j.jsxs(Vt.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},className:"mb-8",children:[j.jsx("h1",{className:"text-4xl font-bold text-primary text-glow mb-2",children:"Galeria de Personagens 3D"}),j.jsxs("p",{className:"text-muted-foreground",children:["Explore os ",h.length," personagens místicos do Sutra Stem Array"]}),k&&j.jsx("p",{className:"text-accent text-sm mt-2",children:"Carregando dados do Sutra..."}),I&&j.jsxs("p",{className:"text-destructive text-sm mt-2",children:["Erro ao carregar dados: ",I]})]}),j.jsx(Vt.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"mb-8 space-y-4",children:j.jsxs("div",{className:"flex gap-4 flex-wrap",children:[j.jsx("div",{className:"flex-1 min-w-[300px]",children:j.jsxs("div",{className:"relative",children:[j.jsx(v0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),j.jsx(qd,{placeholder:"Buscar personagens, ocupações, locais...",value:e,onChange:X=>t(X.target.value),className:"pl-10 bg-secondary border-border"})]})}),j.jsx("div",{className:"flex gap-2",children:["all","common","epic","legendary"].map(X=>j.jsx(ar,{variant:r===X?"default":"outline",size:"sm",onClick:()=>o(X),className:r===X?"gradient-neon text-black":"border-neon",children:X==="all"?"Todos":X.charAt(0).toUpperCase()+X.slice(1)},X))})]})}),j.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:A.map((X,q)=>j.jsx(Vt.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:q*.05},children:j.jsxs(ri,{className:"cyberpunk-card overflow-hidden group",children:[j.jsxs("div",{className:"relative aspect-video bg-secondary",children:[j.jsx("img",{src:X.thumbnailUrl,alt:X.title,className:"w-full h-full object-cover"}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),j.jsx("div",{className:`absolute top-2 right-2 px-2 py-1 rounded text-xs font-bold text-black ${B(X.rarity)}`,children:X.rarity.toUpperCase()}),j.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:j.jsxs("div",{className:"flex gap-2",children:[j.jsxs(ar,{onClick:()=>F(X),className:"gradient-neon text-black font-bold",size:"sm",children:[j.jsx(dS,{className:"w-4 h-4 mr-1"}),"3D"]}),j.jsxs(ar,{onClick:()=>{d(X),w(!0)},variant:"outline",className:"border-neon bg-background/80",size:"sm",children:[j.jsx(bB,{className:"w-4 h-4 mr-1"}),"Info"]})]})})]}),j.jsxs("div",{className:"p-4",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[j.jsx("h3",{className:"font-bold text-primary flex-1",children:X.title}),j.jsxs(h2,{variant:"outline",className:"text-xs",children:["Cap. ",X.chapter]})]}),j.jsxs("div",{className:"flex items-center gap-2 text-xs text-accent mb-2",children:[j.jsx(y0,{className:"w-3 h-3"}),j.jsx("span",{children:X.occupation})]}),j.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-3",children:[j.jsx(eh,{className:"w-3 h-3"}),j.jsx("span",{className:"truncate",children:X.location})]}),j.jsxs("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:[j.jsx("strong",{children:"Significado:"})," ",X.meaning]}),j.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:X.tags.slice(0,3).map(V=>j.jsx(h2,{variant:"secondary",className:"text-xs",children:V},V))}),j.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(MB,{className:"w-3 h-3 text-yellow-400 fill-current"}),X.rating]}),j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(ER,{className:"w-3 h-3"}),X.downloads.toLocaleString()]})]})]})]})},X.id))}),j.jsx(YK,{character:u,isOpen:b,onClose:()=>{w(!1),d(null)}})]})};var JK="Label",Sz=K.forwardRef((e,t)=>j.jsx(Sn.label,{...e,ref:t,onMouseDown:r=>{var u;r.target.closest("button, input, select, textarea")||((u=e.onMouseDown)==null||u.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Sz.displayName=JK;var Tz=Sz;const eX=mg("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Gv=K.forwardRef(({className:e,...t},r)=>j.jsx(Tz,{ref:r,className:Tn(eX(),e),...t}));Gv.displayName=Tz.displayName;const tX=()=>{const[e,t]=K.useState(""),[r,o]=K.useState(""),[u,d]=K.useState(""),[h,s]=K.useState(!1),[b,w]=K.useState(null),[C,k]=K.useState([]),[I,A]=K.useState([]),[B,F]=K.useState("start"),[X,q]=K.useState(!1),V=K.useRef(null),U=K.useRef(null),ne=K.useRef([]);K.useEffect(()=>{if(!V.current)return;Nn.apiKey="rg7OAqXjLo7cLdwqlrVt",U.current=new MT({container:V.current,style:"backdrop",center:[-46.7167,-21.9427],zoom:10,attributionControl:!1}),U.current.addControl(new iT,"top-right");const Ge=localStorage.getItem("technosutra-routes");return Ge&&A(JSON.parse(Ge)),U.current.on("load",()=>{console.log("Map loaded successfully")}),()=>{var tt;(tt=U.current)==null||tt.remove()}},[]),K.useEffect(()=>{if(!U.current)return;const Ge=tt=>{if(!h)return;console.log("Map clicked!",tt.lngLat);const ut=[tt.lngLat.lng,tt.lngLat.lat],Ve={id:`${B}-${Date.now()}`,coordinates:ut,name:ke(B,C.length),type:B};let De=C;(B==="start"||B==="end")&&(De=C.filter(nt=>nt.type!==B));const Ke=[...De,Ve];k(Ke),ze(Ke),B==="start"?F("end"):B==="end"&&F("waypoint")};return U.current.on("click",Ge),()=>{U.current&&U.current.off("click",Ge)}},[h,B,C]);const de=async Ge=>{if(!Ge.trim())return null;try{const ut=await(await fetch(`https://api.maptiler.com/geocoding/${encodeURIComponent(Ge)}.json?key=rg7OAqXjLo7cLdwqlrVt&limit=1`)).json();if(ut.features&&ut.features.length>0){const[Ve,De]=ut.features[0].center;return[Ve,De]}return null}catch(tt){return console.error("Geocoding error:",tt),null}},xe=async(Ge,tt)=>{const ut=await de(Ge);ut&&U.current?(U.current.flyTo({center:ut,zoom:14,duration:2e3}),h&&(F(tt),q(!0),setTimeout(()=>q(!1),5e3))):alert('Local não encontrado. Tente termos como "São Paulo", "Rio de Janeiro", etc.')},ke=(Ge,tt)=>{switch(Ge){case"start":return"Ponto de Partida";case"end":return"Destino Final";default:return`Ponto ${tt}`}},ze=Ge=>{if(ne.current.forEach(tt=>tt.remove()),ne.current=[],Ge.forEach(tt=>{const ut=document.createElement("div");ut.className="custom-waypoint-marker";const Ve=tt.type==="start"?"#00ff00":tt.type==="end"?"#ff0040":"#00ffff";ut.style.cssText=`
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: ${Ve};
        border: 3px solid #ffffff;
        cursor: pointer;
        box-shadow: 0 0 20px ${Ve};
        position: relative;
        z-index: 1000;
      `;const De=document.createElement("div");De.textContent=tt.name,De.style.cssText=`
        position: absolute;
        top: -35px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.9);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        white-space: nowrap;
        pointer-events: none;
        border: 1px solid ${Ve};
      `,ut.appendChild(De);const Ke=new r2(ut).setLngLat(tt.coordinates).addTo(U.current);ne.current.push(Ke)}),Ge.length>=2&&U.current){U.current.getLayer("custom-route")&&(U.current.removeLayer("custom-route"),U.current.removeSource("custom-route"));const tt=[...Ge.filter(ut=>ut.type==="start"),...Ge.filter(ut=>ut.type==="waypoint"),...Ge.filter(ut=>ut.type==="end")];tt.length>=2&&(U.current.addSource("custom-route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:tt.map(ut=>ut.coordinates)}}}),U.current.addLayer({id:"custom-route",type:"line",source:"custom-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ff00ff","line-width":4,"line-opacity":.8}}))}},We=Ge=>{if(Ge.length<2)return 0;let tt=0;for(let ut=1;ut<Ge.length;ut++){const[Ve,De]=Ge[ut-1].coordinates,[Ke,nt]=Ge[ut].coordinates,ot=6371,Et=(nt-De)*Math.PI/180,Rt=(Ke-Ve)*Math.PI/180,lr=Math.sin(Et/2)*Math.sin(Et/2)+Math.cos(De*Math.PI/180)*Math.cos(nt*Math.PI/180)*Math.sin(Rt/2)*Math.sin(Rt/2),gr=2*Math.atan2(Math.sqrt(lr),Math.sqrt(1-lr));tt+=ot*gr}return tt},rt=()=>{s(!0),k([]),F("start"),t(`Nova Rota ${new Date().toLocaleDateString()}`),ne.current.forEach(Ge=>Ge.remove()),ne.current=[],U.current&&U.current.getLayer("custom-route")&&(U.current.removeLayer("custom-route"),U.current.removeSource("custom-route")),q(!0),setTimeout(()=>q(!1),8e3)},Ze=()=>{if(C.length<2){alert("Adicione pelo menos um ponto de partida e um destino!");return}const Ge={id:`route-${Date.now()}`,name:e||`Rota ${new Date().toLocaleDateString()}`,waypoints:C,distance:We(C),created:new Date},tt=[...I,Ge];A(tt),localStorage.setItem("technosutra-routes",JSON.stringify(tt)),w(Ge),s(!1),alert("Rota salva com sucesso!")},He=Ge=>{var tt;if(k(Ge.waypoints),w(Ge),t(Ge.name),s(!1),ze(Ge.waypoints),Ge.waypoints.length>0){const ut=new KK;Ge.waypoints.forEach(Ve=>ut.extend(Ve.coordinates)),(tt=U.current)==null||tt.fitBounds(ut,{padding:50})}},Ct=()=>{k([]),w(null),s(!1),o(""),d(""),ne.current.forEach(Ge=>Ge.remove()),ne.current=[],U.current&&U.current.getLayer("custom-route")&&(U.current.removeLayer("custom-route"),U.current.removeSource("custom-route"))},st=Ge=>{const tt=I.filter(ut=>ut.id!==Ge);A(tt),localStorage.setItem("technosutra-routes",JSON.stringify(tt)),(b==null?void 0:b.id)===Ge&&Ct()};return j.jsxs("div",{className:"h-screen bg-background flex",children:[j.jsx(Vt.div,{initial:{x:-400,opacity:0},animate:{x:0,opacity:1},className:"w-96 bg-card border-r border-border overflow-y-auto",children:j.jsxs("div",{className:"p-6 space-y-6",children:[j.jsxs("div",{children:[j.jsx("h1",{className:"text-2xl font-bold text-primary text-glow mb-2",children:"Criador de Rotas"}),j.jsx("p",{className:"text-sm text-muted-foreground",children:"Crie rotas personalizadas no mundo Techno Sutra"})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"space-y-2",children:[j.jsxs(Gv,{className:"text-foreground flex items-center gap-2",children:[j.jsx(eh,{className:"w-4 h-4 text-green-400"}),"Buscar Ponto de Partida"]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(qd,{value:r,onChange:Ge=>o(Ge.target.value),placeholder:"Ex: São Paulo, SP",className:"cyberpunk-input flex-1",onKeyPress:Ge=>Ge.key==="Enter"&&xe(r,"start")}),j.jsx(ar,{size:"sm",onClick:()=>xe(r,"start"),className:"neon-glow",disabled:!r.trim(),children:j.jsx(v0,{className:"w-4 h-4"})})]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsxs(Gv,{className:"text-foreground flex items-center gap-2",children:[j.jsx(eh,{className:"w-4 h-4 text-red-400"}),"Buscar Destino Final"]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(qd,{value:u,onChange:Ge=>d(Ge.target.value),placeholder:"Ex: Rio de Janeiro, RJ",className:"cyberpunk-input flex-1",onKeyPress:Ge=>Ge.key==="Enter"&&xe(u,"end")}),j.jsx(ar,{size:"sm",onClick:()=>xe(u,"end"),className:"neon-glow",disabled:!u.trim(),children:j.jsx(v0,{className:"w-4 h-4"})})]})]})]}),j.jsxs("div",{className:"space-y-2",children:[j.jsx(Gv,{htmlFor:"routeName",className:"text-foreground",children:"Nome da Rota"}),j.jsx(qd,{id:"routeName",value:e,onChange:Ge=>t(Ge.target.value),className:"cyberpunk-input",placeholder:"Digite o nome da rota..."})]}),j.jsxs(Km,{mode:"wait",children:[!h&&!b&&j.jsxs(Vt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-3",children:[j.jsxs(ar,{onClick:rt,className:"w-full gradient-neon text-black font-bold py-3",children:[j.jsx(CB,{className:"w-4 h-4 mr-2"}),"Começar Nova Rota"]}),j.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["1. Busque os locais acima",j.jsx("br",{}),'2. Clique em "Começar Nova Rota"',j.jsx("br",{}),"3. Clique no mapa para adicionar pontos"]})]}),h&&j.jsxs(Vt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[j.jsxs("div",{className:"bg-muted/20 p-4 rounded-lg border border-border",children:[j.jsx("h3",{className:"font-bold text-primary mb-2",children:"Modo Criação Ativo"}),j.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Clique no mapa para adicionar pontos:"}),j.jsx("div",{className:"space-y-2",children:[{type:"start",label:"🟢 Ponto de Partida",color:"bg-green-500"},{type:"end",label:"🔴 Destino Final",color:"bg-red-500"},{type:"waypoint",label:"🔵 Pontos Intermediários",color:"bg-cyan-500"}].map(({type:Ge,label:tt,color:ut})=>j.jsx(ar,{variant:B===Ge?"default":"outline",size:"sm",className:`w-full justify-start text-left ${B===Ge?"neon-glow":""}`,onClick:()=>F(Ge),children:tt},Ge))})]}),C.length>0&&j.jsxs(ri,{className:"cyberpunk-card p-4",children:[j.jsx("h4",{className:"font-bold text-primary mb-2",children:"Rota Atual"}),j.jsxs("div",{className:"space-y-1 text-sm",children:[j.jsxs("div",{children:["Pontos: ",C.length]}),j.jsxs("div",{children:["Distância: ",We(C).toFixed(2)," km"]}),j.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:[C.filter(Ge=>Ge.type==="start").length>0&&"✅ Partida definida",j.jsx("br",{}),C.filter(Ge=>Ge.type==="end").length>0&&"✅ Destino definido",j.jsx("br",{}),C.filter(Ge=>Ge.type==="waypoint").length>0&&`✅ ${C.filter(Ge=>Ge.type==="waypoint").length} pontos intermediários`]})]})]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsxs(ar,{onClick:Ze,disabled:C.length<2,className:"flex-1 gradient-neon text-black font-bold",children:[j.jsx(EB,{className:"w-4 h-4 mr-2"}),"Salvar"]}),j.jsxs(ar,{onClick:Ct,variant:"outline",className:"flex-1 border-destructive text-destructive",children:[j.jsx(NE,{className:"w-4 h-4 mr-2"}),"Limpar"]})]})]}),b&&!h&&j.jsxs(Vt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[j.jsxs(ri,{className:"cyberpunk-card p-4",children:[j.jsx("h3",{className:"font-bold text-primary mb-2",children:b.name}),j.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[j.jsxs("div",{children:["Pontos: ",b.waypoints.length]}),j.jsxs("div",{children:["Distância: ",b.distance.toFixed(2)," km"]}),j.jsxs("div",{children:["Criado: ",b.created.toLocaleDateString()]})]})]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(ar,{onClick:rt,className:"flex-1 gradient-neon text-black font-bold",children:"Nova Rota"}),j.jsx(ar,{onClick:Ct,variant:"outline",className:"flex-1",children:"Limpar"})]})]})]}),I.length>0&&j.jsxs("div",{className:"space-y-3",children:[j.jsx("h3",{className:"font-bold text-foreground",children:"Rotas Salvas"}),j.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:I.map(Ge=>j.jsx(ri,{className:"cyberpunk-card p-3",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex-1",children:[j.jsx("h4",{className:"font-bold text-sm text-primary",children:Ge.name}),j.jsxs("div",{className:"text-xs text-muted-foreground",children:[Ge.waypoints.length," pontos • ",Ge.distance.toFixed(1)," km"]})]}),j.jsxs("div",{className:"flex gap-1",children:[j.jsx(ar,{size:"sm",variant:"outline",onClick:()=>He(Ge),className:"px-2",children:"Ver"}),j.jsx(ar,{size:"sm",variant:"outline",onClick:()=>st(Ge.id),className:"px-2 text-destructive border-destructive",children:j.jsx(NE,{className:"w-3 h-3"})})]})]})},Ge.id))})]})]})}),j.jsxs("div",{className:"flex-1 relative",children:[j.jsx("div",{ref:V,className:"absolute inset-0"}),j.jsx(Km,{children:h&&X&&j.jsx(Vt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-4 left-4 right-4 z-10",children:j.jsxs(ri,{className:"cyberpunk-card p-4 text-center border-primary",children:[j.jsx("p",{className:"text-primary text-glow font-bold mb-1",children:"Modo de Criação Ativo"}),j.jsxs("p",{className:"text-sm text-muted-foreground",children:["Clique no mapa para adicionar: ",j.jsx("span",{className:"text-primary font-bold",children:B==="start"?"🟢 Ponto de Partida":B==="end"?"🔴 Destino Final":"🔵 Pontos Intermediários"})]})]})})}),h&&j.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:j.jsx(ri,{className:"cyberpunk-card p-3",children:j.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[j.jsx("div",{className:`w-3 h-3 rounded-full ${B==="start"?"bg-green-500":B==="end"?"bg-red-500":"bg-cyan-500"}`}),j.jsx("span",{className:"text-primary font-medium",children:B==="start"?"Clique para Ponto de Partida":B==="end"?"Clique para Destino Final":"Clique para Pontos Intermediários"})]})})})]})]})},rX=()=>{const[e]=iU(),t=kS(),r=K.useRef(null),[o,u]=K.useState(!0),[d,h]=K.useState(null),s=e.get("url"),b=e.get("title")||"Modelo 3D";K.useEffect(()=>{if(!s){h("URL do modelo não fornecida"),u(!1);return}const k=document.createElement("script");return k.type="module",k.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(k),k.onload=()=>{u(!1)},k.onerror=()=>{h("Erro ao carregar o visualizador 3D"),u(!1)},()=>{document.head.removeChild(k)}},[s]);const w=()=>{if(s){const k=document.createElement("a");k.href=s,k.download=`technosutra_${b.replace(/\s+/g,"_")}.glb`,document.body.appendChild(k),k.click(),document.body.removeChild(k)}},C=()=>{r.current&&(r.current.resetTurntableRotation(),r.current.jumpCameraToGoal())};return d?j.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:j.jsxs(ri,{className:"cyberpunk-card p-8 max-w-md text-center",children:[j.jsx("h2",{className:"text-xl font-bold text-destructive mb-4",children:"Erro"}),j.jsx("p",{className:"text-muted-foreground mb-6",children:d}),j.jsxs(ar,{onClick:()=>t("/map"),className:"gradient-neon text-black font-bold",children:[j.jsx(zE,{className:"w-4 h-4 mr-2"}),"Voltar ao Mapa"]})]})}):j.jsxs("div",{className:"min-h-screen bg-background",children:[j.jsx(Vt.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},className:"fixed top-0 left-0 right-0 z-50 bg-background/90 backdrop-blur-md border-b border-border",children:j.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[j.jsxs("div",{className:"flex items-center gap-4",children:[j.jsxs(ar,{variant:"ghost",size:"sm",onClick:()=>t("/map"),className:"neon-glow",children:[j.jsx(zE,{className:"w-4 h-4 mr-2"}),"Voltar"]}),j.jsx("h1",{className:"text-xl font-bold text-primary text-glow",children:b})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsxs(ar,{variant:"outline",size:"sm",onClick:C,className:"purple-glow",children:[j.jsx(PB,{className:"w-4 h-4 mr-2"}),"Reset"]}),j.jsxs(ar,{variant:"outline",size:"sm",onClick:w,className:"border-neon",children:[j.jsx(ER,{className:"w-4 h-4 mr-2"}),"Download"]})]})]})}),o&&j.jsx(Vt.div,{initial:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-background flex items-center justify-center",children:j.jsxs("div",{className:"text-center",children:[j.jsx(Vt.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),j.jsx(Vt.h2,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"text-xl font-bold text-primary text-glow",children:"Carregando Modelo 3D..."})]})}),j.jsx(Vt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:"pt-20 h-screen",children:j.jsx("model-viewer",{ref:r,src:s,alt:b,"auto-rotate":!0,"camera-controls":!0,"environment-image":"https://modelviewer.dev/shared-assets/environments/moon_1k.hdr",style:{width:"100%",height:"calc(100vh - 80px)",background:"linear-gradient(135deg, #000000 0%, #1a1a2e 50%, #16213e 100%)"},loading:"eager",reveal:"auto","tone-mapping":"aces","shadow-intensity":"1","shadow-softness":"0.5","interaction-prompt":"none",children:j.jsx("div",{className:"progress-bar hide",slot:"progress-bar",children:j.jsx("div",{className:"update-bar"})})})}),j.jsx(Vt.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"fixed bottom-4 left-4 right-4 z-30",children:j.jsx(ri,{className:"cyberpunk-card p-4 mx-auto max-w-2xl",children:j.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[j.jsxs("p",{className:"mb-2",children:[j.jsx("strong",{className:"text-primary",children:"Controles:"})," Arraste para rotacionar • Scroll para zoom • Clique duplo para focar"]}),j.jsxs("p",{className:"text-xs",children:["Modelo 3D do ",b," - Parte da jornada sagrada Techno Sutra"]})]})})})]})};var _b="focusScope.autoFocusOnMount",xb="focusScope.autoFocusOnUnmount",xA={bubbles:!1,cancelable:!0},nX="FocusScope",Cz=K.forwardRef((e,t)=>{const{loop:r=!1,trapped:o=!1,onMountAutoFocus:u,onUnmountAutoFocus:d,...h}=e,[s,b]=K.useState(null),w=ya(u),C=ya(d),k=K.useRef(null),I=Zi(t,F=>b(F)),A=K.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;K.useEffect(()=>{if(o){let F=function(U){if(A.paused||!s)return;const ne=U.target;s.contains(ne)?k.current=ne:Gl(k.current,{select:!0})},X=function(U){if(A.paused||!s)return;const ne=U.relatedTarget;ne!==null&&(s.contains(ne)||Gl(k.current,{select:!0}))},q=function(U){if(document.activeElement===document.body)for(const de of U)de.removedNodes.length>0&&Gl(s)};document.addEventListener("focusin",F),document.addEventListener("focusout",X);const V=new MutationObserver(q);return s&&V.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",F),document.removeEventListener("focusout",X),V.disconnect()}}},[o,s,A.paused]),K.useEffect(()=>{if(s){wA.add(A);const F=document.activeElement;if(!s.contains(F)){const q=new CustomEvent(_b,xA);s.addEventListener(_b,w),s.dispatchEvent(q),q.defaultPrevented||(iX(cX(Pz(s)),{select:!0}),document.activeElement===F&&Gl(s))}return()=>{s.removeEventListener(_b,w),setTimeout(()=>{const q=new CustomEvent(xb,xA);s.addEventListener(xb,C),s.dispatchEvent(q),q.defaultPrevented||Gl(F??document.body,{select:!0}),s.removeEventListener(xb,C),wA.remove(A)},0)}}},[s,w,C,A]);const B=K.useCallback(F=>{if(!r&&!o||A.paused)return;const X=F.key==="Tab"&&!F.altKey&&!F.ctrlKey&&!F.metaKey,q=document.activeElement;if(X&&q){const V=F.currentTarget,[U,ne]=oX(V);U&&ne?!F.shiftKey&&q===ne?(F.preventDefault(),r&&Gl(U,{select:!0})):F.shiftKey&&q===U&&(F.preventDefault(),r&&Gl(ne,{select:!0})):q===V&&F.preventDefault()}},[r,o,A.paused]);return j.jsx(Sn.div,{tabIndex:-1,...h,ref:I,onKeyDown:B})});Cz.displayName=nX;function iX(e,{select:t=!1}={}){const r=document.activeElement;for(const o of e)if(Gl(o,{select:t}),document.activeElement!==r)return}function oX(e){const t=Pz(e),r=bA(t,e),o=bA(t.reverse(),e);return[r,o]}function Pz(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const u=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||u?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function bA(e,t){for(const r of e)if(!sX(r,{upTo:t}))return r}function sX(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function aX(e){return e instanceof HTMLInputElement&&"select"in e}function Gl(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&aX(e)&&t&&e.select()}}var wA=lX();function lX(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=SA(e,t),e.unshift(t)},remove(t){var r;e=SA(e,t),(r=e[0])==null||r.resume()}}}function SA(e,t){const r=[...e],o=r.indexOf(t);return o!==-1&&r.splice(o,1),r}function cX(e){return e.filter(t=>t.tagName!=="A")}var bb=0;function uX(){K.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??TA()),document.body.insertAdjacentElement("beforeend",e[1]??TA()),bb++,()=>{bb===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),bb--}},[])}function TA(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var aa=function(){return aa=Object.assign||function(t){for(var r,o=1,u=arguments.length;o<u;o++){r=arguments[o];for(var d in r)Object.prototype.hasOwnProperty.call(r,d)&&(t[d]=r[d])}return t},aa.apply(this,arguments)};function Ez(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(e);u<o.length;u++)t.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(e,o[u])&&(r[o[u]]=e[o[u]]);return r}function hX(e,t,r){if(r||arguments.length===2)for(var o=0,u=t.length,d;o<u;o++)(d||!(o in t))&&(d||(d=Array.prototype.slice.call(t,0,o)),d[o]=t[o]);return e.concat(d||Array.prototype.slice.call(t))}var qv="right-scroll-bar-position",Zv="width-before-scroll-bar",dX="with-scroll-bars-hidden",pX="--removed-body-scroll-bar-size";function wb(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function fX(e,t){var r=K.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(o){var u=r.value;u!==o&&(r.value=o,r.callback(o,u))}}}})[0];return r.callback=t,r.facade}var mX=typeof window<"u"?K.useLayoutEffect:K.useEffect,CA=new WeakMap;function gX(e,t){var r=fX(null,function(o){return e.forEach(function(u){return wb(u,o)})});return mX(function(){var o=CA.get(r);if(o){var u=new Set(o),d=new Set(e),h=r.current;u.forEach(function(s){d.has(s)||wb(s,null)}),d.forEach(function(s){u.has(s)||wb(s,h)})}CA.set(r,e)},[e]),r}function yX(e){return e}function vX(e,t){t===void 0&&(t=yX);var r=[],o=!1,u={read:function(){if(o)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(d){var h=t(d,o);return r.push(h),function(){r=r.filter(function(s){return s!==h})}},assignSyncMedium:function(d){for(o=!0;r.length;){var h=r;r=[],h.forEach(d)}r={push:function(s){return d(s)},filter:function(){return r}}},assignMedium:function(d){o=!0;var h=[];if(r.length){var s=r;r=[],s.forEach(d),h=r}var b=function(){var C=h;h=[],C.forEach(d)},w=function(){return Promise.resolve().then(b)};w(),r={push:function(C){h.push(C),w()},filter:function(C){return h=h.filter(C),r}}}};return u}function _X(e){e===void 0&&(e={});var t=vX(null);return t.options=aa({async:!0,ssr:!1},e),t}var Mz=function(e){var t=e.sideCar,r=Ez(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var o=t.read();if(!o)throw new Error("Sidecar medium not found");return K.createElement(o,aa({},r))};Mz.isSideCarExport=!0;function xX(e,t){return e.useMedium(t),Mz}var kz=_X(),Sb=function(){},U_=K.forwardRef(function(e,t){var r=K.useRef(null),o=K.useState({onScrollCapture:Sb,onWheelCapture:Sb,onTouchMoveCapture:Sb}),u=o[0],d=o[1],h=e.forwardProps,s=e.children,b=e.className,w=e.removeScrollBar,C=e.enabled,k=e.shards,I=e.sideCar,A=e.noRelative,B=e.noIsolation,F=e.inert,X=e.allowPinchZoom,q=e.as,V=q===void 0?"div":q,U=e.gapMode,ne=Ez(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),de=I,xe=gX([r,t]),ke=aa(aa({},ne),u);return K.createElement(K.Fragment,null,C&&K.createElement(de,{sideCar:kz,removeScrollBar:w,shards:k,noRelative:A,noIsolation:B,inert:F,setCallbacks:d,allowPinchZoom:!!X,lockRef:r,gapMode:U}),h?K.cloneElement(K.Children.only(s),aa(aa({},ke),{ref:xe})):K.createElement(V,aa({},ke,{className:b,ref:xe}),s))});U_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};U_.classNames={fullWidth:Zv,zeroRight:qv};var bX=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function wX(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=bX();return t&&e.setAttribute("nonce",t),e}function SX(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function TX(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var CX=function(){var e=0,t=null;return{add:function(r){e==0&&(t=wX())&&(SX(t,r),TX(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},PX=function(){var e=CX();return function(t,r){K.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Az=function(){var e=PX(),t=function(r){var o=r.styles,u=r.dynamic;return e(o,u),null};return t},EX={left:0,top:0,right:0,gap:0},Tb=function(e){return parseInt(e||"",10)||0},MX=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],o=t[e==="padding"?"paddingTop":"marginTop"],u=t[e==="padding"?"paddingRight":"marginRight"];return[Tb(r),Tb(o),Tb(u)]},kX=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return EX;var t=MX(e),r=document.documentElement.clientWidth,o=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,o-r+t[2]-t[0])}},AX=Az(),Zd="data-scroll-locked",IX=function(e,t,r,o){var u=e.left,d=e.top,h=e.right,s=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(dX,` {
   overflow: hidden `).concat(o,`;
   padding-right: `).concat(s,"px ").concat(o,`;
  }
  body[`).concat(Zd,`] {
    overflow: hidden `).concat(o,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(o,";"),r==="margin"&&`
    padding-left: `.concat(u,`px;
    padding-top: `).concat(d,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(o,`;
    `),r==="padding"&&"padding-right: ".concat(s,"px ").concat(o,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(qv,` {
    right: `).concat(s,"px ").concat(o,`;
  }
  
  .`).concat(Zv,` {
    margin-right: `).concat(s,"px ").concat(o,`;
  }
  
  .`).concat(qv," .").concat(qv,` {
    right: 0 `).concat(o,`;
  }
  
  .`).concat(Zv," .").concat(Zv,` {
    margin-right: 0 `).concat(o,`;
  }
  
  body[`).concat(Zd,`] {
    `).concat(pX,": ").concat(s,`px;
  }
`)},PA=function(){var e=parseInt(document.body.getAttribute(Zd)||"0",10);return isFinite(e)?e:0},RX=function(){K.useEffect(function(){return document.body.setAttribute(Zd,(PA()+1).toString()),function(){var e=PA()-1;e<=0?document.body.removeAttribute(Zd):document.body.setAttribute(Zd,e.toString())}},[])},LX=function(e){var t=e.noRelative,r=e.noImportant,o=e.gapMode,u=o===void 0?"margin":o;RX();var d=K.useMemo(function(){return kX(u)},[u]);return K.createElement(AX,{styles:IX(d,!t,u,r?"":"!important")})},d2=!1;if(typeof window<"u")try{var yv=Object.defineProperty({},"passive",{get:function(){return d2=!0,!0}});window.addEventListener("test",yv,yv),window.removeEventListener("test",yv,yv)}catch{d2=!1}var ud=d2?{passive:!1}:!1,DX=function(e){return e.tagName==="TEXTAREA"},Iz=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!DX(e)&&r[t]==="visible")},zX=function(e){return Iz(e,"overflowY")},NX=function(e){return Iz(e,"overflowX")},EA=function(e,t){var r=t.ownerDocument,o=t;do{typeof ShadowRoot<"u"&&o instanceof ShadowRoot&&(o=o.host);var u=Rz(e,o);if(u){var d=Lz(e,o),h=d[1],s=d[2];if(h>s)return!0}o=o.parentNode}while(o&&o!==r.body);return!1},jX=function(e){var t=e.scrollTop,r=e.scrollHeight,o=e.clientHeight;return[t,r,o]},OX=function(e){var t=e.scrollLeft,r=e.scrollWidth,o=e.clientWidth;return[t,r,o]},Rz=function(e,t){return e==="v"?zX(t):NX(t)},Lz=function(e,t){return e==="v"?jX(t):OX(t)},FX=function(e,t){return e==="h"&&t==="rtl"?-1:1},BX=function(e,t,r,o,u){var d=FX(e,window.getComputedStyle(t).direction),h=d*o,s=r.target,b=t.contains(s),w=!1,C=h>0,k=0,I=0;do{if(!s)break;var A=Lz(e,s),B=A[0],F=A[1],X=A[2],q=F-X-d*B;(B||q)&&Rz(e,s)&&(k+=q,I+=B);var V=s.parentNode;s=V&&V.nodeType===Node.DOCUMENT_FRAGMENT_NODE?V.host:V}while(!b&&s!==document.body||b&&(t.contains(s)||t===s));return(C&&Math.abs(k)<1||!C&&Math.abs(I)<1)&&(w=!0),w},vv=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},MA=function(e){return[e.deltaX,e.deltaY]},kA=function(e){return e&&"current"in e?e.current:e},$X=function(e,t){return e[0]===t[0]&&e[1]===t[1]},VX=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},UX=0,hd=[];function GX(e){var t=K.useRef([]),r=K.useRef([0,0]),o=K.useRef(),u=K.useState(UX++)[0],d=K.useState(Az)[0],h=K.useRef(e);K.useEffect(function(){h.current=e},[e]),K.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(u));var F=hX([e.lockRef.current],(e.shards||[]).map(kA),!0).filter(Boolean);return F.forEach(function(X){return X.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),F.forEach(function(X){return X.classList.remove("allow-interactivity-".concat(u))})}}},[e.inert,e.lockRef.current,e.shards]);var s=K.useCallback(function(F,X){if("touches"in F&&F.touches.length===2||F.type==="wheel"&&F.ctrlKey)return!h.current.allowPinchZoom;var q=vv(F),V=r.current,U="deltaX"in F?F.deltaX:V[0]-q[0],ne="deltaY"in F?F.deltaY:V[1]-q[1],de,xe=F.target,ke=Math.abs(U)>Math.abs(ne)?"h":"v";if("touches"in F&&ke==="h"&&xe.type==="range")return!1;var ze=EA(ke,xe);if(!ze)return!0;if(ze?de=ke:(de=ke==="v"?"h":"v",ze=EA(ke,xe)),!ze)return!1;if(!o.current&&"changedTouches"in F&&(U||ne)&&(o.current=de),!de)return!0;var We=o.current||de;return BX(We,X,F,We==="h"?U:ne)},[]),b=K.useCallback(function(F){var X=F;if(!(!hd.length||hd[hd.length-1]!==d)){var q="deltaY"in X?MA(X):vv(X),V=t.current.filter(function(de){return de.name===X.type&&(de.target===X.target||X.target===de.shadowParent)&&$X(de.delta,q)})[0];if(V&&V.should){X.cancelable&&X.preventDefault();return}if(!V){var U=(h.current.shards||[]).map(kA).filter(Boolean).filter(function(de){return de.contains(X.target)}),ne=U.length>0?s(X,U[0]):!h.current.noIsolation;ne&&X.cancelable&&X.preventDefault()}}},[]),w=K.useCallback(function(F,X,q,V){var U={name:F,delta:X,target:q,should:V,shadowParent:qX(q)};t.current.push(U),setTimeout(function(){t.current=t.current.filter(function(ne){return ne!==U})},1)},[]),C=K.useCallback(function(F){r.current=vv(F),o.current=void 0},[]),k=K.useCallback(function(F){w(F.type,MA(F),F.target,s(F,e.lockRef.current))},[]),I=K.useCallback(function(F){w(F.type,vv(F),F.target,s(F,e.lockRef.current))},[]);K.useEffect(function(){return hd.push(d),e.setCallbacks({onScrollCapture:k,onWheelCapture:k,onTouchMoveCapture:I}),document.addEventListener("wheel",b,ud),document.addEventListener("touchmove",b,ud),document.addEventListener("touchstart",C,ud),function(){hd=hd.filter(function(F){return F!==d}),document.removeEventListener("wheel",b,ud),document.removeEventListener("touchmove",b,ud),document.removeEventListener("touchstart",C,ud)}},[]);var A=e.removeScrollBar,B=e.inert;return K.createElement(K.Fragment,null,B?K.createElement(d,{styles:VX(u)}):null,A?K.createElement(LX,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function qX(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ZX=xX(kz,GX);var Dz=K.forwardRef(function(e,t){return K.createElement(U_,aa({},e,{ref:t,sideCar:ZX}))});Dz.classNames=U_.classNames;var WX=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},dd=new WeakMap,_v=new WeakMap,xv={},Cb=0,zz=function(e){return e&&(e.host||zz(e.parentNode))},HX=function(e,t){return t.map(function(r){if(e.contains(r))return r;var o=zz(r);return o&&e.contains(o)?o:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},KX=function(e,t,r,o){var u=HX(t,Array.isArray(e)?e:[e]);xv[r]||(xv[r]=new WeakMap);var d=xv[r],h=[],s=new Set,b=new Set(u),w=function(k){!k||s.has(k)||(s.add(k),w(k.parentNode))};u.forEach(w);var C=function(k){!k||b.has(k)||Array.prototype.forEach.call(k.children,function(I){if(s.has(I))C(I);else try{var A=I.getAttribute(o),B=A!==null&&A!=="false",F=(dd.get(I)||0)+1,X=(d.get(I)||0)+1;dd.set(I,F),d.set(I,X),h.push(I),F===1&&B&&_v.set(I,!0),X===1&&I.setAttribute(r,"true"),B||I.setAttribute(o,"true")}catch(q){console.error("aria-hidden: cannot operate on ",I,q)}})};return C(t),s.clear(),Cb++,function(){h.forEach(function(k){var I=dd.get(k)-1,A=d.get(k)-1;dd.set(k,I),d.set(k,A),I||(_v.has(k)||k.removeAttribute(o),_v.delete(k)),A||k.removeAttribute(r)}),Cb--,Cb||(dd=new WeakMap,dd=new WeakMap,_v=new WeakMap,xv={})}},XX=function(e,t,r){r===void 0&&(r="data-aria-hidden");var o=Array.from(Array.isArray(e)?e:[e]),u=WX(e);return u?(o.push.apply(o,Array.from(u.querySelectorAll("[aria-live], script"))),KX(o,u,r,"aria-hidden")):function(){return null}},G_="Dialog",[Nz,_Q]=pg(G_),[YX,js]=Nz(G_),jz=e=>{const{__scopeDialog:t,children:r,open:o,defaultOpen:u,onOpenChange:d,modal:h=!0}=e,s=K.useRef(null),b=K.useRef(null),[w,C]=iR({prop:o,defaultProp:u??!1,onChange:d,caller:G_});return j.jsx(YX,{scope:t,triggerRef:s,contentRef:b,contentId:O1(),titleId:O1(),descriptionId:O1(),open:w,onOpenChange:C,onOpenToggle:K.useCallback(()=>C(k=>!k),[C]),modal:h,children:r})};jz.displayName=G_;var Oz="DialogTrigger",Fz=K.forwardRef((e,t)=>{const{__scopeDialog:r,...o}=e,u=js(Oz,r),d=Zi(t,u.triggerRef);return j.jsx(Sn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":u.open,"aria-controls":u.contentId,"data-state":IT(u.open),...o,ref:d,onClick:Yr(e.onClick,u.onOpenToggle)})});Fz.displayName=Oz;var kT="DialogPortal",[QX,Bz]=Nz(kT,{forceMount:void 0}),$z=e=>{const{__scopeDialog:t,forceMount:r,children:o,container:u}=e,d=js(kT,t);return j.jsx(QX,{scope:t,forceMount:r,children:K.Children.map(o,h=>j.jsx(yp,{present:r||d.open,children:j.jsx(lS,{asChild:!0,container:u,children:h})}))})};$z.displayName=kT;var U0="DialogOverlay",Vz=K.forwardRef((e,t)=>{const r=Bz(U0,e.__scopeDialog),{forceMount:o=r.forceMount,...u}=e,d=js(U0,e.__scopeDialog);return d.modal?j.jsx(yp,{present:o||d.open,children:j.jsx(eY,{...u,ref:t})}):null});Vz.displayName=U0;var JX=Fm("DialogOverlay.RemoveScroll"),eY=K.forwardRef((e,t)=>{const{__scopeDialog:r,...o}=e,u=js(U0,r);return j.jsx(Dz,{as:JX,allowPinchZoom:!0,shards:[u.contentRef],children:j.jsx(Sn.div,{"data-state":IT(u.open),...o,ref:t,style:{pointerEvents:"auto",...o.style}})})}),ih="DialogContent",Uz=K.forwardRef((e,t)=>{const r=Bz(ih,e.__scopeDialog),{forceMount:o=r.forceMount,...u}=e,d=js(ih,e.__scopeDialog);return j.jsx(yp,{present:o||d.open,children:d.modal?j.jsx(tY,{...u,ref:t}):j.jsx(rY,{...u,ref:t})})});Uz.displayName=ih;var tY=K.forwardRef((e,t)=>{const r=js(ih,e.__scopeDialog),o=K.useRef(null),u=Zi(t,r.contentRef,o);return K.useEffect(()=>{const d=o.current;if(d)return XX(d)},[]),j.jsx(Gz,{...e,ref:u,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Yr(e.onCloseAutoFocus,d=>{var h;d.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Yr(e.onPointerDownOutside,d=>{const h=d.detail.originalEvent,s=h.button===0&&h.ctrlKey===!0;(h.button===2||s)&&d.preventDefault()}),onFocusOutside:Yr(e.onFocusOutside,d=>d.preventDefault())})}),rY=K.forwardRef((e,t)=>{const r=js(ih,e.__scopeDialog),o=K.useRef(!1),u=K.useRef(!1);return j.jsx(Gz,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:d=>{var h,s;(h=e.onCloseAutoFocus)==null||h.call(e,d),d.defaultPrevented||(o.current||(s=r.triggerRef.current)==null||s.focus(),d.preventDefault()),o.current=!1,u.current=!1},onInteractOutside:d=>{var b,w;(b=e.onInteractOutside)==null||b.call(e,d),d.defaultPrevented||(o.current=!0,d.detail.originalEvent.type==="pointerdown"&&(u.current=!0));const h=d.target;((w=r.triggerRef.current)==null?void 0:w.contains(h))&&d.preventDefault(),d.detail.originalEvent.type==="focusin"&&u.current&&d.preventDefault()}})}),Gz=K.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:d,...h}=e,s=js(ih,r),b=K.useRef(null),w=Zi(t,b);return uX(),j.jsxs(j.Fragment,{children:[j.jsx(Cz,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:u,onUnmountAutoFocus:d,children:j.jsx(a_,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":IT(s.open),...h,ref:w,onDismiss:()=>s.onOpenChange(!1)})}),j.jsxs(j.Fragment,{children:[j.jsx(nY,{titleId:s.titleId}),j.jsx(oY,{contentRef:b,descriptionId:s.descriptionId})]})]})}),AT="DialogTitle",qz=K.forwardRef((e,t)=>{const{__scopeDialog:r,...o}=e,u=js(AT,r);return j.jsx(Sn.h2,{id:u.titleId,...o,ref:t})});qz.displayName=AT;var Zz="DialogDescription",Wz=K.forwardRef((e,t)=>{const{__scopeDialog:r,...o}=e,u=js(Zz,r);return j.jsx(Sn.p,{id:u.descriptionId,...o,ref:t})});Wz.displayName=Zz;var Hz="DialogClose",Kz=K.forwardRef((e,t)=>{const{__scopeDialog:r,...o}=e,u=js(Hz,r);return j.jsx(Sn.button,{type:"button",...o,ref:t,onClick:Yr(e.onClick,()=>u.onOpenChange(!1))})});Kz.displayName=Hz;function IT(e){return e?"open":"closed"}var Xz="DialogTitleWarning",[xQ,Yz]=wF(Xz,{contentName:ih,titleName:AT,docsSlug:"dialog"}),nY=({titleId:e})=>{const t=Yz(Xz),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return K.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},iY="DialogDescriptionWarning",oY=({contentRef:e,descriptionId:t})=>{const o=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Yz(iY).contentName}}.`;return K.useEffect(()=>{var d;const u=(d=e.current)==null?void 0:d.getAttribute("aria-describedby");t&&u&&(document.getElementById(t)||console.warn(o))},[o,e,t]),null},sY=jz,aY=Fz,lY=$z,Qz=Vz,Jz=Uz,e4=qz,t4=Wz,cY=Kz;const uY=sY,hY=aY,dY=lY,r4=K.forwardRef(({className:e,...t},r)=>j.jsx(Qz,{className:Tn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));r4.displayName=Qz.displayName;const pY=mg("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),n4=K.forwardRef(({side:e="right",className:t,children:r,...o},u)=>j.jsxs(dY,{children:[j.jsx(r4,{}),j.jsxs(Jz,{ref:u,className:Tn(pY({side:e}),t),...o,children:[r,j.jsxs(cY,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[j.jsx(fS,{className:"h-4 w-4"}),j.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));n4.displayName=Jz.displayName;const fY=K.forwardRef(({className:e,...t},r)=>j.jsx(e4,{ref:r,className:Tn("text-lg font-semibold text-foreground",e),...t}));fY.displayName=e4.displayName;const mY=K.forwardRef(({className:e,...t},r)=>j.jsx(t4,{ref:r,className:Tn("text-sm text-muted-foreground",e),...t}));mY.displayName=t4.displayName;const gY=()=>{const e=ch(),{t}=zL(),r=[{path:"/",icon:xB,label:t("nav.home")},{path:"/map",icon:wB,label:t("nav.map")},{path:"/gallery",icon:_0,label:t("nav.gallery")},{path:"/route-creator",icon:pS,label:t("nav.routeCreator")}],o=({isMobile:u=!1})=>j.jsx("div",{className:`flex ${u?"flex-col space-y-4":"space-x-4"}`,children:r.map(d=>{const h=d.icon,s=e.pathname===d.path;return j.jsx(ar,{asChild:!0,variant:s?"default":"ghost",className:`${s?"gradient-neon text-black":"text-foreground hover:text-primary"} 
                       ${u?"w-full justify-start":""}`,children:j.jsxs(Xl,{to:d.path,children:[j.jsx(h,{className:"w-4 h-4 mr-2"}),d.label]})},d.path)})});return j.jsxs(j.Fragment,{children:[j.jsx(Vt.nav,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},className:"hidden md:block fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-md border-b border-border",children:j.jsx("div",{className:"container mx-auto px-6 py-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs(Xl,{to:"/",className:"flex items-center space-x-3",children:[j.jsx("div",{className:"w-8 h-8 bg-gradient-neon rounded-lg"}),j.jsx("span",{className:"text-xl font-bold text-primary text-glow",children:"Techno Sutra"})]}),j.jsxs("div",{className:"flex items-center gap-4",children:[j.jsx(o,{}),j.jsx(pM,{})]})]})})}),j.jsx("div",{className:"md:hidden fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-md border-b border-border",children:j.jsxs("div",{className:"flex items-center justify-between p-4",children:[j.jsxs(Xl,{to:"/",className:"flex items-center space-x-2",children:[j.jsx("div",{className:"w-6 h-6 bg-gradient-neon rounded"}),j.jsx("span",{className:"font-bold text-primary text-glow",children:"Techno Sutra"})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(pM,{}),j.jsxs(uY,{children:[j.jsx(hY,{asChild:!0,children:j.jsx(ar,{variant:"ghost",size:"sm",children:j.jsx(TB,{className:"w-5 h-5"})})}),j.jsx(n4,{side:"right",className:"cyberpunk-card",children:j.jsx("div",{className:"mt-8",children:j.jsx(o,{isMobile:!0})})})]})]})]})}),j.jsx("div",{className:"h-16 md:h-20"})]})},yY=()=>{const e=ch();return K.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:j.jsxs("div",{className:"text-center",children:[j.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),j.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),j.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},vY=new J$,_Y=()=>j.jsx(tV,{client:vY,children:j.jsx(aU,{children:j.jsxs(k$,{children:[j.jsx(u6,{}),j.jsx(V6,{}),j.jsx(eU,{children:j.jsxs("div",{className:"dark",children:[j.jsx(gY,{}),j.jsxs(ZV,{children:[j.jsx(Su,{path:"/",element:j.jsx(Lq,{})}),j.jsx(Su,{path:"/map",element:j.jsx(wz,{})}),j.jsx(Su,{path:"/gallery",element:j.jsx(QK,{})}),j.jsx(Su,{path:"/route-creator",element:j.jsx(tX,{})}),j.jsx(Su,{path:"/model-viewer",element:j.jsx(rX,{})}),j.jsx(Su,{path:"*",element:j.jsx(yY,{})})]})]})})]})})});Y5(document.getElementById("root")).render(j.jsx(_Y,{}));
